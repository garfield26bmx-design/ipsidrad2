(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const v of g.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&a(v)}).observe(document,{childList:!0,subtree:!0});function s(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerPolicy&&(g.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?g.credentials="include":h.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function a(h){if(h.ep)return;h.ep=!0;const g=s(h);fetch(h.href,g)}})();var JP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k2={exports:{}},Qf={},E2={exports:{}},Qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sd=Symbol.for("react.element"),QP=Symbol.for("react.portal"),eA=Symbol.for("react.fragment"),tA=Symbol.for("react.strict_mode"),nA=Symbol.for("react.profiler"),iA=Symbol.for("react.provider"),rA=Symbol.for("react.context"),sA=Symbol.for("react.forward_ref"),oA=Symbol.for("react.suspense"),aA=Symbol.for("react.memo"),lA=Symbol.for("react.lazy"),g1=Symbol.iterator;function cA(e){return e===null||typeof e!="object"?null:(e=g1&&e[g1]||e["@@iterator"],typeof e=="function"?e:null)}var C2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P2=Object.assign,A2={};function Uc(e,t,s){this.props=e,this.context=t,this.refs=A2,this.updater=s||C2}Uc.prototype.isReactComponent={};Uc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Uc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function I2(){}I2.prototype=Uc.prototype;function t_(e,t,s){this.props=e,this.context=t,this.refs=A2,this.updater=s||C2}var n_=t_.prototype=new I2;n_.constructor=t_;P2(n_,Uc.prototype);n_.isPureReactComponent=!0;var y1=Array.isArray,M2=Object.prototype.hasOwnProperty,i_={current:null},L2={key:!0,ref:!0,__self:!0,__source:!0};function z2(e,t,s){var a,h={},g=null,v=null;if(t!=null)for(a in t.ref!==void 0&&(v=t.ref),t.key!==void 0&&(g=""+t.key),t)M2.call(t,a)&&!L2.hasOwnProperty(a)&&(h[a]=t[a]);var c=arguments.length-2;if(c===1)h.children=s;else if(1<c){for(var C=Array(c),k=0;k<c;k++)C[k]=arguments[k+2];h.children=C}if(e&&e.defaultProps)for(a in c=e.defaultProps,c)h[a]===void 0&&(h[a]=c[a]);return{$$typeof:sd,type:e,key:g,ref:v,props:h,_owner:i_.current}}function uA(e,t){return{$$typeof:sd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function r_(e){return typeof e=="object"&&e!==null&&e.$$typeof===sd}function hA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var _1=/\/+/g;function jg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?hA(""+e.key):t.toString(36)}function Kp(e,t,s,a,h){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var v=!1;if(e===null)v=!0;else switch(g){case"string":case"number":v=!0;break;case"object":switch(e.$$typeof){case sd:case QP:v=!0}}if(v)return v=e,h=h(v),e=a===""?"."+jg(v,0):a,y1(h)?(s="",e!=null&&(s=e.replace(_1,"$&/")+"/"),Kp(h,t,s,"",function(k){return k})):h!=null&&(r_(h)&&(h=uA(h,s+(!h.key||v&&v.key===h.key?"":(""+h.key).replace(_1,"$&/")+"/")+e)),t.push(h)),1;if(v=0,a=a===""?".":a+":",y1(e))for(var c=0;c<e.length;c++){g=e[c];var C=a+jg(g,c);v+=Kp(g,t,s,C,h)}else if(C=cA(e),typeof C=="function")for(e=C.call(e),c=0;!(g=e.next()).done;)g=g.value,C=a+jg(g,c++),v+=Kp(g,t,s,C,h);else if(g==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return v}function Tp(e,t,s){if(e==null)return e;var a=[],h=0;return Kp(e,a,"","",function(g){return t.call(s,g,h++)}),a}function dA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xr={current:null},Xp={transition:null},pA={ReactCurrentDispatcher:xr,ReactCurrentBatchConfig:Xp,ReactCurrentOwner:i_};function D2(){throw Error("act(...) is not supported in production builds of React.")}Qt.Children={map:Tp,forEach:function(e,t,s){Tp(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Tp(e,function(){t++}),t},toArray:function(e){return Tp(e,function(t){return t})||[]},only:function(e){if(!r_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qt.Component=Uc;Qt.Fragment=eA;Qt.Profiler=nA;Qt.PureComponent=t_;Qt.StrictMode=tA;Qt.Suspense=oA;Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pA;Qt.act=D2;Qt.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=P2({},e.props),h=e.key,g=e.ref,v=e._owner;if(t!=null){if(t.ref!==void 0&&(g=t.ref,v=i_.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(C in t)M2.call(t,C)&&!L2.hasOwnProperty(C)&&(a[C]=t[C]===void 0&&c!==void 0?c[C]:t[C])}var C=arguments.length-2;if(C===1)a.children=s;else if(1<C){c=Array(C);for(var k=0;k<C;k++)c[k]=arguments[k+2];a.children=c}return{$$typeof:sd,type:e.type,key:h,ref:g,props:a,_owner:v}};Qt.createContext=function(e){return e={$$typeof:rA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:iA,_context:e},e.Consumer=e};Qt.createElement=z2;Qt.createFactory=function(e){var t=z2.bind(null,e);return t.type=e,t};Qt.createRef=function(){return{current:null}};Qt.forwardRef=function(e){return{$$typeof:sA,render:e}};Qt.isValidElement=r_;Qt.lazy=function(e){return{$$typeof:lA,_payload:{_status:-1,_result:e},_init:dA}};Qt.memo=function(e,t){return{$$typeof:aA,type:e,compare:t===void 0?null:t}};Qt.startTransition=function(e){var t=Xp.transition;Xp.transition={};try{e()}finally{Xp.transition=t}};Qt.unstable_act=D2;Qt.useCallback=function(e,t){return xr.current.useCallback(e,t)};Qt.useContext=function(e){return xr.current.useContext(e)};Qt.useDebugValue=function(){};Qt.useDeferredValue=function(e){return xr.current.useDeferredValue(e)};Qt.useEffect=function(e,t){return xr.current.useEffect(e,t)};Qt.useId=function(){return xr.current.useId()};Qt.useImperativeHandle=function(e,t,s){return xr.current.useImperativeHandle(e,t,s)};Qt.useInsertionEffect=function(e,t){return xr.current.useInsertionEffect(e,t)};Qt.useLayoutEffect=function(e,t){return xr.current.useLayoutEffect(e,t)};Qt.useMemo=function(e,t){return xr.current.useMemo(e,t)};Qt.useReducer=function(e,t,s){return xr.current.useReducer(e,t,s)};Qt.useRef=function(e){return xr.current.useRef(e)};Qt.useState=function(e){return xr.current.useState(e)};Qt.useSyncExternalStore=function(e,t,s){return xr.current.useSyncExternalStore(e,t,s)};Qt.useTransition=function(){return xr.current.useTransition()};Qt.version="18.3.1";E2.exports=Qt;var ce=E2.exports;const $t=T2(ce);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA=ce,mA=Symbol.for("react.element"),gA=Symbol.for("react.fragment"),yA=Object.prototype.hasOwnProperty,_A=fA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xA={key:!0,ref:!0,__self:!0,__source:!0};function R2(e,t,s){var a,h={},g=null,v=null;s!==void 0&&(g=""+s),t.key!==void 0&&(g=""+t.key),t.ref!==void 0&&(v=t.ref);for(a in t)yA.call(t,a)&&!xA.hasOwnProperty(a)&&(h[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)h[a]===void 0&&(h[a]=t[a]);return{$$typeof:mA,type:e,key:g,ref:v,props:h,_owner:_A.current}}Qf.Fragment=gA;Qf.jsx=R2;Qf.jsxs=R2;k2.exports=Qf;var R=k2.exports,Iy={},F2={exports:{}},Xr={},B2={exports:{}},N2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Re,at){var Ne=Re.length;Re.push(at);e:for(;0<Ne;){var wt=Ne-1>>>1,Rt=Re[wt];if(0<h(Rt,at))Re[wt]=at,Re[Ne]=Rt,Ne=wt;else break e}}function s(Re){return Re.length===0?null:Re[0]}function a(Re){if(Re.length===0)return null;var at=Re[0],Ne=Re.pop();if(Ne!==at){Re[0]=Ne;e:for(var wt=0,Rt=Re.length,Ft=Rt>>>1;wt<Ft;){var Nt=2*(wt+1)-1,hn=Re[Nt],an=Nt+1,gn=Re[an];if(0>h(hn,Ne))an<Rt&&0>h(gn,hn)?(Re[wt]=gn,Re[an]=Ne,wt=an):(Re[wt]=hn,Re[Nt]=Ne,wt=Nt);else if(an<Rt&&0>h(gn,Ne))Re[wt]=gn,Re[an]=Ne,wt=an;else break e}}return at}function h(Re,at){var Ne=Re.sortIndex-at.sortIndex;return Ne!==0?Ne:Re.id-at.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var v=Date,c=v.now();e.unstable_now=function(){return v.now()-c}}var C=[],k=[],L=1,B=null,F=3,oe=!1,se=!1,re=!1,ue=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(Re){for(var at=s(k);at!==null;){if(at.callback===null)a(k);else if(at.startTime<=Re)a(k),at.sortIndex=at.expirationTime,t(C,at);else break;at=s(k)}}function fe(Re){if(re=!1,G(Re),!se)if(s(C)!==null)se=!0,Ve(xe);else{var at=s(k);at!==null&&rt(fe,at.startTime-Re)}}function xe(Re,at){se=!1,re&&(re=!1,Z(ke),ke=-1),oe=!0;var Ne=F;try{for(G(at),B=s(C);B!==null&&(!(B.expirationTime>at)||Re&&!At());){var wt=B.callback;if(typeof wt=="function"){B.callback=null,F=B.priorityLevel;var Rt=wt(B.expirationTime<=at);at=e.unstable_now(),typeof Rt=="function"?B.callback=Rt:B===s(C)&&a(C),G(at)}else a(C);B=s(C)}if(B!==null)var Ft=!0;else{var Nt=s(k);Nt!==null&&rt(fe,Nt.startTime-at),Ft=!1}return Ft}finally{B=null,F=Ne,oe=!1}}var Ee=!1,Ie=null,ke=-1,it=5,Oe=-1;function At(){return!(e.unstable_now()-Oe<it)}function Ct(){if(Ie!==null){var Re=e.unstable_now();Oe=Re;var at=!0;try{at=Ie(!0,Re)}finally{at?It():(Ee=!1,Ie=null)}}else Ee=!1}var It;if(typeof q=="function")It=function(){q(Ct)};else if(typeof MessageChannel<"u"){var Ut=new MessageChannel,on=Ut.port2;Ut.port1.onmessage=Ct,It=function(){on.postMessage(null)}}else It=function(){ue(Ct,0)};function Ve(Re){Ie=Re,Ee||(Ee=!0,It())}function rt(Re,at){ke=ue(function(){Re(e.unstable_now())},at)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Re){Re.callback=null},e.unstable_continueExecution=function(){se||oe||(se=!0,Ve(xe))},e.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):it=0<Re?Math.floor(1e3/Re):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return s(C)},e.unstable_next=function(Re){switch(F){case 1:case 2:case 3:var at=3;break;default:at=F}var Ne=F;F=at;try{return Re()}finally{F=Ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Re,at){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var Ne=F;F=Re;try{return at()}finally{F=Ne}},e.unstable_scheduleCallback=function(Re,at,Ne){var wt=e.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?wt+Ne:wt):Ne=wt,Re){case 1:var Rt=-1;break;case 2:Rt=250;break;case 5:Rt=1073741823;break;case 4:Rt=1e4;break;default:Rt=5e3}return Rt=Ne+Rt,Re={id:L++,callback:at,priorityLevel:Re,startTime:Ne,expirationTime:Rt,sortIndex:-1},Ne>wt?(Re.sortIndex=Ne,t(k,Re),s(C)===null&&Re===s(k)&&(re?(Z(ke),ke=-1):re=!0,rt(fe,Ne-wt))):(Re.sortIndex=Rt,t(C,Re),se||oe||(se=!0,Ve(xe))),Re},e.unstable_shouldYield=At,e.unstable_wrapCallback=function(Re){var at=F;return function(){var Ne=F;F=at;try{return Re.apply(this,arguments)}finally{F=Ne}}}})(N2);B2.exports=N2;var vA=B2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wA=ce,Hr=vA;function Ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var j2=new Set,Dh={};function yl(e,t){Lc(e,t),Lc(e+"Capture",t)}function Lc(e,t){for(Dh[e]=t,e=0;e<t.length;e++)j2.add(t[e])}var Io=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),My=Object.prototype.hasOwnProperty,bA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x1={},v1={};function SA(e){return My.call(v1,e)?!0:My.call(x1,e)?!1:bA.test(e)?v1[e]=!0:(x1[e]=!0,!1)}function TA(e,t,s,a){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kA(e,t,s,a){if(t===null||typeof t>"u"||TA(e,t,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function vr(e,t,s,a,h,g,v){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=h,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=v}var $i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$i[e]=new vr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$i[t]=new vr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$i[e]=new vr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$i[e]=new vr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$i[e]=new vr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$i[e]=new vr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$i[e]=new vr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$i[e]=new vr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$i[e]=new vr(e,5,!1,e.toLowerCase(),null,!1,!1)});var s_=/[\-:]([a-z])/g;function o_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(s_,o_);$i[t]=new vr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(s_,o_);$i[t]=new vr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(s_,o_);$i[t]=new vr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$i[e]=new vr(e,1,!1,e.toLowerCase(),null,!1,!1)});$i.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$i[e]=new vr(e,1,!1,e.toLowerCase(),null,!0,!0)});function a_(e,t,s,a){var h=$i.hasOwnProperty(t)?$i[t]:null;(h!==null?h.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kA(t,s,h,a)&&(s=null),a||h===null?SA(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):h.mustUseProperty?e[h.propertyName]=s===null?h.type===3?!1:"":s:(t=h.attributeName,a=h.attributeNamespace,s===null?e.removeAttribute(t):(h=h.type,s=h===3||h===4&&s===!0?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}var Fo=wA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kp=Symbol.for("react.element"),ac=Symbol.for("react.portal"),lc=Symbol.for("react.fragment"),l_=Symbol.for("react.strict_mode"),Ly=Symbol.for("react.profiler"),O2=Symbol.for("react.provider"),V2=Symbol.for("react.context"),c_=Symbol.for("react.forward_ref"),zy=Symbol.for("react.suspense"),Dy=Symbol.for("react.suspense_list"),u_=Symbol.for("react.memo"),sa=Symbol.for("react.lazy"),$2=Symbol.for("react.offscreen"),w1=Symbol.iterator;function nh(e){return e===null||typeof e!="object"?null:(e=w1&&e[w1]||e["@@iterator"],typeof e=="function"?e:null)}var Kn=Object.assign,Og;function dh(e){if(Og===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Og=t&&t[1]||""}return`
`+Og+e}var Vg=!1;function $g(e,t){if(!e||Vg)return"";Vg=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(k){var a=k}Reflect.construct(e,[],t)}else{try{t.call()}catch(k){a=k}e.call(t.prototype)}else{try{throw Error()}catch(k){a=k}e()}}catch(k){if(k&&a&&typeof k.stack=="string"){for(var h=k.stack.split(`
`),g=a.stack.split(`
`),v=h.length-1,c=g.length-1;1<=v&&0<=c&&h[v]!==g[c];)c--;for(;1<=v&&0<=c;v--,c--)if(h[v]!==g[c]){if(v!==1||c!==1)do if(v--,c--,0>c||h[v]!==g[c]){var C=`
`+h[v].replace(" at new "," at ");return e.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",e.displayName)),C}while(1<=v&&0<=c);break}}}finally{Vg=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?dh(e):""}function EA(e){switch(e.tag){case 5:return dh(e.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return e=$g(e.type,!1),e;case 11:return e=$g(e.type.render,!1),e;case 1:return e=$g(e.type,!0),e;default:return""}}function Ry(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case lc:return"Fragment";case ac:return"Portal";case Ly:return"Profiler";case l_:return"StrictMode";case zy:return"Suspense";case Dy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case V2:return(e.displayName||"Context")+".Consumer";case O2:return(e._context.displayName||"Context")+".Provider";case c_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case u_:return t=e.displayName||null,t!==null?t:Ry(e.type)||"Memo";case sa:t=e._payload,e=e._init;try{return Ry(e(t))}catch{}}return null}function CA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ry(t);case 8:return t===l_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function va(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function U2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function PA(e){var t=U2(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var h=s.get,g=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(v){a=""+v,g.call(this,v)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ep(e){e._valueTracker||(e._valueTracker=PA(e))}function q2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=U2(e)?e.checked?"true":"false":e.value),e=a,e!==s?(t.setValue(e),!0):!1}function mf(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fy(e,t){var s=t.checked;return Kn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function b1(e,t){var s=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;s=va(t.value!=null?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Z2(e,t){t=t.checked,t!=null&&a_(e,"checked",t,!1)}function By(e,t){Z2(e,t);var s=va(t.value),a=t.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ny(e,t.type,s):t.hasOwnProperty("defaultValue")&&Ny(e,t.type,va(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function S1(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Ny(e,t,s){(t!=="number"||mf(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var ph=Array.isArray;function kc(e,t,s,a){if(e=e.options,t){t={};for(var h=0;h<s.length;h++)t["$"+s[h]]=!0;for(s=0;s<e.length;s++)h=t.hasOwnProperty("$"+e[s].value),e[s].selected!==h&&(e[s].selected=h),h&&a&&(e[s].defaultSelected=!0)}else{for(s=""+va(s),t=null,h=0;h<e.length;h++){if(e[h].value===s){e[h].selected=!0,a&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function jy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return Kn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function T1(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(Ke(92));if(ph(s)){if(1<s.length)throw Error(Ke(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:va(s)}}function G2(e,t){var s=va(t.value),a=va(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function k1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Oy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cp,H2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,a,h){MSApp.execUnsafeLocalFunction(function(){return e(t,s,a,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cp=Cp||document.createElement("div"),Cp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Rh(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var xh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AA=["Webkit","ms","Moz","O"];Object.keys(xh).forEach(function(e){AA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xh[t]=xh[e]})});function K2(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||xh.hasOwnProperty(e)&&xh[e]?(""+t).trim():t+"px"}function X2(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var a=s.indexOf("--")===0,h=K2(s,t[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,h):e[s]=h}}var IA=Kn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vy(e,t){if(t){if(IA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ke(62))}}function $y(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uy=null;function h_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qy=null,Ec=null,Cc=null;function E1(e){if(e=ld(e)){if(typeof qy!="function")throw Error(Ke(280));var t=e.stateNode;t&&(t=rm(t),qy(e.stateNode,e.type,t))}}function Y2(e){Ec?Cc?Cc.push(e):Cc=[e]:Ec=e}function J2(){if(Ec){var e=Ec,t=Cc;if(Cc=Ec=null,E1(e),t)for(e=0;e<t.length;e++)E1(t[e])}}function Q2(e,t){return e(t)}function eS(){}var Ug=!1;function tS(e,t,s){if(Ug)return e(t,s);Ug=!0;try{return Q2(e,t,s)}finally{Ug=!1,(Ec!==null||Cc!==null)&&(eS(),J2())}}function Fh(e,t){var s=e.stateNode;if(s===null)return null;var a=rm(s);if(a===null)return null;s=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Ke(231,t,typeof s));return s}var Zy=!1;if(Io)try{var ih={};Object.defineProperty(ih,"passive",{get:function(){Zy=!0}}),window.addEventListener("test",ih,ih),window.removeEventListener("test",ih,ih)}catch{Zy=!1}function MA(e,t,s,a,h,g,v,c,C){var k=Array.prototype.slice.call(arguments,3);try{t.apply(s,k)}catch(L){this.onError(L)}}var vh=!1,gf=null,yf=!1,Gy=null,LA={onError:function(e){vh=!0,gf=e}};function zA(e,t,s,a,h,g,v,c,C){vh=!1,gf=null,MA.apply(LA,arguments)}function DA(e,t,s,a,h,g,v,c,C){if(zA.apply(this,arguments),vh){if(vh){var k=gf;vh=!1,gf=null}else throw Error(Ke(198));yf||(yf=!0,Gy=k)}}function _l(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function nS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function C1(e){if(_l(e)!==e)throw Error(Ke(188))}function RA(e){var t=e.alternate;if(!t){if(t=_l(e),t===null)throw Error(Ke(188));return t!==e?null:e}for(var s=e,a=t;;){var h=s.return;if(h===null)break;var g=h.alternate;if(g===null){if(a=h.return,a!==null){s=a;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===s)return C1(h),e;if(g===a)return C1(h),t;g=g.sibling}throw Error(Ke(188))}if(s.return!==a.return)s=h,a=g;else{for(var v=!1,c=h.child;c;){if(c===s){v=!0,s=h,a=g;break}if(c===a){v=!0,a=h,s=g;break}c=c.sibling}if(!v){for(c=g.child;c;){if(c===s){v=!0,s=g,a=h;break}if(c===a){v=!0,a=g,s=h;break}c=c.sibling}if(!v)throw Error(Ke(189))}}if(s.alternate!==a)throw Error(Ke(190))}if(s.tag!==3)throw Error(Ke(188));return s.stateNode.current===s?e:t}function iS(e){return e=RA(e),e!==null?rS(e):null}function rS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rS(e);if(t!==null)return t;e=e.sibling}return null}var sS=Hr.unstable_scheduleCallback,P1=Hr.unstable_cancelCallback,FA=Hr.unstable_shouldYield,BA=Hr.unstable_requestPaint,hi=Hr.unstable_now,NA=Hr.unstable_getCurrentPriorityLevel,d_=Hr.unstable_ImmediatePriority,oS=Hr.unstable_UserBlockingPriority,_f=Hr.unstable_NormalPriority,jA=Hr.unstable_LowPriority,aS=Hr.unstable_IdlePriority,em=null,to=null;function OA(e){if(to&&typeof to.onCommitFiberRoot=="function")try{to.onCommitFiberRoot(em,e,void 0,(e.current.flags&128)===128)}catch{}}var Ds=Math.clz32?Math.clz32:UA,VA=Math.log,$A=Math.LN2;function UA(e){return e>>>=0,e===0?32:31-(VA(e)/$A|0)|0}var Pp=64,Ap=4194304;function fh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xf(e,t){var s=e.pendingLanes;if(s===0)return 0;var a=0,h=e.suspendedLanes,g=e.pingedLanes,v=s&268435455;if(v!==0){var c=v&~h;c!==0?a=fh(c):(g&=v,g!==0&&(a=fh(g)))}else v=s&~h,v!==0?a=fh(v):g!==0&&(a=fh(g));if(a===0)return 0;if(t!==0&&t!==a&&!(t&h)&&(h=a&-a,g=t&-t,h>=g||h===16&&(g&4194240)!==0))return t;if(a&4&&(a|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)s=31-Ds(t),h=1<<s,a|=e[s],t&=~h;return a}function qA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZA(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,h=e.expirationTimes,g=e.pendingLanes;0<g;){var v=31-Ds(g),c=1<<v,C=h[v];C===-1?(!(c&s)||c&a)&&(h[v]=qA(c,t)):C<=t&&(e.expiredLanes|=c),g&=~c}}function Wy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lS(){var e=Pp;return Pp<<=1,!(Pp&4194240)&&(Pp=64),e}function qg(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function od(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ds(t),e[t]=s}function GA(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var h=31-Ds(s),g=1<<h;t[h]=0,a[h]=-1,e[h]=-1,s&=~g}}function p_(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-Ds(s),h=1<<a;h&t|e[a]&t&&(e[a]|=t),s&=~h}}var xn=0;function cS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var uS,f_,hS,dS,pS,Hy=!1,Ip=[],ha=null,da=null,pa=null,Bh=new Map,Nh=new Map,aa=[],WA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A1(e,t){switch(e){case"focusin":case"focusout":ha=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":Bh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nh.delete(t.pointerId)}}function rh(e,t,s,a,h,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:g,targetContainers:[h]},t!==null&&(t=ld(t),t!==null&&f_(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function HA(e,t,s,a,h){switch(t){case"focusin":return ha=rh(ha,e,t,s,a,h),!0;case"dragenter":return da=rh(da,e,t,s,a,h),!0;case"mouseover":return pa=rh(pa,e,t,s,a,h),!0;case"pointerover":var g=h.pointerId;return Bh.set(g,rh(Bh.get(g)||null,e,t,s,a,h)),!0;case"gotpointercapture":return g=h.pointerId,Nh.set(g,rh(Nh.get(g)||null,e,t,s,a,h)),!0}return!1}function fS(e){var t=el(e.target);if(t!==null){var s=_l(t);if(s!==null){if(t=s.tag,t===13){if(t=nS(s),t!==null){e.blockedOn=t,pS(e.priority,function(){hS(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Ky(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);Uy=a,s.target.dispatchEvent(a),Uy=null}else return t=ld(s),t!==null&&f_(t),e.blockedOn=s,!1;t.shift()}return!0}function I1(e,t,s){Yp(e)&&s.delete(t)}function KA(){Hy=!1,ha!==null&&Yp(ha)&&(ha=null),da!==null&&Yp(da)&&(da=null),pa!==null&&Yp(pa)&&(pa=null),Bh.forEach(I1),Nh.forEach(I1)}function sh(e,t){e.blockedOn===t&&(e.blockedOn=null,Hy||(Hy=!0,Hr.unstable_scheduleCallback(Hr.unstable_NormalPriority,KA)))}function jh(e){function t(h){return sh(h,e)}if(0<Ip.length){sh(Ip[0],e);for(var s=1;s<Ip.length;s++){var a=Ip[s];a.blockedOn===e&&(a.blockedOn=null)}}for(ha!==null&&sh(ha,e),da!==null&&sh(da,e),pa!==null&&sh(pa,e),Bh.forEach(t),Nh.forEach(t),s=0;s<aa.length;s++)a=aa[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<aa.length&&(s=aa[0],s.blockedOn===null);)fS(s),s.blockedOn===null&&aa.shift()}var Pc=Fo.ReactCurrentBatchConfig,vf=!0;function XA(e,t,s,a){var h=xn,g=Pc.transition;Pc.transition=null;try{xn=1,m_(e,t,s,a)}finally{xn=h,Pc.transition=g}}function YA(e,t,s,a){var h=xn,g=Pc.transition;Pc.transition=null;try{xn=4,m_(e,t,s,a)}finally{xn=h,Pc.transition=g}}function m_(e,t,s,a){if(vf){var h=Ky(e,t,s,a);if(h===null)ey(e,t,a,wf,s),A1(e,a);else if(HA(h,e,t,s,a))a.stopPropagation();else if(A1(e,a),t&4&&-1<WA.indexOf(e)){for(;h!==null;){var g=ld(h);if(g!==null&&uS(g),g=Ky(e,t,s,a),g===null&&ey(e,t,a,wf,s),g===h)break;h=g}h!==null&&a.stopPropagation()}else ey(e,t,a,null,s)}}var wf=null;function Ky(e,t,s,a){if(wf=null,e=h_(a),e=el(e),e!==null)if(t=_l(e),t===null)e=null;else if(s=t.tag,s===13){if(e=nS(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wf=e,null}function mS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NA()){case d_:return 1;case oS:return 4;case _f:case jA:return 16;case aS:return 536870912;default:return 16}default:return 16}}var ca=null,g_=null,Jp=null;function gS(){if(Jp)return Jp;var e,t=g_,s=t.length,a,h="value"in ca?ca.value:ca.textContent,g=h.length;for(e=0;e<s&&t[e]===h[e];e++);var v=s-e;for(a=1;a<=v&&t[s-a]===h[g-a];a++);return Jp=h.slice(e,1<a?1-a:void 0)}function Qp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mp(){return!0}function M1(){return!1}function Yr(e){function t(s,a,h,g,v){this._reactName=s,this._targetInst=h,this.type=a,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(s=e[c],this[c]=s?s(g):g[c]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Mp:M1,this.isPropagationStopped=M1,this}return Kn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Mp)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Mp)},persist:function(){},isPersistent:Mp}),t}var qc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},y_=Yr(qc),ad=Kn({},qc,{view:0,detail:0}),JA=Yr(ad),Zg,Gg,oh,tm=Kn({},ad,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:__,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oh&&(oh&&e.type==="mousemove"?(Zg=e.screenX-oh.screenX,Gg=e.screenY-oh.screenY):Gg=Zg=0,oh=e),Zg)},movementY:function(e){return"movementY"in e?e.movementY:Gg}}),L1=Yr(tm),QA=Kn({},tm,{dataTransfer:0}),eI=Yr(QA),tI=Kn({},ad,{relatedTarget:0}),Wg=Yr(tI),nI=Kn({},qc,{animationName:0,elapsedTime:0,pseudoElement:0}),iI=Yr(nI),rI=Kn({},qc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sI=Yr(rI),oI=Kn({},qc,{data:0}),z1=Yr(oI),aI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uI(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cI[e])?!!t[e]:!1}function __(){return uI}var hI=Kn({},ad,{key:function(e){if(e.key){var t=aI[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lI[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:__,charCode:function(e){return e.type==="keypress"?Qp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dI=Yr(hI),pI=Kn({},tm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D1=Yr(pI),fI=Kn({},ad,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:__}),mI=Yr(fI),gI=Kn({},qc,{propertyName:0,elapsedTime:0,pseudoElement:0}),yI=Yr(gI),_I=Kn({},tm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xI=Yr(_I),vI=[9,13,27,32],x_=Io&&"CompositionEvent"in window,wh=null;Io&&"documentMode"in document&&(wh=document.documentMode);var wI=Io&&"TextEvent"in window&&!wh,yS=Io&&(!x_||wh&&8<wh&&11>=wh),R1=String.fromCharCode(32),F1=!1;function _S(e,t){switch(e){case"keyup":return vI.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var cc=!1;function bI(e,t){switch(e){case"compositionend":return xS(t);case"keypress":return t.which!==32?null:(F1=!0,R1);case"textInput":return e=t.data,e===R1&&F1?null:e;default:return null}}function SI(e,t){if(cc)return e==="compositionend"||!x_&&_S(e,t)?(e=gS(),Jp=g_=ca=null,cc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yS&&t.locale!=="ko"?null:t.data;default:return null}}var TI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function B1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!TI[e.type]:t==="textarea"}function vS(e,t,s,a){Y2(a),t=bf(t,"onChange"),0<t.length&&(s=new y_("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var bh=null,Oh=null;function kI(e){MS(e,0)}function nm(e){var t=dc(e);if(q2(t))return e}function EI(e,t){if(e==="change")return t}var wS=!1;if(Io){var Hg;if(Io){var Kg="oninput"in document;if(!Kg){var N1=document.createElement("div");N1.setAttribute("oninput","return;"),Kg=typeof N1.oninput=="function"}Hg=Kg}else Hg=!1;wS=Hg&&(!document.documentMode||9<document.documentMode)}function j1(){bh&&(bh.detachEvent("onpropertychange",bS),Oh=bh=null)}function bS(e){if(e.propertyName==="value"&&nm(Oh)){var t=[];vS(t,Oh,e,h_(e)),tS(kI,t)}}function CI(e,t,s){e==="focusin"?(j1(),bh=t,Oh=s,bh.attachEvent("onpropertychange",bS)):e==="focusout"&&j1()}function PI(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nm(Oh)}function AI(e,t){if(e==="click")return nm(t)}function II(e,t){if(e==="input"||e==="change")return nm(t)}function MI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bs=typeof Object.is=="function"?Object.is:MI;function Vh(e,t){if(Bs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var h=s[a];if(!My.call(t,h)||!Bs(e[h],t[h]))return!1}return!0}function O1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function V1(e,t){var s=O1(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=t&&a>=t)return{node:s,offset:t-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=O1(s)}}function SS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?SS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function TS(){for(var e=window,t=mf();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=mf(e.document)}return t}function v_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function LI(e){var t=TS(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&SS(s.ownerDocument.documentElement,s)){if(a!==null&&v_(s)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=s.textContent.length,g=Math.min(a.start,h);a=a.end===void 0?g:Math.min(a.end,h),!e.extend&&g>a&&(h=a,a=g,g=h),h=V1(s,g);var v=V1(s,a);h&&v&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),g>a?(e.addRange(t),e.extend(v.node,v.offset)):(t.setEnd(v.node,v.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zI=Io&&"documentMode"in document&&11>=document.documentMode,uc=null,Xy=null,Sh=null,Yy=!1;function $1(e,t,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Yy||uc==null||uc!==mf(a)||(a=uc,"selectionStart"in a&&v_(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Sh&&Vh(Sh,a)||(Sh=a,a=bf(Xy,"onSelect"),0<a.length&&(t=new y_("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=uc)))}function Lp(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var hc={animationend:Lp("Animation","AnimationEnd"),animationiteration:Lp("Animation","AnimationIteration"),animationstart:Lp("Animation","AnimationStart"),transitionend:Lp("Transition","TransitionEnd")},Xg={},kS={};Io&&(kS=document.createElement("div").style,"AnimationEvent"in window||(delete hc.animationend.animation,delete hc.animationiteration.animation,delete hc.animationstart.animation),"TransitionEvent"in window||delete hc.transitionend.transition);function im(e){if(Xg[e])return Xg[e];if(!hc[e])return e;var t=hc[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in kS)return Xg[e]=t[s];return e}var ES=im("animationend"),CS=im("animationiteration"),PS=im("animationstart"),AS=im("transitionend"),IS=new Map,U1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(e,t){IS.set(e,t),yl(t,[e])}for(var Yg=0;Yg<U1.length;Yg++){var Jg=U1[Yg],DI=Jg.toLowerCase(),RI=Jg[0].toUpperCase()+Jg.slice(1);Ta(DI,"on"+RI)}Ta(ES,"onAnimationEnd");Ta(CS,"onAnimationIteration");Ta(PS,"onAnimationStart");Ta("dblclick","onDoubleClick");Ta("focusin","onFocus");Ta("focusout","onBlur");Ta(AS,"onTransitionEnd");Lc("onMouseEnter",["mouseout","mouseover"]);Lc("onMouseLeave",["mouseout","mouseover"]);Lc("onPointerEnter",["pointerout","pointerover"]);Lc("onPointerLeave",["pointerout","pointerover"]);yl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yl("onBeforeInput",["compositionend","keypress","textInput","paste"]);yl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FI=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function q1(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,DA(a,t,void 0,e),e.currentTarget=null}function MS(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],h=a.event;a=a.listeners;e:{var g=void 0;if(t)for(var v=a.length-1;0<=v;v--){var c=a[v],C=c.instance,k=c.currentTarget;if(c=c.listener,C!==g&&h.isPropagationStopped())break e;q1(h,c,k),g=C}else for(v=0;v<a.length;v++){if(c=a[v],C=c.instance,k=c.currentTarget,c=c.listener,C!==g&&h.isPropagationStopped())break e;q1(h,c,k),g=C}}}if(yf)throw e=Gy,yf=!1,Gy=null,e}function Rn(e,t){var s=t[n0];s===void 0&&(s=t[n0]=new Set);var a=e+"__bubble";s.has(a)||(LS(t,e,2,!1),s.add(a))}function Qg(e,t,s){var a=0;t&&(a|=4),LS(s,e,a,t)}var zp="_reactListening"+Math.random().toString(36).slice(2);function $h(e){if(!e[zp]){e[zp]=!0,j2.forEach(function(s){s!=="selectionchange"&&(FI.has(s)||Qg(s,!1,e),Qg(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zp]||(t[zp]=!0,Qg("selectionchange",!1,t))}}function LS(e,t,s,a){switch(mS(t)){case 1:var h=XA;break;case 4:h=YA;break;default:h=m_}s=h.bind(null,t,s,e),h=void 0,!Zy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),a?h!==void 0?e.addEventListener(t,s,{capture:!0,passive:h}):e.addEventListener(t,s,!0):h!==void 0?e.addEventListener(t,s,{passive:h}):e.addEventListener(t,s,!1)}function ey(e,t,s,a,h){var g=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var v=a.tag;if(v===3||v===4){var c=a.stateNode.containerInfo;if(c===h||c.nodeType===8&&c.parentNode===h)break;if(v===4)for(v=a.return;v!==null;){var C=v.tag;if((C===3||C===4)&&(C=v.stateNode.containerInfo,C===h||C.nodeType===8&&C.parentNode===h))return;v=v.return}for(;c!==null;){if(v=el(c),v===null)return;if(C=v.tag,C===5||C===6){a=g=v;continue e}c=c.parentNode}}a=a.return}tS(function(){var k=g,L=h_(s),B=[];e:{var F=IS.get(e);if(F!==void 0){var oe=y_,se=e;switch(e){case"keypress":if(Qp(s)===0)break e;case"keydown":case"keyup":oe=dI;break;case"focusin":se="focus",oe=Wg;break;case"focusout":se="blur",oe=Wg;break;case"beforeblur":case"afterblur":oe=Wg;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=L1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=eI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=mI;break;case ES:case CS:case PS:oe=iI;break;case AS:oe=yI;break;case"scroll":oe=JA;break;case"wheel":oe=xI;break;case"copy":case"cut":case"paste":oe=sI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=D1}var re=(t&4)!==0,ue=!re&&e==="scroll",Z=re?F!==null?F+"Capture":null:F;re=[];for(var q=k,G;q!==null;){G=q;var fe=G.stateNode;if(G.tag===5&&fe!==null&&(G=fe,Z!==null&&(fe=Fh(q,Z),fe!=null&&re.push(Uh(q,fe,G)))),ue)break;q=q.return}0<re.length&&(F=new oe(F,se,null,s,L),B.push({event:F,listeners:re}))}}if(!(t&7)){e:{if(F=e==="mouseover"||e==="pointerover",oe=e==="mouseout"||e==="pointerout",F&&s!==Uy&&(se=s.relatedTarget||s.fromElement)&&(el(se)||se[Mo]))break e;if((oe||F)&&(F=L.window===L?L:(F=L.ownerDocument)?F.defaultView||F.parentWindow:window,oe?(se=s.relatedTarget||s.toElement,oe=k,se=se?el(se):null,se!==null&&(ue=_l(se),se!==ue||se.tag!==5&&se.tag!==6)&&(se=null)):(oe=null,se=k),oe!==se)){if(re=L1,fe="onMouseLeave",Z="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(re=D1,fe="onPointerLeave",Z="onPointerEnter",q="pointer"),ue=oe==null?F:dc(oe),G=se==null?F:dc(se),F=new re(fe,q+"leave",oe,s,L),F.target=ue,F.relatedTarget=G,fe=null,el(L)===k&&(re=new re(Z,q+"enter",se,s,L),re.target=G,re.relatedTarget=ue,fe=re),ue=fe,oe&&se)t:{for(re=oe,Z=se,q=0,G=re;G;G=sc(G))q++;for(G=0,fe=Z;fe;fe=sc(fe))G++;for(;0<q-G;)re=sc(re),q--;for(;0<G-q;)Z=sc(Z),G--;for(;q--;){if(re===Z||Z!==null&&re===Z.alternate)break t;re=sc(re),Z=sc(Z)}re=null}else re=null;oe!==null&&Z1(B,F,oe,re,!1),se!==null&&ue!==null&&Z1(B,ue,se,re,!0)}}e:{if(F=k?dc(k):window,oe=F.nodeName&&F.nodeName.toLowerCase(),oe==="select"||oe==="input"&&F.type==="file")var xe=EI;else if(B1(F))if(wS)xe=II;else{xe=PI;var Ee=CI}else(oe=F.nodeName)&&oe.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(xe=AI);if(xe&&(xe=xe(e,k))){vS(B,xe,s,L);break e}Ee&&Ee(e,F,k),e==="focusout"&&(Ee=F._wrapperState)&&Ee.controlled&&F.type==="number"&&Ny(F,"number",F.value)}switch(Ee=k?dc(k):window,e){case"focusin":(B1(Ee)||Ee.contentEditable==="true")&&(uc=Ee,Xy=k,Sh=null);break;case"focusout":Sh=Xy=uc=null;break;case"mousedown":Yy=!0;break;case"contextmenu":case"mouseup":case"dragend":Yy=!1,$1(B,s,L);break;case"selectionchange":if(zI)break;case"keydown":case"keyup":$1(B,s,L)}var Ie;if(x_)e:{switch(e){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else cc?_S(e,s)&&(ke="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(ke="onCompositionStart");ke&&(yS&&s.locale!=="ko"&&(cc||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&cc&&(Ie=gS()):(ca=L,g_="value"in ca?ca.value:ca.textContent,cc=!0)),Ee=bf(k,ke),0<Ee.length&&(ke=new z1(ke,e,null,s,L),B.push({event:ke,listeners:Ee}),Ie?ke.data=Ie:(Ie=xS(s),Ie!==null&&(ke.data=Ie)))),(Ie=wI?bI(e,s):SI(e,s))&&(k=bf(k,"onBeforeInput"),0<k.length&&(L=new z1("onBeforeInput","beforeinput",null,s,L),B.push({event:L,listeners:k}),L.data=Ie))}MS(B,t)})}function Uh(e,t,s){return{instance:e,listener:t,currentTarget:s}}function bf(e,t){for(var s=t+"Capture",a=[];e!==null;){var h=e,g=h.stateNode;h.tag===5&&g!==null&&(h=g,g=Fh(e,s),g!=null&&a.unshift(Uh(e,g,h)),g=Fh(e,t),g!=null&&a.push(Uh(e,g,h))),e=e.return}return a}function sc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Z1(e,t,s,a,h){for(var g=t._reactName,v=[];s!==null&&s!==a;){var c=s,C=c.alternate,k=c.stateNode;if(C!==null&&C===a)break;c.tag===5&&k!==null&&(c=k,h?(C=Fh(s,g),C!=null&&v.unshift(Uh(s,C,c))):h||(C=Fh(s,g),C!=null&&v.push(Uh(s,C,c)))),s=s.return}v.length!==0&&e.push({event:t,listeners:v})}var BI=/\r\n?/g,NI=/\u0000|\uFFFD/g;function G1(e){return(typeof e=="string"?e:""+e).replace(BI,`
`).replace(NI,"")}function Dp(e,t,s){if(t=G1(t),G1(e)!==t&&s)throw Error(Ke(425))}function Sf(){}var Jy=null,Qy=null;function e0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var t0=typeof setTimeout=="function"?setTimeout:void 0,jI=typeof clearTimeout=="function"?clearTimeout:void 0,W1=typeof Promise=="function"?Promise:void 0,OI=typeof queueMicrotask=="function"?queueMicrotask:typeof W1<"u"?function(e){return W1.resolve(null).then(e).catch(VI)}:t0;function VI(e){setTimeout(function(){throw e})}function ty(e,t){var s=t,a=0;do{var h=s.nextSibling;if(e.removeChild(s),h&&h.nodeType===8)if(s=h.data,s==="/$"){if(a===0){e.removeChild(h),jh(t);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=h}while(s);jh(t)}function fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function H1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Zc=Math.random().toString(36).slice(2),eo="__reactFiber$"+Zc,qh="__reactProps$"+Zc,Mo="__reactContainer$"+Zc,n0="__reactEvents$"+Zc,$I="__reactListeners$"+Zc,UI="__reactHandles$"+Zc;function el(e){var t=e[eo];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Mo]||s[eo]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=H1(e);e!==null;){if(s=e[eo])return s;e=H1(e)}return t}e=s,s=e.parentNode}return null}function ld(e){return e=e[eo]||e[Mo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function dc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ke(33))}function rm(e){return e[qh]||null}var i0=[],pc=-1;function ka(e){return{current:e}}function Fn(e){0>pc||(e.current=i0[pc],i0[pc]=null,pc--)}function Mn(e,t){pc++,i0[pc]=e.current,e.current=t}var wa={},ir=ka(wa),zr=ka(!1),ul=wa;function zc(e,t){var s=e.type.contextTypes;if(!s)return wa;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var h={},g;for(g in s)h[g]=t[g];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function Dr(e){return e=e.childContextTypes,e!=null}function Tf(){Fn(zr),Fn(ir)}function K1(e,t,s){if(ir.current!==wa)throw Error(Ke(168));Mn(ir,t),Mn(zr,s)}function zS(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var h in a)if(!(h in t))throw Error(Ke(108,CA(e)||"Unknown",h));return Kn({},s,a)}function kf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wa,ul=ir.current,Mn(ir,e),Mn(zr,zr.current),!0}function X1(e,t,s){var a=e.stateNode;if(!a)throw Error(Ke(169));s?(e=zS(e,t,ul),a.__reactInternalMemoizedMergedChildContext=e,Fn(zr),Fn(ir),Mn(ir,e)):Fn(zr),Mn(zr,s)}var To=null,sm=!1,ny=!1;function DS(e){To===null?To=[e]:To.push(e)}function qI(e){sm=!0,DS(e)}function Ea(){if(!ny&&To!==null){ny=!0;var e=0,t=xn;try{var s=To;for(xn=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}To=null,sm=!1}catch(h){throw To!==null&&(To=To.slice(e+1)),sS(d_,Ea),h}finally{xn=t,ny=!1}}return null}var fc=[],mc=0,Ef=null,Cf=0,cs=[],us=0,hl=null,ko=1,Eo="";function Xa(e,t){fc[mc++]=Cf,fc[mc++]=Ef,Ef=e,Cf=t}function RS(e,t,s){cs[us++]=ko,cs[us++]=Eo,cs[us++]=hl,hl=e;var a=ko;e=Eo;var h=32-Ds(a)-1;a&=~(1<<h),s+=1;var g=32-Ds(t)+h;if(30<g){var v=h-h%5;g=(a&(1<<v)-1).toString(32),a>>=v,h-=v,ko=1<<32-Ds(t)+h|s<<h|a,Eo=g+e}else ko=1<<g|s<<h|a,Eo=e}function w_(e){e.return!==null&&(Xa(e,1),RS(e,1,0))}function b_(e){for(;e===Ef;)Ef=fc[--mc],fc[mc]=null,Cf=fc[--mc],fc[mc]=null;for(;e===hl;)hl=cs[--us],cs[us]=null,Eo=cs[--us],cs[us]=null,ko=cs[--us],cs[us]=null}var Zr=null,qr=null,$n=!1,zs=null;function FS(e,t){var s=hs(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Y1(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zr=e,qr=fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zr=e,qr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=hl!==null?{id:ko,overflow:Eo}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=hs(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Zr=e,qr=null,!0):!1;default:return!1}}function r0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function s0(e){if($n){var t=qr;if(t){var s=t;if(!Y1(e,t)){if(r0(e))throw Error(Ke(418));t=fa(s.nextSibling);var a=Zr;t&&Y1(e,t)?FS(a,s):(e.flags=e.flags&-4097|2,$n=!1,Zr=e)}}else{if(r0(e))throw Error(Ke(418));e.flags=e.flags&-4097|2,$n=!1,Zr=e}}}function J1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zr=e}function Rp(e){if(e!==Zr)return!1;if(!$n)return J1(e),$n=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!e0(e.type,e.memoizedProps)),t&&(t=qr)){if(r0(e))throw BS(),Error(Ke(418));for(;t;)FS(e,t),t=fa(t.nextSibling)}if(J1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){qr=fa(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}qr=null}}else qr=Zr?fa(e.stateNode.nextSibling):null;return!0}function BS(){for(var e=qr;e;)e=fa(e.nextSibling)}function Dc(){qr=Zr=null,$n=!1}function S_(e){zs===null?zs=[e]:zs.push(e)}var ZI=Fo.ReactCurrentBatchConfig;function ah(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Ke(309));var a=s.stateNode}if(!a)throw Error(Ke(147,e));var h=a,g=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===g?t.ref:(t=function(v){var c=h.refs;v===null?delete c[g]:c[g]=v},t._stringRef=g,t)}if(typeof e!="string")throw Error(Ke(284));if(!s._owner)throw Error(Ke(290,e))}return e}function Fp(e,t){throw e=Object.prototype.toString.call(t),Error(Ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Q1(e){var t=e._init;return t(e._payload)}function NS(e){function t(Z,q){if(e){var G=Z.deletions;G===null?(Z.deletions=[q],Z.flags|=16):G.push(q)}}function s(Z,q){if(!e)return null;for(;q!==null;)t(Z,q),q=q.sibling;return null}function a(Z,q){for(Z=new Map;q!==null;)q.key!==null?Z.set(q.key,q):Z.set(q.index,q),q=q.sibling;return Z}function h(Z,q){return Z=_a(Z,q),Z.index=0,Z.sibling=null,Z}function g(Z,q,G){return Z.index=G,e?(G=Z.alternate,G!==null?(G=G.index,G<q?(Z.flags|=2,q):G):(Z.flags|=2,q)):(Z.flags|=1048576,q)}function v(Z){return e&&Z.alternate===null&&(Z.flags|=2),Z}function c(Z,q,G,fe){return q===null||q.tag!==6?(q=cy(G,Z.mode,fe),q.return=Z,q):(q=h(q,G),q.return=Z,q)}function C(Z,q,G,fe){var xe=G.type;return xe===lc?L(Z,q,G.props.children,fe,G.key):q!==null&&(q.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===sa&&Q1(xe)===q.type)?(fe=h(q,G.props),fe.ref=ah(Z,q,G),fe.return=Z,fe):(fe=af(G.type,G.key,G.props,null,Z.mode,fe),fe.ref=ah(Z,q,G),fe.return=Z,fe)}function k(Z,q,G,fe){return q===null||q.tag!==4||q.stateNode.containerInfo!==G.containerInfo||q.stateNode.implementation!==G.implementation?(q=uy(G,Z.mode,fe),q.return=Z,q):(q=h(q,G.children||[]),q.return=Z,q)}function L(Z,q,G,fe,xe){return q===null||q.tag!==7?(q=ol(G,Z.mode,fe,xe),q.return=Z,q):(q=h(q,G),q.return=Z,q)}function B(Z,q,G){if(typeof q=="string"&&q!==""||typeof q=="number")return q=cy(""+q,Z.mode,G),q.return=Z,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case kp:return G=af(q.type,q.key,q.props,null,Z.mode,G),G.ref=ah(Z,null,q),G.return=Z,G;case ac:return q=uy(q,Z.mode,G),q.return=Z,q;case sa:var fe=q._init;return B(Z,fe(q._payload),G)}if(ph(q)||nh(q))return q=ol(q,Z.mode,G,null),q.return=Z,q;Fp(Z,q)}return null}function F(Z,q,G,fe){var xe=q!==null?q.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return xe!==null?null:c(Z,q,""+G,fe);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case kp:return G.key===xe?C(Z,q,G,fe):null;case ac:return G.key===xe?k(Z,q,G,fe):null;case sa:return xe=G._init,F(Z,q,xe(G._payload),fe)}if(ph(G)||nh(G))return xe!==null?null:L(Z,q,G,fe,null);Fp(Z,G)}return null}function oe(Z,q,G,fe,xe){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return Z=Z.get(G)||null,c(q,Z,""+fe,xe);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case kp:return Z=Z.get(fe.key===null?G:fe.key)||null,C(q,Z,fe,xe);case ac:return Z=Z.get(fe.key===null?G:fe.key)||null,k(q,Z,fe,xe);case sa:var Ee=fe._init;return oe(Z,q,G,Ee(fe._payload),xe)}if(ph(fe)||nh(fe))return Z=Z.get(G)||null,L(q,Z,fe,xe,null);Fp(q,fe)}return null}function se(Z,q,G,fe){for(var xe=null,Ee=null,Ie=q,ke=q=0,it=null;Ie!==null&&ke<G.length;ke++){Ie.index>ke?(it=Ie,Ie=null):it=Ie.sibling;var Oe=F(Z,Ie,G[ke],fe);if(Oe===null){Ie===null&&(Ie=it);break}e&&Ie&&Oe.alternate===null&&t(Z,Ie),q=g(Oe,q,ke),Ee===null?xe=Oe:Ee.sibling=Oe,Ee=Oe,Ie=it}if(ke===G.length)return s(Z,Ie),$n&&Xa(Z,ke),xe;if(Ie===null){for(;ke<G.length;ke++)Ie=B(Z,G[ke],fe),Ie!==null&&(q=g(Ie,q,ke),Ee===null?xe=Ie:Ee.sibling=Ie,Ee=Ie);return $n&&Xa(Z,ke),xe}for(Ie=a(Z,Ie);ke<G.length;ke++)it=oe(Ie,Z,ke,G[ke],fe),it!==null&&(e&&it.alternate!==null&&Ie.delete(it.key===null?ke:it.key),q=g(it,q,ke),Ee===null?xe=it:Ee.sibling=it,Ee=it);return e&&Ie.forEach(function(At){return t(Z,At)}),$n&&Xa(Z,ke),xe}function re(Z,q,G,fe){var xe=nh(G);if(typeof xe!="function")throw Error(Ke(150));if(G=xe.call(G),G==null)throw Error(Ke(151));for(var Ee=xe=null,Ie=q,ke=q=0,it=null,Oe=G.next();Ie!==null&&!Oe.done;ke++,Oe=G.next()){Ie.index>ke?(it=Ie,Ie=null):it=Ie.sibling;var At=F(Z,Ie,Oe.value,fe);if(At===null){Ie===null&&(Ie=it);break}e&&Ie&&At.alternate===null&&t(Z,Ie),q=g(At,q,ke),Ee===null?xe=At:Ee.sibling=At,Ee=At,Ie=it}if(Oe.done)return s(Z,Ie),$n&&Xa(Z,ke),xe;if(Ie===null){for(;!Oe.done;ke++,Oe=G.next())Oe=B(Z,Oe.value,fe),Oe!==null&&(q=g(Oe,q,ke),Ee===null?xe=Oe:Ee.sibling=Oe,Ee=Oe);return $n&&Xa(Z,ke),xe}for(Ie=a(Z,Ie);!Oe.done;ke++,Oe=G.next())Oe=oe(Ie,Z,ke,Oe.value,fe),Oe!==null&&(e&&Oe.alternate!==null&&Ie.delete(Oe.key===null?ke:Oe.key),q=g(Oe,q,ke),Ee===null?xe=Oe:Ee.sibling=Oe,Ee=Oe);return e&&Ie.forEach(function(Ct){return t(Z,Ct)}),$n&&Xa(Z,ke),xe}function ue(Z,q,G,fe){if(typeof G=="object"&&G!==null&&G.type===lc&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case kp:e:{for(var xe=G.key,Ee=q;Ee!==null;){if(Ee.key===xe){if(xe=G.type,xe===lc){if(Ee.tag===7){s(Z,Ee.sibling),q=h(Ee,G.props.children),q.return=Z,Z=q;break e}}else if(Ee.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===sa&&Q1(xe)===Ee.type){s(Z,Ee.sibling),q=h(Ee,G.props),q.ref=ah(Z,Ee,G),q.return=Z,Z=q;break e}s(Z,Ee);break}else t(Z,Ee);Ee=Ee.sibling}G.type===lc?(q=ol(G.props.children,Z.mode,fe,G.key),q.return=Z,Z=q):(fe=af(G.type,G.key,G.props,null,Z.mode,fe),fe.ref=ah(Z,q,G),fe.return=Z,Z=fe)}return v(Z);case ac:e:{for(Ee=G.key;q!==null;){if(q.key===Ee)if(q.tag===4&&q.stateNode.containerInfo===G.containerInfo&&q.stateNode.implementation===G.implementation){s(Z,q.sibling),q=h(q,G.children||[]),q.return=Z,Z=q;break e}else{s(Z,q);break}else t(Z,q);q=q.sibling}q=uy(G,Z.mode,fe),q.return=Z,Z=q}return v(Z);case sa:return Ee=G._init,ue(Z,q,Ee(G._payload),fe)}if(ph(G))return se(Z,q,G,fe);if(nh(G))return re(Z,q,G,fe);Fp(Z,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,q!==null&&q.tag===6?(s(Z,q.sibling),q=h(q,G),q.return=Z,Z=q):(s(Z,q),q=cy(G,Z.mode,fe),q.return=Z,Z=q),v(Z)):s(Z,q)}return ue}var Rc=NS(!0),jS=NS(!1),Pf=ka(null),Af=null,gc=null,T_=null;function k_(){T_=gc=Af=null}function E_(e){var t=Pf.current;Fn(Pf),e._currentValue=t}function o0(e,t,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function Ac(e,t){Af=e,T_=gc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Lr=!0),e.firstContext=null)}function ps(e){var t=e._currentValue;if(T_!==e)if(e={context:e,memoizedValue:t,next:null},gc===null){if(Af===null)throw Error(Ke(308));gc=e,Af.dependencies={lanes:0,firstContext:e}}else gc=gc.next=e;return t}var tl=null;function C_(e){tl===null?tl=[e]:tl.push(e)}function OS(e,t,s,a){var h=t.interleaved;return h===null?(s.next=s,C_(t)):(s.next=h.next,h.next=s),t.interleaved=s,Lo(e,a)}function Lo(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var oa=!1;function P_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Co(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,un&2){var h=a.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),a.pending=t,Lo(e,s)}return h=a.interleaved,h===null?(t.next=t,C_(a)):(t.next=h.next,h.next=t),a.interleaved=t,Lo(e,s)}function ef(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,p_(e,s)}}function ew(e,t){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var h=null,g=null;if(s=s.firstBaseUpdate,s!==null){do{var v={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};g===null?h=g=v:g=g.next=v,s=s.next}while(s!==null);g===null?h=g=t:g=g.next=t}else h=g=t;s={baseState:a.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function If(e,t,s,a){var h=e.updateQueue;oa=!1;var g=h.firstBaseUpdate,v=h.lastBaseUpdate,c=h.shared.pending;if(c!==null){h.shared.pending=null;var C=c,k=C.next;C.next=null,v===null?g=k:v.next=k,v=C;var L=e.alternate;L!==null&&(L=L.updateQueue,c=L.lastBaseUpdate,c!==v&&(c===null?L.firstBaseUpdate=k:c.next=k,L.lastBaseUpdate=C))}if(g!==null){var B=h.baseState;v=0,L=k=C=null,c=g;do{var F=c.lane,oe=c.eventTime;if((a&F)===F){L!==null&&(L=L.next={eventTime:oe,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var se=e,re=c;switch(F=t,oe=s,re.tag){case 1:if(se=re.payload,typeof se=="function"){B=se.call(oe,B,F);break e}B=se;break e;case 3:se.flags=se.flags&-65537|128;case 0:if(se=re.payload,F=typeof se=="function"?se.call(oe,B,F):se,F==null)break e;B=Kn({},B,F);break e;case 2:oa=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,F=h.effects,F===null?h.effects=[c]:F.push(c))}else oe={eventTime:oe,lane:F,tag:c.tag,payload:c.payload,callback:c.callback,next:null},L===null?(k=L=oe,C=B):L=L.next=oe,v|=F;if(c=c.next,c===null){if(c=h.shared.pending,c===null)break;F=c,c=F.next,F.next=null,h.lastBaseUpdate=F,h.shared.pending=null}}while(1);if(L===null&&(C=B),h.baseState=C,h.firstBaseUpdate=k,h.lastBaseUpdate=L,t=h.shared.interleaved,t!==null){h=t;do v|=h.lane,h=h.next;while(h!==t)}else g===null&&(h.shared.lanes=0);pl|=v,e.lanes=v,e.memoizedState=B}}function tw(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],h=a.callback;if(h!==null){if(a.callback=null,a=s,typeof h!="function")throw Error(Ke(191,h));h.call(a)}}}var cd={},no=ka(cd),Zh=ka(cd),Gh=ka(cd);function nl(e){if(e===cd)throw Error(Ke(174));return e}function A_(e,t){switch(Mn(Gh,t),Mn(Zh,e),Mn(no,cd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Oy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Oy(t,e)}Fn(no),Mn(no,t)}function Fc(){Fn(no),Fn(Zh),Fn(Gh)}function $S(e){nl(Gh.current);var t=nl(no.current),s=Oy(t,e.type);t!==s&&(Mn(Zh,e),Mn(no,s))}function I_(e){Zh.current===e&&(Fn(no),Fn(Zh))}var Gn=ka(0);function Mf(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var iy=[];function M_(){for(var e=0;e<iy.length;e++)iy[e]._workInProgressVersionPrimary=null;iy.length=0}var tf=Fo.ReactCurrentDispatcher,ry=Fo.ReactCurrentBatchConfig,dl=0,Hn=null,Si=null,Mi=null,Lf=!1,Th=!1,Wh=0,GI=0;function Yi(){throw Error(Ke(321))}function L_(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Bs(e[s],t[s]))return!1;return!0}function z_(e,t,s,a,h,g){if(dl=g,Hn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tf.current=e===null||e.memoizedState===null?XI:YI,e=s(a,h),Th){g=0;do{if(Th=!1,Wh=0,25<=g)throw Error(Ke(301));g+=1,Mi=Si=null,t.updateQueue=null,tf.current=JI,e=s(a,h)}while(Th)}if(tf.current=zf,t=Si!==null&&Si.next!==null,dl=0,Mi=Si=Hn=null,Lf=!1,t)throw Error(Ke(300));return e}function D_(){var e=Wh!==0;return Wh=0,e}function Js(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mi===null?Hn.memoizedState=Mi=e:Mi=Mi.next=e,Mi}function fs(){if(Si===null){var e=Hn.alternate;e=e!==null?e.memoizedState:null}else e=Si.next;var t=Mi===null?Hn.memoizedState:Mi.next;if(t!==null)Mi=t,Si=e;else{if(e===null)throw Error(Ke(310));Si=e,e={memoizedState:Si.memoizedState,baseState:Si.baseState,baseQueue:Si.baseQueue,queue:Si.queue,next:null},Mi===null?Hn.memoizedState=Mi=e:Mi=Mi.next=e}return Mi}function Hh(e,t){return typeof t=="function"?t(e):t}function sy(e){var t=fs(),s=t.queue;if(s===null)throw Error(Ke(311));s.lastRenderedReducer=e;var a=Si,h=a.baseQueue,g=s.pending;if(g!==null){if(h!==null){var v=h.next;h.next=g.next,g.next=v}a.baseQueue=h=g,s.pending=null}if(h!==null){g=h.next,a=a.baseState;var c=v=null,C=null,k=g;do{var L=k.lane;if((dl&L)===L)C!==null&&(C=C.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),a=k.hasEagerState?k.eagerState:e(a,k.action);else{var B={lane:L,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};C===null?(c=C=B,v=a):C=C.next=B,Hn.lanes|=L,pl|=L}k=k.next}while(k!==null&&k!==g);C===null?v=a:C.next=c,Bs(a,t.memoizedState)||(Lr=!0),t.memoizedState=a,t.baseState=v,t.baseQueue=C,s.lastRenderedState=a}if(e=s.interleaved,e!==null){h=e;do g=h.lane,Hn.lanes|=g,pl|=g,h=h.next;while(h!==e)}else h===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function oy(e){var t=fs(),s=t.queue;if(s===null)throw Error(Ke(311));s.lastRenderedReducer=e;var a=s.dispatch,h=s.pending,g=t.memoizedState;if(h!==null){s.pending=null;var v=h=h.next;do g=e(g,v.action),v=v.next;while(v!==h);Bs(g,t.memoizedState)||(Lr=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),s.lastRenderedState=g}return[g,a]}function US(){}function qS(e,t){var s=Hn,a=fs(),h=t(),g=!Bs(a.memoizedState,h);if(g&&(a.memoizedState=h,Lr=!0),a=a.queue,R_(WS.bind(null,s,a,e),[e]),a.getSnapshot!==t||g||Mi!==null&&Mi.memoizedState.tag&1){if(s.flags|=2048,Kh(9,GS.bind(null,s,a,h,t),void 0,null),Li===null)throw Error(Ke(349));dl&30||ZS(s,t,h)}return h}function ZS(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Hn.updateQueue,t===null?(t={lastEffect:null,stores:null},Hn.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function GS(e,t,s,a){t.value=s,t.getSnapshot=a,HS(t)&&KS(e)}function WS(e,t,s){return s(function(){HS(t)&&KS(e)})}function HS(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Bs(e,s)}catch{return!0}}function KS(e){var t=Lo(e,1);t!==null&&Rs(t,e,1,-1)}function nw(e){var t=Js();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hh,lastRenderedState:e},t.queue=e,e=e.dispatch=KI.bind(null,Hn,e),[t.memoizedState,e]}function Kh(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},t=Hn.updateQueue,t===null?(t={lastEffect:null,stores:null},Hn.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e)),e}function XS(){return fs().memoizedState}function nf(e,t,s,a){var h=Js();Hn.flags|=e,h.memoizedState=Kh(1|t,s,void 0,a===void 0?null:a)}function om(e,t,s,a){var h=fs();a=a===void 0?null:a;var g=void 0;if(Si!==null){var v=Si.memoizedState;if(g=v.destroy,a!==null&&L_(a,v.deps)){h.memoizedState=Kh(t,s,g,a);return}}Hn.flags|=e,h.memoizedState=Kh(1|t,s,g,a)}function iw(e,t){return nf(8390656,8,e,t)}function R_(e,t){return om(2048,8,e,t)}function YS(e,t){return om(4,2,e,t)}function JS(e,t){return om(4,4,e,t)}function QS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function eT(e,t,s){return s=s!=null?s.concat([e]):null,om(4,4,QS.bind(null,t,e),s)}function F_(){}function tT(e,t){var s=fs();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&L_(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function nT(e,t){var s=fs();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&L_(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function iT(e,t,s){return dl&21?(Bs(s,t)||(s=lS(),Hn.lanes|=s,pl|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=s)}function WI(e,t){var s=xn;xn=s!==0&&4>s?s:4,e(!0);var a=ry.transition;ry.transition={};try{e(!1),t()}finally{xn=s,ry.transition=a}}function rT(){return fs().memoizedState}function HI(e,t,s){var a=ya(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},sT(e))oT(t,s);else if(s=OS(e,t,s,a),s!==null){var h=_r();Rs(s,e,a,h),aT(s,t,a)}}function KI(e,t,s){var a=ya(e),h={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(sT(e))oT(t,h);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var v=t.lastRenderedState,c=g(v,s);if(h.hasEagerState=!0,h.eagerState=c,Bs(c,v)){var C=t.interleaved;C===null?(h.next=h,C_(t)):(h.next=C.next,C.next=h),t.interleaved=h;return}}catch{}finally{}s=OS(e,t,h,a),s!==null&&(h=_r(),Rs(s,e,a,h),aT(s,t,a))}}function sT(e){var t=e.alternate;return e===Hn||t!==null&&t===Hn}function oT(e,t){Th=Lf=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function aT(e,t,s){if(s&4194240){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,p_(e,s)}}var zf={readContext:ps,useCallback:Yi,useContext:Yi,useEffect:Yi,useImperativeHandle:Yi,useInsertionEffect:Yi,useLayoutEffect:Yi,useMemo:Yi,useReducer:Yi,useRef:Yi,useState:Yi,useDebugValue:Yi,useDeferredValue:Yi,useTransition:Yi,useMutableSource:Yi,useSyncExternalStore:Yi,useId:Yi,unstable_isNewReconciler:!1},XI={readContext:ps,useCallback:function(e,t){return Js().memoizedState=[e,t===void 0?null:t],e},useContext:ps,useEffect:iw,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,nf(4194308,4,QS.bind(null,t,e),s)},useLayoutEffect:function(e,t){return nf(4194308,4,e,t)},useInsertionEffect:function(e,t){return nf(4,2,e,t)},useMemo:function(e,t){var s=Js();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=Js();return t=s!==void 0?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=HI.bind(null,Hn,e),[a.memoizedState,e]},useRef:function(e){var t=Js();return e={current:e},t.memoizedState=e},useState:nw,useDebugValue:F_,useDeferredValue:function(e){return Js().memoizedState=e},useTransition:function(){var e=nw(!1),t=e[0];return e=WI.bind(null,e[1]),Js().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=Hn,h=Js();if($n){if(s===void 0)throw Error(Ke(407));s=s()}else{if(s=t(),Li===null)throw Error(Ke(349));dl&30||ZS(a,t,s)}h.memoizedState=s;var g={value:s,getSnapshot:t};return h.queue=g,iw(WS.bind(null,a,g,e),[e]),a.flags|=2048,Kh(9,GS.bind(null,a,g,s,t),void 0,null),s},useId:function(){var e=Js(),t=Li.identifierPrefix;if($n){var s=Eo,a=ko;s=(a&~(1<<32-Ds(a)-1)).toString(32)+s,t=":"+t+"R"+s,s=Wh++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=GI++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},YI={readContext:ps,useCallback:tT,useContext:ps,useEffect:R_,useImperativeHandle:eT,useInsertionEffect:YS,useLayoutEffect:JS,useMemo:nT,useReducer:sy,useRef:XS,useState:function(){return sy(Hh)},useDebugValue:F_,useDeferredValue:function(e){var t=fs();return iT(t,Si.memoizedState,e)},useTransition:function(){var e=sy(Hh)[0],t=fs().memoizedState;return[e,t]},useMutableSource:US,useSyncExternalStore:qS,useId:rT,unstable_isNewReconciler:!1},JI={readContext:ps,useCallback:tT,useContext:ps,useEffect:R_,useImperativeHandle:eT,useInsertionEffect:YS,useLayoutEffect:JS,useMemo:nT,useReducer:oy,useRef:XS,useState:function(){return oy(Hh)},useDebugValue:F_,useDeferredValue:function(e){var t=fs();return Si===null?t.memoizedState=e:iT(t,Si.memoizedState,e)},useTransition:function(){var e=oy(Hh)[0],t=fs().memoizedState;return[e,t]},useMutableSource:US,useSyncExternalStore:qS,useId:rT,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=Kn({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function a0(e,t,s,a){t=e.memoizedState,s=s(a,t),s=s==null?t:Kn({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var am={isMounted:function(e){return(e=e._reactInternals)?_l(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=_r(),h=ya(e),g=Co(a,h);g.payload=t,s!=null&&(g.callback=s),t=ma(e,g,h),t!==null&&(Rs(t,e,h,a),ef(t,e,h))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=_r(),h=ya(e),g=Co(a,h);g.tag=1,g.payload=t,s!=null&&(g.callback=s),t=ma(e,g,h),t!==null&&(Rs(t,e,h,a),ef(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=_r(),a=ya(e),h=Co(s,a);h.tag=2,t!=null&&(h.callback=t),t=ma(e,h,a),t!==null&&(Rs(t,e,a,s),ef(t,e,a))}};function rw(e,t,s,a,h,g,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,g,v):t.prototype&&t.prototype.isPureReactComponent?!Vh(s,a)||!Vh(h,g):!0}function lT(e,t,s){var a=!1,h=wa,g=t.contextType;return typeof g=="object"&&g!==null?g=ps(g):(h=Dr(t)?ul:ir.current,a=t.contextTypes,g=(a=a!=null)?zc(e,h):wa),t=new t(s,g),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=am,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=g),t}function sw(e,t,s,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&am.enqueueReplaceState(t,t.state,null)}function l0(e,t,s,a){var h=e.stateNode;h.props=s,h.state=e.memoizedState,h.refs={},P_(e);var g=t.contextType;typeof g=="object"&&g!==null?h.context=ps(g):(g=Dr(t)?ul:ir.current,h.context=zc(e,g)),h.state=e.memoizedState,g=t.getDerivedStateFromProps,typeof g=="function"&&(a0(e,t,g,s),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&am.enqueueReplaceState(h,h.state,null),If(e,s,h,a),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function Bc(e,t){try{var s="",a=t;do s+=EA(a),a=a.return;while(a);var h=s}catch(g){h=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:t,stack:h,digest:null}}function ay(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function c0(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var QI=typeof WeakMap=="function"?WeakMap:Map;function cT(e,t,s){s=Co(-1,s),s.tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){Rf||(Rf=!0,x0=a),c0(e,t)},s}function uT(e,t,s){s=Co(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var h=t.value;s.payload=function(){return a(h)},s.callback=function(){c0(e,t)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(s.callback=function(){c0(e,t),typeof a!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var v=t.stack;this.componentDidCatch(t.value,{componentStack:v!==null?v:""})}),s}function ow(e,t,s){var a=e.pingCache;if(a===null){a=e.pingCache=new QI;var h=new Set;a.set(t,h)}else h=a.get(t),h===void 0&&(h=new Set,a.set(t,h));h.has(s)||(h.add(s),e=p5.bind(null,e,t,s),t.then(e,e))}function aw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function lw(e,t,s,a,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Co(-1,1),t.tag=2,ma(s,t,1))),s.lanes|=1),e)}var e5=Fo.ReactCurrentOwner,Lr=!1;function gr(e,t,s,a){t.child=e===null?jS(t,null,s,a):Rc(t,e.child,s,a)}function cw(e,t,s,a,h){s=s.render;var g=t.ref;return Ac(t,h),a=z_(e,t,s,a,g,h),s=D_(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,zo(e,t,h)):($n&&s&&w_(t),t.flags|=1,gr(e,t,a,h),t.child)}function uw(e,t,s,a,h){if(e===null){var g=s.type;return typeof g=="function"&&!q_(g)&&g.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=g,hT(e,t,g,a,h)):(e=af(s.type,null,a,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!(e.lanes&h)){var v=g.memoizedProps;if(s=s.compare,s=s!==null?s:Vh,s(v,a)&&e.ref===t.ref)return zo(e,t,h)}return t.flags|=1,e=_a(g,a),e.ref=t.ref,e.return=t,t.child=e}function hT(e,t,s,a,h){if(e!==null){var g=e.memoizedProps;if(Vh(g,a)&&e.ref===t.ref)if(Lr=!1,t.pendingProps=a=g,(e.lanes&h)!==0)e.flags&131072&&(Lr=!0);else return t.lanes=e.lanes,zo(e,t,h)}return u0(e,t,s,a,h)}function dT(e,t,s){var a=t.pendingProps,h=a.children,g=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mn(_c,Ur),Ur|=s;else{if(!(s&1073741824))return e=g!==null?g.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mn(_c,Ur),Ur|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=g!==null?g.baseLanes:s,Mn(_c,Ur),Ur|=a}else g!==null?(a=g.baseLanes|s,t.memoizedState=null):a=s,Mn(_c,Ur),Ur|=a;return gr(e,t,h,s),t.child}function pT(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function u0(e,t,s,a,h){var g=Dr(s)?ul:ir.current;return g=zc(t,g),Ac(t,h),s=z_(e,t,s,a,g,h),a=D_(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,zo(e,t,h)):($n&&a&&w_(t),t.flags|=1,gr(e,t,s,h),t.child)}function hw(e,t,s,a,h){if(Dr(s)){var g=!0;kf(t)}else g=!1;if(Ac(t,h),t.stateNode===null)rf(e,t),lT(t,s,a),l0(t,s,a,h),a=!0;else if(e===null){var v=t.stateNode,c=t.memoizedProps;v.props=c;var C=v.context,k=s.contextType;typeof k=="object"&&k!==null?k=ps(k):(k=Dr(s)?ul:ir.current,k=zc(t,k));var L=s.getDerivedStateFromProps,B=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function";B||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==a||C!==k)&&sw(t,v,a,k),oa=!1;var F=t.memoizedState;v.state=F,If(t,a,v,h),C=t.memoizedState,c!==a||F!==C||zr.current||oa?(typeof L=="function"&&(a0(t,s,L,a),C=t.memoizedState),(c=oa||rw(t,s,c,a,F,C,k))?(B||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(t.flags|=4194308)):(typeof v.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=C),v.props=a,v.state=C,v.context=k,a=c):(typeof v.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{v=t.stateNode,VS(e,t),c=t.memoizedProps,k=t.type===t.elementType?c:Ms(t.type,c),v.props=k,B=t.pendingProps,F=v.context,C=s.contextType,typeof C=="object"&&C!==null?C=ps(C):(C=Dr(s)?ul:ir.current,C=zc(t,C));var oe=s.getDerivedStateFromProps;(L=typeof oe=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==B||F!==C)&&sw(t,v,a,C),oa=!1,F=t.memoizedState,v.state=F,If(t,a,v,h);var se=t.memoizedState;c!==B||F!==se||zr.current||oa?(typeof oe=="function"&&(a0(t,s,oe,a),se=t.memoizedState),(k=oa||rw(t,s,k,a,F,se,C)||!1)?(L||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(a,se,C),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(a,se,C)),typeof v.componentDidUpdate=="function"&&(t.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=se),v.props=a,v.state=se,v.context=C,a=k):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),a=!1)}return h0(e,t,s,a,g,h)}function h0(e,t,s,a,h,g){pT(e,t);var v=(t.flags&128)!==0;if(!a&&!v)return h&&X1(t,s,!1),zo(e,t,g);a=t.stateNode,e5.current=t;var c=v&&typeof s.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&v?(t.child=Rc(t,e.child,null,g),t.child=Rc(t,null,c,g)):gr(e,t,c,g),t.memoizedState=a.state,h&&X1(t,s,!0),t.child}function fT(e){var t=e.stateNode;t.pendingContext?K1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&K1(e,t.context,!1),A_(e,t.containerInfo)}function dw(e,t,s,a,h){return Dc(),S_(h),t.flags|=256,gr(e,t,s,a),t.child}var d0={dehydrated:null,treeContext:null,retryLane:0};function p0(e){return{baseLanes:e,cachePool:null,transitions:null}}function mT(e,t,s){var a=t.pendingProps,h=Gn.current,g=!1,v=(t.flags&128)!==0,c;if((c=v)||(c=e!==null&&e.memoizedState===null?!1:(h&2)!==0),c?(g=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),Mn(Gn,h&1),e===null)return s0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(v=a.children,e=a.fallback,g?(a=t.mode,g=t.child,v={mode:"hidden",children:v},!(a&1)&&g!==null?(g.childLanes=0,g.pendingProps=v):g=um(v,a,0,null),e=ol(e,a,s,null),g.return=t,e.return=t,g.sibling=e,t.child=g,t.child.memoizedState=p0(s),t.memoizedState=d0,e):B_(t,v));if(h=e.memoizedState,h!==null&&(c=h.dehydrated,c!==null))return t5(e,t,v,a,c,h,s);if(g){g=a.fallback,v=t.mode,h=e.child,c=h.sibling;var C={mode:"hidden",children:a.children};return!(v&1)&&t.child!==h?(a=t.child,a.childLanes=0,a.pendingProps=C,t.deletions=null):(a=_a(h,C),a.subtreeFlags=h.subtreeFlags&14680064),c!==null?g=_a(c,g):(g=ol(g,v,s,null),g.flags|=2),g.return=t,a.return=t,a.sibling=g,t.child=a,a=g,g=t.child,v=e.child.memoizedState,v=v===null?p0(s):{baseLanes:v.baseLanes|s,cachePool:null,transitions:v.transitions},g.memoizedState=v,g.childLanes=e.childLanes&~s,t.memoizedState=d0,a}return g=e.child,e=g.sibling,a=_a(g,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=s),a.return=t,a.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a}function B_(e,t){return t=um({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bp(e,t,s,a){return a!==null&&S_(a),Rc(t,e.child,null,s),e=B_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function t5(e,t,s,a,h,g,v){if(s)return t.flags&256?(t.flags&=-257,a=ay(Error(Ke(422))),Bp(e,t,v,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(g=a.fallback,h=t.mode,a=um({mode:"visible",children:a.children},h,0,null),g=ol(g,h,v,null),g.flags|=2,a.return=t,g.return=t,a.sibling=g,t.child=a,t.mode&1&&Rc(t,e.child,null,v),t.child.memoizedState=p0(v),t.memoizedState=d0,g);if(!(t.mode&1))return Bp(e,t,v,null);if(h.data==="$!"){if(a=h.nextSibling&&h.nextSibling.dataset,a)var c=a.dgst;return a=c,g=Error(Ke(419)),a=ay(g,a,void 0),Bp(e,t,v,a)}if(c=(v&e.childLanes)!==0,Lr||c){if(a=Li,a!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(a.suspendedLanes|v)?0:h,h!==0&&h!==g.retryLane&&(g.retryLane=h,Lo(e,h),Rs(a,e,h,-1))}return U_(),a=ay(Error(Ke(421))),Bp(e,t,v,a)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=f5.bind(null,e),h._reactRetry=t,null):(e=g.treeContext,qr=fa(h.nextSibling),Zr=t,$n=!0,zs=null,e!==null&&(cs[us++]=ko,cs[us++]=Eo,cs[us++]=hl,ko=e.id,Eo=e.overflow,hl=t),t=B_(t,a.children),t.flags|=4096,t)}function pw(e,t,s){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),o0(e.return,t,s)}function ly(e,t,s,a,h){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:h}:(g.isBackwards=t,g.rendering=null,g.renderingStartTime=0,g.last=a,g.tail=s,g.tailMode=h)}function gT(e,t,s){var a=t.pendingProps,h=a.revealOrder,g=a.tail;if(gr(e,t,a.children,s),a=Gn.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&pw(e,s,t);else if(e.tag===19)pw(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Mn(Gn,a),!(t.mode&1))t.memoizedState=null;else switch(h){case"forwards":for(s=t.child,h=null;s!==null;)e=s.alternate,e!==null&&Mf(e)===null&&(h=s),s=s.sibling;s=h,s===null?(h=t.child,t.child=null):(h=s.sibling,s.sibling=null),ly(t,!1,h,s,g);break;case"backwards":for(s=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Mf(e)===null){t.child=h;break}e=h.sibling,h.sibling=s,s=h,h=e}ly(t,!0,s,null,g);break;case"together":ly(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zo(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),pl|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ke(153));if(t.child!==null){for(e=t.child,s=_a(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=_a(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function n5(e,t,s){switch(t.tag){case 3:fT(t),Dc();break;case 5:$S(t);break;case 1:Dr(t.type)&&kf(t);break;case 4:A_(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,h=t.memoizedProps.value;Mn(Pf,a._currentValue),a._currentValue=h;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(Mn(Gn,Gn.current&1),t.flags|=128,null):s&t.child.childLanes?mT(e,t,s):(Mn(Gn,Gn.current&1),e=zo(e,t,s),e!==null?e.sibling:null);Mn(Gn,Gn.current&1);break;case 19:if(a=(s&t.childLanes)!==0,e.flags&128){if(a)return gT(e,t,s);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Mn(Gn,Gn.current),a)break;return null;case 22:case 23:return t.lanes=0,dT(e,t,s)}return zo(e,t,s)}var yT,f0,_T,xT;yT=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};f0=function(){};_T=function(e,t,s,a){var h=e.memoizedProps;if(h!==a){e=t.stateNode,nl(no.current);var g=null;switch(s){case"input":h=Fy(e,h),a=Fy(e,a),g=[];break;case"select":h=Kn({},h,{value:void 0}),a=Kn({},a,{value:void 0}),g=[];break;case"textarea":h=jy(e,h),a=jy(e,a),g=[];break;default:typeof h.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Sf)}Vy(s,a);var v;s=null;for(k in h)if(!a.hasOwnProperty(k)&&h.hasOwnProperty(k)&&h[k]!=null)if(k==="style"){var c=h[k];for(v in c)c.hasOwnProperty(v)&&(s||(s={}),s[v]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(Dh.hasOwnProperty(k)?g||(g=[]):(g=g||[]).push(k,null));for(k in a){var C=a[k];if(c=h!=null?h[k]:void 0,a.hasOwnProperty(k)&&C!==c&&(C!=null||c!=null))if(k==="style")if(c){for(v in c)!c.hasOwnProperty(v)||C&&C.hasOwnProperty(v)||(s||(s={}),s[v]="");for(v in C)C.hasOwnProperty(v)&&c[v]!==C[v]&&(s||(s={}),s[v]=C[v])}else s||(g||(g=[]),g.push(k,s)),s=C;else k==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,c=c?c.__html:void 0,C!=null&&c!==C&&(g=g||[]).push(k,C)):k==="children"?typeof C!="string"&&typeof C!="number"||(g=g||[]).push(k,""+C):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(Dh.hasOwnProperty(k)?(C!=null&&k==="onScroll"&&Rn("scroll",e),g||c===C||(g=[])):(g=g||[]).push(k,C))}s&&(g=g||[]).push("style",s);var k=g;(t.updateQueue=k)&&(t.flags|=4)}};xT=function(e,t,s,a){s!==a&&(t.flags|=4)};function lh(e,t){if(!$n)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Ji(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(t)for(var h=e.child;h!==null;)s|=h.lanes|h.childLanes,a|=h.subtreeFlags&14680064,a|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)s|=h.lanes|h.childLanes,a|=h.subtreeFlags,a|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function i5(e,t,s){var a=t.pendingProps;switch(b_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ji(t),null;case 1:return Dr(t.type)&&Tf(),Ji(t),null;case 3:return a=t.stateNode,Fc(),Fn(zr),Fn(ir),M_(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Rp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zs!==null&&(b0(zs),zs=null))),f0(e,t),Ji(t),null;case 5:I_(t);var h=nl(Gh.current);if(s=t.type,e!==null&&t.stateNode!=null)_T(e,t,s,a,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Ke(166));return Ji(t),null}if(e=nl(no.current),Rp(t)){a=t.stateNode,s=t.type;var g=t.memoizedProps;switch(a[eo]=t,a[qh]=g,e=(t.mode&1)!==0,s){case"dialog":Rn("cancel",a),Rn("close",a);break;case"iframe":case"object":case"embed":Rn("load",a);break;case"video":case"audio":for(h=0;h<mh.length;h++)Rn(mh[h],a);break;case"source":Rn("error",a);break;case"img":case"image":case"link":Rn("error",a),Rn("load",a);break;case"details":Rn("toggle",a);break;case"input":b1(a,g),Rn("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!g.multiple},Rn("invalid",a);break;case"textarea":T1(a,g),Rn("invalid",a)}Vy(s,g),h=null;for(var v in g)if(g.hasOwnProperty(v)){var c=g[v];v==="children"?typeof c=="string"?a.textContent!==c&&(g.suppressHydrationWarning!==!0&&Dp(a.textContent,c,e),h=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(g.suppressHydrationWarning!==!0&&Dp(a.textContent,c,e),h=["children",""+c]):Dh.hasOwnProperty(v)&&c!=null&&v==="onScroll"&&Rn("scroll",a)}switch(s){case"input":Ep(a),S1(a,g,!0);break;case"textarea":Ep(a),k1(a);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(a.onclick=Sf)}a=h,t.updateQueue=a,a!==null&&(t.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W2(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=v.createElement(s,{is:a.is}):(e=v.createElement(s),s==="select"&&(v=e,a.multiple?v.multiple=!0:a.size&&(v.size=a.size))):e=v.createElementNS(e,s),e[eo]=t,e[qh]=a,yT(e,t,!1,!1),t.stateNode=e;e:{switch(v=$y(s,a),s){case"dialog":Rn("cancel",e),Rn("close",e),h=a;break;case"iframe":case"object":case"embed":Rn("load",e),h=a;break;case"video":case"audio":for(h=0;h<mh.length;h++)Rn(mh[h],e);h=a;break;case"source":Rn("error",e),h=a;break;case"img":case"image":case"link":Rn("error",e),Rn("load",e),h=a;break;case"details":Rn("toggle",e),h=a;break;case"input":b1(e,a),h=Fy(e,a),Rn("invalid",e);break;case"option":h=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},h=Kn({},a,{value:void 0}),Rn("invalid",e);break;case"textarea":T1(e,a),h=jy(e,a),Rn("invalid",e);break;default:h=a}Vy(s,h),c=h;for(g in c)if(c.hasOwnProperty(g)){var C=c[g];g==="style"?X2(e,C):g==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&H2(e,C)):g==="children"?typeof C=="string"?(s!=="textarea"||C!=="")&&Rh(e,C):typeof C=="number"&&Rh(e,""+C):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Dh.hasOwnProperty(g)?C!=null&&g==="onScroll"&&Rn("scroll",e):C!=null&&a_(e,g,C,v))}switch(s){case"input":Ep(e),S1(e,a,!1);break;case"textarea":Ep(e),k1(e);break;case"option":a.value!=null&&e.setAttribute("value",""+va(a.value));break;case"select":e.multiple=!!a.multiple,g=a.value,g!=null?kc(e,!!a.multiple,g,!1):a.defaultValue!=null&&kc(e,!!a.multiple,a.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=Sf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ji(t),null;case 6:if(e&&t.stateNode!=null)xT(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ke(166));if(s=nl(Gh.current),nl(no.current),Rp(t)){if(a=t.stateNode,s=t.memoizedProps,a[eo]=t,(g=a.nodeValue!==s)&&(e=Zr,e!==null))switch(e.tag){case 3:Dp(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Dp(a.nodeValue,s,(e.mode&1)!==0)}g&&(t.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[eo]=t,t.stateNode=a}return Ji(t),null;case 13:if(Fn(Gn),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($n&&qr!==null&&t.mode&1&&!(t.flags&128))BS(),Dc(),t.flags|=98560,g=!1;else if(g=Rp(t),a!==null&&a.dehydrated!==null){if(e===null){if(!g)throw Error(Ke(318));if(g=t.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(Ke(317));g[eo]=t}else Dc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ji(t),g=!1}else zs!==null&&(b0(zs),zs=null),g=!0;if(!g)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||Gn.current&1?Ti===0&&(Ti=3):U_())),t.updateQueue!==null&&(t.flags|=4),Ji(t),null);case 4:return Fc(),f0(e,t),e===null&&$h(t.stateNode.containerInfo),Ji(t),null;case 10:return E_(t.type._context),Ji(t),null;case 17:return Dr(t.type)&&Tf(),Ji(t),null;case 19:if(Fn(Gn),g=t.memoizedState,g===null)return Ji(t),null;if(a=(t.flags&128)!==0,v=g.rendering,v===null)if(a)lh(g,!1);else{if(Ti!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(v=Mf(e),v!==null){for(t.flags|=128,lh(g,!1),a=v.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;s!==null;)g=s,e=a,g.flags&=14680066,v=g.alternate,v===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=v.childLanes,g.lanes=v.lanes,g.child=v.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=v.memoizedProps,g.memoizedState=v.memoizedState,g.updateQueue=v.updateQueue,g.type=v.type,e=v.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Mn(Gn,Gn.current&1|2),t.child}e=e.sibling}g.tail!==null&&hi()>Nc&&(t.flags|=128,a=!0,lh(g,!1),t.lanes=4194304)}else{if(!a)if(e=Mf(v),e!==null){if(t.flags|=128,a=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),lh(g,!0),g.tail===null&&g.tailMode==="hidden"&&!v.alternate&&!$n)return Ji(t),null}else 2*hi()-g.renderingStartTime>Nc&&s!==1073741824&&(t.flags|=128,a=!0,lh(g,!1),t.lanes=4194304);g.isBackwards?(v.sibling=t.child,t.child=v):(s=g.last,s!==null?s.sibling=v:t.child=v,g.last=v)}return g.tail!==null?(t=g.tail,g.rendering=t,g.tail=t.sibling,g.renderingStartTime=hi(),t.sibling=null,s=Gn.current,Mn(Gn,a?s&1|2:s&1),t):(Ji(t),null);case 22:case 23:return $_(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Ur&1073741824&&(Ji(t),t.subtreeFlags&6&&(t.flags|=8192)):Ji(t),null;case 24:return null;case 25:return null}throw Error(Ke(156,t.tag))}function r5(e,t){switch(b_(t),t.tag){case 1:return Dr(t.type)&&Tf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fc(),Fn(zr),Fn(ir),M_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return I_(t),null;case 13:if(Fn(Gn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ke(340));Dc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Fn(Gn),null;case 4:return Fc(),null;case 10:return E_(t.type._context),null;case 22:case 23:return $_(),null;case 24:return null;default:return null}}var Np=!1,er=!1,s5=typeof WeakSet=="function"?WeakSet:Set,gt=null;function yc(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){ei(e,t,a)}else s.current=null}function m0(e,t,s){try{s()}catch(a){ei(e,t,a)}}var fw=!1;function o5(e,t){if(Jy=vf,e=TS(),v_(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var h=a.anchorOffset,g=a.focusNode;a=a.focusOffset;try{s.nodeType,g.nodeType}catch{s=null;break e}var v=0,c=-1,C=-1,k=0,L=0,B=e,F=null;t:for(;;){for(var oe;B!==s||h!==0&&B.nodeType!==3||(c=v+h),B!==g||a!==0&&B.nodeType!==3||(C=v+a),B.nodeType===3&&(v+=B.nodeValue.length),(oe=B.firstChild)!==null;)F=B,B=oe;for(;;){if(B===e)break t;if(F===s&&++k===h&&(c=v),F===g&&++L===a&&(C=v),(oe=B.nextSibling)!==null)break;B=F,F=B.parentNode}B=oe}s=c===-1||C===-1?null:{start:c,end:C}}else s=null}s=s||{start:0,end:0}}else s=null;for(Qy={focusedElem:e,selectionRange:s},vf=!1,gt=t;gt!==null;)if(t=gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,gt=e;else for(;gt!==null;){t=gt;try{var se=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(se!==null){var re=se.memoizedProps,ue=se.memoizedState,Z=t.stateNode,q=Z.getSnapshotBeforeUpdate(t.elementType===t.type?re:Ms(t.type,re),ue);Z.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var G=t.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(fe){ei(t,t.return,fe)}if(e=t.sibling,e!==null){e.return=t.return,gt=e;break}gt=t.return}return se=fw,fw=!1,se}function kh(e,t,s){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&e)===e){var g=h.destroy;h.destroy=void 0,g!==void 0&&m0(t,s,g)}h=h.next}while(h!==a)}}function lm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function g0(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function vT(e){var t=e.alternate;t!==null&&(e.alternate=null,vT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[eo],delete t[qh],delete t[n0],delete t[$I],delete t[UI])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function wT(e){return e.tag===5||e.tag===3||e.tag===4}function mw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||wT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function y0(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Sf));else if(a!==4&&(e=e.child,e!==null))for(y0(e,t,s),e=e.sibling;e!==null;)y0(e,t,s),e=e.sibling}function _0(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(_0(e,t,s),e=e.sibling;e!==null;)_0(e,t,s),e=e.sibling}var ji=null,Ls=!1;function ia(e,t,s){for(s=s.child;s!==null;)bT(e,t,s),s=s.sibling}function bT(e,t,s){if(to&&typeof to.onCommitFiberUnmount=="function")try{to.onCommitFiberUnmount(em,s)}catch{}switch(s.tag){case 5:er||yc(s,t);case 6:var a=ji,h=Ls;ji=null,ia(e,t,s),ji=a,Ls=h,ji!==null&&(Ls?(e=ji,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):ji.removeChild(s.stateNode));break;case 18:ji!==null&&(Ls?(e=ji,s=s.stateNode,e.nodeType===8?ty(e.parentNode,s):e.nodeType===1&&ty(e,s),jh(e)):ty(ji,s.stateNode));break;case 4:a=ji,h=Ls,ji=s.stateNode.containerInfo,Ls=!0,ia(e,t,s),ji=a,Ls=h;break;case 0:case 11:case 14:case 15:if(!er&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){h=a=a.next;do{var g=h,v=g.destroy;g=g.tag,v!==void 0&&(g&2||g&4)&&m0(s,t,v),h=h.next}while(h!==a)}ia(e,t,s);break;case 1:if(!er&&(yc(s,t),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(c){ei(s,t,c)}ia(e,t,s);break;case 21:ia(e,t,s);break;case 22:s.mode&1?(er=(a=er)||s.memoizedState!==null,ia(e,t,s),er=a):ia(e,t,s);break;default:ia(e,t,s)}}function gw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new s5),t.forEach(function(a){var h=m5.bind(null,e,a);s.has(a)||(s.add(a),a.then(h,h))})}}function Ps(e,t){var s=t.deletions;if(s!==null)for(var a=0;a<s.length;a++){var h=s[a];try{var g=e,v=t,c=v;e:for(;c!==null;){switch(c.tag){case 5:ji=c.stateNode,Ls=!1;break e;case 3:ji=c.stateNode.containerInfo,Ls=!0;break e;case 4:ji=c.stateNode.containerInfo,Ls=!0;break e}c=c.return}if(ji===null)throw Error(Ke(160));bT(g,v,h),ji=null,Ls=!1;var C=h.alternate;C!==null&&(C.return=null),h.return=null}catch(k){ei(h,t,k)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ST(t,e),t=t.sibling}function ST(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ps(t,e),Ks(e),a&4){try{kh(3,e,e.return),lm(3,e)}catch(re){ei(e,e.return,re)}try{kh(5,e,e.return)}catch(re){ei(e,e.return,re)}}break;case 1:Ps(t,e),Ks(e),a&512&&s!==null&&yc(s,s.return);break;case 5:if(Ps(t,e),Ks(e),a&512&&s!==null&&yc(s,s.return),e.flags&32){var h=e.stateNode;try{Rh(h,"")}catch(re){ei(e,e.return,re)}}if(a&4&&(h=e.stateNode,h!=null)){var g=e.memoizedProps,v=s!==null?s.memoizedProps:g,c=e.type,C=e.updateQueue;if(e.updateQueue=null,C!==null)try{c==="input"&&g.type==="radio"&&g.name!=null&&Z2(h,g),$y(c,v);var k=$y(c,g);for(v=0;v<C.length;v+=2){var L=C[v],B=C[v+1];L==="style"?X2(h,B):L==="dangerouslySetInnerHTML"?H2(h,B):L==="children"?Rh(h,B):a_(h,L,B,k)}switch(c){case"input":By(h,g);break;case"textarea":G2(h,g);break;case"select":var F=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!g.multiple;var oe=g.value;oe!=null?kc(h,!!g.multiple,oe,!1):F!==!!g.multiple&&(g.defaultValue!=null?kc(h,!!g.multiple,g.defaultValue,!0):kc(h,!!g.multiple,g.multiple?[]:"",!1))}h[qh]=g}catch(re){ei(e,e.return,re)}}break;case 6:if(Ps(t,e),Ks(e),a&4){if(e.stateNode===null)throw Error(Ke(162));h=e.stateNode,g=e.memoizedProps;try{h.nodeValue=g}catch(re){ei(e,e.return,re)}}break;case 3:if(Ps(t,e),Ks(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{jh(t.containerInfo)}catch(re){ei(e,e.return,re)}break;case 4:Ps(t,e),Ks(e);break;case 13:Ps(t,e),Ks(e),h=e.child,h.flags&8192&&(g=h.memoizedState!==null,h.stateNode.isHidden=g,!g||h.alternate!==null&&h.alternate.memoizedState!==null||(O_=hi())),a&4&&gw(e);break;case 22:if(L=s!==null&&s.memoizedState!==null,e.mode&1?(er=(k=er)||L,Ps(t,e),er=k):Ps(t,e),Ks(e),a&8192){if(k=e.memoizedState!==null,(e.stateNode.isHidden=k)&&!L&&e.mode&1)for(gt=e,L=e.child;L!==null;){for(B=gt=L;gt!==null;){switch(F=gt,oe=F.child,F.tag){case 0:case 11:case 14:case 15:kh(4,F,F.return);break;case 1:yc(F,F.return);var se=F.stateNode;if(typeof se.componentWillUnmount=="function"){a=F,s=F.return;try{t=a,se.props=t.memoizedProps,se.state=t.memoizedState,se.componentWillUnmount()}catch(re){ei(a,s,re)}}break;case 5:yc(F,F.return);break;case 22:if(F.memoizedState!==null){_w(B);continue}}oe!==null?(oe.return=F,gt=oe):_w(B)}L=L.sibling}e:for(L=null,B=e;;){if(B.tag===5){if(L===null){L=B;try{h=B.stateNode,k?(g=h.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(c=B.stateNode,C=B.memoizedProps.style,v=C!=null&&C.hasOwnProperty("display")?C.display:null,c.style.display=K2("display",v))}catch(re){ei(e,e.return,re)}}}else if(B.tag===6){if(L===null)try{B.stateNode.nodeValue=k?"":B.memoizedProps}catch(re){ei(e,e.return,re)}}else if((B.tag!==22&&B.tag!==23||B.memoizedState===null||B===e)&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===e)break e;for(;B.sibling===null;){if(B.return===null||B.return===e)break e;L===B&&(L=null),B=B.return}L===B&&(L=null),B.sibling.return=B.return,B=B.sibling}}break;case 19:Ps(t,e),Ks(e),a&4&&gw(e);break;case 21:break;default:Ps(t,e),Ks(e)}}function Ks(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(wT(s)){var a=s;break e}s=s.return}throw Error(Ke(160))}switch(a.tag){case 5:var h=a.stateNode;a.flags&32&&(Rh(h,""),a.flags&=-33);var g=mw(e);_0(e,g,h);break;case 3:case 4:var v=a.stateNode.containerInfo,c=mw(e);y0(e,c,v);break;default:throw Error(Ke(161))}}catch(C){ei(e,e.return,C)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function a5(e,t,s){gt=e,TT(e)}function TT(e,t,s){for(var a=(e.mode&1)!==0;gt!==null;){var h=gt,g=h.child;if(h.tag===22&&a){var v=h.memoizedState!==null||Np;if(!v){var c=h.alternate,C=c!==null&&c.memoizedState!==null||er;c=Np;var k=er;if(Np=v,(er=C)&&!k)for(gt=h;gt!==null;)v=gt,C=v.child,v.tag===22&&v.memoizedState!==null?xw(h):C!==null?(C.return=v,gt=C):xw(h);for(;g!==null;)gt=g,TT(g),g=g.sibling;gt=h,Np=c,er=k}yw(e)}else h.subtreeFlags&8772&&g!==null?(g.return=h,gt=g):yw(e)}}function yw(e){for(;gt!==null;){var t=gt;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:er||lm(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!er)if(s===null)a.componentDidMount();else{var h=t.elementType===t.type?s.memoizedProps:Ms(t.type,s.memoizedProps);a.componentDidUpdate(h,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var g=t.updateQueue;g!==null&&tw(t,g,a);break;case 3:var v=t.updateQueue;if(v!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}tw(t,v,s)}break;case 5:var c=t.stateNode;if(s===null&&t.flags&4){s=c;var C=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&s.focus();break;case"img":C.src&&(s.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var k=t.alternate;if(k!==null){var L=k.memoizedState;if(L!==null){var B=L.dehydrated;B!==null&&jh(B)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}er||t.flags&512&&g0(t)}catch(F){ei(t,t.return,F)}}if(t===e){gt=null;break}if(s=t.sibling,s!==null){s.return=t.return,gt=s;break}gt=t.return}}function _w(e){for(;gt!==null;){var t=gt;if(t===e){gt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,gt=s;break}gt=t.return}}function xw(e){for(;gt!==null;){var t=gt;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{lm(4,t)}catch(C){ei(t,s,C)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var h=t.return;try{a.componentDidMount()}catch(C){ei(t,h,C)}}var g=t.return;try{g0(t)}catch(C){ei(t,g,C)}break;case 5:var v=t.return;try{g0(t)}catch(C){ei(t,v,C)}}}catch(C){ei(t,t.return,C)}if(t===e){gt=null;break}var c=t.sibling;if(c!==null){c.return=t.return,gt=c;break}gt=t.return}}var l5=Math.ceil,Df=Fo.ReactCurrentDispatcher,N_=Fo.ReactCurrentOwner,ds=Fo.ReactCurrentBatchConfig,un=0,Li=null,fi=null,Vi=0,Ur=0,_c=ka(0),Ti=0,Xh=null,pl=0,cm=0,j_=0,Eh=null,Mr=null,O_=0,Nc=1/0,So=null,Rf=!1,x0=null,ga=null,jp=!1,ua=null,Ff=0,Ch=0,v0=null,sf=-1,of=0;function _r(){return un&6?hi():sf!==-1?sf:sf=hi()}function ya(e){return e.mode&1?un&2&&Vi!==0?Vi&-Vi:ZI.transition!==null?(of===0&&(of=lS()),of):(e=xn,e!==0||(e=window.event,e=e===void 0?16:mS(e.type)),e):1}function Rs(e,t,s,a){if(50<Ch)throw Ch=0,v0=null,Error(Ke(185));od(e,s,a),(!(un&2)||e!==Li)&&(e===Li&&(!(un&2)&&(cm|=s),Ti===4&&la(e,Vi)),Rr(e,a),s===1&&un===0&&!(t.mode&1)&&(Nc=hi()+500,sm&&Ea()))}function Rr(e,t){var s=e.callbackNode;ZA(e,t);var a=xf(e,e===Li?Vi:0);if(a===0)s!==null&&P1(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(s!=null&&P1(s),t===1)e.tag===0?qI(vw.bind(null,e)):DS(vw.bind(null,e)),OI(function(){!(un&6)&&Ea()}),s=null;else{switch(cS(a)){case 1:s=d_;break;case 4:s=oS;break;case 16:s=_f;break;case 536870912:s=aS;break;default:s=_f}s=LT(s,kT.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function kT(e,t){if(sf=-1,of=0,un&6)throw Error(Ke(327));var s=e.callbackNode;if(Ic()&&e.callbackNode!==s)return null;var a=xf(e,e===Li?Vi:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Bf(e,a);else{t=a;var h=un;un|=2;var g=CT();(Li!==e||Vi!==t)&&(So=null,Nc=hi()+500,sl(e,t));do try{h5();break}catch(c){ET(e,c)}while(1);k_(),Df.current=g,un=h,fi!==null?t=0:(Li=null,Vi=0,t=Ti)}if(t!==0){if(t===2&&(h=Wy(e),h!==0&&(a=h,t=w0(e,h))),t===1)throw s=Xh,sl(e,0),la(e,a),Rr(e,hi()),s;if(t===6)la(e,a);else{if(h=e.current.alternate,!(a&30)&&!c5(h)&&(t=Bf(e,a),t===2&&(g=Wy(e),g!==0&&(a=g,t=w0(e,g))),t===1))throw s=Xh,sl(e,0),la(e,a),Rr(e,hi()),s;switch(e.finishedWork=h,e.finishedLanes=a,t){case 0:case 1:throw Error(Ke(345));case 2:Ya(e,Mr,So);break;case 3:if(la(e,a),(a&130023424)===a&&(t=O_+500-hi(),10<t)){if(xf(e,0)!==0)break;if(h=e.suspendedLanes,(h&a)!==a){_r(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=t0(Ya.bind(null,e,Mr,So),t);break}Ya(e,Mr,So);break;case 4:if(la(e,a),(a&4194240)===a)break;for(t=e.eventTimes,h=-1;0<a;){var v=31-Ds(a);g=1<<v,v=t[v],v>h&&(h=v),a&=~g}if(a=h,a=hi()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*l5(a/1960))-a,10<a){e.timeoutHandle=t0(Ya.bind(null,e,Mr,So),a);break}Ya(e,Mr,So);break;case 5:Ya(e,Mr,So);break;default:throw Error(Ke(329))}}}return Rr(e,hi()),e.callbackNode===s?kT.bind(null,e):null}function w0(e,t){var s=Eh;return e.current.memoizedState.isDehydrated&&(sl(e,t).flags|=256),e=Bf(e,t),e!==2&&(t=Mr,Mr=s,t!==null&&b0(t)),e}function b0(e){Mr===null?Mr=e:Mr.push.apply(Mr,e)}function c5(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var h=s[a],g=h.getSnapshot;h=h.value;try{if(!Bs(g(),h))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function la(e,t){for(t&=~j_,t&=~cm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Ds(t),a=1<<s;e[s]=-1,t&=~a}}function vw(e){if(un&6)throw Error(Ke(327));Ic();var t=xf(e,0);if(!(t&1))return Rr(e,hi()),null;var s=Bf(e,t);if(e.tag!==0&&s===2){var a=Wy(e);a!==0&&(t=a,s=w0(e,a))}if(s===1)throw s=Xh,sl(e,0),la(e,t),Rr(e,hi()),s;if(s===6)throw Error(Ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ya(e,Mr,So),Rr(e,hi()),null}function V_(e,t){var s=un;un|=1;try{return e(t)}finally{un=s,un===0&&(Nc=hi()+500,sm&&Ea())}}function fl(e){ua!==null&&ua.tag===0&&!(un&6)&&Ic();var t=un;un|=1;var s=ds.transition,a=xn;try{if(ds.transition=null,xn=1,e)return e()}finally{xn=a,ds.transition=s,un=t,!(un&6)&&Ea()}}function $_(){Ur=_c.current,Fn(_c)}function sl(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,jI(s)),fi!==null)for(s=fi.return;s!==null;){var a=s;switch(b_(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Tf();break;case 3:Fc(),Fn(zr),Fn(ir),M_();break;case 5:I_(a);break;case 4:Fc();break;case 13:Fn(Gn);break;case 19:Fn(Gn);break;case 10:E_(a.type._context);break;case 22:case 23:$_()}s=s.return}if(Li=e,fi=e=_a(e.current,null),Vi=Ur=t,Ti=0,Xh=null,j_=cm=pl=0,Mr=Eh=null,tl!==null){for(t=0;t<tl.length;t++)if(s=tl[t],a=s.interleaved,a!==null){s.interleaved=null;var h=a.next,g=s.pending;if(g!==null){var v=g.next;g.next=h,a.next=v}s.pending=a}tl=null}return e}function ET(e,t){do{var s=fi;try{if(k_(),tf.current=zf,Lf){for(var a=Hn.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}Lf=!1}if(dl=0,Mi=Si=Hn=null,Th=!1,Wh=0,N_.current=null,s===null||s.return===null){Ti=1,Xh=t,fi=null;break}e:{var g=e,v=s.return,c=s,C=t;if(t=Vi,c.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var k=C,L=c,B=L.tag;if(!(L.mode&1)&&(B===0||B===11||B===15)){var F=L.alternate;F?(L.updateQueue=F.updateQueue,L.memoizedState=F.memoizedState,L.lanes=F.lanes):(L.updateQueue=null,L.memoizedState=null)}var oe=aw(v);if(oe!==null){oe.flags&=-257,lw(oe,v,c,g,t),oe.mode&1&&ow(g,k,t),t=oe,C=k;var se=t.updateQueue;if(se===null){var re=new Set;re.add(C),t.updateQueue=re}else se.add(C);break e}else{if(!(t&1)){ow(g,k,t),U_();break e}C=Error(Ke(426))}}else if($n&&c.mode&1){var ue=aw(v);if(ue!==null){!(ue.flags&65536)&&(ue.flags|=256),lw(ue,v,c,g,t),S_(Bc(C,c));break e}}g=C=Bc(C,c),Ti!==4&&(Ti=2),Eh===null?Eh=[g]:Eh.push(g),g=v;do{switch(g.tag){case 3:g.flags|=65536,t&=-t,g.lanes|=t;var Z=cT(g,C,t);ew(g,Z);break e;case 1:c=C;var q=g.type,G=g.stateNode;if(!(g.flags&128)&&(typeof q.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(ga===null||!ga.has(G)))){g.flags|=65536,t&=-t,g.lanes|=t;var fe=uT(g,c,t);ew(g,fe);break e}}g=g.return}while(g!==null)}AT(s)}catch(xe){t=xe,fi===s&&s!==null&&(fi=s=s.return);continue}break}while(1)}function CT(){var e=Df.current;return Df.current=zf,e===null?zf:e}function U_(){(Ti===0||Ti===3||Ti===2)&&(Ti=4),Li===null||!(pl&268435455)&&!(cm&268435455)||la(Li,Vi)}function Bf(e,t){var s=un;un|=2;var a=CT();(Li!==e||Vi!==t)&&(So=null,sl(e,t));do try{u5();break}catch(h){ET(e,h)}while(1);if(k_(),un=s,Df.current=a,fi!==null)throw Error(Ke(261));return Li=null,Vi=0,Ti}function u5(){for(;fi!==null;)PT(fi)}function h5(){for(;fi!==null&&!FA();)PT(fi)}function PT(e){var t=MT(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,t===null?AT(e):fi=t,N_.current=null}function AT(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=r5(s,t),s!==null){s.flags&=32767,fi=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ti=6,fi=null;return}}else if(s=i5(s,t,Ur),s!==null){fi=s;return}if(t=t.sibling,t!==null){fi=t;return}fi=t=e}while(t!==null);Ti===0&&(Ti=5)}function Ya(e,t,s){var a=xn,h=ds.transition;try{ds.transition=null,xn=1,d5(e,t,s,a)}finally{ds.transition=h,xn=a}return null}function d5(e,t,s,a){do Ic();while(ua!==null);if(un&6)throw Error(Ke(327));s=e.finishedWork;var h=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Ke(177));e.callbackNode=null,e.callbackPriority=0;var g=s.lanes|s.childLanes;if(GA(e,g),e===Li&&(fi=Li=null,Vi=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||jp||(jp=!0,LT(_f,function(){return Ic(),null})),g=(s.flags&15990)!==0,s.subtreeFlags&15990||g){g=ds.transition,ds.transition=null;var v=xn;xn=1;var c=un;un|=4,N_.current=null,o5(e,s),ST(s,e),LI(Qy),vf=!!Jy,Qy=Jy=null,e.current=s,a5(s),BA(),un=c,xn=v,ds.transition=g}else e.current=s;if(jp&&(jp=!1,ua=e,Ff=h),g=e.pendingLanes,g===0&&(ga=null),OA(s.stateNode),Rr(e,hi()),t!==null)for(a=e.onRecoverableError,s=0;s<t.length;s++)h=t[s],a(h.value,{componentStack:h.stack,digest:h.digest});if(Rf)throw Rf=!1,e=x0,x0=null,e;return Ff&1&&e.tag!==0&&Ic(),g=e.pendingLanes,g&1?e===v0?Ch++:(Ch=0,v0=e):Ch=0,Ea(),null}function Ic(){if(ua!==null){var e=cS(Ff),t=ds.transition,s=xn;try{if(ds.transition=null,xn=16>e?16:e,ua===null)var a=!1;else{if(e=ua,ua=null,Ff=0,un&6)throw Error(Ke(331));var h=un;for(un|=4,gt=e.current;gt!==null;){var g=gt,v=g.child;if(gt.flags&16){var c=g.deletions;if(c!==null){for(var C=0;C<c.length;C++){var k=c[C];for(gt=k;gt!==null;){var L=gt;switch(L.tag){case 0:case 11:case 15:kh(8,L,g)}var B=L.child;if(B!==null)B.return=L,gt=B;else for(;gt!==null;){L=gt;var F=L.sibling,oe=L.return;if(vT(L),L===k){gt=null;break}if(F!==null){F.return=oe,gt=F;break}gt=oe}}}var se=g.alternate;if(se!==null){var re=se.child;if(re!==null){se.child=null;do{var ue=re.sibling;re.sibling=null,re=ue}while(re!==null)}}gt=g}}if(g.subtreeFlags&2064&&v!==null)v.return=g,gt=v;else e:for(;gt!==null;){if(g=gt,g.flags&2048)switch(g.tag){case 0:case 11:case 15:kh(9,g,g.return)}var Z=g.sibling;if(Z!==null){Z.return=g.return,gt=Z;break e}gt=g.return}}var q=e.current;for(gt=q;gt!==null;){v=gt;var G=v.child;if(v.subtreeFlags&2064&&G!==null)G.return=v,gt=G;else e:for(v=q;gt!==null;){if(c=gt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:lm(9,c)}}catch(xe){ei(c,c.return,xe)}if(c===v){gt=null;break e}var fe=c.sibling;if(fe!==null){fe.return=c.return,gt=fe;break e}gt=c.return}}if(un=h,Ea(),to&&typeof to.onPostCommitFiberRoot=="function")try{to.onPostCommitFiberRoot(em,e)}catch{}a=!0}return a}finally{xn=s,ds.transition=t}}return!1}function ww(e,t,s){t=Bc(s,t),t=cT(e,t,1),e=ma(e,t,1),t=_r(),e!==null&&(od(e,1,t),Rr(e,t))}function ei(e,t,s){if(e.tag===3)ww(e,e,s);else for(;t!==null;){if(t.tag===3){ww(t,e,s);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(ga===null||!ga.has(a))){e=Bc(s,e),e=uT(t,e,1),t=ma(t,e,1),e=_r(),t!==null&&(od(t,1,e),Rr(t,e));break}}t=t.return}}function p5(e,t,s){var a=e.pingCache;a!==null&&a.delete(t),t=_r(),e.pingedLanes|=e.suspendedLanes&s,Li===e&&(Vi&s)===s&&(Ti===4||Ti===3&&(Vi&130023424)===Vi&&500>hi()-O_?sl(e,0):j_|=s),Rr(e,t)}function IT(e,t){t===0&&(e.mode&1?(t=Ap,Ap<<=1,!(Ap&130023424)&&(Ap=4194304)):t=1);var s=_r();e=Lo(e,t),e!==null&&(od(e,t,s),Rr(e,s))}function f5(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),IT(e,s)}function m5(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,h=e.memoizedState;h!==null&&(s=h.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Ke(314))}a!==null&&a.delete(t),IT(e,s)}var MT;MT=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||zr.current)Lr=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Lr=!1,n5(e,t,s);Lr=!!(e.flags&131072)}else Lr=!1,$n&&t.flags&1048576&&RS(t,Cf,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;rf(e,t),e=t.pendingProps;var h=zc(t,ir.current);Ac(t,s),h=z_(null,t,a,e,h,s);var g=D_();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(a)?(g=!0,kf(t)):g=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,P_(t),h.updater=am,t.stateNode=h,h._reactInternals=t,l0(t,a,e,s),t=h0(null,t,a,!0,g,s)):(t.tag=0,$n&&g&&w_(t),gr(null,t,h,s),t=t.child),t;case 16:a=t.elementType;e:{switch(rf(e,t),e=t.pendingProps,h=a._init,a=h(a._payload),t.type=a,h=t.tag=y5(a),e=Ms(a,e),h){case 0:t=u0(null,t,a,e,s);break e;case 1:t=hw(null,t,a,e,s);break e;case 11:t=cw(null,t,a,e,s);break e;case 14:t=uw(null,t,a,Ms(a.type,e),s);break e}throw Error(Ke(306,a,""))}return t;case 0:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),u0(e,t,a,h,s);case 1:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),hw(e,t,a,h,s);case 3:e:{if(fT(t),e===null)throw Error(Ke(387));a=t.pendingProps,g=t.memoizedState,h=g.element,VS(e,t),If(t,a,null,s);var v=t.memoizedState;if(a=v.element,g.isDehydrated)if(g={element:a,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){h=Bc(Error(Ke(423)),t),t=dw(e,t,a,s,h);break e}else if(a!==h){h=Bc(Error(Ke(424)),t),t=dw(e,t,a,s,h);break e}else for(qr=fa(t.stateNode.containerInfo.firstChild),Zr=t,$n=!0,zs=null,s=jS(t,null,a,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Dc(),a===h){t=zo(e,t,s);break e}gr(e,t,a,s)}t=t.child}return t;case 5:return $S(t),e===null&&s0(t),a=t.type,h=t.pendingProps,g=e!==null?e.memoizedProps:null,v=h.children,e0(a,h)?v=null:g!==null&&e0(a,g)&&(t.flags|=32),pT(e,t),gr(e,t,v,s),t.child;case 6:return e===null&&s0(t),null;case 13:return mT(e,t,s);case 4:return A_(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Rc(t,null,a,s):gr(e,t,a,s),t.child;case 11:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),cw(e,t,a,h,s);case 7:return gr(e,t,t.pendingProps,s),t.child;case 8:return gr(e,t,t.pendingProps.children,s),t.child;case 12:return gr(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(a=t.type._context,h=t.pendingProps,g=t.memoizedProps,v=h.value,Mn(Pf,a._currentValue),a._currentValue=v,g!==null)if(Bs(g.value,v)){if(g.children===h.children&&!zr.current){t=zo(e,t,s);break e}}else for(g=t.child,g!==null&&(g.return=t);g!==null;){var c=g.dependencies;if(c!==null){v=g.child;for(var C=c.firstContext;C!==null;){if(C.context===a){if(g.tag===1){C=Co(-1,s&-s),C.tag=2;var k=g.updateQueue;if(k!==null){k=k.shared;var L=k.pending;L===null?C.next=C:(C.next=L.next,L.next=C),k.pending=C}}g.lanes|=s,C=g.alternate,C!==null&&(C.lanes|=s),o0(g.return,s,t),c.lanes|=s;break}C=C.next}}else if(g.tag===10)v=g.type===t.type?null:g.child;else if(g.tag===18){if(v=g.return,v===null)throw Error(Ke(341));v.lanes|=s,c=v.alternate,c!==null&&(c.lanes|=s),o0(v,s,t),v=g.sibling}else v=g.child;if(v!==null)v.return=g;else for(v=g;v!==null;){if(v===t){v=null;break}if(g=v.sibling,g!==null){g.return=v.return,v=g;break}v=v.return}g=v}gr(e,t,h.children,s),t=t.child}return t;case 9:return h=t.type,a=t.pendingProps.children,Ac(t,s),h=ps(h),a=a(h),t.flags|=1,gr(e,t,a,s),t.child;case 14:return a=t.type,h=Ms(a,t.pendingProps),h=Ms(a.type,h),uw(e,t,a,h,s);case 15:return hT(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),rf(e,t),t.tag=1,Dr(a)?(e=!0,kf(t)):e=!1,Ac(t,s),lT(t,a,h),l0(t,a,h,s),h0(null,t,a,!0,e,s);case 19:return gT(e,t,s);case 22:return dT(e,t,s)}throw Error(Ke(156,t.tag))};function LT(e,t){return sS(e,t)}function g5(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hs(e,t,s,a){return new g5(e,t,s,a)}function q_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function y5(e){if(typeof e=="function")return q_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===c_)return 11;if(e===u_)return 14}return 2}function _a(e,t){var s=e.alternate;return s===null?(s=hs(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function af(e,t,s,a,h,g){var v=2;if(a=e,typeof e=="function")q_(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case lc:return ol(s.children,h,g,t);case l_:v=8,h|=8;break;case Ly:return e=hs(12,s,t,h|2),e.elementType=Ly,e.lanes=g,e;case zy:return e=hs(13,s,t,h),e.elementType=zy,e.lanes=g,e;case Dy:return e=hs(19,s,t,h),e.elementType=Dy,e.lanes=g,e;case $2:return um(s,h,g,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O2:v=10;break e;case V2:v=9;break e;case c_:v=11;break e;case u_:v=14;break e;case sa:v=16,a=null;break e}throw Error(Ke(130,e==null?e:typeof e,""))}return t=hs(v,s,t,h),t.elementType=e,t.type=a,t.lanes=g,t}function ol(e,t,s,a){return e=hs(7,e,a,t),e.lanes=s,e}function um(e,t,s,a){return e=hs(22,e,a,t),e.elementType=$2,e.lanes=s,e.stateNode={isHidden:!1},e}function cy(e,t,s){return e=hs(6,e,null,t),e.lanes=s,e}function uy(e,t,s){return t=hs(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _5(e,t,s,a,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qg(0),this.expirationTimes=qg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qg(0),this.identifierPrefix=a,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Z_(e,t,s,a,h,g,v,c,C){return e=new _5(e,t,s,c,C),t===1?(t=1,g===!0&&(t|=8)):t=0,g=hs(3,null,null,t),e.current=g,g.stateNode=e,g.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},P_(g),e}function x5(e,t,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ac,key:a==null?null:""+a,children:e,containerInfo:t,implementation:s}}function zT(e){if(!e)return wa;e=e._reactInternals;e:{if(_l(e)!==e||e.tag!==1)throw Error(Ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ke(171))}if(e.tag===1){var s=e.type;if(Dr(s))return zS(e,s,t)}return t}function DT(e,t,s,a,h,g,v,c,C){return e=Z_(s,a,!0,e,h,g,v,c,C),e.context=zT(null),s=e.current,a=_r(),h=ya(s),g=Co(a,h),g.callback=t??null,ma(s,g,h),e.current.lanes=h,od(e,h,a),Rr(e,a),e}function hm(e,t,s,a){var h=t.current,g=_r(),v=ya(h);return s=zT(s),t.context===null?t.context=s:t.pendingContext=s,t=Co(g,v),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=ma(h,t,v),e!==null&&(Rs(e,h,v,g),ef(e,h,v)),v}function Nf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function G_(e,t){bw(e,t),(e=e.alternate)&&bw(e,t)}function v5(){return null}var RT=typeof reportError=="function"?reportError:function(e){console.error(e)};function W_(e){this._internalRoot=e}dm.prototype.render=W_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ke(409));hm(e,t,null,null)};dm.prototype.unmount=W_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fl(function(){hm(null,e,null,null)}),t[Mo]=null}};function dm(e){this._internalRoot=e}dm.prototype.unstable_scheduleHydration=function(e){if(e){var t=dS();e={blockedOn:null,target:e,priority:t};for(var s=0;s<aa.length&&t!==0&&t<aa[s].priority;s++);aa.splice(s,0,e),s===0&&fS(e)}};function H_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sw(){}function w5(e,t,s,a,h){if(h){if(typeof a=="function"){var g=a;a=function(){var k=Nf(v);g.call(k)}}var v=DT(t,a,e,0,null,!1,!1,"",Sw);return e._reactRootContainer=v,e[Mo]=v.current,$h(e.nodeType===8?e.parentNode:e),fl(),v}for(;h=e.lastChild;)e.removeChild(h);if(typeof a=="function"){var c=a;a=function(){var k=Nf(C);c.call(k)}}var C=Z_(e,0,!1,null,null,!1,!1,"",Sw);return e._reactRootContainer=C,e[Mo]=C.current,$h(e.nodeType===8?e.parentNode:e),fl(function(){hm(t,C,s,a)}),C}function fm(e,t,s,a,h){var g=s._reactRootContainer;if(g){var v=g;if(typeof h=="function"){var c=h;h=function(){var C=Nf(v);c.call(C)}}hm(t,v,e,h)}else v=w5(s,t,e,h,a);return Nf(v)}uS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=fh(t.pendingLanes);s!==0&&(p_(t,s|1),Rr(t,hi()),!(un&6)&&(Nc=hi()+500,Ea()))}break;case 13:fl(function(){var a=Lo(e,1);if(a!==null){var h=_r();Rs(a,e,1,h)}}),G_(e,1)}};f_=function(e){if(e.tag===13){var t=Lo(e,134217728);if(t!==null){var s=_r();Rs(t,e,134217728,s)}G_(e,134217728)}};hS=function(e){if(e.tag===13){var t=ya(e),s=Lo(e,t);if(s!==null){var a=_r();Rs(s,e,t,a)}G_(e,t)}};dS=function(){return xn};pS=function(e,t){var s=xn;try{return xn=e,t()}finally{xn=s}};qy=function(e,t,s){switch(t){case"input":if(By(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var h=rm(a);if(!h)throw Error(Ke(90));q2(a),By(a,h)}}}break;case"textarea":G2(e,s);break;case"select":t=s.value,t!=null&&kc(e,!!s.multiple,t,!1)}};Q2=V_;eS=fl;var b5={usingClientEntryPoint:!1,Events:[ld,dc,rm,Y2,J2,V_]},ch={findFiberByHostInstance:el,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},S5={bundleType:ch.bundleType,version:ch.version,rendererPackageName:ch.rendererPackageName,rendererConfig:ch.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=iS(e),e===null?null:e.stateNode},findFiberByHostInstance:ch.findFiberByHostInstance||v5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Op.isDisabled&&Op.supportsFiber)try{em=Op.inject(S5),to=Op}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b5;Xr.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H_(t))throw Error(Ke(200));return x5(e,t,null,s)};Xr.createRoot=function(e,t){if(!H_(e))throw Error(Ke(299));var s=!1,a="",h=RT;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=Z_(e,1,!1,null,null,s,!1,a,h),e[Mo]=t.current,$h(e.nodeType===8?e.parentNode:e),new W_(t)};Xr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ke(188)):(e=Object.keys(e).join(","),Error(Ke(268,e)));return e=iS(t),e=e===null?null:e.stateNode,e};Xr.flushSync=function(e){return fl(e)};Xr.hydrate=function(e,t,s){if(!pm(t))throw Error(Ke(200));return fm(null,e,t,!0,s)};Xr.hydrateRoot=function(e,t,s){if(!H_(e))throw Error(Ke(405));var a=s!=null&&s.hydratedSources||null,h=!1,g="",v=RT;if(s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),t=DT(t,null,e,1,s??null,h,!1,g,v),e[Mo]=t.current,$h(e),a)for(e=0;e<a.length;e++)s=a[e],h=s._getVersion,h=h(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,h]:t.mutableSourceEagerHydrationData.push(s,h);return new dm(t)};Xr.render=function(e,t,s){if(!pm(t))throw Error(Ke(200));return fm(null,e,t,!1,s)};Xr.unmountComponentAtNode=function(e){if(!pm(e))throw Error(Ke(40));return e._reactRootContainer?(fl(function(){fm(null,null,e,!1,function(){e._reactRootContainer=null,e[Mo]=null})}),!0):!1};Xr.unstable_batchedUpdates=V_;Xr.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!pm(s))throw Error(Ke(200));if(e==null||e._reactInternals===void 0)throw Error(Ke(38));return fm(e,t,s,!1,a)};Xr.version="18.3.1-next-f1338f8080-20240426";function FT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FT)}catch(e){console.error(e)}}FT(),F2.exports=Xr;var T5=F2.exports,Tw=T5;Iy.createRoot=Tw.createRoot,Iy.hydrateRoot=Tw.hydrateRoot;function BT(e,t){return function(){return e.apply(t,arguments)}}const{toString:k5}=Object.prototype,{getPrototypeOf:K_}=Object,mm=(e=>t=>{const s=k5.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),js=e=>(e=e.toLowerCase(),t=>mm(t)===e),gm=e=>t=>typeof t===e,{isArray:Gc}=Array,Yh=gm("undefined");function E5(e){return e!==null&&!Yh(e)&&e.constructor!==null&&!Yh(e.constructor)&&Gr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const NT=js("ArrayBuffer");function C5(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&NT(e.buffer),t}const P5=gm("string"),Gr=gm("function"),jT=gm("number"),ym=e=>e!==null&&typeof e=="object",A5=e=>e===!0||e===!1,lf=e=>{if(mm(e)!=="object")return!1;const t=K_(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},I5=js("Date"),M5=js("File"),L5=js("Blob"),z5=js("FileList"),D5=e=>ym(e)&&Gr(e.pipe),R5=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Gr(e.append)&&((t=mm(e))==="formdata"||t==="object"&&Gr(e.toString)&&e.toString()==="[object FormData]"))},F5=js("URLSearchParams"),[B5,N5,j5,O5]=["ReadableStream","Request","Response","Headers"].map(js),V5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ud(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let a,h;if(typeof e!="object"&&(e=[e]),Gc(e))for(a=0,h=e.length;a<h;a++)t.call(null,e[a],a,e);else{const g=s?Object.getOwnPropertyNames(e):Object.keys(e),v=g.length;let c;for(a=0;a<v;a++)c=g[a],t.call(null,e[c],c,e)}}function OT(e,t){t=t.toLowerCase();const s=Object.keys(e);let a=s.length,h;for(;a-- >0;)if(h=s[a],t===h.toLowerCase())return h;return null}const il=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),VT=e=>!Yh(e)&&e!==il;function S0(){const{caseless:e}=VT(this)&&this||{},t={},s=(a,h)=>{const g=e&&OT(t,h)||h;lf(t[g])&&lf(a)?t[g]=S0(t[g],a):lf(a)?t[g]=S0({},a):Gc(a)?t[g]=a.slice():t[g]=a};for(let a=0,h=arguments.length;a<h;a++)arguments[a]&&ud(arguments[a],s);return t}const $5=(e,t,s,{allOwnKeys:a}={})=>(ud(t,(h,g)=>{s&&Gr(h)?e[g]=BT(h,s):e[g]=h},{allOwnKeys:a}),e),U5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),q5=(e,t,s,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},Z5=(e,t,s,a)=>{let h,g,v;const c={};if(t=t||{},e==null)return t;do{for(h=Object.getOwnPropertyNames(e),g=h.length;g-- >0;)v=h[g],(!a||a(v,e,t))&&!c[v]&&(t[v]=e[v],c[v]=!0);e=s!==!1&&K_(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},G5=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const a=e.indexOf(t,s);return a!==-1&&a===s},W5=e=>{if(!e)return null;if(Gc(e))return e;let t=e.length;if(!jT(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},H5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&K_(Uint8Array)),K5=(e,t)=>{const a=(e&&e[Symbol.iterator]).call(e);let h;for(;(h=a.next())&&!h.done;){const g=h.value;t.call(e,g[0],g[1])}},X5=(e,t)=>{let s;const a=[];for(;(s=e.exec(t))!==null;)a.push(s);return a},Y5=js("HTMLFormElement"),J5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,h){return a.toUpperCase()+h}),kw=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),Q5=js("RegExp"),$T=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),a={};ud(s,(h,g)=>{let v;(v=t(h,g,e))!==!1&&(a[g]=v||h)}),Object.defineProperties(e,a)},eM=e=>{$T(e,(t,s)=>{if(Gr(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=e[s];if(Gr(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},tM=(e,t)=>{const s={},a=h=>{h.forEach(g=>{s[g]=!0})};return Gc(e)?a(e):a(String(e).split(t)),s},nM=()=>{},iM=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function rM(e){return!!(e&&Gr(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const sM=e=>{const t=new Array(10),s=(a,h)=>{if(ym(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[h]=a;const g=Gc(a)?[]:{};return ud(a,(v,c)=>{const C=s(v,h+1);!Yh(C)&&(g[c]=C)}),t[h]=void 0,g}}return a};return s(e,0)},oM=js("AsyncFunction"),aM=e=>e&&(ym(e)||Gr(e))&&Gr(e.then)&&Gr(e.catch),UT=((e,t)=>e?setImmediate:t?((s,a)=>(il.addEventListener("message",({source:h,data:g})=>{h===il&&g===s&&a.length&&a.shift()()},!1),h=>{a.push(h),il.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Gr(il.postMessage)),lM=typeof queueMicrotask<"u"?queueMicrotask.bind(il):typeof process<"u"&&process.nextTick||UT,Le={isArray:Gc,isArrayBuffer:NT,isBuffer:E5,isFormData:R5,isArrayBufferView:C5,isString:P5,isNumber:jT,isBoolean:A5,isObject:ym,isPlainObject:lf,isReadableStream:B5,isRequest:N5,isResponse:j5,isHeaders:O5,isUndefined:Yh,isDate:I5,isFile:M5,isBlob:L5,isRegExp:Q5,isFunction:Gr,isStream:D5,isURLSearchParams:F5,isTypedArray:H5,isFileList:z5,forEach:ud,merge:S0,extend:$5,trim:V5,stripBOM:U5,inherits:q5,toFlatObject:Z5,kindOf:mm,kindOfTest:js,endsWith:G5,toArray:W5,forEachEntry:K5,matchAll:X5,isHTMLForm:Y5,hasOwnProperty:kw,hasOwnProp:kw,reduceDescriptors:$T,freezeMethods:eM,toObjectSet:tM,toCamelCase:J5,noop:nM,toFiniteNumber:iM,findKey:OT,global:il,isContextDefined:VT,isSpecCompliantForm:rM,toJSONObject:sM,isAsyncFn:oM,isThenable:aM,setImmediate:UT,asap:lM};function Wt(e,t,s,a,h){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),a&&(this.request=a),h&&(this.response=h,this.status=h.status?h.status:null)}Le.inherits(Wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Le.toJSONObject(this.config),code:this.code,status:this.status}}});const qT=Wt.prototype,ZT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ZT[e]={value:e}});Object.defineProperties(Wt,ZT);Object.defineProperty(qT,"isAxiosError",{value:!0});Wt.from=(e,t,s,a,h,g)=>{const v=Object.create(qT);return Le.toFlatObject(e,v,function(C){return C!==Error.prototype},c=>c!=="isAxiosError"),Wt.call(v,e.message,t,s,a,h),v.cause=e,v.name=e.name,g&&Object.assign(v,g),v};const cM=null;function T0(e){return Le.isPlainObject(e)||Le.isArray(e)}function GT(e){return Le.endsWith(e,"[]")?e.slice(0,-2):e}function Ew(e,t,s){return e?e.concat(t).map(function(h,g){return h=GT(h),!s&&g?"["+h+"]":h}).join(s?".":""):t}function uM(e){return Le.isArray(e)&&!e.some(T0)}const hM=Le.toFlatObject(Le,{},null,function(t){return/^is[A-Z]/.test(t)});function _m(e,t,s){if(!Le.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=Le.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(re,ue){return!Le.isUndefined(ue[re])});const a=s.metaTokens,h=s.visitor||L,g=s.dots,v=s.indexes,C=(s.Blob||typeof Blob<"u"&&Blob)&&Le.isSpecCompliantForm(t);if(!Le.isFunction(h))throw new TypeError("visitor must be a function");function k(se){if(se===null)return"";if(Le.isDate(se))return se.toISOString();if(!C&&Le.isBlob(se))throw new Wt("Blob is not supported. Use a Buffer instead.");return Le.isArrayBuffer(se)||Le.isTypedArray(se)?C&&typeof Blob=="function"?new Blob([se]):Buffer.from(se):se}function L(se,re,ue){let Z=se;if(se&&!ue&&typeof se=="object"){if(Le.endsWith(re,"{}"))re=a?re:re.slice(0,-2),se=JSON.stringify(se);else if(Le.isArray(se)&&uM(se)||(Le.isFileList(se)||Le.endsWith(re,"[]"))&&(Z=Le.toArray(se)))return re=GT(re),Z.forEach(function(G,fe){!(Le.isUndefined(G)||G===null)&&t.append(v===!0?Ew([re],fe,g):v===null?re:re+"[]",k(G))}),!1}return T0(se)?!0:(t.append(Ew(ue,re,g),k(se)),!1)}const B=[],F=Object.assign(hM,{defaultVisitor:L,convertValue:k,isVisitable:T0});function oe(se,re){if(!Le.isUndefined(se)){if(B.indexOf(se)!==-1)throw Error("Circular reference detected in "+re.join("."));B.push(se),Le.forEach(se,function(Z,q){(!(Le.isUndefined(Z)||Z===null)&&h.call(t,Z,Le.isString(q)?q.trim():q,re,F))===!0&&oe(Z,re?re.concat(q):[q])}),B.pop()}}if(!Le.isObject(e))throw new TypeError("data must be an object");return oe(e),t}function Cw(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function X_(e,t){this._pairs=[],e&&_m(e,this,t)}const WT=X_.prototype;WT.append=function(t,s){this._pairs.push([t,s])};WT.toString=function(t){const s=t?function(a){return t.call(this,a,Cw)}:Cw;return this._pairs.map(function(h){return s(h[0])+"="+s(h[1])},"").join("&")};function dM(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function HT(e,t,s){if(!t)return e;const a=s&&s.encode||dM;Le.isFunction(s)&&(s={serialize:s});const h=s&&s.serialize;let g;if(h?g=h(t,s):g=Le.isURLSearchParams(t)?t.toString():new X_(t,s).toString(a),g){const v=e.indexOf("#");v!==-1&&(e=e.slice(0,v)),e+=(e.indexOf("?")===-1?"?":"&")+g}return e}class pM{constructor(){this.handlers=[]}use(t,s,a){return this.handlers.push({fulfilled:t,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Le.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Pw=pM,KT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fM=typeof URLSearchParams<"u"?URLSearchParams:X_,mM=typeof FormData<"u"?FormData:null,gM=typeof Blob<"u"?Blob:null,yM={isBrowser:!0,classes:{URLSearchParams:fM,FormData:mM,Blob:gM},protocols:["http","https","file","blob","url","data"]},Y_=typeof window<"u"&&typeof document<"u",k0=typeof navigator=="object"&&navigator||void 0,_M=Y_&&(!k0||["ReactNative","NativeScript","NS"].indexOf(k0.product)<0),xM=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),vM=Y_&&window.location.href||"http://localhost",wM=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Y_,hasStandardBrowserEnv:_M,hasStandardBrowserWebWorkerEnv:xM,navigator:k0,origin:vM},Symbol.toStringTag,{value:"Module"})),tr={...wM,...yM};function bM(e,t){return _m(e,new tr.classes.URLSearchParams,Object.assign({visitor:function(s,a,h,g){return tr.isNode&&Le.isBuffer(s)?(this.append(a,s.toString("base64")),!1):g.defaultVisitor.apply(this,arguments)}},t))}function SM(e){return Le.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function TM(e){const t={},s=Object.keys(e);let a;const h=s.length;let g;for(a=0;a<h;a++)g=s[a],t[g]=e[g];return t}function XT(e){function t(s,a,h,g){let v=s[g++];if(v==="__proto__")return!0;const c=Number.isFinite(+v),C=g>=s.length;return v=!v&&Le.isArray(h)?h.length:v,C?(Le.hasOwnProp(h,v)?h[v]=[h[v],a]:h[v]=a,!c):((!h[v]||!Le.isObject(h[v]))&&(h[v]=[]),t(s,a,h[v],g)&&Le.isArray(h[v])&&(h[v]=TM(h[v])),!c)}if(Le.isFormData(e)&&Le.isFunction(e.entries)){const s={};return Le.forEachEntry(e,(a,h)=>{t(SM(a),h,s,0)}),s}return null}function kM(e,t,s){if(Le.isString(e))try{return(t||JSON.parse)(e),Le.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(e)}const J_={transitional:KT,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const a=s.getContentType()||"",h=a.indexOf("application/json")>-1,g=Le.isObject(t);if(g&&Le.isHTMLForm(t)&&(t=new FormData(t)),Le.isFormData(t))return h?JSON.stringify(XT(t)):t;if(Le.isArrayBuffer(t)||Le.isBuffer(t)||Le.isStream(t)||Le.isFile(t)||Le.isBlob(t)||Le.isReadableStream(t))return t;if(Le.isArrayBufferView(t))return t.buffer;if(Le.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(g){if(a.indexOf("application/x-www-form-urlencoded")>-1)return bM(t,this.formSerializer).toString();if((c=Le.isFileList(t))||a.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return _m(c?{"files[]":t}:t,C&&new C,this.formSerializer)}}return g||h?(s.setContentType("application/json",!1),kM(t)):t}],transformResponse:[function(t){const s=this.transitional||J_.transitional,a=s&&s.forcedJSONParsing,h=this.responseType==="json";if(Le.isResponse(t)||Le.isReadableStream(t))return t;if(t&&Le.isString(t)&&(a&&!this.responseType||h)){const v=!(s&&s.silentJSONParsing)&&h;try{return JSON.parse(t)}catch(c){if(v)throw c.name==="SyntaxError"?Wt.from(c,Wt.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tr.classes.FormData,Blob:tr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Le.forEach(["delete","get","head","post","put","patch"],e=>{J_.headers[e]={}});const Q_=J_,EM=Le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),CM=e=>{const t={};let s,a,h;return e&&e.split(`
`).forEach(function(v){h=v.indexOf(":"),s=v.substring(0,h).trim().toLowerCase(),a=v.substring(h+1).trim(),!(!s||t[s]&&EM[s])&&(s==="set-cookie"?t[s]?t[s].push(a):t[s]=[a]:t[s]=t[s]?t[s]+", "+a:a)}),t},Aw=Symbol("internals");function uh(e){return e&&String(e).trim().toLowerCase()}function cf(e){return e===!1||e==null?e:Le.isArray(e)?e.map(cf):String(e)}function PM(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)t[a[1]]=a[2];return t}const AM=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function hy(e,t,s,a,h){if(Le.isFunction(a))return a.call(this,t,s);if(h&&(t=s),!!Le.isString(t)){if(Le.isString(a))return t.indexOf(a)!==-1;if(Le.isRegExp(a))return a.test(t)}}function IM(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,a)=>s.toUpperCase()+a)}function MM(e,t){const s=Le.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(h,g,v){return this[a].call(this,t,h,g,v)},configurable:!0})})}class xm{constructor(t){t&&this.set(t)}set(t,s,a){const h=this;function g(c,C,k){const L=uh(C);if(!L)throw new Error("header name must be a non-empty string");const B=Le.findKey(h,L);(!B||h[B]===void 0||k===!0||k===void 0&&h[B]!==!1)&&(h[B||C]=cf(c))}const v=(c,C)=>Le.forEach(c,(k,L)=>g(k,L,C));if(Le.isPlainObject(t)||t instanceof this.constructor)v(t,s);else if(Le.isString(t)&&(t=t.trim())&&!AM(t))v(CM(t),s);else if(Le.isHeaders(t))for(const[c,C]of t.entries())g(C,c,a);else t!=null&&g(s,t,a);return this}get(t,s){if(t=uh(t),t){const a=Le.findKey(this,t);if(a){const h=this[a];if(!s)return h;if(s===!0)return PM(h);if(Le.isFunction(s))return s.call(this,h,a);if(Le.isRegExp(s))return s.exec(h);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=uh(t),t){const a=Le.findKey(this,t);return!!(a&&this[a]!==void 0&&(!s||hy(this,this[a],a,s)))}return!1}delete(t,s){const a=this;let h=!1;function g(v){if(v=uh(v),v){const c=Le.findKey(a,v);c&&(!s||hy(a,a[c],c,s))&&(delete a[c],h=!0)}}return Le.isArray(t)?t.forEach(g):g(t),h}clear(t){const s=Object.keys(this);let a=s.length,h=!1;for(;a--;){const g=s[a];(!t||hy(this,this[g],g,t,!0))&&(delete this[g],h=!0)}return h}normalize(t){const s=this,a={};return Le.forEach(this,(h,g)=>{const v=Le.findKey(a,g);if(v){s[v]=cf(h),delete s[g];return}const c=t?IM(g):String(g).trim();c!==g&&delete s[g],s[c]=cf(h),a[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return Le.forEach(this,(a,h)=>{a!=null&&a!==!1&&(s[h]=t&&Le.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const a=new this(t);return s.forEach(h=>a.set(h)),a}static accessor(t){const a=(this[Aw]=this[Aw]={accessors:{}}).accessors,h=this.prototype;function g(v){const c=uh(v);a[c]||(MM(h,v),a[c]=!0)}return Le.isArray(t)?t.forEach(g):g(t),this}}xm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Le.reduceDescriptors(xm.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[s]=a}}});Le.freezeMethods(xm);const Fs=xm;function dy(e,t){const s=this||Q_,a=t||s,h=Fs.from(a.headers);let g=a.data;return Le.forEach(e,function(c){g=c.call(s,g,h.normalize(),t?t.status:void 0)}),h.normalize(),g}function YT(e){return!!(e&&e.__CANCEL__)}function Wc(e,t,s){Wt.call(this,e??"canceled",Wt.ERR_CANCELED,t,s),this.name="CanceledError"}Le.inherits(Wc,Wt,{__CANCEL__:!0});function JT(e,t,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?e(s):t(new Wt("Request failed with status code "+s.status,[Wt.ERR_BAD_REQUEST,Wt.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function LM(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function zM(e,t){e=e||10;const s=new Array(e),a=new Array(e);let h=0,g=0,v;return t=t!==void 0?t:1e3,function(C){const k=Date.now(),L=a[g];v||(v=k),s[h]=C,a[h]=k;let B=g,F=0;for(;B!==h;)F+=s[B++],B=B%e;if(h=(h+1)%e,h===g&&(g=(g+1)%e),k-v<t)return;const oe=L&&k-L;return oe?Math.round(F*1e3/oe):void 0}}function DM(e,t){let s=0,a=1e3/t,h,g;const v=(k,L=Date.now())=>{s=L,h=null,g&&(clearTimeout(g),g=null),e.apply(null,k)};return[(...k)=>{const L=Date.now(),B=L-s;B>=a?v(k,L):(h=k,g||(g=setTimeout(()=>{g=null,v(h)},a-B)))},()=>h&&v(h)]}const jf=(e,t,s=3)=>{let a=0;const h=zM(50,250);return DM(g=>{const v=g.loaded,c=g.lengthComputable?g.total:void 0,C=v-a,k=h(C),L=v<=c;a=v;const B={loaded:v,total:c,progress:c?v/c:void 0,bytes:C,rate:k||void 0,estimated:k&&c&&L?(c-v)/k:void 0,event:g,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(B)},s)},Iw=(e,t)=>{const s=e!=null;return[a=>t[0]({lengthComputable:s,total:e,loaded:a}),t[1]]},Mw=e=>(...t)=>Le.asap(()=>e(...t)),RM=tr.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,tr.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(tr.origin),tr.navigator&&/(msie|trident)/i.test(tr.navigator.userAgent)):()=>!0,FM=tr.hasStandardBrowserEnv?{write(e,t,s,a,h,g){const v=[e+"="+encodeURIComponent(t)];Le.isNumber(s)&&v.push("expires="+new Date(s).toGMTString()),Le.isString(a)&&v.push("path="+a),Le.isString(h)&&v.push("domain="+h),g===!0&&v.push("secure"),document.cookie=v.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function BM(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function NM(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function QT(e,t,s){let a=!BM(t);return e&&(a||s==!1)?NM(e,t):t}const Lw=e=>e instanceof Fs?{...e}:e;function ml(e,t){t=t||{};const s={};function a(k,L,B,F){return Le.isPlainObject(k)&&Le.isPlainObject(L)?Le.merge.call({caseless:F},k,L):Le.isPlainObject(L)?Le.merge({},L):Le.isArray(L)?L.slice():L}function h(k,L,B,F){if(Le.isUndefined(L)){if(!Le.isUndefined(k))return a(void 0,k,B,F)}else return a(k,L,B,F)}function g(k,L){if(!Le.isUndefined(L))return a(void 0,L)}function v(k,L){if(Le.isUndefined(L)){if(!Le.isUndefined(k))return a(void 0,k)}else return a(void 0,L)}function c(k,L,B){if(B in t)return a(k,L);if(B in e)return a(void 0,k)}const C={url:g,method:g,data:g,baseURL:v,transformRequest:v,transformResponse:v,paramsSerializer:v,timeout:v,timeoutMessage:v,withCredentials:v,withXSRFToken:v,adapter:v,responseType:v,xsrfCookieName:v,xsrfHeaderName:v,onUploadProgress:v,onDownloadProgress:v,decompress:v,maxContentLength:v,maxBodyLength:v,beforeRedirect:v,transport:v,httpAgent:v,httpsAgent:v,cancelToken:v,socketPath:v,responseEncoding:v,validateStatus:c,headers:(k,L,B)=>h(Lw(k),Lw(L),B,!0)};return Le.forEach(Object.keys(Object.assign({},e,t)),function(L){const B=C[L]||h,F=B(e[L],t[L],L);Le.isUndefined(F)&&B!==c||(s[L]=F)}),s}const ek=e=>{const t=ml({},e);let{data:s,withXSRFToken:a,xsrfHeaderName:h,xsrfCookieName:g,headers:v,auth:c}=t;t.headers=v=Fs.from(v),t.url=HT(QT(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&v.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let C;if(Le.isFormData(s)){if(tr.hasStandardBrowserEnv||tr.hasStandardBrowserWebWorkerEnv)v.setContentType(void 0);else if((C=v.getContentType())!==!1){const[k,...L]=C?C.split(";").map(B=>B.trim()).filter(Boolean):[];v.setContentType([k||"multipart/form-data",...L].join("; "))}}if(tr.hasStandardBrowserEnv&&(a&&Le.isFunction(a)&&(a=a(t)),a||a!==!1&&RM(t.url))){const k=h&&g&&FM.read(g);k&&v.set(h,k)}return t},jM=typeof XMLHttpRequest<"u",OM=jM&&function(e){return new Promise(function(s,a){const h=ek(e);let g=h.data;const v=Fs.from(h.headers).normalize();let{responseType:c,onUploadProgress:C,onDownloadProgress:k}=h,L,B,F,oe,se;function re(){oe&&oe(),se&&se(),h.cancelToken&&h.cancelToken.unsubscribe(L),h.signal&&h.signal.removeEventListener("abort",L)}let ue=new XMLHttpRequest;ue.open(h.method.toUpperCase(),h.url,!0),ue.timeout=h.timeout;function Z(){if(!ue)return;const G=Fs.from("getAllResponseHeaders"in ue&&ue.getAllResponseHeaders()),xe={data:!c||c==="text"||c==="json"?ue.responseText:ue.response,status:ue.status,statusText:ue.statusText,headers:G,config:e,request:ue};JT(function(Ie){s(Ie),re()},function(Ie){a(Ie),re()},xe),ue=null}"onloadend"in ue?ue.onloadend=Z:ue.onreadystatechange=function(){!ue||ue.readyState!==4||ue.status===0&&!(ue.responseURL&&ue.responseURL.indexOf("file:")===0)||setTimeout(Z)},ue.onabort=function(){ue&&(a(new Wt("Request aborted",Wt.ECONNABORTED,e,ue)),ue=null)},ue.onerror=function(){a(new Wt("Network Error",Wt.ERR_NETWORK,e,ue)),ue=null},ue.ontimeout=function(){let fe=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded";const xe=h.transitional||KT;h.timeoutErrorMessage&&(fe=h.timeoutErrorMessage),a(new Wt(fe,xe.clarifyTimeoutError?Wt.ETIMEDOUT:Wt.ECONNABORTED,e,ue)),ue=null},g===void 0&&v.setContentType(null),"setRequestHeader"in ue&&Le.forEach(v.toJSON(),function(fe,xe){ue.setRequestHeader(xe,fe)}),Le.isUndefined(h.withCredentials)||(ue.withCredentials=!!h.withCredentials),c&&c!=="json"&&(ue.responseType=h.responseType),k&&([F,se]=jf(k,!0),ue.addEventListener("progress",F)),C&&ue.upload&&([B,oe]=jf(C),ue.upload.addEventListener("progress",B),ue.upload.addEventListener("loadend",oe)),(h.cancelToken||h.signal)&&(L=G=>{ue&&(a(!G||G.type?new Wc(null,e,ue):G),ue.abort(),ue=null)},h.cancelToken&&h.cancelToken.subscribe(L),h.signal&&(h.signal.aborted?L():h.signal.addEventListener("abort",L)));const q=LM(h.url);if(q&&tr.protocols.indexOf(q)===-1){a(new Wt("Unsupported protocol "+q+":",Wt.ERR_BAD_REQUEST,e));return}ue.send(g||null)})},VM=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let a=new AbortController,h;const g=function(k){if(!h){h=!0,c();const L=k instanceof Error?k:this.reason;a.abort(L instanceof Wt?L:new Wc(L instanceof Error?L.message:L))}};let v=t&&setTimeout(()=>{v=null,g(new Wt(`timeout ${t} of ms exceeded`,Wt.ETIMEDOUT))},t);const c=()=>{e&&(v&&clearTimeout(v),v=null,e.forEach(k=>{k.unsubscribe?k.unsubscribe(g):k.removeEventListener("abort",g)}),e=null)};e.forEach(k=>k.addEventListener("abort",g));const{signal:C}=a;return C.unsubscribe=()=>Le.asap(c),C}},$M=VM,UM=function*(e,t){let s=e.byteLength;if(!t||s<t){yield e;return}let a=0,h;for(;a<s;)h=a+t,yield e.slice(a,h),a=h},qM=async function*(e,t){for await(const s of ZM(e))yield*UM(s,t)},ZM=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:a}=await t.read();if(s)break;yield a}}finally{await t.cancel()}},zw=(e,t,s,a)=>{const h=qM(e,t);let g=0,v,c=C=>{v||(v=!0,a&&a(C))};return new ReadableStream({async pull(C){try{const{done:k,value:L}=await h.next();if(k){c(),C.close();return}let B=L.byteLength;if(s){let F=g+=B;s(F)}C.enqueue(new Uint8Array(L))}catch(k){throw c(k),k}},cancel(C){return c(C),h.return()}},{highWaterMark:2})},vm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",tk=vm&&typeof ReadableStream=="function",GM=vm&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),nk=(e,...t)=>{try{return!!e(...t)}catch{return!1}},WM=tk&&nk(()=>{let e=!1;const t=new Request(tr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Dw=64*1024,E0=tk&&nk(()=>Le.isReadableStream(new Response("").body)),Of={stream:E0&&(e=>e.body)};vm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Of[t]&&(Of[t]=Le.isFunction(e[t])?s=>s[t]():(s,a)=>{throw new Wt(`Response type '${t}' is not supported`,Wt.ERR_NOT_SUPPORT,a)})})})(new Response);const HM=async e=>{if(e==null)return 0;if(Le.isBlob(e))return e.size;if(Le.isSpecCompliantForm(e))return(await new Request(tr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Le.isArrayBufferView(e)||Le.isArrayBuffer(e))return e.byteLength;if(Le.isURLSearchParams(e)&&(e=e+""),Le.isString(e))return(await GM(e)).byteLength},KM=async(e,t)=>{const s=Le.toFiniteNumber(e.getContentLength());return s??HM(t)},XM=vm&&(async e=>{let{url:t,method:s,data:a,signal:h,cancelToken:g,timeout:v,onDownloadProgress:c,onUploadProgress:C,responseType:k,headers:L,withCredentials:B="same-origin",fetchOptions:F}=ek(e);k=k?(k+"").toLowerCase():"text";let oe=$M([h,g&&g.toAbortSignal()],v),se;const re=oe&&oe.unsubscribe&&(()=>{oe.unsubscribe()});let ue;try{if(C&&WM&&s!=="get"&&s!=="head"&&(ue=await KM(L,a))!==0){let xe=new Request(t,{method:"POST",body:a,duplex:"half"}),Ee;if(Le.isFormData(a)&&(Ee=xe.headers.get("content-type"))&&L.setContentType(Ee),xe.body){const[Ie,ke]=Iw(ue,jf(Mw(C)));a=zw(xe.body,Dw,Ie,ke)}}Le.isString(B)||(B=B?"include":"omit");const Z="credentials"in Request.prototype;se=new Request(t,{...F,signal:oe,method:s.toUpperCase(),headers:L.normalize().toJSON(),body:a,duplex:"half",credentials:Z?B:void 0});let q=await fetch(se);const G=E0&&(k==="stream"||k==="response");if(E0&&(c||G&&re)){const xe={};["status","statusText","headers"].forEach(it=>{xe[it]=q[it]});const Ee=Le.toFiniteNumber(q.headers.get("content-length")),[Ie,ke]=c&&Iw(Ee,jf(Mw(c),!0))||[];q=new Response(zw(q.body,Dw,Ie,()=>{ke&&ke(),re&&re()}),xe)}k=k||"text";let fe=await Of[Le.findKey(Of,k)||"text"](q,e);return!G&&re&&re(),await new Promise((xe,Ee)=>{JT(xe,Ee,{data:fe,headers:Fs.from(q.headers),status:q.status,statusText:q.statusText,config:e,request:se})})}catch(Z){throw re&&re(),Z&&Z.name==="TypeError"&&/fetch/i.test(Z.message)?Object.assign(new Wt("Network Error",Wt.ERR_NETWORK,e,se),{cause:Z.cause||Z}):Wt.from(Z,Z&&Z.code,e,se)}}),C0={http:cM,xhr:OM,fetch:XM};Le.forEach(C0,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Rw=e=>`- ${e}`,YM=e=>Le.isFunction(e)||e===null||e===!1,ik={getAdapter:e=>{e=Le.isArray(e)?e:[e];const{length:t}=e;let s,a;const h={};for(let g=0;g<t;g++){s=e[g];let v;if(a=s,!YM(s)&&(a=C0[(v=String(s)).toLowerCase()],a===void 0))throw new Wt(`Unknown adapter '${v}'`);if(a)break;h[v||"#"+g]=a}if(!a){const g=Object.entries(h).map(([c,C])=>`adapter ${c} `+(C===!1?"is not supported by the environment":"is not available in the build"));let v=t?g.length>1?`since :
`+g.map(Rw).join(`
`):" "+Rw(g[0]):"as no adapter specified";throw new Wt("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return a},adapters:C0};function py(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Wc(null,e)}function Fw(e){return py(e),e.headers=Fs.from(e.headers),e.data=dy.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),ik.getAdapter(e.adapter||Q_.adapter)(e).then(function(a){return py(e),a.data=dy.call(e,e.transformResponse,a),a.headers=Fs.from(a.headers),a},function(a){return YT(a)||(py(e),a&&a.response&&(a.response.data=dy.call(e,e.transformResponse,a.response),a.response.headers=Fs.from(a.response.headers))),Promise.reject(a)})}const rk="1.8.4",wm={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{wm[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Bw={};wm.transitional=function(t,s,a){function h(g,v){return"[Axios v"+rk+"] Transitional option '"+g+"'"+v+(a?". "+a:"")}return(g,v,c)=>{if(t===!1)throw new Wt(h(v," has been removed"+(s?" in "+s:"")),Wt.ERR_DEPRECATED);return s&&!Bw[v]&&(Bw[v]=!0,console.warn(h(v," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(g,v,c):!0}};wm.spelling=function(t){return(s,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function JM(e,t,s){if(typeof e!="object")throw new Wt("options must be an object",Wt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let h=a.length;for(;h-- >0;){const g=a[h],v=t[g];if(v){const c=e[g],C=c===void 0||v(c,g,e);if(C!==!0)throw new Wt("option "+g+" must be "+C,Wt.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new Wt("Unknown option "+g,Wt.ERR_BAD_OPTION)}}const uf={assertOptions:JM,validators:wm},Xs=uf.validators;class Vf{constructor(t){this.defaults=t,this.interceptors={request:new Pw,response:new Pw}}async request(t,s){try{return await this._request(t,s)}catch(a){if(a instanceof Error){let h={};Error.captureStackTrace?Error.captureStackTrace(h):h=new Error;const g=h.stack?h.stack.replace(/^.+\n/,""):"";try{a.stack?g&&!String(a.stack).endsWith(g.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+g):a.stack=g}catch{}}throw a}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=ml(this.defaults,s);const{transitional:a,paramsSerializer:h,headers:g}=s;a!==void 0&&uf.assertOptions(a,{silentJSONParsing:Xs.transitional(Xs.boolean),forcedJSONParsing:Xs.transitional(Xs.boolean),clarifyTimeoutError:Xs.transitional(Xs.boolean)},!1),h!=null&&(Le.isFunction(h)?s.paramsSerializer={serialize:h}:uf.assertOptions(h,{encode:Xs.function,serialize:Xs.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),uf.assertOptions(s,{baseUrl:Xs.spelling("baseURL"),withXsrfToken:Xs.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let v=g&&Le.merge(g.common,g[s.method]);g&&Le.forEach(["delete","get","head","post","put","patch","common"],se=>{delete g[se]}),s.headers=Fs.concat(v,g);const c=[];let C=!0;this.interceptors.request.forEach(function(re){typeof re.runWhen=="function"&&re.runWhen(s)===!1||(C=C&&re.synchronous,c.unshift(re.fulfilled,re.rejected))});const k=[];this.interceptors.response.forEach(function(re){k.push(re.fulfilled,re.rejected)});let L,B=0,F;if(!C){const se=[Fw.bind(this),void 0];for(se.unshift.apply(se,c),se.push.apply(se,k),F=se.length,L=Promise.resolve(s);B<F;)L=L.then(se[B++],se[B++]);return L}F=c.length;let oe=s;for(B=0;B<F;){const se=c[B++],re=c[B++];try{oe=se(oe)}catch(ue){re.call(this,ue);break}}try{L=Fw.call(this,oe)}catch(se){return Promise.reject(se)}for(B=0,F=k.length;B<F;)L=L.then(k[B++],k[B++]);return L}getUri(t){t=ml(this.defaults,t);const s=QT(t.baseURL,t.url,t.allowAbsoluteUrls);return HT(s,t.params,t.paramsSerializer)}}Le.forEach(["delete","get","head","options"],function(t){Vf.prototype[t]=function(s,a){return this.request(ml(a||{},{method:t,url:s,data:(a||{}).data}))}});Le.forEach(["post","put","patch"],function(t){function s(a){return function(g,v,c){return this.request(ml(c||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:g,data:v}))}}Vf.prototype[t]=s(),Vf.prototype[t+"Form"]=s(!0)});const hf=Vf;class ex{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(g){s=g});const a=this;this.promise.then(h=>{if(!a._listeners)return;let g=a._listeners.length;for(;g-- >0;)a._listeners[g](h);a._listeners=null}),this.promise.then=h=>{let g;const v=new Promise(c=>{a.subscribe(c),g=c}).then(h);return v.cancel=function(){a.unsubscribe(g)},v},t(function(g,v,c){a.reason||(a.reason=new Wc(g,v,c),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=a=>{t.abort(a)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new ex(function(h){t=h}),cancel:t}}}const QM=ex;function e3(e){return function(s){return e.apply(null,s)}}function t3(e){return Le.isObject(e)&&e.isAxiosError===!0}const P0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(P0).forEach(([e,t])=>{P0[t]=e});const n3=P0;function sk(e){const t=new hf(e),s=BT(hf.prototype.request,t);return Le.extend(s,hf.prototype,t,{allOwnKeys:!0}),Le.extend(s,t,null,{allOwnKeys:!0}),s.create=function(h){return sk(ml(e,h))},s}const mi=sk(Q_);mi.Axios=hf;mi.CanceledError=Wc;mi.CancelToken=QM;mi.isCancel=YT;mi.VERSION=rk;mi.toFormData=_m;mi.AxiosError=Wt;mi.Cancel=mi.CanceledError;mi.all=function(t){return Promise.all(t)};mi.spread=e3;mi.isAxiosError=t3;mi.mergeConfig=ml;mi.AxiosHeaders=Fs;mi.formToJSON=e=>XT(Le.isHTMLForm(e)?new FormData(e):e);mi.getAdapter=ik.getAdapter;mi.HttpStatusCode=n3;mi.default=mi;const i3=mi,tx=ce.createContext({});function nx(e){const t=ce.useRef(null);return t.current===null&&(t.current=e()),t.current}const bm=ce.createContext(null),ix=ce.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class r3 extends ce.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const a=this.props.sizeRef.current;a.height=s.offsetHeight||0,a.width=s.offsetWidth||0,a.top=s.offsetTop,a.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function s3({children:e,isPresent:t}){const s=ce.useId(),a=ce.useRef(null),h=ce.useRef({width:0,height:0,top:0,left:0}),{nonce:g}=ce.useContext(ix);return ce.useInsertionEffect(()=>{const{width:v,height:c,top:C,left:k}=h.current;if(t||!a.current||!v||!c)return;a.current.dataset.motionPopId=s;const L=document.createElement("style");return g&&(L.nonce=g),document.head.appendChild(L),L.sheet&&L.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${v}px !important;
            height: ${c}px !important;
            top: ${C}px !important;
            left: ${k}px !important;
          }
        `),()=>{document.head.removeChild(L)}},[t]),R.jsx(r3,{isPresent:t,childRef:a,sizeRef:h,children:ce.cloneElement(e,{ref:a})})}const o3=({children:e,initial:t,isPresent:s,onExitComplete:a,custom:h,presenceAffectsLayout:g,mode:v})=>{const c=nx(a3),C=ce.useId(),k=ce.useCallback(B=>{c.set(B,!0);for(const F of c.values())if(!F)return;a&&a()},[c,a]),L=ce.useMemo(()=>({id:C,initial:t,isPresent:s,custom:h,onExitComplete:k,register:B=>(c.set(B,!1),()=>c.delete(B))}),g?[Math.random(),k]:[s,k]);return ce.useMemo(()=>{c.forEach((B,F)=>c.set(F,!1))},[s]),ce.useEffect(()=>{!s&&!c.size&&a&&a()},[s]),v==="popLayout"&&(e=R.jsx(s3,{isPresent:s,children:e})),R.jsx(bm.Provider,{value:L,children:e})};function a3(){return new Map}function ok(e=!0){const t=ce.useContext(bm);if(t===null)return[!0,null];const{isPresent:s,onExitComplete:a,register:h}=t,g=ce.useId();ce.useEffect(()=>{e&&h(g)},[e]);const v=ce.useCallback(()=>e&&a&&a(g),[g,a,e]);return!s&&a?[!1,v]:[!0]}const Vp=e=>e.key||"";function Nw(e){const t=[];return ce.Children.forEach(e,s=>{ce.isValidElement(s)&&t.push(s)}),t}const rx=typeof window<"u",ak=rx?ce.useLayoutEffect:ce.useEffect,In=({children:e,custom:t,initial:s=!0,onExitComplete:a,presenceAffectsLayout:h=!0,mode:g="sync",propagate:v=!1})=>{const[c,C]=ok(v),k=ce.useMemo(()=>Nw(e),[e]),L=v&&!c?[]:k.map(Vp),B=ce.useRef(!0),F=ce.useRef(k),oe=nx(()=>new Map),[se,re]=ce.useState(k),[ue,Z]=ce.useState(k);ak(()=>{B.current=!1,F.current=k;for(let fe=0;fe<ue.length;fe++){const xe=Vp(ue[fe]);L.includes(xe)?oe.delete(xe):oe.get(xe)!==!0&&oe.set(xe,!1)}},[ue,L.length,L.join("-")]);const q=[];if(k!==se){let fe=[...k];for(let xe=0;xe<ue.length;xe++){const Ee=ue[xe],Ie=Vp(Ee);L.includes(Ie)||(fe.splice(xe,0,Ee),q.push(Ee))}g==="wait"&&q.length&&(fe=q),Z(Nw(fe)),re(k);return}const{forceRender:G}=ce.useContext(tx);return R.jsx(R.Fragment,{children:ue.map(fe=>{const xe=Vp(fe),Ee=v&&!c?!1:k===ue||L.includes(xe),Ie=()=>{if(oe.has(xe))oe.set(xe,!0);else return;let ke=!0;oe.forEach(it=>{it||(ke=!1)}),ke&&(G==null||G(),Z(F.current),v&&(C==null||C()),a&&a())};return R.jsx(o3,{isPresent:Ee,initial:!B.current||s?void 0:!1,custom:Ee?void 0:t,presenceAffectsLayout:h,mode:g,onExitComplete:Ee?void 0:Ie,children:fe},xe)})})},Wr=e=>e;let lk=Wr;function sx(e){let t;return()=>(t===void 0&&(t=e()),t)}const jc=(e,t,s)=>{const a=t-e;return a===0?1:(s-e)/a},Po=e=>e*1e3,Ao=e=>e/1e3,l3={skipAnimations:!1,useManualTiming:!1};function c3(e){let t=new Set,s=new Set,a=!1,h=!1;const g=new WeakSet;let v={delta:0,timestamp:0,isProcessing:!1};function c(k){g.has(k)&&(C.schedule(k),e()),k(v)}const C={schedule:(k,L=!1,B=!1)=>{const oe=B&&a?t:s;return L&&g.add(k),oe.has(k)||oe.add(k),k},cancel:k=>{s.delete(k),g.delete(k)},process:k=>{if(v=k,a){h=!0;return}a=!0,[t,s]=[s,t],t.forEach(c),t.clear(),a=!1,h&&(h=!1,C.process(k))}};return C}const $p=["read","resolveKeyframes","update","preRender","render","postRender"],u3=40;function ck(e,t){let s=!1,a=!0;const h={delta:0,timestamp:0,isProcessing:!1},g=()=>s=!0,v=$p.reduce((Z,q)=>(Z[q]=c3(g),Z),{}),{read:c,resolveKeyframes:C,update:k,preRender:L,render:B,postRender:F}=v,oe=()=>{const Z=performance.now();s=!1,h.delta=a?1e3/60:Math.max(Math.min(Z-h.timestamp,u3),1),h.timestamp=Z,h.isProcessing=!0,c.process(h),C.process(h),k.process(h),L.process(h),B.process(h),F.process(h),h.isProcessing=!1,s&&t&&(a=!1,e(oe))},se=()=>{s=!0,a=!0,h.isProcessing||e(oe)};return{schedule:$p.reduce((Z,q)=>{const G=v[q];return Z[q]=(fe,xe=!1,Ee=!1)=>(s||se(),G.schedule(fe,xe,Ee)),Z},{}),cancel:Z=>{for(let q=0;q<$p.length;q++)v[$p[q]].cancel(Z)},state:h,steps:v}}const{schedule:Bn,cancel:ba,state:Oi,steps:fy}=ck(typeof requestAnimationFrame<"u"?requestAnimationFrame:Wr,!0),uk=ce.createContext({strict:!1}),jw={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Oc={};for(const e in jw)Oc[e]={isEnabled:t=>jw[e].some(s=>!!t[s])};function h3(e){for(const t in e)Oc[t]={...Oc[t],...e[t]}}const d3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $f(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||d3.has(e)}let hk=e=>!$f(e);function p3(e){e&&(hk=t=>t.startsWith("on")?!$f(t):e(t))}try{p3(require("@emotion/is-prop-valid").default)}catch{}function f3(e,t,s){const a={};for(const h in e)h==="values"&&typeof e.values=="object"||(hk(h)||s===!0&&$f(h)||!t&&!$f(h)||e.draggable&&h.startsWith("onDrag"))&&(a[h]=e[h]);return a}function m3(e){if(typeof Proxy>"u")return e;const t=new Map,s=(...a)=>e(...a);return new Proxy(s,{get:(a,h)=>h==="create"?e:(t.has(h)||t.set(h,e(h)),t.get(h))})}const Sm=ce.createContext({});function Jh(e){return typeof e=="string"||Array.isArray(e)}function Tm(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const ox=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ax=["initial",...ox];function km(e){return Tm(e.animate)||ax.some(t=>Jh(e[t]))}function dk(e){return!!(km(e)||e.variants)}function g3(e,t){if(km(e)){const{initial:s,animate:a}=e;return{initial:s===!1||Jh(s)?s:void 0,animate:Jh(a)?a:void 0}}return e.inherit!==!1?t:{}}function y3(e){const{initial:t,animate:s}=g3(e,ce.useContext(Sm));return ce.useMemo(()=>({initial:t,animate:s}),[Ow(t),Ow(s)])}function Ow(e){return Array.isArray(e)?e.join(" "):e}const _3=Symbol.for("motionComponentSymbol");function xc(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function x3(e,t,s){return ce.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),s&&(typeof s=="function"?s(a):xc(s)&&(s.current=a))},[t])}const lx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),v3="framerAppearId",pk="data-"+lx(v3),{schedule:cx,cancel:TF}=ck(queueMicrotask,!1),fk=ce.createContext({});function w3(e,t,s,a,h){var g,v;const{visualElement:c}=ce.useContext(Sm),C=ce.useContext(uk),k=ce.useContext(bm),L=ce.useContext(ix).reducedMotion,B=ce.useRef(null);a=a||C.renderer,!B.current&&a&&(B.current=a(e,{visualState:t,parent:c,props:s,presenceContext:k,blockInitialAnimation:k?k.initial===!1:!1,reducedMotionConfig:L}));const F=B.current,oe=ce.useContext(fk);F&&!F.projection&&h&&(F.type==="html"||F.type==="svg")&&b3(B.current,s,h,oe);const se=ce.useRef(!1);ce.useInsertionEffect(()=>{F&&se.current&&F.update(s,k)});const re=s[pk],ue=ce.useRef(!!re&&!(!((g=window.MotionHandoffIsComplete)===null||g===void 0)&&g.call(window,re))&&((v=window.MotionHasOptimisedAnimation)===null||v===void 0?void 0:v.call(window,re)));return ak(()=>{F&&(se.current=!0,window.MotionIsMounted=!0,F.updateFeatures(),cx.render(F.render),ue.current&&F.animationState&&F.animationState.animateChanges())}),ce.useEffect(()=>{F&&(!ue.current&&F.animationState&&F.animationState.animateChanges(),ue.current&&(queueMicrotask(()=>{var Z;(Z=window.MotionHandoffMarkAsComplete)===null||Z===void 0||Z.call(window,re)}),ue.current=!1))}),F}function b3(e,t,s,a){const{layoutId:h,layout:g,drag:v,dragConstraints:c,layoutScroll:C,layoutRoot:k}=t;e.projection=new s(e.latestValues,t["data-framer-portal-id"]?void 0:mk(e.parent)),e.projection.setOptions({layoutId:h,layout:g,alwaysMeasureLayout:!!v||c&&xc(c),visualElement:e,animationType:typeof g=="string"?g:"both",initialPromotionConfig:a,layoutScroll:C,layoutRoot:k})}function mk(e){if(e)return e.options.allowProjection!==!1?e.projection:mk(e.parent)}function S3({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:a,Component:h}){var g,v;e&&h3(e);function c(k,L){let B;const F={...ce.useContext(ix),...k,layoutId:T3(k)},{isStatic:oe}=F,se=y3(k),re=a(k,oe);if(!oe&&rx){k3();const ue=E3(F);B=ue.MeasureLayout,se.visualElement=w3(h,re,F,t,ue.ProjectionNode)}return R.jsxs(Sm.Provider,{value:se,children:[B&&se.visualElement?R.jsx(B,{visualElement:se.visualElement,...F}):null,s(h,k,x3(re,se.visualElement,L),re,oe,se.visualElement)]})}c.displayName=`motion.${typeof h=="string"?h:`create(${(v=(g=h.displayName)!==null&&g!==void 0?g:h.name)!==null&&v!==void 0?v:""})`}`;const C=ce.forwardRef(c);return C[_3]=h,C}function T3({layoutId:e}){const t=ce.useContext(tx).id;return t&&e!==void 0?t+"-"+e:e}function k3(e,t){ce.useContext(uk).strict}function E3(e){const{drag:t,layout:s}=Oc;if(!t&&!s)return{};const a={...t,...s};return{MeasureLayout:t!=null&&t.isEnabled(e)||s!=null&&s.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}const C3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ux(e){return typeof e!="string"||e.includes("-")?!1:!!(C3.indexOf(e)>-1||/[A-Z]/u.test(e))}function Vw(e){const t=[{},{}];return e==null||e.values.forEach((s,a)=>{t[0][a]=s.get(),t[1][a]=s.getVelocity()}),t}function hx(e,t,s,a){if(typeof t=="function"){const[h,g]=Vw(a);t=t(s!==void 0?s:e.custom,h,g)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[h,g]=Vw(a);t=t(s!==void 0?s:e.custom,h,g)}return t}const A0=e=>Array.isArray(e),P3=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),A3=e=>A0(e)?e[e.length-1]||0:e,nr=e=>!!(e&&e.getVelocity);function df(e){const t=nr(e)?e.get():e;return P3(t)?t.toValue():t}function I3({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:s},a,h,g){const v={latestValues:M3(a,h,g,e),renderState:t()};return s&&(v.onMount=c=>s({props:a,current:c,...v}),v.onUpdate=c=>s(c)),v}const gk=e=>(t,s)=>{const a=ce.useContext(Sm),h=ce.useContext(bm),g=()=>I3(e,t,a,h);return s?g():nx(g)};function M3(e,t,s,a){const h={},g=a(e,{});for(const F in g)h[F]=df(g[F]);let{initial:v,animate:c}=e;const C=km(e),k=dk(e);t&&k&&!C&&e.inherit!==!1&&(v===void 0&&(v=t.initial),c===void 0&&(c=t.animate));let L=s?s.initial===!1:!1;L=L||v===!1;const B=L?c:v;if(B&&typeof B!="boolean"&&!Tm(B)){const F=Array.isArray(B)?B:[B];for(let oe=0;oe<F.length;oe++){const se=hx(e,F[oe]);if(se){const{transitionEnd:re,transition:ue,...Z}=se;for(const q in Z){let G=Z[q];if(Array.isArray(G)){const fe=L?G.length-1:0;G=G[fe]}G!==null&&(h[q]=G)}for(const q in re)h[q]=re[q]}}}return h}const Hc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xl=new Set(Hc),yk=e=>t=>typeof t=="string"&&t.startsWith(e),_k=yk("--"),L3=yk("var(--"),dx=e=>L3(e)?z3.test(e.split("/*")[0].trim()):!1,z3=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,xk=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Do=(e,t,s)=>s>t?t:s<e?e:s,Kc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Qh={...Kc,transform:e=>Do(0,1,e)},Up={...Kc,default:1},hd=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ra=hd("deg"),io=hd("%"),Pt=hd("px"),D3=hd("vh"),R3=hd("vw"),$w={...io,parse:e=>io.parse(e)/100,transform:e=>io.transform(e*100)},F3={borderWidth:Pt,borderTopWidth:Pt,borderRightWidth:Pt,borderBottomWidth:Pt,borderLeftWidth:Pt,borderRadius:Pt,radius:Pt,borderTopLeftRadius:Pt,borderTopRightRadius:Pt,borderBottomRightRadius:Pt,borderBottomLeftRadius:Pt,width:Pt,maxWidth:Pt,height:Pt,maxHeight:Pt,top:Pt,right:Pt,bottom:Pt,left:Pt,padding:Pt,paddingTop:Pt,paddingRight:Pt,paddingBottom:Pt,paddingLeft:Pt,margin:Pt,marginTop:Pt,marginRight:Pt,marginBottom:Pt,marginLeft:Pt,backgroundPositionX:Pt,backgroundPositionY:Pt},B3={rotate:ra,rotateX:ra,rotateY:ra,rotateZ:ra,scale:Up,scaleX:Up,scaleY:Up,scaleZ:Up,skew:ra,skewX:ra,skewY:ra,distance:Pt,translateX:Pt,translateY:Pt,translateZ:Pt,x:Pt,y:Pt,z:Pt,perspective:Pt,transformPerspective:Pt,opacity:Qh,originX:$w,originY:$w,originZ:Pt},Uw={...Kc,transform:Math.round},px={...F3,...B3,zIndex:Uw,size:Pt,fillOpacity:Qh,strokeOpacity:Qh,numOctaves:Uw},N3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},j3=Hc.length;function O3(e,t,s){let a="",h=!0;for(let g=0;g<j3;g++){const v=Hc[g],c=e[v];if(c===void 0)continue;let C=!0;if(typeof c=="number"?C=c===(v.startsWith("scale")?1:0):C=parseFloat(c)===0,!C||s){const k=xk(c,px[v]);if(!C){h=!1;const L=N3[v]||v;a+=`${L}(${k}) `}s&&(t[v]=k)}}return a=a.trim(),s?a=s(t,h?"":a):h&&(a="none"),a}function fx(e,t,s){const{style:a,vars:h,transformOrigin:g}=e;let v=!1,c=!1;for(const C in t){const k=t[C];if(xl.has(C)){v=!0;continue}else if(_k(C)){h[C]=k;continue}else{const L=xk(k,px[C]);C.startsWith("origin")?(c=!0,g[C]=L):a[C]=L}}if(t.transform||(v||s?a.transform=O3(t,e.transform,s):a.transform&&(a.transform="none")),c){const{originX:C="50%",originY:k="50%",originZ:L=0}=g;a.transformOrigin=`${C} ${k} ${L}`}}const V3={offset:"stroke-dashoffset",array:"stroke-dasharray"},$3={offset:"strokeDashoffset",array:"strokeDasharray"};function U3(e,t,s=1,a=0,h=!0){e.pathLength=1;const g=h?V3:$3;e[g.offset]=Pt.transform(-a);const v=Pt.transform(t),c=Pt.transform(s);e[g.array]=`${v} ${c}`}function qw(e,t,s){return typeof e=="string"?e:Pt.transform(t+s*e)}function q3(e,t,s){const a=qw(t,e.x,e.width),h=qw(s,e.y,e.height);return`${a} ${h}`}function mx(e,{attrX:t,attrY:s,attrScale:a,originX:h,originY:g,pathLength:v,pathSpacing:c=1,pathOffset:C=0,...k},L,B){if(fx(e,k,B),L){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:F,style:oe,dimensions:se}=e;F.transform&&(se&&(oe.transform=F.transform),delete F.transform),se&&(h!==void 0||g!==void 0||oe.transform)&&(oe.transformOrigin=q3(se,h!==void 0?h:.5,g!==void 0?g:.5)),t!==void 0&&(F.x=t),s!==void 0&&(F.y=s),a!==void 0&&(F.scale=a),v!==void 0&&U3(F,v,c,C,!1)}const gx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),vk=()=>({...gx(),attrs:{}}),yx=e=>typeof e=="string"&&e.toLowerCase()==="svg";function wk(e,{style:t,vars:s},a,h){Object.assign(e.style,t,h&&h.getProjectionStyles(a));for(const g in s)e.style.setProperty(g,s[g])}const bk=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Sk(e,t,s,a){wk(e,t,void 0,a);for(const h in t.attrs)e.setAttribute(bk.has(h)?h:lx(h),t.attrs[h])}const Uf={};function Z3(e){Object.assign(Uf,e)}function Tk(e,{layout:t,layoutId:s}){return xl.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!Uf[e]||e==="opacity")}function _x(e,t,s){var a;const{style:h}=e,g={};for(const v in h)(nr(h[v])||t.style&&nr(t.style[v])||Tk(v,e)||((a=s==null?void 0:s.getValue(v))===null||a===void 0?void 0:a.liveStyle)!==void 0)&&(g[v]=h[v]);return g}function kk(e,t,s){const a=_x(e,t,s);for(const h in e)if(nr(e[h])||nr(t[h])){const g=Hc.indexOf(h)!==-1?"attr"+h.charAt(0).toUpperCase()+h.substring(1):h;a[g]=e[h]}return a}function G3(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const Zw=["x","y","width","height","cx","cy","r"],W3={useVisualState:gk({scrapeMotionValuesFromProps:kk,createRenderState:vk,onUpdate:({props:e,prevProps:t,current:s,renderState:a,latestValues:h})=>{if(!s)return;let g=!!e.drag;if(!g){for(const c in h)if(xl.has(c)){g=!0;break}}if(!g)return;let v=!t;if(t)for(let c=0;c<Zw.length;c++){const C=Zw[c];e[C]!==t[C]&&(v=!0)}v&&Bn.read(()=>{G3(s,a),Bn.render(()=>{mx(a,h,yx(s.tagName),e.transformTemplate),Sk(s,a)})})}})},H3={useVisualState:gk({scrapeMotionValuesFromProps:_x,createRenderState:gx})};function Ek(e,t,s){for(const a in t)!nr(t[a])&&!Tk(a,s)&&(e[a]=t[a])}function K3({transformTemplate:e},t){return ce.useMemo(()=>{const s=gx();return fx(s,t,e),Object.assign({},s.vars,s.style)},[t])}function X3(e,t){const s=e.style||{},a={};return Ek(a,s,e),Object.assign(a,K3(e,t)),a}function Y3(e,t){const s={},a=X3(e,t);return e.drag&&e.dragListener!==!1&&(s.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=a,s}function J3(e,t,s,a){const h=ce.useMemo(()=>{const g=vk();return mx(g,t,yx(a),e.transformTemplate),{...g.attrs,style:{...g.style}}},[t]);if(e.style){const g={};Ek(g,e.style,e),h.style={...g,...h.style}}return h}function Q3(e=!1){return(s,a,h,{latestValues:g},v)=>{const C=(ux(s)?J3:Y3)(a,g,v,s),k=f3(a,typeof s=="string",e),L=s!==ce.Fragment?{...k,...C,ref:h}:{},{children:B}=a,F=ce.useMemo(()=>nr(B)?B.get():B,[B]);return ce.createElement(s,{...L,children:F})}}function eL(e,t){return function(a,{forwardMotionProps:h}={forwardMotionProps:!1}){const v={...ux(a)?W3:H3,preloadedFeatures:e,useRender:Q3(h),createVisualElement:t,Component:a};return S3(v)}}function Ck(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let a=0;a<s;a++)if(t[a]!==e[a])return!1;return!0}function Em(e,t,s){const a=e.getProps();return hx(a,t,s!==void 0?s:a.custom,e)}const tL=sx(()=>window.ScrollTimeline!==void 0);class nL{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,s){for(let a=0;a<this.animations.length;a++)this.animations[a][t]=s}attachTimeline(t,s){const a=this.animations.map(h=>{if(tL()&&h.attachTimeline)return h.attachTimeline(t);if(typeof s=="function")return s(h)});return()=>{a.forEach((h,g)=>{h&&h(),this.animations[g].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let s=0;s<this.animations.length;s++)t=Math.max(t,this.animations[s].duration);return t}runAll(t){this.animations.forEach(s=>s[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class iL extends nL{then(t,s){return Promise.all(this.animations).then(t).catch(s)}}function xx(e,t){return e?e[t]||e.default||e:void 0}const I0=2e4;function Pk(e){let t=0;const s=50;let a=e.next(t);for(;!a.done&&t<I0;)t+=s,a=e.next(t);return t>=I0?1/0:t}function vx(e){return typeof e=="function"}function Gw(e,t){e.timeline=t,e.onfinish=null}const wx=e=>Array.isArray(e)&&typeof e[0]=="number",rL={linearEasing:void 0};function sL(e,t){const s=sx(e);return()=>{var a;return(a=rL[t])!==null&&a!==void 0?a:s()}}const qf=sL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ak=(e,t,s=10)=>{let a="";const h=Math.max(Math.round(t/s),2);for(let g=0;g<h;g++)a+=e(jc(0,h-1,g))+", ";return`linear(${a.substring(0,a.length-2)})`};function Ik(e){return!!(typeof e=="function"&&qf()||!e||typeof e=="string"&&(e in M0||qf())||wx(e)||Array.isArray(e)&&e.every(Ik))}const gh=([e,t,s,a])=>`cubic-bezier(${e}, ${t}, ${s}, ${a})`,M0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gh([0,.65,.55,1]),circOut:gh([.55,0,1,.45]),backIn:gh([.31,.01,.66,-.59]),backOut:gh([.33,1.53,.69,.99])};function Mk(e,t){if(e)return typeof e=="function"&&qf()?Ak(e,t):wx(e)?gh(e):Array.isArray(e)?e.map(s=>Mk(s,t)||M0.easeOut):M0[e]}const Is={x:!1,y:!1};function Lk(){return Is.x||Is.y}function oL(e,t,s){var a;if(e instanceof Element)return[e];if(typeof e=="string"){let h=document;t&&(h=t.current);const g=(a=s==null?void 0:s[e])!==null&&a!==void 0?a:h.querySelectorAll(e);return g?Array.from(g):[]}return Array.from(e)}function zk(e,t){const s=oL(e),a=new AbortController,h={passive:!0,...t,signal:a.signal};return[s,h,()=>a.abort()]}function Ww(e){return t=>{t.pointerType==="touch"||Lk()||e(t)}}function aL(e,t,s={}){const[a,h,g]=zk(e,s),v=Ww(c=>{const{target:C}=c,k=t(c);if(typeof k!="function"||!C)return;const L=Ww(B=>{k(B),C.removeEventListener("pointerleave",L)});C.addEventListener("pointerleave",L,h)});return a.forEach(c=>{c.addEventListener("pointerenter",v,h)}),g}const Dk=(e,t)=>t?e===t?!0:Dk(e,t.parentElement):!1,bx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,lL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function cL(e){return lL.has(e.tagName)||e.tabIndex!==-1}const yh=new WeakSet;function Hw(e){return t=>{t.key==="Enter"&&e(t)}}function my(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const uL=(e,t)=>{const s=e.currentTarget;if(!s)return;const a=Hw(()=>{if(yh.has(s))return;my(s,"down");const h=Hw(()=>{my(s,"up")}),g=()=>my(s,"cancel");s.addEventListener("keyup",h,t),s.addEventListener("blur",g,t)});s.addEventListener("keydown",a,t),s.addEventListener("blur",()=>s.removeEventListener("keydown",a),t)};function Kw(e){return bx(e)&&!Lk()}function hL(e,t,s={}){const[a,h,g]=zk(e,s),v=c=>{const C=c.currentTarget;if(!Kw(c)||yh.has(C))return;yh.add(C);const k=t(c),L=(oe,se)=>{window.removeEventListener("pointerup",B),window.removeEventListener("pointercancel",F),!(!Kw(oe)||!yh.has(C))&&(yh.delete(C),typeof k=="function"&&k(oe,{success:se}))},B=oe=>{L(oe,s.useGlobalTarget||Dk(C,oe.target))},F=oe=>{L(oe,!1)};window.addEventListener("pointerup",B,h),window.addEventListener("pointercancel",F,h)};return a.forEach(c=>{!cL(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(s.useGlobalTarget?window:c).addEventListener("pointerdown",v,h),c.addEventListener("focus",k=>uL(k,h),h)}),g}function dL(e){return e==="x"||e==="y"?Is[e]?null:(Is[e]=!0,()=>{Is[e]=!1}):Is.x||Is.y?null:(Is.x=Is.y=!0,()=>{Is.x=Is.y=!1})}const Rk=new Set(["width","height","top","left","right","bottom",...Hc]);let pf;function pL(){pf=void 0}const ro={now:()=>(pf===void 0&&ro.set(Oi.isProcessing||l3.useManualTiming?Oi.timestamp:performance.now()),pf),set:e=>{pf=e,queueMicrotask(pL)}};function Sx(e,t){e.indexOf(t)===-1&&e.push(t)}function Tx(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class kx{constructor(){this.subscriptions=[]}add(t){return Sx(this.subscriptions,t),()=>Tx(this.subscriptions,t)}notify(t,s,a){const h=this.subscriptions.length;if(h)if(h===1)this.subscriptions[0](t,s,a);else for(let g=0;g<h;g++){const v=this.subscriptions[g];v&&v(t,s,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Fk(e,t){return t?e*(1e3/t):0}const Xw=30,fL=e=>!isNaN(parseFloat(e));class mL{constructor(t,s={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(a,h=!0)=>{const g=ro.now();this.updatedAt!==g&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),h&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=s.owner}setCurrent(t){this.current=t,this.updatedAt=ro.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=fL(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new kx);const a=this.events[t].add(s);return t==="change"?()=>{a(),Bn.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,a){this.set(s),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,s=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ro.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Xw)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,Xw);return Fk(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ed(e,t){return new mL(e,t)}function gL(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,ed(s))}function yL(e,t){const s=Em(e,t);let{transitionEnd:a={},transition:h={},...g}=s||{};g={...g,...a};for(const v in g){const c=A3(g[v]);gL(e,v,c)}}function _L(e){return!!(nr(e)&&e.add)}function L0(e,t){const s=e.getValue("willChange");if(_L(s))return s.add(t)}function Bk(e){return e.props[pk]}const Nk=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,xL=1e-7,vL=12;function wL(e,t,s,a,h){let g,v,c=0;do v=t+(s-t)/2,g=Nk(v,a,h)-e,g>0?s=v:t=v;while(Math.abs(g)>xL&&++c<vL);return v}function dd(e,t,s,a){if(e===t&&s===a)return Wr;const h=g=>wL(g,0,1,e,s);return g=>g===0||g===1?g:Nk(h(g),t,a)}const jk=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Ok=e=>t=>1-e(1-t),Vk=dd(.33,1.53,.69,.99),Ex=Ok(Vk),$k=jk(Ex),Uk=e=>(e*=2)<1?.5*Ex(e):.5*(2-Math.pow(2,-10*(e-1))),Cx=e=>1-Math.sin(Math.acos(e)),qk=Ok(Cx),Zk=jk(Cx),Gk=e=>/^0[^.\s]+$/u.test(e);function bL(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Gk(e):!0}const Ph=e=>Math.round(e*1e5)/1e5,Px=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function SL(e){return e==null}const TL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Ax=(e,t)=>s=>!!(typeof s=="string"&&TL.test(s)&&s.startsWith(e)||t&&!SL(s)&&Object.prototype.hasOwnProperty.call(s,t)),Wk=(e,t,s)=>a=>{if(typeof a!="string")return a;const[h,g,v,c]=a.match(Px);return{[e]:parseFloat(h),[t]:parseFloat(g),[s]:parseFloat(v),alpha:c!==void 0?parseFloat(c):1}},kL=e=>Do(0,255,e),gy={...Kc,transform:e=>Math.round(kL(e))},rl={test:Ax("rgb","red"),parse:Wk("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:a=1})=>"rgba("+gy.transform(e)+", "+gy.transform(t)+", "+gy.transform(s)+", "+Ph(Qh.transform(a))+")"};function EL(e){let t="",s="",a="",h="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),a=e.substring(5,7),h=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),a=e.substring(3,4),h=e.substring(4,5),t+=t,s+=s,a+=a,h+=h),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(a,16),alpha:h?parseInt(h,16)/255:1}}const z0={test:Ax("#"),parse:EL,transform:rl.transform},vc={test:Ax("hsl","hue"),parse:Wk("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:a=1})=>"hsla("+Math.round(e)+", "+io.transform(Ph(t))+", "+io.transform(Ph(s))+", "+Ph(Qh.transform(a))+")"},Qi={test:e=>rl.test(e)||z0.test(e)||vc.test(e),parse:e=>rl.test(e)?rl.parse(e):vc.test(e)?vc.parse(e):z0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?rl.transform(e):vc.transform(e)},CL=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function PL(e){var t,s;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Px))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(CL))===null||s===void 0?void 0:s.length)||0)>0}const Hk="number",Kk="color",AL="var",IL="var(",Yw="${}",ML=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function td(e){const t=e.toString(),s=[],a={color:[],number:[],var:[]},h=[];let g=0;const c=t.replace(ML,C=>(Qi.test(C)?(a.color.push(g),h.push(Kk),s.push(Qi.parse(C))):C.startsWith(IL)?(a.var.push(g),h.push(AL),s.push(C)):(a.number.push(g),h.push(Hk),s.push(parseFloat(C))),++g,Yw)).split(Yw);return{values:s,split:c,indexes:a,types:h}}function Xk(e){return td(e).values}function Yk(e){const{split:t,types:s}=td(e),a=t.length;return h=>{let g="";for(let v=0;v<a;v++)if(g+=t[v],h[v]!==void 0){const c=s[v];c===Hk?g+=Ph(h[v]):c===Kk?g+=Qi.transform(h[v]):g+=h[v]}return g}}const LL=e=>typeof e=="number"?0:e;function zL(e){const t=Xk(e);return Yk(e)(t.map(LL))}const Sa={test:PL,parse:Xk,createTransformer:Yk,getAnimatableNone:zL},DL=new Set(["brightness","contrast","saturate","opacity"]);function RL(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=s.match(Px)||[];if(!a)return e;const h=s.replace(a,"");let g=DL.has(t)?1:0;return a!==s&&(g*=100),t+"("+g+h+")"}const FL=/\b([a-z-]*)\(.*?\)/gu,D0={...Sa,getAnimatableNone:e=>{const t=e.match(FL);return t?t.map(RL).join(" "):e}},BL={...px,color:Qi,backgroundColor:Qi,outlineColor:Qi,fill:Qi,stroke:Qi,borderColor:Qi,borderTopColor:Qi,borderRightColor:Qi,borderBottomColor:Qi,borderLeftColor:Qi,filter:D0,WebkitFilter:D0},Ix=e=>BL[e];function Jk(e,t){let s=Ix(e);return s!==D0&&(s=Sa),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const NL=new Set(["auto","none","0"]);function jL(e,t,s){let a=0,h;for(;a<e.length&&!h;){const g=e[a];typeof g=="string"&&!NL.has(g)&&td(g).values.length&&(h=e[a]),a++}if(h&&s)for(const g of t)e[g]=Jk(s,h)}const Jw=e=>e===Kc||e===Pt,Qw=(e,t)=>parseFloat(e.split(", ")[t]),eb=(e,t)=>(s,{transform:a})=>{if(a==="none"||!a)return 0;const h=a.match(/^matrix3d\((.+)\)$/u);if(h)return Qw(h[1],t);{const g=a.match(/^matrix\((.+)\)$/u);return g?Qw(g[1],e):0}},OL=new Set(["x","y","z"]),VL=Hc.filter(e=>!OL.has(e));function $L(e){const t=[];return VL.forEach(s=>{const a=e.getValue(s);a!==void 0&&(t.push([s,a.get()]),a.set(s.startsWith("scale")?1:0))}),t}const Vc={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:eb(4,13),y:eb(5,14)};Vc.translateX=Vc.x;Vc.translateY=Vc.y;const al=new Set;let R0=!1,F0=!1;function Qk(){if(F0){const e=Array.from(al).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),s=new Map;t.forEach(a=>{const h=$L(a);h.length&&(s.set(a,h),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const h=s.get(a);h&&h.forEach(([g,v])=>{var c;(c=a.getValue(g))===null||c===void 0||c.set(v)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}F0=!1,R0=!1,al.forEach(e=>e.complete()),al.clear()}function eE(){al.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(F0=!0)})}function UL(){eE(),Qk()}class Mx{constructor(t,s,a,h,g,v=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=s,this.name=a,this.motionValue=h,this.element=g,this.isAsync=v}scheduleResolve(){this.isScheduled=!0,this.isAsync?(al.add(this),R0||(R0=!0,Bn.read(eE),Bn.resolveKeyframes(Qk))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:s,element:a,motionValue:h}=this;for(let g=0;g<t.length;g++)if(t[g]===null)if(g===0){const v=h==null?void 0:h.get(),c=t[t.length-1];if(v!==void 0)t[0]=v;else if(a&&s){const C=a.readValue(s,c);C!=null&&(t[0]=C)}t[0]===void 0&&(t[0]=c),h&&v===void 0&&h.set(t[0])}else t[g]=t[g-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),al.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,al.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const tE=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),qL=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ZL(e){const t=qL.exec(e);if(!t)return[,];const[,s,a,h]=t;return[`--${s??a}`,h]}function nE(e,t,s=1){const[a,h]=ZL(e);if(!a)return;const g=window.getComputedStyle(t).getPropertyValue(a);if(g){const v=g.trim();return tE(v)?parseFloat(v):v}return dx(h)?nE(h,t,s+1):h}const iE=e=>t=>t.test(e),GL={test:e=>e==="auto",parse:e=>e},rE=[Kc,Pt,io,ra,R3,D3,GL],tb=e=>rE.find(iE(e));class sE extends Mx{constructor(t,s,a,h,g){super(t,s,a,h,g,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:s,name:a}=this;if(!s||!s.current)return;super.readKeyframes();for(let C=0;C<t.length;C++){let k=t[C];if(typeof k=="string"&&(k=k.trim(),dx(k))){const L=nE(k,s.current);L!==void 0&&(t[C]=L),C===t.length-1&&(this.finalKeyframe=k)}}if(this.resolveNoneKeyframes(),!Rk.has(a)||t.length!==2)return;const[h,g]=t,v=tb(h),c=tb(g);if(v!==c)if(Jw(v)&&Jw(c))for(let C=0;C<t.length;C++){const k=t[C];typeof k=="string"&&(t[C]=parseFloat(k))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:s}=this,a=[];for(let h=0;h<t.length;h++)bL(t[h])&&a.push(h);a.length&&jL(t,a,s)}measureInitialState(){const{element:t,unresolvedKeyframes:s,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Vc[a](t.measureViewportBox(),window.getComputedStyle(t.current)),s[0]=this.measuredOrigin;const h=s[s.length-1];h!==void 0&&t.getValue(a,h).jump(h,!1)}measureEndState(){var t;const{element:s,name:a,unresolvedKeyframes:h}=this;if(!s||!s.current)return;const g=s.getValue(a);g&&g.jump(this.measuredOrigin,!1);const v=h.length-1,c=h[v];h[v]=Vc[a](s.measureViewportBox(),window.getComputedStyle(s.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([C,k])=>{s.getValue(C).set(k)}),this.resolveNoneKeyframes()}}const nb=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Sa.test(e)||e==="0")&&!e.startsWith("url("));function WL(e){const t=e[0];if(e.length===1)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t)return!0}function HL(e,t,s,a){const h=e[0];if(h===null)return!1;if(t==="display"||t==="visibility")return!0;const g=e[e.length-1],v=nb(h,t),c=nb(g,t);return!v||!c?!1:WL(e)||(s==="spring"||vx(s))&&a}const KL=e=>e!==null;function Cm(e,{repeat:t,repeatType:s="loop"},a){const h=e.filter(KL),g=t&&s!=="loop"&&t%2===1?0:h.length-1;return!g||a===void 0?h[g]:a}const XL=40;class oE{constructor({autoplay:t=!0,delay:s=0,type:a="keyframes",repeat:h=0,repeatDelay:g=0,repeatType:v="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ro.now(),this.options={autoplay:t,delay:s,type:a,repeat:h,repeatDelay:g,repeatType:v,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>XL?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&UL(),this._resolved}onKeyframesResolved(t,s){this.resolvedAt=ro.now(),this.hasAttemptedResolve=!0;const{name:a,type:h,velocity:g,delay:v,onComplete:c,onUpdate:C,isGenerator:k}=this.options;if(!k&&!HL(t,a,h,g))if(v)this.options.duration=0;else{C&&C(Cm(t,this.options,s)),c&&c(),this.resolveFinishedPromise();return}const L=this.initPlayback(t,s);L!==!1&&(this._resolved={keyframes:t,finalKeyframe:s,...L},this.onPostResolved())}onPostResolved(){}then(t,s){return this.currentFinishedPromise.then(t,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Wn=(e,t,s)=>e+(t-e)*s;function yy(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function YL({hue:e,saturation:t,lightness:s,alpha:a}){e/=360,t/=100,s/=100;let h=0,g=0,v=0;if(!t)h=g=v=s;else{const c=s<.5?s*(1+t):s+t-s*t,C=2*s-c;h=yy(C,c,e+1/3),g=yy(C,c,e),v=yy(C,c,e-1/3)}return{red:Math.round(h*255),green:Math.round(g*255),blue:Math.round(v*255),alpha:a}}function Zf(e,t){return s=>s>0?t:e}const _y=(e,t,s)=>{const a=e*e,h=s*(t*t-a)+a;return h<0?0:Math.sqrt(h)},JL=[z0,rl,vc],QL=e=>JL.find(t=>t.test(e));function ib(e){const t=QL(e);if(!t)return!1;let s=t.parse(e);return t===vc&&(s=YL(s)),s}const rb=(e,t)=>{const s=ib(e),a=ib(t);if(!s||!a)return Zf(e,t);const h={...s};return g=>(h.red=_y(s.red,a.red,g),h.green=_y(s.green,a.green,g),h.blue=_y(s.blue,a.blue,g),h.alpha=Wn(s.alpha,a.alpha,g),rl.transform(h))},e4=(e,t)=>s=>t(e(s)),pd=(...e)=>e.reduce(e4),B0=new Set(["none","hidden"]);function t4(e,t){return B0.has(e)?s=>s<=0?e:t:s=>s>=1?t:e}function n4(e,t){return s=>Wn(e,t,s)}function Lx(e){return typeof e=="number"?n4:typeof e=="string"?dx(e)?Zf:Qi.test(e)?rb:s4:Array.isArray(e)?aE:typeof e=="object"?Qi.test(e)?rb:i4:Zf}function aE(e,t){const s=[...e],a=s.length,h=e.map((g,v)=>Lx(g)(g,t[v]));return g=>{for(let v=0;v<a;v++)s[v]=h[v](g);return s}}function i4(e,t){const s={...e,...t},a={};for(const h in s)e[h]!==void 0&&t[h]!==void 0&&(a[h]=Lx(e[h])(e[h],t[h]));return h=>{for(const g in a)s[g]=a[g](h);return s}}function r4(e,t){var s;const a=[],h={color:0,var:0,number:0};for(let g=0;g<t.values.length;g++){const v=t.types[g],c=e.indexes[v][h[v]],C=(s=e.values[c])!==null&&s!==void 0?s:0;a[g]=C,h[v]++}return a}const s4=(e,t)=>{const s=Sa.createTransformer(t),a=td(e),h=td(t);return a.indexes.var.length===h.indexes.var.length&&a.indexes.color.length===h.indexes.color.length&&a.indexes.number.length>=h.indexes.number.length?B0.has(e)&&!h.values.length||B0.has(t)&&!a.values.length?t4(e,t):pd(aE(r4(a,h),h.values),s):Zf(e,t)};function lE(e,t,s){return typeof e=="number"&&typeof t=="number"&&typeof s=="number"?Wn(e,t,s):Lx(e)(e,t)}const o4=5;function cE(e,t,s){const a=Math.max(t-o4,0);return Fk(s-e(a),t-a)}const Qn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},xy=.001;function a4({duration:e=Qn.duration,bounce:t=Qn.bounce,velocity:s=Qn.velocity,mass:a=Qn.mass}){let h,g,v=1-t;v=Do(Qn.minDamping,Qn.maxDamping,v),e=Do(Qn.minDuration,Qn.maxDuration,Ao(e)),v<1?(h=k=>{const L=k*v,B=L*e,F=L-s,oe=N0(k,v),se=Math.exp(-B);return xy-F/oe*se},g=k=>{const B=k*v*e,F=B*s+s,oe=Math.pow(v,2)*Math.pow(k,2)*e,se=Math.exp(-B),re=N0(Math.pow(k,2),v);return(-h(k)+xy>0?-1:1)*((F-oe)*se)/re}):(h=k=>{const L=Math.exp(-k*e),B=(k-s)*e+1;return-xy+L*B},g=k=>{const L=Math.exp(-k*e),B=(s-k)*(e*e);return L*B});const c=5/e,C=c4(h,g,c);if(e=Po(e),isNaN(C))return{stiffness:Qn.stiffness,damping:Qn.damping,duration:e};{const k=Math.pow(C,2)*a;return{stiffness:k,damping:v*2*Math.sqrt(a*k),duration:e}}}const l4=12;function c4(e,t,s){let a=s;for(let h=1;h<l4;h++)a=a-e(a)/t(a);return a}function N0(e,t){return e*Math.sqrt(1-t*t)}const u4=["duration","bounce"],h4=["stiffness","damping","mass"];function sb(e,t){return t.some(s=>e[s]!==void 0)}function d4(e){let t={velocity:Qn.velocity,stiffness:Qn.stiffness,damping:Qn.damping,mass:Qn.mass,isResolvedFromDuration:!1,...e};if(!sb(e,h4)&&sb(e,u4))if(e.visualDuration){const s=e.visualDuration,a=2*Math.PI/(s*1.2),h=a*a,g=2*Do(.05,1,1-(e.bounce||0))*Math.sqrt(h);t={...t,mass:Qn.mass,stiffness:h,damping:g}}else{const s=a4(e);t={...t,...s,mass:Qn.mass},t.isResolvedFromDuration=!0}return t}function uE(e=Qn.visualDuration,t=Qn.bounce){const s=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:h}=s;const g=s.keyframes[0],v=s.keyframes[s.keyframes.length-1],c={done:!1,value:g},{stiffness:C,damping:k,mass:L,duration:B,velocity:F,isResolvedFromDuration:oe}=d4({...s,velocity:-Ao(s.velocity||0)}),se=F||0,re=k/(2*Math.sqrt(C*L)),ue=v-g,Z=Ao(Math.sqrt(C/L)),q=Math.abs(ue)<5;a||(a=q?Qn.restSpeed.granular:Qn.restSpeed.default),h||(h=q?Qn.restDelta.granular:Qn.restDelta.default);let G;if(re<1){const xe=N0(Z,re);G=Ee=>{const Ie=Math.exp(-re*Z*Ee);return v-Ie*((se+re*Z*ue)/xe*Math.sin(xe*Ee)+ue*Math.cos(xe*Ee))}}else if(re===1)G=xe=>v-Math.exp(-Z*xe)*(ue+(se+Z*ue)*xe);else{const xe=Z*Math.sqrt(re*re-1);G=Ee=>{const Ie=Math.exp(-re*Z*Ee),ke=Math.min(xe*Ee,300);return v-Ie*((se+re*Z*ue)*Math.sinh(ke)+xe*ue*Math.cosh(ke))/xe}}const fe={calculatedDuration:oe&&B||null,next:xe=>{const Ee=G(xe);if(oe)c.done=xe>=B;else{let Ie=0;re<1&&(Ie=xe===0?Po(se):cE(G,xe,Ee));const ke=Math.abs(Ie)<=a,it=Math.abs(v-Ee)<=h;c.done=ke&&it}return c.value=c.done?v:Ee,c},toString:()=>{const xe=Math.min(Pk(fe),I0),Ee=Ak(Ie=>fe.next(xe*Ie).value,xe,30);return xe+"ms "+Ee}};return fe}function ob({keyframes:e,velocity:t=0,power:s=.8,timeConstant:a=325,bounceDamping:h=10,bounceStiffness:g=500,modifyTarget:v,min:c,max:C,restDelta:k=.5,restSpeed:L}){const B=e[0],F={done:!1,value:B},oe=ke=>c!==void 0&&ke<c||C!==void 0&&ke>C,se=ke=>c===void 0?C:C===void 0||Math.abs(c-ke)<Math.abs(C-ke)?c:C;let re=s*t;const ue=B+re,Z=v===void 0?ue:v(ue);Z!==ue&&(re=Z-B);const q=ke=>-re*Math.exp(-ke/a),G=ke=>Z+q(ke),fe=ke=>{const it=q(ke),Oe=G(ke);F.done=Math.abs(it)<=k,F.value=F.done?Z:Oe};let xe,Ee;const Ie=ke=>{oe(F.value)&&(xe=ke,Ee=uE({keyframes:[F.value,se(F.value)],velocity:cE(G,ke,F.value),damping:h,stiffness:g,restDelta:k,restSpeed:L}))};return Ie(0),{calculatedDuration:null,next:ke=>{let it=!1;return!Ee&&xe===void 0&&(it=!0,fe(ke),Ie(ke)),xe!==void 0&&ke>=xe?Ee.next(ke-xe):(!it&&fe(ke),F)}}}const p4=dd(.42,0,1,1),f4=dd(0,0,.58,1),hE=dd(.42,0,.58,1),m4=e=>Array.isArray(e)&&typeof e[0]!="number",g4={linear:Wr,easeIn:p4,easeInOut:hE,easeOut:f4,circIn:Cx,circInOut:Zk,circOut:qk,backIn:Ex,backInOut:$k,backOut:Vk,anticipate:Uk},ab=e=>{if(wx(e)){lk(e.length===4);const[t,s,a,h]=e;return dd(t,s,a,h)}else if(typeof e=="string")return g4[e];return e};function y4(e,t,s){const a=[],h=s||lE,g=e.length-1;for(let v=0;v<g;v++){let c=h(e[v],e[v+1]);if(t){const C=Array.isArray(t)?t[v]||Wr:t;c=pd(C,c)}a.push(c)}return a}function _4(e,t,{clamp:s=!0,ease:a,mixer:h}={}){const g=e.length;if(lk(g===t.length),g===1)return()=>t[0];if(g===2&&t[0]===t[1])return()=>t[1];const v=e[0]===e[1];e[0]>e[g-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=y4(t,a,h),C=c.length,k=L=>{if(v&&L<e[0])return t[0];let B=0;if(C>1)for(;B<e.length-2&&!(L<e[B+1]);B++);const F=jc(e[B],e[B+1],L);return c[B](F)};return s?L=>k(Do(e[0],e[g-1],L)):k}function x4(e,t){const s=e[e.length-1];for(let a=1;a<=t;a++){const h=jc(0,t,a);e.push(Wn(s,1,h))}}function v4(e){const t=[0];return x4(t,e.length-1),t}function w4(e,t){return e.map(s=>s*t)}function b4(e,t){return e.map(()=>t||hE).splice(0,e.length-1)}function Gf({duration:e=300,keyframes:t,times:s,ease:a="easeInOut"}){const h=m4(a)?a.map(ab):ab(a),g={done:!1,value:t[0]},v=w4(s&&s.length===t.length?s:v4(t),e),c=_4(v,t,{ease:Array.isArray(h)?h:b4(t,h)});return{calculatedDuration:e,next:C=>(g.value=c(C),g.done=C>=e,g)}}const S4=e=>{const t=({timestamp:s})=>e(s);return{start:()=>Bn.update(t,!0),stop:()=>ba(t),now:()=>Oi.isProcessing?Oi.timestamp:ro.now()}},T4={decay:ob,inertia:ob,tween:Gf,keyframes:Gf,spring:uE},k4=e=>e/100;class zx extends oE{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:C}=this.options;C&&C()};const{name:s,motionValue:a,element:h,keyframes:g}=this.options,v=(h==null?void 0:h.KeyframeResolver)||Mx,c=(C,k)=>this.onKeyframesResolved(C,k);this.resolver=new v(g,c,s,a,h),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:s="keyframes",repeat:a=0,repeatDelay:h=0,repeatType:g,velocity:v=0}=this.options,c=vx(s)?s:T4[s]||Gf;let C,k;c!==Gf&&typeof t[0]!="number"&&(C=pd(k4,lE(t[0],t[1])),t=[0,100]);const L=c({...this.options,keyframes:t});g==="mirror"&&(k=c({...this.options,keyframes:[...t].reverse(),velocity:-v})),L.calculatedDuration===null&&(L.calculatedDuration=Pk(L));const{calculatedDuration:B}=L,F=B+h,oe=F*(a+1)-h;return{generator:L,mirroredGenerator:k,mapPercentToKeyframes:C,calculatedDuration:B,resolvedDuration:F,totalDuration:oe}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,s=!1){const{resolved:a}=this;if(!a){const{keyframes:ke}=this.options;return{done:!0,value:ke[ke.length-1]}}const{finalKeyframe:h,generator:g,mirroredGenerator:v,mapPercentToKeyframes:c,keyframes:C,calculatedDuration:k,totalDuration:L,resolvedDuration:B}=a;if(this.startTime===null)return g.next(0);const{delay:F,repeat:oe,repeatType:se,repeatDelay:re,onUpdate:ue}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-L/this.speed,this.startTime)),s?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const Z=this.currentTime-F*(this.speed>=0?1:-1),q=this.speed>=0?Z<0:Z>L;this.currentTime=Math.max(Z,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=L);let G=this.currentTime,fe=g;if(oe){const ke=Math.min(this.currentTime,L)/B;let it=Math.floor(ke),Oe=ke%1;!Oe&&ke>=1&&(Oe=1),Oe===1&&it--,it=Math.min(it,oe+1),!!(it%2)&&(se==="reverse"?(Oe=1-Oe,re&&(Oe-=re/B)):se==="mirror"&&(fe=v)),G=Do(0,1,Oe)*B}const xe=q?{done:!1,value:C[0]}:fe.next(G);c&&(xe.value=c(xe.value));let{done:Ee}=xe;!q&&k!==null&&(Ee=this.speed>=0?this.currentTime>=L:this.currentTime<=0);const Ie=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Ee);return Ie&&h!==void 0&&(xe.value=Cm(C,this.options,h)),ue&&ue(xe.value),Ie&&this.finish(),xe}get duration(){const{resolved:t}=this;return t?Ao(t.calculatedDuration):0}get time(){return Ao(this.currentTime)}set time(t){t=Po(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const s=this.playbackSpeed!==t;this.playbackSpeed=t,s&&(this.time=Ao(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=S4,onPlay:s,startTime:a}=this.options;this.driver||(this.driver=t(g=>this.tick(g))),s&&s();const h=this.driver.now();this.holdTime!==null?this.startTime=h-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=h):this.startTime=a??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const E4=new Set(["opacity","clipPath","filter","transform"]);function C4(e,t,s,{delay:a=0,duration:h=300,repeat:g=0,repeatType:v="loop",ease:c="easeInOut",times:C}={}){const k={[t]:s};C&&(k.offset=C);const L=Mk(c,h);return Array.isArray(L)&&(k.easing=L),e.animate(k,{delay:a,duration:h,easing:Array.isArray(L)?"linear":L,fill:"both",iterations:g+1,direction:v==="reverse"?"alternate":"normal"})}const P4=sx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Wf=10,A4=2e4;function I4(e){return vx(e.type)||e.type==="spring"||!Ik(e.ease)}function M4(e,t){const s=new zx({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let a={done:!1,value:e[0]};const h=[];let g=0;for(;!a.done&&g<A4;)a=s.sample(g),h.push(a.value),g+=Wf;return{times:void 0,keyframes:h,duration:g-Wf,ease:"linear"}}const dE={anticipate:Uk,backInOut:$k,circInOut:Zk};function L4(e){return e in dE}class lb extends oE{constructor(t){super(t);const{name:s,motionValue:a,element:h,keyframes:g}=this.options;this.resolver=new sE(g,(v,c)=>this.onKeyframesResolved(v,c),s,a,h),this.resolver.scheduleResolve()}initPlayback(t,s){let{duration:a=300,times:h,ease:g,type:v,motionValue:c,name:C,startTime:k}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof g=="string"&&qf()&&L4(g)&&(g=dE[g]),I4(this.options)){const{onComplete:B,onUpdate:F,motionValue:oe,element:se,...re}=this.options,ue=M4(t,re);t=ue.keyframes,t.length===1&&(t[1]=t[0]),a=ue.duration,h=ue.times,g=ue.ease,v="keyframes"}const L=C4(c.owner.current,C,t,{...this.options,duration:a,times:h,ease:g});return L.startTime=k??this.calcStartTime(),this.pendingTimeline?(Gw(L,this.pendingTimeline),this.pendingTimeline=void 0):L.onfinish=()=>{const{onComplete:B}=this.options;c.set(Cm(t,this.options,s)),B&&B(),this.cancel(),this.resolveFinishedPromise()},{animation:L,duration:a,times:h,type:v,ease:g,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:s}=t;return Ao(s)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:s}=t;return Ao(s.currentTime||0)}set time(t){const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.currentTime=Po(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:s}=t;return s.playbackRate}set speed(t){const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:s}=t;return s.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:s}=t;return s.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:s}=this;if(!s)return Wr;const{animation:a}=s;Gw(a,t)}return Wr}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:s,keyframes:a,duration:h,type:g,ease:v,times:c}=t;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:k,onUpdate:L,onComplete:B,element:F,...oe}=this.options,se=new zx({...oe,keyframes:a,duration:h,type:g,ease:v,times:c,isGenerator:!0}),re=Po(this.time);k.setWithVelocity(se.sample(re-Wf).value,se.sample(re).value,Wf)}const{onStop:C}=this.options;C&&C(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:s,name:a,repeatDelay:h,repeatType:g,damping:v,type:c}=t;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:C,transformTemplate:k}=s.owner.getProps();return P4()&&a&&E4.has(a)&&!C&&!k&&!h&&g!=="mirror"&&v!==0&&c!=="inertia"}}const z4={type:"spring",stiffness:500,damping:25,restSpeed:10},D4=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),R4={type:"keyframes",duration:.8},F4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},B4=(e,{keyframes:t})=>t.length>2?R4:xl.has(e)?e.startsWith("scale")?D4(t[1]):z4:F4;function N4({when:e,delay:t,delayChildren:s,staggerChildren:a,staggerDirection:h,repeat:g,repeatType:v,repeatDelay:c,from:C,elapsed:k,...L}){return!!Object.keys(L).length}const Dx=(e,t,s,a={},h,g)=>v=>{const c=xx(a,e)||{},C=c.delay||a.delay||0;let{elapsed:k=0}=a;k=k-Po(C);let L={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-k,onUpdate:F=>{t.set(F),c.onUpdate&&c.onUpdate(F)},onComplete:()=>{v(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:g?void 0:h};N4(c)||(L={...L,...B4(e,L)}),L.duration&&(L.duration=Po(L.duration)),L.repeatDelay&&(L.repeatDelay=Po(L.repeatDelay)),L.from!==void 0&&(L.keyframes[0]=L.from);let B=!1;if((L.type===!1||L.duration===0&&!L.repeatDelay)&&(L.duration=0,L.delay===0&&(B=!0)),B&&!g&&t.get()!==void 0){const F=Cm(L.keyframes,c);if(F!==void 0)return Bn.update(()=>{L.onUpdate(F),L.onComplete()}),new iL([])}return!g&&lb.supports(L)?new lb(L):new zx(L)};function j4({protectedKeys:e,needsAnimating:t},s){const a=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,a}function pE(e,t,{delay:s=0,transitionOverride:a,type:h}={}){var g;let{transition:v=e.getDefaultTransition(),transitionEnd:c,...C}=t;a&&(v=a);const k=[],L=h&&e.animationState&&e.animationState.getState()[h];for(const B in C){const F=e.getValue(B,(g=e.latestValues[B])!==null&&g!==void 0?g:null),oe=C[B];if(oe===void 0||L&&j4(L,B))continue;const se={delay:s,...xx(v||{},B)};let re=!1;if(window.MotionHandoffAnimation){const Z=Bk(e);if(Z){const q=window.MotionHandoffAnimation(Z,B,Bn);q!==null&&(se.startTime=q,re=!0)}}L0(e,B),F.start(Dx(B,F,oe,e.shouldReduceMotion&&Rk.has(B)?{type:!1}:se,e,re));const ue=F.animation;ue&&k.push(ue)}return c&&Promise.all(k).then(()=>{Bn.update(()=>{c&&yL(e,c)})}),k}function j0(e,t,s={}){var a;const h=Em(e,t,s.type==="exit"?(a=e.presenceContext)===null||a===void 0?void 0:a.custom:void 0);let{transition:g=e.getDefaultTransition()||{}}=h||{};s.transitionOverride&&(g=s.transitionOverride);const v=h?()=>Promise.all(pE(e,h,s)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(k=0)=>{const{delayChildren:L=0,staggerChildren:B,staggerDirection:F}=g;return O4(e,t,L+k,B,F,s)}:()=>Promise.resolve(),{when:C}=g;if(C){const[k,L]=C==="beforeChildren"?[v,c]:[c,v];return k().then(()=>L())}else return Promise.all([v(),c(s.delay)])}function O4(e,t,s=0,a=0,h=1,g){const v=[],c=(e.variantChildren.size-1)*a,C=h===1?(k=0)=>k*a:(k=0)=>c-k*a;return Array.from(e.variantChildren).sort(V4).forEach((k,L)=>{k.notify("AnimationStart",t),v.push(j0(k,t,{...g,delay:s+C(L)}).then(()=>k.notify("AnimationComplete",t)))}),Promise.all(v)}function V4(e,t){return e.sortNodePosition(t)}function $4(e,t,s={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const h=t.map(g=>j0(e,g,s));a=Promise.all(h)}else if(typeof t=="string")a=j0(e,t,s);else{const h=typeof t=="function"?Em(e,t,s.custom):t;a=Promise.all(pE(e,h,s))}return a.then(()=>{e.notify("AnimationComplete",t)})}const U4=ax.length;function fE(e){if(!e)return;if(!e.isControllingVariants){const s=e.parent?fE(e.parent)||{}:{};return e.props.initial!==void 0&&(s.initial=e.props.initial),s}const t={};for(let s=0;s<U4;s++){const a=ax[s],h=e.props[a];(Jh(h)||h===!1)&&(t[a]=h)}return t}const q4=[...ox].reverse(),Z4=ox.length;function G4(e){return t=>Promise.all(t.map(({animation:s,options:a})=>$4(e,s,a)))}function W4(e){let t=G4(e),s=cb(),a=!0;const h=C=>(k,L)=>{var B;const F=Em(e,L,C==="exit"?(B=e.presenceContext)===null||B===void 0?void 0:B.custom:void 0);if(F){const{transition:oe,transitionEnd:se,...re}=F;k={...k,...re,...se}}return k};function g(C){t=C(e)}function v(C){const{props:k}=e,L=fE(e.parent)||{},B=[],F=new Set;let oe={},se=1/0;for(let ue=0;ue<Z4;ue++){const Z=q4[ue],q=s[Z],G=k[Z]!==void 0?k[Z]:L[Z],fe=Jh(G),xe=Z===C?q.isActive:null;xe===!1&&(se=ue);let Ee=G===L[Z]&&G!==k[Z]&&fe;if(Ee&&a&&e.manuallyAnimateOnMount&&(Ee=!1),q.protectedKeys={...oe},!q.isActive&&xe===null||!G&&!q.prevProp||Tm(G)||typeof G=="boolean")continue;const Ie=H4(q.prevProp,G);let ke=Ie||Z===C&&q.isActive&&!Ee&&fe||ue>se&&fe,it=!1;const Oe=Array.isArray(G)?G:[G];let At=Oe.reduce(h(Z),{});xe===!1&&(At={});const{prevResolvedValues:Ct={}}=q,It={...Ct,...At},Ut=rt=>{ke=!0,F.has(rt)&&(it=!0,F.delete(rt)),q.needsAnimating[rt]=!0;const Re=e.getValue(rt);Re&&(Re.liveStyle=!1)};for(const rt in It){const Re=At[rt],at=Ct[rt];if(oe.hasOwnProperty(rt))continue;let Ne=!1;A0(Re)&&A0(at)?Ne=!Ck(Re,at):Ne=Re!==at,Ne?Re!=null?Ut(rt):F.add(rt):Re!==void 0&&F.has(rt)?Ut(rt):q.protectedKeys[rt]=!0}q.prevProp=G,q.prevResolvedValues=At,q.isActive&&(oe={...oe,...At}),a&&e.blockInitialAnimation&&(ke=!1),ke&&(!(Ee&&Ie)||it)&&B.push(...Oe.map(rt=>({animation:rt,options:{type:Z}})))}if(F.size){const ue={};F.forEach(Z=>{const q=e.getBaseTarget(Z),G=e.getValue(Z);G&&(G.liveStyle=!0),ue[Z]=q??null}),B.push({animation:ue})}let re=!!B.length;return a&&(k.initial===!1||k.initial===k.animate)&&!e.manuallyAnimateOnMount&&(re=!1),a=!1,re?t(B):Promise.resolve()}function c(C,k){var L;if(s[C].isActive===k)return Promise.resolve();(L=e.variantChildren)===null||L===void 0||L.forEach(F=>{var oe;return(oe=F.animationState)===null||oe===void 0?void 0:oe.setActive(C,k)}),s[C].isActive=k;const B=v(C);for(const F in s)s[F].protectedKeys={};return B}return{animateChanges:v,setActive:c,setAnimateFunction:g,getState:()=>s,reset:()=>{s=cb(),a=!0}}}function H4(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Ck(t,e):!1}function Ka(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cb(){return{animate:Ka(!0),whileInView:Ka(),whileHover:Ka(),whileTap:Ka(),whileDrag:Ka(),whileFocus:Ka(),exit:Ka()}}class Ca{constructor(t){this.isMounted=!1,this.node=t}update(){}}class K4 extends Ca{constructor(t){super(t),t.animationState||(t.animationState=W4(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Tm(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let X4=0;class Y4 extends Ca{constructor(){super(...arguments),this.id=X4++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const h=this.node.animationState.setActive("exit",!t);s&&!t&&h.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const J4={animation:{Feature:K4},exit:{Feature:Y4}};function nd(e,t,s,a={passive:!0}){return e.addEventListener(t,s,a),()=>e.removeEventListener(t,s)}function fd(e){return{point:{x:e.pageX,y:e.pageY}}}const Q4=e=>t=>bx(t)&&e(t,fd(t));function Ah(e,t,s,a){return nd(e,t,Q4(s),a)}const ub=(e,t)=>Math.abs(e-t);function ez(e,t){const s=ub(e.x,t.x),a=ub(e.y,t.y);return Math.sqrt(s**2+a**2)}class mE{constructor(t,s,{transformPagePoint:a,contextWindow:h,dragSnapToOrigin:g=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const B=wy(this.lastMoveEventInfo,this.history),F=this.startEvent!==null,oe=ez(B.offset,{x:0,y:0})>=3;if(!F&&!oe)return;const{point:se}=B,{timestamp:re}=Oi;this.history.push({...se,timestamp:re});const{onStart:ue,onMove:Z}=this.handlers;F||(ue&&ue(this.lastMoveEvent,B),this.startEvent=this.lastMoveEvent),Z&&Z(this.lastMoveEvent,B)},this.handlePointerMove=(B,F)=>{this.lastMoveEvent=B,this.lastMoveEventInfo=vy(F,this.transformPagePoint),Bn.update(this.updatePoint,!0)},this.handlePointerUp=(B,F)=>{this.end();const{onEnd:oe,onSessionEnd:se,resumeAnimation:re}=this.handlers;if(this.dragSnapToOrigin&&re&&re(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ue=wy(B.type==="pointercancel"?this.lastMoveEventInfo:vy(F,this.transformPagePoint),this.history);this.startEvent&&oe&&oe(B,ue),se&&se(B,ue)},!bx(t))return;this.dragSnapToOrigin=g,this.handlers=s,this.transformPagePoint=a,this.contextWindow=h||window;const v=fd(t),c=vy(v,this.transformPagePoint),{point:C}=c,{timestamp:k}=Oi;this.history=[{...C,timestamp:k}];const{onSessionStart:L}=s;L&&L(t,wy(c,this.history)),this.removeListeners=pd(Ah(this.contextWindow,"pointermove",this.handlePointerMove),Ah(this.contextWindow,"pointerup",this.handlePointerUp),Ah(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ba(this.updatePoint)}}function vy(e,t){return t?{point:t(e.point)}:e}function hb(e,t){return{x:e.x-t.x,y:e.y-t.y}}function wy({point:e},t){return{point:e,delta:hb(e,gE(t)),offset:hb(e,tz(t)),velocity:nz(t,.1)}}function tz(e){return e[0]}function gE(e){return e[e.length-1]}function nz(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,a=null;const h=gE(e);for(;s>=0&&(a=e[s],!(h.timestamp-a.timestamp>Po(t)));)s--;if(!a)return{x:0,y:0};const g=Ao(h.timestamp-a.timestamp);if(g===0)return{x:0,y:0};const v={x:(h.x-a.x)/g,y:(h.y-a.y)/g};return v.x===1/0&&(v.x=0),v.y===1/0&&(v.y=0),v}const yE=1e-4,iz=1-yE,rz=1+yE,_E=.01,sz=0-_E,oz=0+_E;function Kr(e){return e.max-e.min}function az(e,t,s){return Math.abs(e-t)<=s}function db(e,t,s,a=.5){e.origin=a,e.originPoint=Wn(t.min,t.max,e.origin),e.scale=Kr(s)/Kr(t),e.translate=Wn(s.min,s.max,e.origin)-e.originPoint,(e.scale>=iz&&e.scale<=rz||isNaN(e.scale))&&(e.scale=1),(e.translate>=sz&&e.translate<=oz||isNaN(e.translate))&&(e.translate=0)}function Ih(e,t,s,a){db(e.x,t.x,s.x,a?a.originX:void 0),db(e.y,t.y,s.y,a?a.originY:void 0)}function pb(e,t,s){e.min=s.min+t.min,e.max=e.min+Kr(t)}function lz(e,t,s){pb(e.x,t.x,s.x),pb(e.y,t.y,s.y)}function fb(e,t,s){e.min=t.min-s.min,e.max=e.min+Kr(t)}function Mh(e,t,s){fb(e.x,t.x,s.x),fb(e.y,t.y,s.y)}function cz(e,{min:t,max:s},a){return t!==void 0&&e<t?e=a?Wn(t,e,a.min):Math.max(e,t):s!==void 0&&e>s&&(e=a?Wn(s,e,a.max):Math.min(e,s)),e}function mb(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function uz(e,{top:t,left:s,bottom:a,right:h}){return{x:mb(e.x,s,h),y:mb(e.y,t,a)}}function gb(e,t){let s=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,a]=[a,s]),{min:s,max:a}}function hz(e,t){return{x:gb(e.x,t.x),y:gb(e.y,t.y)}}function dz(e,t){let s=.5;const a=Kr(e),h=Kr(t);return h>a?s=jc(t.min,t.max-a,e.min):a>h&&(s=jc(e.min,e.max-h,t.min)),Do(0,1,s)}function pz(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const O0=.35;function fz(e=O0){return e===!1?e=0:e===!0&&(e=O0),{x:yb(e,"left","right"),y:yb(e,"top","bottom")}}function yb(e,t,s){return{min:_b(e,t),max:_b(e,s)}}function _b(e,t){return typeof e=="number"?e:e[t]||0}const xb=()=>({translate:0,scale:1,origin:0,originPoint:0}),wc=()=>({x:xb(),y:xb()}),vb=()=>({min:0,max:0}),ui=()=>({x:vb(),y:vb()});function ls(e){return[e("x"),e("y")]}function xE({top:e,left:t,right:s,bottom:a}){return{x:{min:t,max:s},y:{min:e,max:a}}}function mz({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function gz(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:a.y,right:a.x}}function by(e){return e===void 0||e===1}function V0({scale:e,scaleX:t,scaleY:s}){return!by(e)||!by(t)||!by(s)}function Ja(e){return V0(e)||vE(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function vE(e){return wb(e.x)||wb(e.y)}function wb(e){return e&&e!=="0%"}function Hf(e,t,s){const a=e-s,h=t*a;return s+h}function bb(e,t,s,a,h){return h!==void 0&&(e=Hf(e,h,a)),Hf(e,s,a)+t}function $0(e,t=0,s=1,a,h){e.min=bb(e.min,t,s,a,h),e.max=bb(e.max,t,s,a,h)}function wE(e,{x:t,y:s}){$0(e.x,t.translate,t.scale,t.originPoint),$0(e.y,s.translate,s.scale,s.originPoint)}const Sb=.999999999999,Tb=1.0000000000001;function yz(e,t,s,a=!1){const h=s.length;if(!h)return;t.x=t.y=1;let g,v;for(let c=0;c<h;c++){g=s[c],v=g.projectionDelta;const{visualElement:C}=g.options;C&&C.props.style&&C.props.style.display==="contents"||(a&&g.options.layoutScroll&&g.scroll&&g!==g.root&&Sc(e,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),v&&(t.x*=v.x.scale,t.y*=v.y.scale,wE(e,v)),a&&Ja(g.latestValues)&&Sc(e,g.latestValues))}t.x<Tb&&t.x>Sb&&(t.x=1),t.y<Tb&&t.y>Sb&&(t.y=1)}function bc(e,t){e.min=e.min+t,e.max=e.max+t}function kb(e,t,s,a,h=.5){const g=Wn(e.min,e.max,h);$0(e,t,s,g,a)}function Sc(e,t){kb(e.x,t.x,t.scaleX,t.scale,t.originX),kb(e.y,t.y,t.scaleY,t.scale,t.originY)}function bE(e,t){return xE(gz(e.getBoundingClientRect(),t))}function _z(e,t,s){const a=bE(e,s),{scroll:h}=t;return h&&(bc(a.x,h.offset.x),bc(a.y,h.offset.y)),a}const SE=({current:e})=>e?e.ownerDocument.defaultView:null,xz=new WeakMap;class vz{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ui(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const h=L=>{const{dragSnapToOrigin:B}=this.getProps();B?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(fd(L).point)},g=(L,B)=>{const{drag:F,dragPropagation:oe,onDragStart:se}=this.getProps();if(F&&!oe&&(this.openDragLock&&this.openDragLock(),this.openDragLock=dL(F),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ls(ue=>{let Z=this.getAxisMotionValue(ue).get()||0;if(io.test(Z)){const{projection:q}=this.visualElement;if(q&&q.layout){const G=q.layout.layoutBox[ue];G&&(Z=Kr(G)*(parseFloat(Z)/100))}}this.originPoint[ue]=Z}),se&&Bn.postRender(()=>se(L,B)),L0(this.visualElement,"transform");const{animationState:re}=this.visualElement;re&&re.setActive("whileDrag",!0)},v=(L,B)=>{const{dragPropagation:F,dragDirectionLock:oe,onDirectionLock:se,onDrag:re}=this.getProps();if(!F&&!this.openDragLock)return;const{offset:ue}=B;if(oe&&this.currentDirection===null){this.currentDirection=wz(ue),this.currentDirection!==null&&se&&se(this.currentDirection);return}this.updateAxis("x",B.point,ue),this.updateAxis("y",B.point,ue),this.visualElement.render(),re&&re(L,B)},c=(L,B)=>this.stop(L,B),C=()=>ls(L=>{var B;return this.getAnimationState(L)==="paused"&&((B=this.getAxisMotionValue(L).animation)===null||B===void 0?void 0:B.play())}),{dragSnapToOrigin:k}=this.getProps();this.panSession=new mE(t,{onSessionStart:h,onStart:g,onMove:v,onSessionEnd:c,resumeAnimation:C},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:k,contextWindow:SE(this.visualElement)})}stop(t,s){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:h}=s;this.startAnimation(h);const{onDragEnd:g}=this.getProps();g&&Bn.postRender(()=>g(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,a){const{drag:h}=this.getProps();if(!a||!qp(t,h,this.currentDirection))return;const g=this.getAxisMotionValue(t);let v=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(v=cz(v,this.constraints[t],this.elastic[t])),g.set(v)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:a}=this.getProps(),h=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,g=this.constraints;s&&xc(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&h?this.constraints=uz(h.layoutBox,s):this.constraints=!1,this.elastic=fz(a),g!==this.constraints&&h&&this.constraints&&!this.hasMutatedConstraints&&ls(v=>{this.constraints!==!1&&this.getAxisMotionValue(v)&&(this.constraints[v]=pz(h.layoutBox[v],this.constraints[v]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!xc(t))return!1;const a=t.current,{projection:h}=this.visualElement;if(!h||!h.layout)return!1;const g=_z(a,h.root,this.visualElement.getTransformPagePoint());let v=hz(h.layout.layoutBox,g);if(s){const c=s(mz(v));this.hasMutatedConstraints=!!c,c&&(v=xE(c))}return v}startAnimation(t){const{drag:s,dragMomentum:a,dragElastic:h,dragTransition:g,dragSnapToOrigin:v,onDragTransitionEnd:c}=this.getProps(),C=this.constraints||{},k=ls(L=>{if(!qp(L,s,this.currentDirection))return;let B=C&&C[L]||{};v&&(B={min:0,max:0});const F=h?200:1e6,oe=h?40:1e7,se={type:"inertia",velocity:a?t[L]:0,bounceStiffness:F,bounceDamping:oe,timeConstant:750,restDelta:1,restSpeed:10,...g,...B};return this.startAxisValueAnimation(L,se)});return Promise.all(k).then(c)}startAxisValueAnimation(t,s){const a=this.getAxisMotionValue(t);return L0(this.visualElement,t),a.start(Dx(t,a,0,s,this.visualElement,!1))}stopAnimation(){ls(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ls(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),h=a[s];return h||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){ls(s=>{const{drag:a}=this.getProps();if(!qp(s,a,this.currentDirection))return;const{projection:h}=this.visualElement,g=this.getAxisMotionValue(s);if(h&&h.layout){const{min:v,max:c}=h.layout.layoutBox[s];g.set(t[s]-Wn(v,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:a}=this.visualElement;if(!xc(s)||!a||!this.constraints)return;this.stopAnimation();const h={x:0,y:0};ls(v=>{const c=this.getAxisMotionValue(v);if(c&&this.constraints!==!1){const C=c.get();h[v]=dz({min:C,max:C},this.constraints[v])}});const{transformTemplate:g}=this.visualElement.getProps();this.visualElement.current.style.transform=g?g({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),ls(v=>{if(!qp(v,t,null))return;const c=this.getAxisMotionValue(v),{min:C,max:k}=this.constraints[v];c.set(Wn(C,k,h[v]))})}addListeners(){if(!this.visualElement.current)return;xz.set(this.visualElement,this);const t=this.visualElement.current,s=Ah(t,"pointerdown",C=>{const{drag:k,dragListener:L=!0}=this.getProps();k&&L&&this.start(C)}),a=()=>{const{dragConstraints:C}=this.getProps();xc(C)&&C.current&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,g=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),Bn.read(a);const v=nd(window,"resize",()=>this.scalePositionWithinConstraints()),c=h.addEventListener("didUpdate",({delta:C,hasLayoutChanged:k})=>{this.isDragging&&k&&(ls(L=>{const B=this.getAxisMotionValue(L);B&&(this.originPoint[L]+=C[L].translate,B.set(B.get()+C[L].translate))}),this.visualElement.render())});return()=>{v(),s(),g(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:a=!1,dragPropagation:h=!1,dragConstraints:g=!1,dragElastic:v=O0,dragMomentum:c=!0}=t;return{...t,drag:s,dragDirectionLock:a,dragPropagation:h,dragConstraints:g,dragElastic:v,dragMomentum:c}}}function qp(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function wz(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class bz extends Ca{constructor(t){super(t),this.removeGroupControls=Wr,this.removeListeners=Wr,this.controls=new vz(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Wr}unmount(){this.removeGroupControls(),this.removeListeners()}}const Eb=e=>(t,s)=>{e&&Bn.postRender(()=>e(t,s))};class Sz extends Ca{constructor(){super(...arguments),this.removePointerDownListener=Wr}onPointerDown(t){this.session=new mE(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:SE(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:a,onPanEnd:h}=this.node.getProps();return{onSessionStart:Eb(t),onStart:Eb(s),onMove:a,onEnd:(g,v)=>{delete this.session,h&&Bn.postRender(()=>h(g,v))}}}mount(){this.removePointerDownListener=Ah(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ff={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Cb(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const hh={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Pt.test(e))e=parseFloat(e);else return e;const s=Cb(e,t.target.x),a=Cb(e,t.target.y);return`${s}% ${a}%`}},Tz={correct:(e,{treeScale:t,projectionDelta:s})=>{const a=e,h=Sa.parse(e);if(h.length>5)return a;const g=Sa.createTransformer(e),v=typeof h[0]!="number"?1:0,c=s.x.scale*t.x,C=s.y.scale*t.y;h[0+v]/=c,h[1+v]/=C;const k=Wn(c,C,.5);return typeof h[2+v]=="number"&&(h[2+v]/=k),typeof h[3+v]=="number"&&(h[3+v]/=k),g(h)}};class kz extends ce.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:a,layoutId:h}=this.props,{projection:g}=t;Z3(Ez),g&&(s.group&&s.group.add(g),a&&a.register&&h&&a.register(g),g.root.didUpdate(),g.addEventListener("animationComplete",()=>{this.safeToRemove()}),g.setOptions({...g.options,onExitComplete:()=>this.safeToRemove()})),ff.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:a,drag:h,isPresent:g}=this.props,v=a.projection;return v&&(v.isPresent=g,h||t.layoutDependency!==s||s===void 0?v.willUpdate():this.safeToRemove(),t.isPresent!==g&&(g?v.promote():v.relegate()||Bn.postRender(()=>{const c=v.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),cx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:a}=this.props,{projection:h}=t;h&&(h.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(h),a&&a.deregister&&a.deregister(h))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function TE(e){const[t,s]=ok(),a=ce.useContext(tx);return R.jsx(kz,{...e,layoutGroup:a,switchLayoutGroup:ce.useContext(fk),isPresent:t,safeToRemove:s})}const Ez={borderRadius:{...hh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hh,borderTopRightRadius:hh,borderBottomLeftRadius:hh,borderBottomRightRadius:hh,boxShadow:Tz};function Cz(e,t,s){const a=nr(e)?e:ed(e);return a.start(Dx("",a,t,s)),a.animation}function Pz(e){return e instanceof SVGElement&&e.tagName!=="svg"}const Az=(e,t)=>e.depth-t.depth;class Iz{constructor(){this.children=[],this.isDirty=!1}add(t){Sx(this.children,t),this.isDirty=!0}remove(t){Tx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Az),this.isDirty=!1,this.children.forEach(t)}}function Mz(e,t){const s=ro.now(),a=({timestamp:h})=>{const g=h-s;g>=t&&(ba(a),e(g-t))};return Bn.read(a,!0),()=>ba(a)}const kE=["TopLeft","TopRight","BottomLeft","BottomRight"],Lz=kE.length,Pb=e=>typeof e=="string"?parseFloat(e):e,Ab=e=>typeof e=="number"||Pt.test(e);function zz(e,t,s,a,h,g){h?(e.opacity=Wn(0,s.opacity!==void 0?s.opacity:1,Dz(a)),e.opacityExit=Wn(t.opacity!==void 0?t.opacity:1,0,Rz(a))):g&&(e.opacity=Wn(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,a));for(let v=0;v<Lz;v++){const c=`border${kE[v]}Radius`;let C=Ib(t,c),k=Ib(s,c);if(C===void 0&&k===void 0)continue;C||(C=0),k||(k=0),C===0||k===0||Ab(C)===Ab(k)?(e[c]=Math.max(Wn(Pb(C),Pb(k),a),0),(io.test(k)||io.test(C))&&(e[c]+="%")):e[c]=k}(t.rotate||s.rotate)&&(e.rotate=Wn(t.rotate||0,s.rotate||0,a))}function Ib(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Dz=EE(0,.5,qk),Rz=EE(.5,.95,Wr);function EE(e,t,s){return a=>a<e?0:a>t?1:s(jc(e,t,a))}function Mb(e,t){e.min=t.min,e.max=t.max}function as(e,t){Mb(e.x,t.x),Mb(e.y,t.y)}function Lb(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function zb(e,t,s,a,h){return e-=t,e=Hf(e,1/s,a),h!==void 0&&(e=Hf(e,1/h,a)),e}function Fz(e,t=0,s=1,a=.5,h,g=e,v=e){if(io.test(t)&&(t=parseFloat(t),t=Wn(v.min,v.max,t/100)-v.min),typeof t!="number")return;let c=Wn(g.min,g.max,a);e===g&&(c-=t),e.min=zb(e.min,t,s,c,h),e.max=zb(e.max,t,s,c,h)}function Db(e,t,[s,a,h],g,v){Fz(e,t[s],t[a],t[h],t.scale,g,v)}const Bz=["x","scaleX","originX"],Nz=["y","scaleY","originY"];function Rb(e,t,s,a){Db(e.x,t,Bz,s?s.x:void 0,a?a.x:void 0),Db(e.y,t,Nz,s?s.y:void 0,a?a.y:void 0)}function Fb(e){return e.translate===0&&e.scale===1}function CE(e){return Fb(e.x)&&Fb(e.y)}function Bb(e,t){return e.min===t.min&&e.max===t.max}function jz(e,t){return Bb(e.x,t.x)&&Bb(e.y,t.y)}function Nb(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function PE(e,t){return Nb(e.x,t.x)&&Nb(e.y,t.y)}function jb(e){return Kr(e.x)/Kr(e.y)}function Ob(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Oz{constructor(){this.members=[]}add(t){Sx(this.members,t),t.scheduleRender()}remove(t){if(Tx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(h=>t===h);if(s===0)return!1;let a;for(let h=s;h>=0;h--){const g=this.members[h];if(g.isPresent!==!1){a=g;break}}return a?(this.promote(a),!0):!1}promote(t,s){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,s&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:h}=t.options;h===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:a}=t;s.onExitComplete&&s.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Vz(e,t,s){let a="";const h=e.x.translate/t.x,g=e.y.translate/t.y,v=(s==null?void 0:s.z)||0;if((h||g||v)&&(a=`translate3d(${h}px, ${g}px, ${v}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),s){const{transformPerspective:k,rotate:L,rotateX:B,rotateY:F,skewX:oe,skewY:se}=s;k&&(a=`perspective(${k}px) ${a}`),L&&(a+=`rotate(${L}deg) `),B&&(a+=`rotateX(${B}deg) `),F&&(a+=`rotateY(${F}deg) `),oe&&(a+=`skewX(${oe}deg) `),se&&(a+=`skewY(${se}deg) `)}const c=e.x.scale*t.x,C=e.y.scale*t.y;return(c!==1||C!==1)&&(a+=`scale(${c}, ${C})`),a||"none"}const Qa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},_h=typeof window<"u"&&window.MotionDebug!==void 0,Sy=["","X","Y","Z"],$z={visibility:"hidden"},Vb=1e3;let Uz=0;function Ty(e,t,s,a){const{latestValues:h}=t;h[e]&&(s[e]=h[e],t.setStaticValue(e,0),a&&(a[e]=0))}function AE(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const s=Bk(t);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:h,layoutId:g}=e.options;window.MotionCancelOptimisedAnimation(s,"transform",Bn,!(h||g))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&AE(a)}function IE({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:a,resetTransform:h}){return class{constructor(v={},c=t==null?void 0:t()){this.id=Uz++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,_h&&(Qa.totalNodes=Qa.resolvedTargetDeltas=Qa.recalculatedProjection=0),this.nodes.forEach(Gz),this.nodes.forEach(Yz),this.nodes.forEach(Jz),this.nodes.forEach(Wz),_h&&window.MotionDebug.record(Qa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=v,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let C=0;C<this.path.length;C++)this.path[C].shouldResetTransform=!0;this.root===this&&(this.nodes=new Iz)}addEventListener(v,c){return this.eventHandlers.has(v)||this.eventHandlers.set(v,new kx),this.eventHandlers.get(v).add(c)}notifyListeners(v,...c){const C=this.eventHandlers.get(v);C&&C.notify(...c)}hasListeners(v){return this.eventHandlers.has(v)}mount(v,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Pz(v),this.instance=v;const{layoutId:C,layout:k,visualElement:L}=this.options;if(L&&!L.current&&L.mount(v),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(k||C)&&(this.isLayoutDirty=!0),e){let B;const F=()=>this.root.updateBlockedByResize=!1;e(v,()=>{this.root.updateBlockedByResize=!0,B&&B(),B=Mz(F,250),ff.hasAnimatedSinceResize&&(ff.hasAnimatedSinceResize=!1,this.nodes.forEach(Ub))})}C&&this.root.registerSharedNode(C,this),this.options.animate!==!1&&L&&(C||k)&&this.addEventListener("didUpdate",({delta:B,hasLayoutChanged:F,hasRelativeTargetChanged:oe,layout:se})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const re=this.options.transition||L.getDefaultTransition()||iD,{onLayoutAnimationStart:ue,onLayoutAnimationComplete:Z}=L.getProps(),q=!this.targetLayout||!PE(this.targetLayout,se)||oe,G=!F&&oe;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||G||F&&(q||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(B,G);const fe={...xx(re,"layout"),onPlay:ue,onComplete:Z};(L.shouldReduceMotion||this.options.layoutRoot)&&(fe.delay=0,fe.type=!1),this.startAnimation(fe)}else F||Ub(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=se})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const v=this.getStack();v&&v.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ba(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Qz),this.animationId++)}getTransformTemplate(){const{visualElement:v}=this.options;return v&&v.getProps().transformTemplate}willUpdate(v=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&AE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let L=0;L<this.path.length;L++){const B=this.path[L];B.shouldResetTransform=!0,B.updateScroll("snapshot"),B.options.layoutRoot&&B.willUpdate(!1)}const{layoutId:c,layout:C}=this.options;if(c===void 0&&!C)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),v&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach($b);return}this.isUpdating||this.nodes.forEach(Kz),this.isUpdating=!1,this.nodes.forEach(Xz),this.nodes.forEach(qz),this.nodes.forEach(Zz),this.clearAllSnapshots();const c=ro.now();Oi.delta=Do(0,1e3/60,c-Oi.timestamp),Oi.timestamp=c,Oi.isProcessing=!0,fy.update.process(Oi),fy.preRender.process(Oi),fy.render.process(Oi),Oi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,cx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Hz),this.sharedNodes.forEach(eD)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Bn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Bn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let C=0;C<this.path.length;C++)this.path[C].updateScroll();const v=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ui(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,v?v.layoutBox:void 0)}updateScroll(v="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===v&&(c=!1),c){const C=a(this.instance);this.scroll={animationId:this.root.animationId,phase:v,isRoot:C,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:C}}}resetTransform(){if(!h)return;const v=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!CE(this.projectionDelta),C=this.getTransformTemplate(),k=C?C(this.latestValues,""):void 0,L=k!==this.prevTransformTemplateValue;v&&(c||Ja(this.latestValues)||L)&&(h(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(v=!0){const c=this.measurePageBox();let C=this.removeElementScroll(c);return v&&(C=this.removeTransform(C)),rD(C),{animationId:this.root.animationId,measuredBox:c,layoutBox:C,latestValues:{},source:this.id}}measurePageBox(){var v;const{visualElement:c}=this.options;if(!c)return ui();const C=c.measureViewportBox();if(!(((v=this.scroll)===null||v===void 0?void 0:v.wasRoot)||this.path.some(sD))){const{scroll:L}=this.root;L&&(bc(C.x,L.offset.x),bc(C.y,L.offset.y))}return C}removeElementScroll(v){var c;const C=ui();if(as(C,v),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return C;for(let k=0;k<this.path.length;k++){const L=this.path[k],{scroll:B,options:F}=L;L!==this.root&&B&&F.layoutScroll&&(B.wasRoot&&as(C,v),bc(C.x,B.offset.x),bc(C.y,B.offset.y))}return C}applyTransform(v,c=!1){const C=ui();as(C,v);for(let k=0;k<this.path.length;k++){const L=this.path[k];!c&&L.options.layoutScroll&&L.scroll&&L!==L.root&&Sc(C,{x:-L.scroll.offset.x,y:-L.scroll.offset.y}),Ja(L.latestValues)&&Sc(C,L.latestValues)}return Ja(this.latestValues)&&Sc(C,this.latestValues),C}removeTransform(v){const c=ui();as(c,v);for(let C=0;C<this.path.length;C++){const k=this.path[C];if(!k.instance||!Ja(k.latestValues))continue;V0(k.latestValues)&&k.updateSnapshot();const L=ui(),B=k.measurePageBox();as(L,B),Rb(c,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,L)}return Ja(this.latestValues)&&Rb(c,this.latestValues),c}setTargetDelta(v){this.targetDelta=v,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(v){this.options={...this.options,...v,crossfade:v.crossfade!==void 0?v.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Oi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(v=!1){var c;const C=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=C.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=C.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=C.isSharedProjectionDirty);const k=!!this.resumingFrom||this!==C;if(!(v||k&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:B,layoutId:F}=this.options;if(!(!this.layout||!(B||F))){if(this.resolvedRelativeTargetAt=Oi.timestamp,!this.targetDelta&&!this.relativeTarget){const oe=this.getClosestProjectingParent();oe&&oe.layout&&this.animationProgress!==1?(this.relativeParent=oe,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ui(),this.relativeTargetOrigin=ui(),Mh(this.relativeTargetOrigin,this.layout.layoutBox,oe.layout.layoutBox),as(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ui(),this.targetWithTransforms=ui()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),lz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):as(this.target,this.layout.layoutBox),wE(this.target,this.targetDelta)):as(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const oe=this.getClosestProjectingParent();oe&&!!oe.resumingFrom==!!this.resumingFrom&&!oe.options.layoutScroll&&oe.target&&this.animationProgress!==1?(this.relativeParent=oe,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ui(),this.relativeTargetOrigin=ui(),Mh(this.relativeTargetOrigin,this.target,oe.target),as(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}_h&&Qa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||V0(this.parent.latestValues)||vE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var v;const c=this.getLead(),C=!!this.resumingFrom||this!==c;let k=!0;if((this.isProjectionDirty||!((v=this.parent)===null||v===void 0)&&v.isProjectionDirty)&&(k=!1),C&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(k=!1),this.resolvedRelativeTargetAt===Oi.timestamp&&(k=!1),k)return;const{layout:L,layoutId:B}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(L||B))return;as(this.layoutCorrected,this.layout.layoutBox);const F=this.treeScale.x,oe=this.treeScale.y;yz(this.layoutCorrected,this.treeScale,this.path,C),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=ui());const{target:se}=c;if(!se){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Lb(this.prevProjectionDelta.x,this.projectionDelta.x),Lb(this.prevProjectionDelta.y,this.projectionDelta.y)),Ih(this.projectionDelta,this.layoutCorrected,se,this.latestValues),(this.treeScale.x!==F||this.treeScale.y!==oe||!Ob(this.projectionDelta.x,this.prevProjectionDelta.x)||!Ob(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",se)),_h&&Qa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(v=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),v){const C=this.getStack();C&&C.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=wc(),this.projectionDelta=wc(),this.projectionDeltaWithTransform=wc()}setAnimationOrigin(v,c=!1){const C=this.snapshot,k=C?C.latestValues:{},L={...this.latestValues},B=wc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const F=ui(),oe=C?C.source:void 0,se=this.layout?this.layout.source:void 0,re=oe!==se,ue=this.getStack(),Z=!ue||ue.members.length<=1,q=!!(re&&!Z&&this.options.crossfade===!0&&!this.path.some(nD));this.animationProgress=0;let G;this.mixTargetDelta=fe=>{const xe=fe/1e3;qb(B.x,v.x,xe),qb(B.y,v.y,xe),this.setTargetDelta(B),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Mh(F,this.layout.layoutBox,this.relativeParent.layout.layoutBox),tD(this.relativeTarget,this.relativeTargetOrigin,F,xe),G&&jz(this.relativeTarget,G)&&(this.isProjectionDirty=!1),G||(G=ui()),as(G,this.relativeTarget)),re&&(this.animationValues=L,zz(L,k,this.latestValues,xe,q,Z)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=xe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(v){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ba(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Bn.update(()=>{ff.hasAnimatedSinceResize=!0,this.currentAnimation=Cz(0,Vb,{...v,onUpdate:c=>{this.mixTargetDelta(c),v.onUpdate&&v.onUpdate(c)},onComplete:()=>{v.onComplete&&v.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const v=this.getStack();v&&v.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Vb),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const v=this.getLead();let{targetWithTransforms:c,target:C,layout:k,latestValues:L}=v;if(!(!c||!C||!k)){if(this!==v&&this.layout&&k&&ME(this.options.animationType,this.layout.layoutBox,k.layoutBox)){C=this.target||ui();const B=Kr(this.layout.layoutBox.x);C.x.min=v.target.x.min,C.x.max=C.x.min+B;const F=Kr(this.layout.layoutBox.y);C.y.min=v.target.y.min,C.y.max=C.y.min+F}as(c,C),Sc(c,L),Ih(this.projectionDeltaWithTransform,this.layoutCorrected,c,L)}}registerSharedNode(v,c){this.sharedNodes.has(v)||this.sharedNodes.set(v,new Oz),this.sharedNodes.get(v).add(c);const k=c.options.initialPromotionConfig;c.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(c):void 0})}isLead(){const v=this.getStack();return v?v.lead===this:!0}getLead(){var v;const{layoutId:c}=this.options;return c?((v=this.getStack())===null||v===void 0?void 0:v.lead)||this:this}getPrevLead(){var v;const{layoutId:c}=this.options;return c?(v=this.getStack())===null||v===void 0?void 0:v.prevLead:void 0}getStack(){const{layoutId:v}=this.options;if(v)return this.root.sharedNodes.get(v)}promote({needsReset:v,transition:c,preserveFollowOpacity:C}={}){const k=this.getStack();k&&k.promote(this,C),v&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const v=this.getStack();return v?v.relegate(this):!1}resetSkewAndRotation(){const{visualElement:v}=this.options;if(!v)return;let c=!1;const{latestValues:C}=v;if((C.z||C.rotate||C.rotateX||C.rotateY||C.rotateZ||C.skewX||C.skewY)&&(c=!0),!c)return;const k={};C.z&&Ty("z",v,k,this.animationValues);for(let L=0;L<Sy.length;L++)Ty(`rotate${Sy[L]}`,v,k,this.animationValues),Ty(`skew${Sy[L]}`,v,k,this.animationValues);v.render();for(const L in k)v.setStaticValue(L,k[L]),this.animationValues&&(this.animationValues[L]=k[L]);v.scheduleRender()}getProjectionStyles(v){var c,C;if(!this.instance||this.isSVG)return;if(!this.isVisible)return $z;const k={visibility:""},L=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,k.opacity="",k.pointerEvents=df(v==null?void 0:v.pointerEvents)||"",k.transform=L?L(this.latestValues,""):"none",k;const B=this.getLead();if(!this.projectionDelta||!this.layout||!B.target){const re={};return this.options.layoutId&&(re.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,re.pointerEvents=df(v==null?void 0:v.pointerEvents)||""),this.hasProjected&&!Ja(this.latestValues)&&(re.transform=L?L({},""):"none",this.hasProjected=!1),re}const F=B.animationValues||B.latestValues;this.applyTransformsToTarget(),k.transform=Vz(this.projectionDeltaWithTransform,this.treeScale,F),L&&(k.transform=L(F,k.transform));const{x:oe,y:se}=this.projectionDelta;k.transformOrigin=`${oe.origin*100}% ${se.origin*100}% 0`,B.animationValues?k.opacity=B===this?(C=(c=F.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&C!==void 0?C:1:this.preserveOpacity?this.latestValues.opacity:F.opacityExit:k.opacity=B===this?F.opacity!==void 0?F.opacity:"":F.opacityExit!==void 0?F.opacityExit:0;for(const re in Uf){if(F[re]===void 0)continue;const{correct:ue,applyTo:Z}=Uf[re],q=k.transform==="none"?F[re]:ue(F[re],B);if(Z){const G=Z.length;for(let fe=0;fe<G;fe++)k[Z[fe]]=q}else k[re]=q}return this.options.layoutId&&(k.pointerEvents=B===this?df(v==null?void 0:v.pointerEvents)||"":"none"),k}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(v=>{var c;return(c=v.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach($b),this.root.sharedNodes.clear()}}}function qz(e){e.updateLayout()}function Zz(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=e.layout,{animationType:g}=e.options,v=s.source!==e.layout.source;g==="size"?ls(B=>{const F=v?s.measuredBox[B]:s.layoutBox[B],oe=Kr(F);F.min=a[B].min,F.max=F.min+oe}):ME(g,s.layoutBox,a)&&ls(B=>{const F=v?s.measuredBox[B]:s.layoutBox[B],oe=Kr(a[B]);F.max=F.min+oe,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[B].max=e.relativeTarget[B].min+oe)});const c=wc();Ih(c,a,s.layoutBox);const C=wc();v?Ih(C,e.applyTransform(h,!0),s.measuredBox):Ih(C,a,s.layoutBox);const k=!CE(c);let L=!1;if(!e.resumeFrom){const B=e.getClosestProjectingParent();if(B&&!B.resumeFrom){const{snapshot:F,layout:oe}=B;if(F&&oe){const se=ui();Mh(se,s.layoutBox,F.layoutBox);const re=ui();Mh(re,a,oe.layoutBox),PE(se,re)||(L=!0),B.options.layoutRoot&&(e.relativeTarget=re,e.relativeTargetOrigin=se,e.relativeParent=B)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:C,layoutDelta:c,hasLayoutChanged:k,hasRelativeTargetChanged:L})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function Gz(e){_h&&Qa.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Wz(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Hz(e){e.clearSnapshot()}function $b(e){e.clearMeasurements()}function Kz(e){e.isLayoutDirty=!1}function Xz(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ub(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Yz(e){e.resolveTargetDelta()}function Jz(e){e.calcProjection()}function Qz(e){e.resetSkewAndRotation()}function eD(e){e.removeLeadSnapshot()}function qb(e,t,s){e.translate=Wn(t.translate,0,s),e.scale=Wn(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function Zb(e,t,s,a){e.min=Wn(t.min,s.min,a),e.max=Wn(t.max,s.max,a)}function tD(e,t,s,a){Zb(e.x,t.x,s.x,a),Zb(e.y,t.y,s.y,a)}function nD(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const iD={duration:.45,ease:[.4,0,.1,1]},Gb=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Wb=Gb("applewebkit/")&&!Gb("chrome/")?Math.round:Wr;function Hb(e){e.min=Wb(e.min),e.max=Wb(e.max)}function rD(e){Hb(e.x),Hb(e.y)}function ME(e,t,s){return e==="position"||e==="preserve-aspect"&&!az(jb(t),jb(s),.2)}function sD(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const oD=IE({attachResizeListener:(e,t)=>nd(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ky={current:void 0},LE=IE({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!ky.current){const e=new oD({});e.mount(window),e.setOptions({layoutScroll:!0}),ky.current=e}return ky.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),aD={pan:{Feature:Sz},drag:{Feature:bz,ProjectionNode:LE,MeasureLayout:TE}};function Kb(e,t,s){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",s==="Start");const h="onHover"+s,g=a[h];g&&Bn.postRender(()=>g(t,fd(t)))}class lD extends Ca{mount(){const{current:t}=this.node;t&&(this.unmount=aL(t,s=>(Kb(this.node,s,"Start"),a=>Kb(this.node,a,"End"))))}unmount(){}}class cD extends Ca{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pd(nd(this.node.current,"focus",()=>this.onFocus()),nd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Xb(e,t,s){const{props:a}=e;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",s==="Start");const h="onTap"+(s==="End"?"":s),g=a[h];g&&Bn.postRender(()=>g(t,fd(t)))}class uD extends Ca{mount(){const{current:t}=this.node;t&&(this.unmount=hL(t,s=>(Xb(this.node,s,"Start"),(a,{success:h})=>Xb(this.node,a,h?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const U0=new WeakMap,Ey=new WeakMap,hD=e=>{const t=U0.get(e.target);t&&t(e)},dD=e=>{e.forEach(hD)};function pD({root:e,...t}){const s=e||document;Ey.has(s)||Ey.set(s,{});const a=Ey.get(s),h=JSON.stringify(t);return a[h]||(a[h]=new IntersectionObserver(dD,{root:e,...t})),a[h]}function fD(e,t,s){const a=pD(t);return U0.set(e,s),a.observe(e),()=>{U0.delete(e),a.unobserve(e)}}const mD={some:0,all:1};class gD extends Ca{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:a,amount:h="some",once:g}=t,v={root:s?s.current:void 0,rootMargin:a,threshold:typeof h=="number"?h:mD[h]},c=C=>{const{isIntersecting:k}=C;if(this.isInView===k||(this.isInView=k,g&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:L,onViewportLeave:B}=this.node.getProps(),F=k?L:B;F&&F(C)};return fD(this.node.current,v,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(yD(t,s))&&this.startObserver()}unmount(){}}function yD({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const _D={inView:{Feature:gD},tap:{Feature:uD},focus:{Feature:cD},hover:{Feature:lD}},xD={layout:{ProjectionNode:LE,MeasureLayout:TE}},q0={current:null},zE={current:!1};function vD(){if(zE.current=!0,!!rx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>q0.current=e.matches;e.addListener(t),t()}else q0.current=!1}const wD=[...rE,Qi,Sa],bD=e=>wD.find(iE(e)),Yb=new WeakMap;function SD(e,t,s){for(const a in t){const h=t[a],g=s[a];if(nr(h))e.addValue(a,h);else if(nr(g))e.addValue(a,ed(h,{owner:e}));else if(g!==h)if(e.hasValue(a)){const v=e.getValue(a);v.liveStyle===!0?v.jump(h):v.hasAnimated||v.set(h)}else{const v=e.getStaticValue(a);e.addValue(a,ed(v!==void 0?v:h,{owner:e}))}}for(const a in s)t[a]===void 0&&e.removeValue(a);return t}const Jb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class TD{scrapeMotionValuesFromProps(t,s,a){return{}}constructor({parent:t,props:s,presenceContext:a,reducedMotionConfig:h,blockInitialAnimation:g,visualState:v},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Mx,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const oe=ro.now();this.renderScheduledAt<oe&&(this.renderScheduledAt=oe,Bn.render(this.render,!1,!0))};const{latestValues:C,renderState:k,onUpdate:L}=v;this.onUpdate=L,this.latestValues=C,this.baseTarget={...C},this.initialValues=s.initial?{...C}:{},this.renderState=k,this.parent=t,this.props=s,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=h,this.options=c,this.blockInitialAnimation=!!g,this.isControllingVariants=km(s),this.isVariantNode=dk(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:B,...F}=this.scrapeMotionValuesFromProps(s,{},this);for(const oe in F){const se=F[oe];C[oe]!==void 0&&nr(se)&&se.set(C[oe],!1)}}mount(t){this.current=t,Yb.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,a)=>this.bindToMotionValue(a,s)),zE.current||vD(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:q0.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Yb.delete(this.current),this.projection&&this.projection.unmount(),ba(this.notifyUpdate),ba(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const s=this.features[t];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(t,s){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=xl.has(t),h=s.on("change",c=>{this.latestValues[t]=c,this.props.onUpdate&&Bn.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0)}),g=s.on("renderRequest",this.scheduleRender);let v;window.MotionCheckAppearSync&&(v=window.MotionCheckAppearSync(this,t,s)),this.valueSubscriptions.set(t,()=>{h(),g(),v&&v(),s.owner&&s.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Oc){const s=Oc[t];if(!s)continue;const{isEnabled:a,Feature:h}=s;if(!this.features[t]&&h&&a(this.props)&&(this.features[t]=new h(this)),this.features[t]){const g=this.features[t];g.isMounted?g.update():(g.mount(),g.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ui()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let a=0;a<Jb.length;a++){const h=Jb[a];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);const g="on"+h,v=t[g];v&&(this.propEventSubscriptions[h]=this.on(h,v))}this.prevMotionValues=SD(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){const a=this.values.get(t);s!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,s),this.values.set(t,s),this.latestValues[t]=s.get())}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&s!==void 0&&(a=ed(s===null?void 0:s,{owner:this}),this.addValue(t,a)),a}readValue(t,s){var a;let h=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(a=this.getBaseTargetFromProps(this.props,t))!==null&&a!==void 0?a:this.readValueFromInstance(this.current,t,this.options);return h!=null&&(typeof h=="string"&&(tE(h)||Gk(h))?h=parseFloat(h):!bD(h)&&Sa.test(s)&&(h=Jk(t,s)),this.setBaseTarget(t,nr(h)?h.get():h)),nr(h)?h.get():h}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:a}=this.props;let h;if(typeof a=="string"||typeof a=="object"){const v=hx(this.props,a,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);v&&(h=v[t])}if(a&&h!==void 0)return h;const g=this.getBaseTargetFromProps(this.props,t);return g!==void 0&&!nr(g)?g:this.initialValues[t]!==void 0&&h===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new kx),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class DE extends TD{constructor(){super(...arguments),this.KeyframeResolver=sE}sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:a}){delete s[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;nr(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function kD(e){return window.getComputedStyle(e)}class ED extends DE{constructor(){super(...arguments),this.type="html",this.renderInstance=wk}readValueFromInstance(t,s){if(xl.has(s)){const a=Ix(s);return a&&a.default||0}else{const a=kD(t),h=(_k(s)?a.getPropertyValue(s):a[s])||0;return typeof h=="string"?h.trim():h}}measureInstanceViewportBox(t,{transformPagePoint:s}){return bE(t,s)}build(t,s,a){fx(t,s,a.transformTemplate)}scrapeMotionValuesFromProps(t,s,a){return _x(t,s,a)}}class CD extends DE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ui}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(xl.has(s)){const a=Ix(s);return a&&a.default||0}return s=bk.has(s)?s:lx(s),t.getAttribute(s)}scrapeMotionValuesFromProps(t,s,a){return kk(t,s,a)}build(t,s,a){mx(t,s,this.isSVGTag,a.transformTemplate)}renderInstance(t,s,a,h){Sk(t,s,a,h)}mount(t){this.isSVGTag=yx(t.tagName),super.mount(t)}}const PD=(e,t)=>ux(e)?new CD(t):new ED(t,{allowProjection:e!==ce.Fragment}),AD=eL({...J4,..._D,...aD,...xD},PD),lt=m3(AD);var RE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Qb=$t.createContext&&$t.createContext(RE),ID=["attr","size","title"];function MD(e,t){if(e==null)return{};var s=LD(e,t),a,h;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(e);for(h=0;h<g.length;h++)a=g[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function LD(e,t){if(e==null)return{};var s={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;s[a]=e[a]}return s}function Kf(){return Kf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Kf.apply(this,arguments)}function e2(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),s.push.apply(s,a)}return s}function Xf(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?e2(Object(s),!0).forEach(function(a){zD(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):e2(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function zD(e,t,s){return t=DD(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function DD(e){var t=RD(e,"string");return typeof t=="symbol"?t:t+""}function RD(e,t){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var a=s.call(e,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FE(e){return e&&e.map((t,s)=>$t.createElement(t.tag,Xf({key:s},t.attr),FE(t.child)))}function kt(e){return t=>$t.createElement(FD,Kf({attr:Xf({},e.attr)},t),FE(e.child))}function FD(e){var t=s=>{var{attr:a,size:h,title:g}=e,v=MD(e,ID),c=h||s.size||"1em",C;return s.className&&(C=s.className),e.className&&(C=(C?C+" ":"")+e.className),$t.createElement("svg",Kf({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,v,{className:C,style:Xf(Xf({color:e.color||s.color},s.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),g&&$t.createElement("title",null,g),e.children)};return Qb!==void 0?$t.createElement(Qb.Consumer,null,s=>t(s)):t(RE)}function t2(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function BD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)}function ND(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function Pm(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(e)}function jD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(e)}function BE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function OD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function VD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"},child:[]}]})(e)}function $D(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8h1a4 4 0 0 1 0 8h-1"},child:[]},{tag:"path",attr:{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},child:[]},{tag:"line",attr:{x1:"6",y1:"1",x2:"6",y2:"4"},child:[]},{tag:"line",attr:{x1:"10",y1:"1",x2:"10",y2:"4"},child:[]},{tag:"line",attr:{x1:"14",y1:"1",x2:"14",y2:"4"},child:[]}]})(e)}function Yf(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"},child:[]}]})(e)}function UD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polygon",attr:{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"},child:[]}]})(e)}function qD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"},child:[]},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"},child:[]},{tag:"line",attr:{x1:"9",y1:"1",x2:"9",y2:"4"},child:[]},{tag:"line",attr:{x1:"15",y1:"1",x2:"15",y2:"4"},child:[]},{tag:"line",attr:{x1:"9",y1:"20",x2:"9",y2:"23"},child:[]},{tag:"line",attr:{x1:"15",y1:"20",x2:"15",y2:"23"},child:[]},{tag:"line",attr:{x1:"20",y1:"9",x2:"23",y2:"9"},child:[]},{tag:"line",attr:{x1:"20",y1:"14",x2:"23",y2:"14"},child:[]},{tag:"line",attr:{x1:"1",y1:"9",x2:"4",y2:"9"},child:[]},{tag:"line",attr:{x1:"1",y1:"14",x2:"4",y2:"14"},child:[]}]})(e)}function ZD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function GD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(e)}function WD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},child:[]},{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"},child:[]}]})(e)}function n2(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"},child:[]},{tag:"line",attr:{x1:"16",y1:"8",x2:"2",y2:"22"},child:[]},{tag:"line",attr:{x1:"17.5",y1:"15",x2:"9",y2:"15"},child:[]}]})(e)}function HD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"},child:[]}]})(e)}function id(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"},child:[]}]})(e)}function KD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 18v-6a9 9 0 0 1 18 0v6"},child:[]},{tag:"path",attr:{d:"M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"},child:[]}]})(e)}function Ns(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(e)}function Jf(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(e)}function NE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"},child:[]},{tag:"path",attr:{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"},child:[]}]})(e)}function XD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"},child:[]},{tag:"rect",attr:{x:"2",y:"9",width:"4",height:"12"},child:[]},{tag:"circle",attr:{cx:"4",cy:"4",r:"2"},child:[]}]})(e)}function i2(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(e)}function YD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(e)}function jE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function r2(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"polyline",attr:{points:"9 21 3 21 3 15"},child:[]},{tag:"line",attr:{x1:"21",y1:"3",x2:"14",y2:"10"},child:[]},{tag:"line",attr:{x1:"3",y1:"21",x2:"10",y2:"14"},child:[]}]})(e)}function JD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"},child:[]}]})(e)}function s2(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 14 10 14 10 20"},child:[]},{tag:"polyline",attr:{points:"20 10 14 10 14 4"},child:[]},{tag:"line",attr:{x1:"14",y1:"10",x2:"21",y2:"3"},child:[]},{tag:"line",attr:{x1:"3",y1:"21",x2:"10",y2:"14"},child:[]}]})(e)}function OE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},child:[]}]})(e)}function $c(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 18V5l12-2v13"},child:[]},{tag:"circle",attr:{cx:"6",cy:"18",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"16",r:"3"},child:[]}]})(e)}function Z0(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"6",y:"4",width:"4",height:"16"},child:[]},{tag:"rect",attr:{x:"14",y:"4",width:"4",height:"16"},child:[]}]})(e)}function G0(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"},child:[]}]})(e)}function QD(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(e)}function VE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]},{tag:"path",attr:{d:"M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"},child:[]}]})(e)}function eR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function tR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"2",width:"20",height:"8",rx:"2",ry:"2"},child:[]},{tag:"rect",attr:{x:"2",y:"14",width:"20",height:"8",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"6.01",y2:"6"},child:[]},{tag:"line",attr:{x1:"6",y1:"18",x2:"6.01",y2:"18"},child:[]}]})(e)}function nR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"},child:[]},{tag:"polyline",attr:{points:"16 6 12 2 8 6"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"15"},child:[]}]})(e)}function $E(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 3 21 3 21 8"},child:[]},{tag:"line",attr:{x1:"4",y1:"20",x2:"21",y2:"3"},child:[]},{tag:"polyline",attr:{points:"21 16 21 21 16 21"},child:[]},{tag:"line",attr:{x1:"15",y1:"15",x2:"21",y2:"21"},child:[]},{tag:"line",attr:{x1:"4",y1:"4",x2:"9",y2:"9"},child:[]}]})(e)}function UE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(e)}function iR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 18a5 5 0 0 0-10 0"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"9"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"10.22",x2:"5.64",y2:"11.64"},child:[]},{tag:"line",attr:{x1:"1",y1:"18",x2:"3",y2:"18"},child:[]},{tag:"line",attr:{x1:"21",y1:"18",x2:"23",y2:"18"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"11.64",x2:"19.78",y2:"10.22"},child:[]},{tag:"line",attr:{x1:"23",y1:"22",x2:"1",y2:"22"},child:[]},{tag:"polyline",attr:{points:"8 6 12 2 16 6"},child:[]}]})(e)}function rR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(e)}function Zp(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 7 4 4 20 4 20 7"},child:[]},{tag:"line",attr:{x1:"9",y1:"20",x2:"15",y2:"20"},child:[]},{tag:"line",attr:{x1:"12",y1:"4",x2:"12",y2:"20"},child:[]}]})(e)}function qE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"},child:[]},{tag:"path",attr:{d:"M15.54 8.46a5 5 0 0 1 0 7.07"},child:[]}]})(e)}function W0(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"},child:[]},{tag:"path",attr:{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"},child:[]}]})(e)}function ZE(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"},child:[]},{tag:"line",attr:{x1:"23",y1:"9",x2:"17",y2:"15"},child:[]},{tag:"line",attr:{x1:"17",y1:"9",x2:"23",y2:"15"},child:[]}]})(e)}function sR(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"},child:[]}]})(e)}function Lh(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}function H0(e){return kt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},child:[]}]})(e)}function K0(e){return kt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"m6.75 7.5 3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0 0 21 18V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v12a2.25 2.25 0 0 0 2.25 2.25Z"},child:[]}]})(e)}function oR(e){return kt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"},child:[]}]})(e)}function aR(e){return kt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"},child:[]}]})(e)}function oc(e){return kt({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.455 2.004a.75.75 0 0 1 .26.77 7 7 0 0 0 9.958 7.967.75.75 0 0 1 1.067.853A8.5 8.5 0 1 1 6.647 1.921a.75.75 0 0 1 .808.083Z",clipRule:"evenodd"},child:[]}]})(e)}const xa=e=>{if(!e)return"";try{return new Intl.DisplayNames(["en"],{type:"region"}).of(e.toUpperCase())}catch{return e}},Mc=e=>{const t=[];return e.city&&t.push(e.city),e.state&&e.state!==e.city&&t.push(e.state),e.countrycode&&t.push(xa(e.countrycode)),t.join(", ")||""},o2={GENRES:[{id:"all",label:"All",icon:KD},{id:"pop",label:"Pop",icon:VE},{id:"rock",label:"Rock",icon:H0},{id:"jazz",label:"Jazz",icon:sR},{id:"classical",label:"Classical",icon:n2},{id:"electronic",label:"Electronic",icon:t2},{id:"hiphop",label:"Hip Hop",icon:ZD},{id:"news",label:"News",icon:id},{id:"talk",label:"Talk",icon:JD},{id:"ambient",label:"Ambient",icon:VD},{id:"folk",label:"Folk",icon:UE},{id:"world",label:"World",icon:UD}],MOODS:[{id:"chill",label:"Chill",icon:$D},{id:"energetic",label:"Energetic",icon:H0},{id:"focus",label:"Focus",icon:rR},{id:"party",label:"Party",icon:$c},{id:"relaxing",label:"Relaxing",icon:iR},{id:"workout",label:"Workout",icon:t2},{id:"sleep",label:"Sleep",icon:OE},{id:"meditation",label:"Meditation",icon:n2}]},lR=({selectedGenre:e,selectedMood:t,onGenreSelect:s,onMoodSelect:a,isCollapsed:h,isDarkMode:g})=>{const[v,c]=ce.useState(()=>t?"moods":"genres"),C=ce.useRef(null),[k,L]=ce.useState(e),[B,F]=ce.useState(t);ce.useEffect(()=>{t&&(c("moods"),F(t)),e&&(c("genres"),L(e))},[t,e]);const oe=G=>{C.current&&(C.current.scrollLeft+=G.deltaY)},se=G=>{if(C.current){const fe=G==="left"?-200:200;C.current.scrollBy({left:fe,behavior:"smooth"})}},re=G=>`
    px-3 py-1.5 rounded-xl text-sm whitespace-nowrap transition-all
    flex items-center gap-2
    ${G?g?"bg-white/15 text-white shadow-lg backdrop-blur-sm":"bg-black text-white shadow-lg":g?"text-white/60 hover:text-white hover:bg-white/10 hover:backdrop-blur-sm":"text-black/60 hover:text-black hover:bg-black/5"}
  `,ue=G=>`
    flex-1 px-4 py-2 rounded-xl text-sm transition-all
    flex items-center justify-center gap-2 font-medium
    ${G?g?"bg-white/15 text-white backdrop-blur-sm":"bg-black text-white":g?"text-white/60 hover:text-white hover:bg-white/10":"text-black/60 hover:text-black hover:bg-black/5"}
  `,Z={enter:{opacity:0,x:20,transition:{duration:.2}},center:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}},q=(G,fe)=>fe?[...G.filter(xe=>xe.id===fe),...G.filter(xe=>xe.id!==fe)]:G;return R.jsx(lt.div,{initial:{opacity:0,y:20},animate:{opacity:h?0:1,y:h?10:0,height:h?0:"auto"},transition:{duration:.3},className:`w-[320px] ${g?"bg-black/80":"bg-white/80"} backdrop-blur-md rounded-2xl shadow-xl relative overflow-hidden mb-3`,children:R.jsxs("div",{className:"flex flex-col px-2 pt-2 gap-2",children:[R.jsxs("div",{className:"flex gap-1",children:[R.jsxs(lt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{c("genres"),k&&s(k)},className:ue(v==="genres"),children:[R.jsx($c,{className:"w-4 h-4"}),"Genres"]}),R.jsxs(lt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{c("moods"),B&&a(B)},className:ue(v==="moods"),children:[R.jsx(Ns,{className:"w-4 h-4"}),"Moods"]})]}),R.jsxs("div",{className:"p-2 flex items-center gap-1",children:[R.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>se("left"),className:`p-1.5 rounded-xl ${g?"text-white/60 hover:text-white hover:bg-white/10":"text-black/60 hover:text-black hover:bg-black/5"} hidden md:block backdrop-blur-sm`,children:R.jsx(jD,{className:"w-4 h-4"})}),R.jsx(In,{mode:"wait",children:R.jsx(lt.div,{variants:Z,initial:"enter",animate:"center",exit:"exit",className:"flex gap-1 overflow-x-auto w-full no-scrollbar",ref:C,onWheel:oe,style:{scrollBehavior:"smooth",WebkitOverflowScrolling:"touch"},children:v==="genres"?q(o2.GENRES,e).map(G=>{const fe=G.icon;return R.jsxs(lt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{s(e===G.id||G.id==="all"?null:G.id),a(null)},className:re(e===G.id||G.id==="all"&&!e),children:[R.jsx(fe,{className:"w-4 h-4"}),G.label]},G.id)}):q(o2.MOODS,t).map(G=>{const fe=G.icon;return R.jsxs(lt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{a(t===G.id?null:G.id),s(null)},className:re(t===G.id),children:[R.jsx(fe,{className:"w-4 h-4"}),G.label]},G.id)})},v)}),R.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>se("right"),className:`p-1.5 rounded-xl ${g?"text-white/60 hover:text-white hover:bg-white/10":"text-black/60 hover:text-black hover:bg-black/5"} hidden md:block backdrop-blur-sm`,children:R.jsx(BE,{className:"w-4 h-4"})})]})]})})},cR=({text:e,isDarkMode:t})=>R.jsxs("div",{className:`
    absolute -top-8 left-1/2 -translate-x-1/2 pointer-events-none
    opacity-0 group-hover:opacity-100 transition-opacity duration-200
  `,children:[R.jsx("div",{className:`
      px-2 py-1 text-xs rounded-md whitespace-nowrap
      flex items-center gap-1 font-inter
      ${t?"bg-[#161616] text-gray-400 border border-gray-800/50":"bg-[#EFEFEF] text-gray-500 border border-gray-200/50"}
    `,children:e}),R.jsx("div",{className:`
      w-2 h-2 rotate-45 
      absolute -bottom-1 left-1/2 -translate-x-1/2
      ${t?"bg-[#161616] border-r border-b border-gray-800/50":"bg-[#EFEFEF] border-r border-b border-gray-200/50"}
    `})]}),uR=$t.memo(({volume:e,onVolumeChange:t,isDarkMode:s})=>{const[a,h]=ce.useState(!1),g=ce.useRef(null);ce.useEffect(()=>{const C=k=>{g.current&&!g.current.contains(k.target)&&h(!1)};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]);const v=C=>{t(parseFloat(C.target.value))},c=e===0?ZE:e<.5?qE:W0;return R.jsxs("div",{ref:g,className:"relative z-50",children:[R.jsxs("button",{onClick:()=>h(!a),className:`p-2.5 rounded-xl relative group ${s?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,children:[R.jsx(c,{className:"w-5 h-5"}),!a&&R.jsx(cR,{text:"M",isDarkMode:s})]}),R.jsx(In,{children:a&&R.jsx(lt.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},transition:{duration:.15,ease:"easeInOut"},className:`absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 p-3 rounded-xl shadow-lg ${s?"bg-black/90 border-gray-800/50":"bg-white/90 border-gray-200/50"} backdrop-blur-md border`,children:R.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:e,onChange:v,className:"w-24 h-1 appearance-none rounded-full outline-none",style:{WebkitAppearance:"none",background:`linear-gradient(to right, #D94E1F 0%, #D94E1F ${e*100}%, ${s?"#1F2937":"#E5E7EB"} ${e*100}%, ${s?"#1F2937":"#E5E7EB"} 100%)`}})})})]})}),hR=3*60*1e3,dR=2*24*60*60*1e3,a2=({isDarkMode:e,showButton:t=!0})=>{const[s,a]=ce.useState(!1),[h,g]=ce.useState(()=>window.innerWidth<768),[v,c]=ce.useState(0),C=["Help keep it ad-free","Keep server running","Support development"];ce.useEffect(()=>{const L=localStorage.getItem("lastDonationModalShow");if(L&&Date.now()-parseInt(L)<dR)return;let F=!1;const oe=["mousemove","keydown","scroll","click"],se=()=>{F||(F=!0)};oe.forEach(ue=>{window.addEventListener(ue,se)});const re=setTimeout(()=>{var ue;F&&(a(!0),localStorage.setItem("lastDonationModalShow",Date.now().toString()),(ue=window.track)==null||ue.call(window,"donation_modal_auto_show"))},hR);return()=>{clearTimeout(re),oe.forEach(ue=>{window.removeEventListener(ue,se)})}},[]);const k=ce.useCallback(()=>{var L;a(!1),(L=window.track)==null||L.call(window,"donation_modal_close")},[]);return ce.useEffect(()=>{const L=()=>g(window.innerWidth<768);return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),ce.useEffect(()=>{const L=setInterval(()=>{c(B=>(B+1)%C.length)},5e3);return()=>clearInterval(L)},[]),R.jsxs(R.Fragment,{children:[t&&(h?R.jsx(lt.button,{onClick:()=>a(!0),initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:`fixed z-[100] top-4 right-4 p-2.5 rounded-xl shadow-lg transition-all duration-75
              ${e?"bg-black/90 hover:bg-black ring-1 ring-white/10":"bg-white/90 hover:bg-white ring-1 ring-black/5"}
              backdrop-blur-md`,whileHover:{scale:1.05},whileTap:{scale:.95},children:R.jsx("div",{className:`relative w-5 h-5 rounded-lg flex items-center justify-center
              ${e?"bg-gradient-to-br from-emerald-500/20 to-emerald-400/10":"bg-gradient-to-br from-emerald-100 to-emerald-50"}`,children:R.jsx(Ns,{className:`w-3 h-3 ${e?"text-emerald-400":"text-emerald-600"}`})})}):R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"fixed z-[100] top-4 right-4",children:R.jsxs(lt.button,{onClick:()=>a(!0),className:`group flex items-center gap-3 px-4 py-2.5 rounded-xl text-left
                ${e?"bg-black/90 hover:bg-black ring-1 ring-white/10":"bg-white/90 hover:bg-white ring-1 ring-black/5"}
                backdrop-blur-md shadow-lg transition-all duration-75`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[R.jsx("div",{className:`relative w-8 h-8 rounded-lg flex items-center justify-center
                ${e?"bg-gradient-to-br from-emerald-500/20 to-emerald-400/10":"bg-gradient-to-br from-emerald-100 to-emerald-50"}`,children:R.jsx(Ns,{className:`w-4 h-4 ${e?"text-emerald-400":"text-emerald-600"}`})}),R.jsxs("div",{className:"overflow-hidden",children:[R.jsx("span",{className:`block text-sm font-medium ${e?"text-white":"text-black"}`,children:"Support Radiocast"}),R.jsx(In,{mode:"wait",children:R.jsx(lt.div,{initial:{y:15,opacity:0,filter:"blur(8px)"},animate:{y:0,opacity:1,filter:"blur(0px)"},exit:{y:-15,opacity:0,filter:"blur(8px)"},transition:{duration:.5,ease:"easeOut",opacity:{duration:.3},filter:{duration:.2}},className:"h-4",children:R.jsx("span",{className:`block text-xs ${e?"text-neutral-400":"text-neutral-500"}`,children:C[v]})},v)})]})]})})),R.jsx(GE,{isOpen:s,onClose:k,isDarkMode:e})]})},l2=[{amount:"10",url:"https://donate.stripe.com/6oE5lfcOG5UJ0gM002",description:"Keep Radiocast running",icon:tR,color:"emerald"},{amount:"15",url:"https://donate.stripe.com/cN2dRL01U6YNd3yeUX",description:"Support active development",icon:qD,color:"emerald"},{amount:"20",url:"https://donate.stripe.com/7sI14ZdSK82R4x26op",description:"Fund new features",icon:H0,color:"emerald"}],pR=({isDarkMode:e})=>R.jsxs("div",{className:`
    flex items-center gap-3 px-4 py-3 rounded-xl
    ${e?"bg-black/90":"bg-white/90"} 
    backdrop-blur-md shadow-xl
    ${e?"ring-1 ring-white/10":"ring-1 ring-black/5"}
  `,children:[R.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center
      ${e?"bg-emerald-900/50":"bg-emerald-100"}`,children:R.jsx(Pm,{className:"w-4 h-4 text-emerald-500"})}),R.jsx("p",{className:`text-base font-medium ${e?"text-white":"text-black"}`,children:"Thank you for your support!"})]}),fR=({isDarkMode:e})=>R.jsxs("div",{className:`flex items-center justify-center gap-2 ${e?"text-neutral-600":"text-neutral-500"}`,children:[R.jsx("span",{className:"text-[10px] opacity-80",children:"One-time payment  Powered by "}),R.jsx("svg",{className:"h-3 w-auto",viewBox:"0 0 60 25",fill:"currentColor",children:R.jsx("path",{d:"M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a8.33 8.33 0 0 1-4.56 1.1c-4.01 0-6.83-2.5-6.83-7.48 0-4.19 2.39-7.52 6.3-7.52 3.92 0 5.96 3.28 5.96 7.5 0 .4-.04 1.26-.06 1.48zm-5.92-5.62c-1.03 0-2.17.73-2.17 2.58h4.25c0-1.85-1.07-2.58-2.08-2.58zM40.95 20.3c-1.44 0-2.32-.6-2.9-1.04l-.02 4.63-4.12.87V5.57h3.76l.08 1.02a4.7 4.7 0 0 1 3.23-1.29c2.9 0 5.62 2.6 5.62 7.4 0 5.23-2.7 7.6-5.65 7.6zM40 8.95c-.95 0-1.54.34-1.97.81l.02 6.12c.4.44.98.78 1.95.78 1.52 0 2.54-1.65 2.54-3.87 0-2.15-1.04-3.84-2.54-3.84zM28.24 5.57h4.13v14.44h-4.13V5.57zm0-4.7L32.37 0v3.36l-4.13.88V.88zm-4.32 9.35v9.79H19.8V5.57h3.7l.12 1.22c1-1.77 3.07-1.41 3.62-1.22v3.79c-.52-.17-2.29-.43-3.32.86zm-8.55 4.72c0 2.43 2.6 1.68 3.12 1.46v3.36c-.55.3-1.54.54-2.89.54a4.15 4.15 0 0 1-4.27-4.24l.01-13.17 4.02-.86v3.54h3.14V9.1h-3.13v5.85zm-4.91.7c0 2.97-2.31 4.66-5.73 4.66a11.2 11.2 0 0 1-4.46-.93v-3.93c1.38.75 3.1 1.31 4.46 1.31.92 0 1.53-.24 1.53-1C6.26 13.77 0 14.51 0 9.95 0 7.04 2.28 5.3 5.62 5.3c1.36 0 2.72.2 4.09.75v3.88a9.23 9.23 0 0 0-4.1-1.06c-.86 0-1.44.25-1.44.9 0 1.85 6.29.97 6.29 5.88z",fillRule:"evenodd"})})]}),GE=({isOpen:e,onClose:t,isDarkMode:s})=>{var C;const[a,h]=ce.useState("15"),[g,v]=ce.useState(!1);ce.useEffect(()=>(e&&(document.body.style.overflow="hidden",window.addEventListener("keydown",k=>k.key==="Escape"&&t())),()=>{document.body.style.overflow="",window.removeEventListener("keydown",k=>k.key==="Escape"&&t())}),[e,t]);const c=()=>{var k;(k=window.track)==null||k.call(window,"donation_click",{source:"donate_modal",amount:a}),v(!0),setTimeout(()=>v(!1),500)};return R.jsx(In,{mode:"wait",children:e&&R.jsxs(R.Fragment,{children:[R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"fixed inset-0 bg-black/60 backdrop-blur-[2px] z-[101]",onClick:t}),R.jsx(lt.div,{className:"fixed inset-0 z-[102] flex items-center justify-center p-3",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},onClick:k=>k.target===k.currentTarget&&t(),children:R.jsx(lt.div,{className:`w-full max-w-xs rounded-xl overflow-hidden p-0.5
                ${s?"bg-gradient-to-br from-emerald-500/20 via-emerald-400/10 to-emerald-500/20":"bg-gradient-to-br from-emerald-100 via-emerald-50 to-emerald-100"}`,initial:{scale:.98},animate:{scale:1},exit:{scale:.98},transition:{duration:.1},onClick:k=>k.stopPropagation(),children:R.jsx("div",{className:`w-full h-full rounded-lg ${s?"bg-black text-white":"bg-white text-black"} shadow-2xl`,children:R.jsxs("div",{className:"p-4",children:[R.jsxs("div",{className:"text-center mb-4",children:[R.jsx("div",{className:`inline-flex items-center justify-center w-10 h-10 rounded-lg mb-3
                      ${s?"bg-gradient-to-br from-emerald-500/20 to-emerald-400/10":"bg-gradient-to-br from-emerald-100 to-emerald-50"}`,children:R.jsx(Ns,{className:`w-5 h-5 ${s?"text-emerald-400":"text-emerald-600"}`})}),R.jsx("h2",{className:"text-xl font-semibold mb-1.5",children:"One-time support"}),R.jsx("p",{className:`text-xs leading-relaxed max-w-xs mx-auto ${s?"text-neutral-300":"text-neutral-600"}`,children:"Radiocast is a one-person project bringing you 8,000+ stations. Your support helps keep the servers running and enables new features."})]}),R.jsx("div",{className:"space-y-2 mb-4",children:l2.map(k=>{const L=k.icon,B=a===k.amount;return R.jsxs(lt.button,{onClick:()=>h(k.amount),className:`w-full flex items-center p-3 rounded-lg transition-all duration-300
                            ${B?s?"bg-gradient-to-r from-emerald-500/20 to-emerald-400/10 ring-1 ring-emerald-500/30":"bg-gradient-to-r from-emerald-100 to-emerald-50/80 ring-1 ring-emerald-500/20":s?"bg-neutral-900 hover:bg-neutral-800":"bg-neutral-50 hover:bg-neutral-100"}`,whileHover:{scale:1.01},whileTap:{scale:.99},transition:{duration:.2},children:[R.jsx("div",{className:`flex-none mr-3 w-9 h-9 rounded-lg flex items-center justify-center transition-colors duration-300
                            ${B?s?"bg-emerald-500/20":"bg-emerald-100":s?"bg-neutral-800":"bg-white"}`,children:R.jsx(L,{className:`w-4 h-4 transition-colors duration-300 ${B?s?"text-emerald-400":"text-emerald-600":s?"text-white":"text-black"}`})}),R.jsxs("div",{className:"flex-1 text-left",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsxs("span",{className:`text-base font-semibold transition-colors duration-300 ${B?s?"text-emerald-400":"text-emerald-600":s?"text-white":"text-black"}`,children:["$",k.amount]}),k.amount==="15"&&R.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full font-medium
                                  ${s?"bg-emerald-500/20 text-emerald-400":"bg-emerald-100 text-emerald-600"}`,children:"Popular"})]}),R.jsx("span",{className:`text-xs ${s?"text-neutral-300":"text-neutral-600"}`,children:k.description})]}),R.jsx(In,{children:B&&R.jsx(lt.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{duration:.2},className:`flex-none ml-2 w-5 h-5 rounded-full flex items-center justify-center
                                  ${s?"bg-emerald-500/20 text-emerald-400":"bg-emerald-100 text-emerald-600"}`,children:R.jsx(Pm,{className:"w-3 h-3"})})})]},k.amount)})}),R.jsxs(lt.a,{href:(C=l2.find(k=>k.amount===a))==null?void 0:C.url,target:"_blank",rel:"noopener noreferrer",onClick:c,className:`w-full flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                      text-white font-medium text-sm
                      bg-gradient-to-r from-emerald-600 to-emerald-500
                      shadow-lg shadow-emerald-900/20
                      transition-all mb-3`,whileHover:{scale:1.02,backgroundImage:"linear-gradient(to right, rgb(5, 150, 105), rgb(16, 185, 129))"},whileTap:{scale:.98,backgroundImage:"linear-gradient(to right, rgb(4, 120, 87), rgb(5, 150, 105))"},transition:{duration:.2,ease:"easeOut"},children:["Support with $",a,R.jsx(WD,{className:"w-3.5 h-3.5 opacity-80"})]}),R.jsx(fR,{isDarkMode:s})]})})})}),R.jsx(In,{children:g&&R.jsx(lt.div,{initial:{opacity:0,scale:.98,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.98,y:10},transition:{duration:.1},className:"fixed bottom-4 inset-x-4 md:left-auto md:right-4 md:w-auto z-[103] flex items-center justify-center pointer-events-none",children:R.jsx(pR,{isDarkMode:s})})})]})})},mR=({currentTime:e,showDate:t,setShowDate:s,formatDate:a,timeRemaining:h,formatTime:g,isCollapsed:v,isDarkMode:c,station:C,isHoveringTime:k})=>R.jsx("div",{className:`flex items-center overflow-hidden ${c?"text-white":"text-gray-500"}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:R.jsx("div",{className:`relative overflow-hidden ${v?"w-28":"w-32"} h-5`,children:R.jsx(In,{mode:"wait",children:R.jsx(lt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},transition:{type:"spring",stiffness:300,damping:30,duration:.2},className:"absolute inset-0 flex items-center",children:t?R.jsx("span",{className:"text-sm",children:a(e)}):h?R.jsxs("span",{className:"text-sm flex items-center gap-2",children:[R.jsx(oc,{className:"w-4 h-4"}),g(h)]}):R.jsx("span",{className:"text-sm",children:e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})},t?"date":h?"timer":"time")})})}),Qs=({children:e,text:t,isDarkMode:s,position:a="top"})=>{const[h,g]=ce.useState(()=>window.innerWidth<768);return ce.useEffect(()=>{const v=()=>{g(window.innerWidth<768)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]),h?e:R.jsxs("div",{className:"group relative",children:[e,R.jsxs("div",{className:`
        pointer-events-none absolute ${a==="top"?"bottom-full mb-2":"top-full mt-2"} 
        left-1/2 -translate-x-1/2
        opacity-0 group-hover:opacity-100 transition-opacity duration-200
      `,children:[R.jsx("div",{className:`
          px-2 py-1 text-xs rounded-md whitespace-nowrap
          flex items-center gap-1 font-inter
          ${s?"bg-[#161616] text-gray-400 border border-gray-800/50":"bg-[#EFEFEF] text-gray-500 border border-gray-200/50"}
        `,children:t}),R.jsx("div",{className:`
          w-2 h-2 rotate-45 
          absolute ${a==="top"?"bottom-[-4px]":"-top-1"} left-1/2 -translate-x-1/2
          ${s?"bg-[#161616] border-r border-b border-gray-800/50":"bg-[#EFEFEF] border-r border-b border-gray-200/50"}
        `})]})]})},gR=({station:e,isDarkMode:t})=>R.jsx("div",{className:"relative",children:R.jsx("h3",{className:`text-xl font-bold ${t?"text-white":"text-gray-900"} mb-2 line-clamp-2`,children:(e==null?void 0:e.name)||"Select a station"})}),yR=({station:e,isDarkMode:t,onShare:s,buttonPadding:a})=>{const h=()=>{e&&s(e)};return R.jsx(Qs,{text:"Share station (C)",isDarkMode:t,position:"bottom",children:R.jsx(lt.button,{onClick:h,disabled:!e,className:`${a} rounded-xl ${t?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"} ${!e&&"opacity-50 cursor-not-allowed"}`,children:R.jsx(NE,{className:"w-5 h-5"})})})},c2=({isDarkMode:e,buttonPadding:t})=>{const[s,a]=ce.useState(!1),h=()=>{a(!0)};return R.jsxs(R.Fragment,{children:[R.jsx(Qs,{text:"Support",isDarkMode:e,position:"bottom",children:R.jsx(lt.button,{onClick:h,className:`${t} rounded-xl ${e?"hover:bg-[#161616] text-emerald-400":"hover:bg-[#EFEFEF] text-emerald-600"}`,children:R.jsx(GD,{className:"w-5 h-5"})})}),R.jsx(GE,{isOpen:s,onClose:()=>a(!1),isDarkMode:e})]})},u2=({station:e,isPlaying:t,onPlayToggle:s,onToggleFavorite:a,isFavorite:h,onShuffle:g,recentStations:v,onStationSelect:c,stations:C,selectedGenre:k,onGenreSelect:L,favorites:B,isDarkMode:F,onThemeToggle:oe,volume:se,onVolumeChange:re,sleepTimeout:ue,timeRemaining:Z,setShowCommandPalette:q,selectedStation:G,onStationLocate:fe,isCollapsed:xe,onCollapseToggle:Ee,selectedMood:Ie,onMoodSelect:ke,onShare:it})=>{const Oe=ce.useRef(new Audio),At=ce.useRef(new Audio);ce.useState(!1);const[Ct,It]=ce.useState(!1),[Ut,on]=ce.useState(new Date),[Ve,rt]=ce.useState(!1);ce.useState(!1);const[Re,at]=ce.useState(()=>window.innerWidth<768);ce.useEffect(()=>{const Lt=()=>{at(window.innerWidth<768)};return window.addEventListener("resize",Lt),()=>window.removeEventListener("resize",Lt)},[]);const Ne=Re?"p-3":xe?"p-2":"p-2.5",[wt,Rt]=ce.useState(!1),Ft=2e3,Nt=ce.useRef(null),hn=Lt=>{if(!Lt)return"";const tn=Math.floor(Lt/60),qe=Lt%60;return`${tn}:${qe.toString().padStart(2,"0")}`},an=ce.useCallback(Lt=>{Nt.current&&cancelAnimationFrame(Nt.current);const tn=Oe.current,qe=At.current;if(!t){tn.src=Lt;return}qe.src=Lt,qe.volume=0,qe.load();const ut=()=>{Rt(!0),qe.play().catch(en=>{console.error("Failed to play next audio:",en),tn.src=Lt,Rt(!1)});const zt=performance.now(),qt=en=>{const jt=Math.min((en-zt)/Ft,1),_t=jt*jt*(3-2*jt);qe.volume=_t*se,tn.volume=(1-_t)*se,jt<1?Nt.current=requestAnimationFrame(qt):(tn.pause(),tn.src="",[Oe.current,At.current]=[At.current,Oe.current],Rt(!1))};Nt.current=requestAnimationFrame(qt)};qe.addEventListener("canplay",ut,{once:!0}),qe.addEventListener("error",()=>{console.error("Error loading next audio - falling back to direct switch"),tn.src=Lt,Rt(!1)},{once:!0})},[t,se]);ce.useEffect(()=>{if(!e)return;const Lt=e.url_resolved||e.url;Oe.current.src!==Lt&&an(Lt)},[e,an]),ce.useEffect(()=>{wt||(Oe.current.volume=se)},[se,wt]),ce.useEffect(()=>{const Lt=Oe.current;t?Lt.play().catch(console.error):Lt.pause()},[t]),ce.useEffect(()=>{const Lt=setInterval(()=>on(new Date),1e3);return()=>clearInterval(Lt)},[]);const gn=Lt=>{const tn={day:"numeric",month:"short"};return Lt.toLocaleDateString("en-US",tn)},gi="Radiocast  Explore world radio stations";return ce.useEffect(()=>(e&&t?document.title=`${e.name} - Radiocast  World radio stations`:document.title=gi,()=>{document.title=gi}),[e,t]),ce.useEffect(()=>{const Lt=Oe.current,tn=At.current;return()=>{Nt.current&&cancelAnimationFrame(Nt.current),Lt.pause(),Lt.src="",tn.pause(),tn.src=""}},[]),R.jsxs(R.Fragment,{children:[R.jsx("div",{id:"main-content",className:"relative blur-on-volume",children:R.jsx(lR,{selectedGenre:k,selectedMood:Ie,onGenreSelect:L,onMoodSelect:ke,isCollapsed:xe,isDarkMode:F})}),R.jsxs(lt.div,{id:"audio-player",className:`select-none ${F?"bg-black text-white":"bg-white"} ${xe?"px-6 py-6":"px-8 py-6"} rounded-3xl shadow-xl relative overflow-visible mb-6 pb-safe-bottom ${xe?"w-auto min-w-[280px]":"w-[320px]"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0,height:xe?"80px":"270px"},transition:{type:"spring",duration:.6},children:[R.jsx("div",{className:`absolute -top-4 left-0 w-16 h-8 blur-xl opacity-20 
            ${F?"bg-black":"bg-gray-400"}`}),R.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${F?"from-[#141414] to-[#000000]":"from-gray-200 to-gray-300"} opacity-75 rounded-3xl blur-on-volume`}),R.jsx("div",{className:`absolute inset-[6px] ${F?"bg-black":"bg-white"} rounded-[calc(1.5rem-5px)] blur-on-volume`}),R.jsx("div",{className:"w-full flex flex-col justify-between h-full z-10 relative",children:xe?R.jsxs("div",{className:"flex items-center justify-between h-full blur-on-volume",children:[R.jsx(Qs,{text:(e==null?void 0:e.name)||"Select a station",isDarkMode:F,position:"top",children:R.jsxs(lt.div,{className:"flex flex-col gap-0.5 overflow-hidden cursor-default",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:[R.jsx("div",{className:`overflow-hidden ${F?"text-white":"text-gray-500"}`,children:R.jsx("p",{className:"text-sm font-medium truncate max-w-[160px] transition-colors duration-200",children:(e==null?void 0:e.name)||"Select a station"})}),R.jsx("div",{className:"text-gray-400",children:R.jsx("p",{className:"text-xs truncate max-w-[160px]",children:e?Mc(e):""})})]},e==null?void 0:e.stationuuid)}),R.jsxs("div",{className:"flex items-center gap-1",children:[R.jsx("button",{onClick:()=>{e&&s()},className:`${Ne} rounded-xl ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"} ${!e&&"opacity-50 cursor-not-allowed"}`,disabled:!e,children:Ct?R.jsx(i2,{className:"animate-spin w-5 h-5"}):t?R.jsx(Z0,{className:"w-5 h-5"}):R.jsx(G0,{className:"w-5 h-5 ml-0.5"})}),R.jsx("button",{onClick:()=>e&&a(e),className:`${Ne} rounded-xl ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,disabled:!e,children:R.jsx(Ns,{className:`w-5 h-5 ${h?"text-[#D94E1F] fill-current":"text-gray-400"}`})}),R.jsx(c2,{isDarkMode:F,buttonPadding:Ne}),R.jsx(Qs,{text:xe?"Maximize player (Z)":"Minimize player (Z)",isDarkMode:F,position:"bottom",children:R.jsx("button",{onClick:()=>Ee(!xe),className:`${Ne} rounded-xl ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,children:xe?R.jsx(r2,{className:"w-5 h-5"}):R.jsx(s2,{className:"w-5 h-5"})})})]})]}):R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex justify-between items-center mb-6 blur-on-volume",children:[R.jsx(mR,{currentTime:Ut,showDate:Ve,setShowDate:rt,formatDate:gn,timeRemaining:Z,formatTime:hn,isCollapsed:xe,isDarkMode:F,station:e,isHoveringTime:Ve}),R.jsxs("div",{className:"flex space-x-1",children:[R.jsx(yR,{station:e,isDarkMode:F,onShare:it,buttonPadding:Ne}),R.jsx(c2,{isDarkMode:F,buttonPadding:Ne}),R.jsx(Qs,{text:"L",isDarkMode:F,position:"bottom",children:R.jsx("button",{onClick:oe,className:`${Ne} rounded-xl ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,children:F?R.jsx(UE,{className:"w-5 h-5"}):R.jsx(OE,{className:"w-5 h-5"})})}),R.jsx(Qs,{text:xe?"Maximize player (Z)":"Minimize player (Z)",isDarkMode:F,position:"bottom",children:R.jsx("button",{onClick:()=>Ee(!xe),className:`${Ne} rounded-xl ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,children:xe?R.jsx(r2,{className:"w-5 h-5"}):R.jsx(s2,{className:"w-5 h-5"})})})]})]}),R.jsxs("div",{className:"flex-1 flex flex-col justify-center blur-on-volume",children:[R.jsx(gR,{station:e,isDarkMode:F}),R.jsx("p",{className:`text-sm ${F?"text-gray-400":"text-gray-500"}`,children:e?Mc(e):""})]}),R.jsxs("div",{className:"flex items-center justify-between mt-6",children:[R.jsx("div",{className:"flex items-center",children:R.jsx(Qs,{text:"Space",isDarkMode:F,children:R.jsx("button",{onClick:()=>{e&&s()},className:`${Ne} rounded-xl blur-on-volume ${!e&&"opacity-50 cursor-not-allowed"} ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,disabled:!e,children:Ct?R.jsx(i2,{className:"animate-spin w-5 h-5"}):t?R.jsx(Z0,{className:"w-5 h-5"}):R.jsx(G0,{className:"w-5 h-5 ml-0.5"})})})}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx(uR,{volume:se,onVolumeChange:re,isDarkMode:F}),R.jsx(Qs,{text:"F",isDarkMode:F,position:"top",children:R.jsx("button",{onClick:()=>e&&a(e),className:`${Ne} rounded-xl blur-on-volume ${F?"hover:bg-[#161616]":"hover:bg-[#EFEFEF]"}`,disabled:!e,children:R.jsx(Ns,{className:`w-5 h-5 ${h?"text-[#D94E1F] fill-current":"text-gray-400"}`})})}),R.jsx(Qs,{text:"G",isDarkMode:F,position:"top",children:R.jsx("button",{onClick:()=>fe&&fe(e),className:`${Ne} rounded-xl blur-on-volume ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"} ${!e&&"opacity-50 cursor-not-allowed"}`,disabled:!e,title:"Locate on map",children:R.jsx(jE,{className:"w-5 h-5"})})}),R.jsx(Qs,{text:"R",isDarkMode:F,position:"top",children:R.jsx("button",{onClick:g,className:`${Ne} rounded-xl blur-on-volume ${F?"hover:bg-[#161616] text-gray-400":"hover:bg-[#EFEFEF] text-gray-400"}`,children:R.jsx($E,{className:"w-5 h-5"})})})]})]})]})})]})]})};var WE={exports:{}};(function(e,t){(function(s,a){e.exports=a()})(JP,function(){var s,a,h;function g(c,C){if(!s)s=C;else if(!a)a=C;else{var k="var sharedChunk = {}; ("+s+")(sharedChunk); ("+a+")(sharedChunk);",L={};s(L),h=C(L),typeof window<"u"&&(h.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}g(["exports"],function(c){function C(r,n,o,u){return new(o||(o=Promise))(function(p,y){function x(P){try{T(u.next(P))}catch(I){y(I)}}function w(P){try{T(u.throw(P))}catch(I){y(I)}}function T(P){var I;P.done?p(P.value):(I=P.value,I instanceof o?I:new o(function(D){D(I)})).then(x,w)}T((u=u.apply(r,n||[])).next())})}function k(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var L=B;function B(r,n){this.x=r,this.y=n}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,o=r.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=n,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),o=Math.sin(r),u=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=u,this},_rotateAround:function(r,n){var o=Math.cos(r),u=Math.sin(r),p=n.y+u*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-u*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(r){return r instanceof B?r:Array.isArray(r)?new B(r[0],r[1]):r};var F=k(L),oe=se;function se(r,n,o,u){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=n,this.p2x=o,this.p2y=u}se.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,n){if(n===void 0&&(n=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,u=0;u<8;u++){var p=this.sampleCurveX(o)-r;if(Math.abs(p)<n)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=p/y}var x=0,w=1;for(o=r,u=0;u<20&&(p=this.sampleCurveX(o),!(Math.abs(p-r)<n));u++)r>p?x=o:w=o,o=.5*(w-x)+x;return o},solve:function(r,n){return this.sampleCurveY(this.solveCurveX(r,n))}};var re=k(oe);let ue,Z;function q(){return ue==null&&(ue=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ue}function G(){if(Z==null&&(Z=!1,q())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let u=0;u<5*5;u++){const p=4*u;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(u%5,Math.floor(u/5),1,1)}const o=n.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&o[u]!==u){Z=!0;break}}}return Z||!1}function fe(r,n,o,u){const p=new re(r,n,o,u);return function(y){return p.solve(y)}}const xe=fe(.25,.1,.25,1);function Ee(r,n,o){return Math.min(o,Math.max(n,r))}function Ie(r,n,o){const u=o-n,p=((r-n)%u+u)%u+n;return p===n?o:p}function ke(r,...n){for(const o of n)for(const u in o)r[u]=o[u];return r}let it=1;function Oe(r,n,o){const u={};for(const p in r)u[p]=n.call(o||this,r[p],p,r);return u}function At(r,n,o){const u={};for(const p in r)n.call(o||this,r[p],p,r)&&(u[p]=r[p]);return u}function Ct(r){return Array.isArray(r)?r.map(Ct):typeof r=="object"&&r?Oe(r,Ct):r}const It={};function Ut(r){It[r]||(typeof console<"u"&&console.warn(r),It[r]=!0)}function on(r,n,o){return(o.y-r.y)*(n.x-r.x)>(n.y-r.y)*(o.x-r.x)}function Ve(r){let n=0;for(let o,u,p=0,y=r.length,x=y-1;p<y;x=p++)o=r[p],u=r[x],n+=(u.x-o.x)*(o.y+u.y);return n}function rt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Re=null;function at(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function wt(r,n,o,u,p){return C(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(r,{timestamp:0});try{const x=y==null?void 0:y.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const w=x.startsWith("BGR"),T=new Uint8ClampedArray(u*p*4);if(yield y.copyTo(T,function(P,I,D,j,$){const U=4*Math.max(-I,0),K=(Math.max(0,D)-D)*j*4+U,te=4*j,le=Math.max(0,I),_e=Math.max(0,D);return{rect:{x:le,y:_e,width:Math.min(P.width,I+j)-le,height:Math.min(P.height,D+$)-_e},layout:[{offset:K,stride:te}]}}(r,n,o,u,p)),w)for(let P=0;P<T.length;P+=4){const I=T[P];T[P]=T[P+2],T[P+2]=I}return T}finally{y.close()}})}let Rt,Ft,Nt,hn;const an={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const n=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(r,n=0){return this.getImageCanvasContext(r).getImageData(-n,-n,r.width+2*n,r.height+2*n)},getImageCanvasContext(r){const n=window.document.createElement("canvas"),o=n.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return n.width=r.width,n.height=r.height,o.drawImage(r,0,0,r.width,r.height),o},resolveURL:r=>(Nt||(Nt=document.createElement("a")),Nt.href=r,Nt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(hn==null&&(hn=matchMedia("(prefers-reduced-motion: reduce)")),hn.matches)}},gn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class gi extends Error{constructor(n,o,u,p){super(`AJAXError: ${o} (${n}): ${u}`),this.status=n,this.statusText=o,this.url=u,this.body=p}}const Lt=rt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,tn=r=>gn.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))];function qe(r,n){const o=new AbortController,u=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,cache:r.cache,referrer:Lt(),signal:o.signal});let p=!1,y=!1;return r.type==="json"&&u.headers.set("Accept","application/json"),y||fetch(u).then(x=>x.ok?(w=>{(r.type==="arrayBuffer"||r.type==="image"?w.arrayBuffer():r.type==="json"?w.json():w.text()).then(T=>{y||(p=!0,n(null,T,w.headers.get("Cache-Control"),w.headers.get("Expires")))}).catch(T=>{y||n(new Error(T.message))})})(x):x.blob().then(w=>n(new gi(x.status,x.statusText,r.url,w)))).catch(x=>{x.code!==20&&n(new Error(x.message))}),{cancel:()=>{y=!0,p||o.abort()}}}const ut=function(r,n){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(rt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,n);if(!rt())return(tn(r.url)||qe)(r,n)}if(!(/^file:/.test(o=r.url)||/^file:/.test(Lt())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return qe(r,n);if(rt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,n,void 0,!0)}var o;return function(u,p){const y=new XMLHttpRequest;y.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(y.responseType="arraybuffer");for(const x in u.headers)y.setRequestHeader(x,u.headers[x]);return u.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=u.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let x=y.response;if(u.type==="json")try{x=JSON.parse(y.response)}catch(w){return p(w)}p(null,x,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else{const x=new Blob([y.response],{type:y.getResponseHeader("Content-Type")});p(new gi(y.status,y.statusText,u.url,x))}},y.send(u.body),{cancel:()=>y.abort()}}(r,n)},zt=function(r,n){return ut(ke(r,{type:"arrayBuffer"}),n)};function qt(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const n=new URL(r),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function en(r,n,o){o[r]&&o[r].indexOf(n)!==-1||(o[r]=o[r]||[],o[r].push(n))}function jt(r,n,o){if(o&&o[r]){const u=o[r].indexOf(n);u!==-1&&o[r].splice(u,1)}}class _t{constructor(n,o={}){ke(this,o),this.type=n}}class ki extends _t{constructor(n,o={}){super("error",ke({error:n},o))}}class ms{on(n,o){return this._listeners=this._listeners||{},en(n,o,this._listeners),this}off(n,o){return jt(n,o,this._listeners),jt(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},en(n,o,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,o){typeof n=="string"&&(n=new _t(n,o||{}));const u=n.type;if(this.listens(u)){n.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const w of p)w.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const w of y)jt(u,w,this._oneTimeListeners),w.call(this,n);const x=this._eventedParent;x&&(ke(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof ki&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ti=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function di(r,n){const o={};for(const u in r)u!=="ref"&&(o[u]=r[u]);return ti.forEach(u=>{u in n&&(o[u]=n[u])}),o}function ln(r,n){if(Array.isArray(r)){if(!Array.isArray(n)||r.length!==n.length)return!1;for(let o=0;o<r.length;o++)if(!ln(r[o],n[o]))return!1;return!0}if(typeof r=="object"&&r!==null&&n!==null){if(typeof n!="object"||Object.keys(r).length!==Object.keys(n).length)return!1;for(const o in r)if(!ln(r[o],n[o]))return!1;return!0}return r===n}const Ht={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function rr(r,n,o){o.push({command:Ht.addSource,args:[r,n[r]]})}function Fr(r,n,o){n.push({command:Ht.removeSource,args:[r]}),o[r]=!0}function wr(r,n,o,u){Fr(r,o,u),rr(r,n,o)}function so(r,n,o){let u;for(u in r[o])if(Object.prototype.hasOwnProperty.call(r[o],u)&&u!=="data"&&!ln(r[o][u],n[o][u]))return!1;for(u in n[o])if(Object.prototype.hasOwnProperty.call(n[o],u)&&u!=="data"&&!ln(r[o][u],n[o][u]))return!1;return!0}function gs(r,n,o,u,p,y){let x;for(x in n=n||{},r=r||{})Object.prototype.hasOwnProperty.call(r,x)&&(ln(r[x],n[x])||o.push({command:y,args:[u,x,n[x],p]}));for(x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(r,x)&&(ln(r[x],n[x])||o.push({command:y,args:[u,x,n[x],p]}))}function Br(r){return r.id}function Nr(r,n){return r[n.id]=n,r}class Ze{constructor(n,o,u,p){this.message=(n?`${n}: `:"")+u,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function sr(r,...n){for(const o of n)for(const u in o)r[u]=o[u];return r}class Sn extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class ys{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[u,p]of o)this.bindings[u]=p}concat(n){return new ys(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Jr={kind:"null"},He={kind:"number"},Tt={kind:"string"},bt={kind:"boolean"},Nn={kind:"color"},yi={kind:"object"},Et={kind:"value"},br={kind:"collator"},J={kind:"formatted"},N={kind:"padding"},O={kind:"resolvedImage"},W={kind:"variableAnchorOffsetCollection"};function ee(r,n){return{kind:"array",itemType:r,N:n}}function ne(r){if(r.kind==="array"){const n=ne(r.itemType);return typeof r.N=="number"?`array<${n}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${n}>`}return r.kind}const we=[Jr,He,Tt,bt,Nn,J,yi,ee(Et),N,O,W];function pe(r,n){if(n.kind==="error")return null;if(r.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!pe(r.itemType,n.itemType))&&(typeof r.N!="number"||r.N===n.N))return null}else{if(r.kind===n.kind)return null;if(r.kind==="value"){for(const o of we)if(!pe(o,n))return null}}return`Expected ${ne(r)} but found ${ne(n)} instead.`}function ae(r,n){return n.some(o=>o.kind===r.kind)}function ge(r,n){return n.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}function he(r,n){return r.kind==="array"&&n.kind==="array"?r.itemType.kind===n.itemType.kind&&typeof r.N=="number":r.kind===n.kind}const ve=.96422,Te=.82521,Qe=4/29,Ge=6/29,Ue=3*Ge*Ge,ct=Ge*Ge*Ge,St=Math.PI/180,Jt=180/Math.PI;function cn(r){return(r%=360)<0&&(r+=360),r}function Ot([r,n,o,u]){let p,y;const x=pi((.2225045*(r=Dt(r))+.7168786*(n=Dt(n))+.0606169*(o=Dt(o)))/1);r===n&&n===o?p=y=x:(p=pi((.4360747*r+.3850649*n+.1430804*o)/ve),y=pi((.0139322*r+.0971045*n+.7141733*o)/Te));const w=116*x-16;return[w<0?0:w,500*(p-x),200*(x-y),u]}function Dt(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function pi(r){return r>ct?Math.pow(r,1/3):r/Ue+Qe}function yn([r,n,o,u]){let p=(r+16)/116,y=isNaN(n)?p:p+n/500,x=isNaN(o)?p:p-o/200;return p=1*_i(p),y=ve*_i(y),x=Te*_i(x),[Xn(3.1338561*y-1.6168667*p-.4906146*x),Xn(-.9787684*y+1.9161415*p+.033454*x),Xn(.0719453*y-.2289914*p+1.4052427*x),u]}function Xn(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function _i(r){return r>Ge?r*r*r:Ue*(r-Qe)}function Sr(r){return parseInt(r.padEnd(2,r),16)/255}function yd(r,n){return Bo(n?r/100:r,0,1)}function Bo(r,n,o){return Math.min(Math.max(n,r),o)}function No(r){return!r.some(Number.isNaN)}const Lm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class dn{constructor(n,o,u,p=1,y=!0){this.r=n,this.g=o,this.b=u,this.a=p,y||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,o,u,p]))}static parse(n){if(n instanceof dn)return n;if(typeof n!="string")return;const o=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=Lm[u];if(p){const[x,w,T]=p;return[x/255,w/255,T/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const x=u.length<6?1:2;let w=1;return[Sr(u.slice(w,w+=x)),Sr(u.slice(w,w+=x)),Sr(u.slice(w,w+=x)),Sr(u.slice(w,w+x)||"ff")]}if(u.startsWith("rgb")){const x=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,P,I,D,j,$,U,K,te,le,_e]=x,de=[I||" ",$||" ",te].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const be=[P,j,K].join(""),Ce=be==="%%%"?100:be===""?255:0;if(Ce){const De=[Bo(+T/Ce,0,1),Bo(+D/Ce,0,1),Bo(+U/Ce,0,1),le?yd(+le,_e):1];if(No(De))return De}}return}}const y=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,w,T,P,I,D,j,$,U]=y,K=[T||" ",I||" ",j].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const te=[+w,Bo(+P,0,100),Bo(+D,0,100),$?yd(+$,U):1];if(No(te))return function([le,_e,de,be]){function Ce(De){const nt=(De+le/30)%12,dt=_e*Math.min(de,1-de);return de-dt*Math.max(-1,Math.min(nt-3,9-nt,1))}return le=cn(le),_e/=100,de/=100,[Ce(0),Ce(8),Ce(4),be]}(te)}}}(n);return o?new dn(...o,!1):void 0}get rgb(){const{r:n,g:o,b:u,a:p}=this,y=p||1/0;return this.overwriteGetter("rgb",[n/y,o/y,u/y,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[o,u,p,y]=Ot(n),x=Math.sqrt(u*u+p*p);return[Math.round(1e4*x)?cn(Math.atan2(p,u)*Jt):NaN,x,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ot(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,u,p]=this.rgb;return`rgba(${[n,o,u].map(y=>Math.round(255*y)).join(",")},${p})`}}dn.black=new dn(0,0,0,1),dn.white=new dn(1,1,1,1),dn.transparent=new dn(0,0,0,0),dn.red=new dn(1,0,0,1);class Xc{constructor(n,o,u){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vl{constructor(n,o,u,p,y){this.text=n,this.image=o,this.scale=u,this.fontStack=p,this.textColor=y}}class Ei{constructor(n){this.sections=n}static fromString(n){return new Ei([new vl(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Ei?n:Ei.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class or{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof or)return n;if(typeof n=="number")return new or([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new or(n)}}toString(){return JSON.stringify(this.values)}}const zm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Tr)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let o=0;o<n.length;o+=2){const u=n[o],p=n[o+1];if(typeof u!="string"||!zm.has(u)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Tr(n)}}toString(){return JSON.stringify(this.values)}}class xi{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new xi({name:n,available:!1}):null}}function wl(r,n,o,u){return typeof r=="number"&&r>=0&&r<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[r,n,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[r,n,o,u]:[r,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function jo(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof dn||r instanceof Xc||r instanceof Ei||r instanceof or||r instanceof Tr||r instanceof xi)return!0;if(Array.isArray(r)){for(const n of r)if(!jo(n))return!1;return!0}if(typeof r=="object"){for(const n in r)if(!jo(r[n]))return!1;return!0}return!1}function En(r){if(r===null)return Jr;if(typeof r=="string")return Tt;if(typeof r=="boolean")return bt;if(typeof r=="number")return He;if(r instanceof dn)return Nn;if(r instanceof Xc)return br;if(r instanceof Ei)return J;if(r instanceof or)return N;if(r instanceof Tr)return W;if(r instanceof xi)return O;if(Array.isArray(r)){const n=r.length;let o;for(const u of r){const p=En(u);if(o){if(o===p)continue;o=Et;break}o=p}return ee(o||Et,n)}return yi}function nn(r){const n=typeof r;return r===null?"":n==="string"||n==="number"||n==="boolean"?String(r):r instanceof dn||r instanceof Ei||r instanceof or||r instanceof Tr||r instanceof xi?r.toString():JSON.stringify(r)}class oo{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!jo(n[1]))return o.error("invalid value");const u=n[1];let p=En(u);const y=o.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new oo(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ln{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const bl={string:Tt,number:He,boolean:bt,object:yi};class kr{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let u,p=1;const y=n[0];if(y==="array"){let w,T;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in bl)||P==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);w=bl[P],p++}else w=Et;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=n[2],p++}u=ee(w,T)}else{if(!bl[y])throw new Error(`Types doesn't contain name = ${y}`);u=bl[y]}const x=[];for(;p<n.length;p++){const w=o.parse(n[p],p,Et);if(!w)return null;x.push(w)}return new kr(u,x)}evaluate(n){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(n);if(!pe(this.type,En(u)))return u;if(o===this.args.length-1)throw new Ln(`Expected value to be of type ${ne(this.type)}, but found ${ne(En(u))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Yc={"to-boolean":bt,"to-color":Nn,"to-number":He,"to-string":Tt};class Os{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[0];if(!Yc[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&n.length!==2)return o.error("Expected one argument.");const p=Yc[u],y=[];for(let x=1;x<n.length;x++){const w=o.parse(n[x],x,Et);if(!w)return null;y.push(w)}return new Os(p,y)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let o,u;for(const p of this.args){if(o=p.evaluate(n),u=null,o instanceof dn)return o;if(typeof o=="string"){const y=n.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:wl(o[0],o[1],o[2],o[3]),!u))return new dn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Ln(u||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const u of this.args){o=u.evaluate(n);const p=or.parse(o);if(p)return p}throw new Ln(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const u of this.args){o=u.evaluate(n);const p=Tr.parse(o);if(p)return p}throw new Ln(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const u of this.args){if(o=u.evaluate(n),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new Ln(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Ei.fromString(nn(this.args[0].evaluate(n)));case"resolvedImage":return xi.fromString(nn(this.args[0].evaluate(n)));default:return nn(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const _d=["Unknown","Point","LineString","Polygon"];class Jc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_d[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache[n];return o||(o=this._parseColorCache[n]=dn.parse(n)),o}}class Sl{constructor(n,o,u=[],p,y=new ys,x=[]){this.registry=n,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=y,this.errors=x,this.expectedType=p,this._isConstant=o}parse(n,o,u,p,y={}){return o?this.concat(o,u,p)._parse(n,y):this._parse(n,y)}_parse(n,o){function u(p,y,x){return x==="assert"?new kr(y,[p]):x==="coerce"?new Os(y,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let x=y.parse(n,this);if(!x)return null;if(this.expectedType){const w=this.expectedType,T=x.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||T.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(w.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(w,T))return null}else x=u(x,w,o.typeAnnotation||"coerce");else x=u(x,w,o.typeAnnotation||"coerce");else x=u(x,w,o.typeAnnotation||"coerce");else x=u(x,w,o.typeAnnotation||"assert")}if(!(x instanceof oo)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const w=new Jc;try{x=new oo(x.type,x.evaluate(w))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,u){const p=typeof n=="number"?this.path.concat(n):this.path,y=u?this.scope.concat(u):this.scope;return new Sl(this.registry,this._isConstant,p,o||null,y,this.errors)}error(n,...o){const u=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new Sn(u,n))}checkSubtype(n,o){const u=pe(n,o);return u&&this.error(u),u}}class Tl{constructor(n,o,u){this.type=br,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const p=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,bt);if(!p)return null;const y=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,bt);if(!y)return null;let x=null;return u.locale&&(x=o.parse(u.locale,1,Tt),!x)?null:new Tl(p,y,x)}evaluate(n){return new Xc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}const Vs=8192;function Qc(r,n){r[0]=Math.min(r[0],n[0]),r[1]=Math.min(r[1],n[1]),r[2]=Math.max(r[2],n[0]),r[3]=Math.max(r[3],n[1])}function Pa(r,n){return!(r[0]<=n[0]||r[2]>=n[2]||r[1]<=n[1]||r[3]>=n[3])}function xd(r,n){const o=(180+r[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(o*p*Vs),Math.round(u*p*Vs)]}function Dm(r,n,o){const u=r[0]-n[0],p=r[1]-n[1],y=r[0]-o[0],x=r[1]-o[1];return u*x-y*p==0&&u*y<=0&&p*x<=0}function eu(r,n){let o=!1;for(let x=0,w=n.length;x<w;x++){const T=n[x];for(let P=0,I=T.length;P<I-1;P++){if(Dm(r,T[P],T[P+1]))return!1;(p=T[P])[1]>(u=r)[1]!=(y=T[P+1])[1]>u[1]&&u[0]<(y[0]-p[0])*(u[1]-p[1])/(y[1]-p[1])+p[0]&&(o=!o)}}var u,p,y;return o}function tu(r,n){for(let o=0;o<n.length;o++)if(eu(r,n[o]))return!0;return!1}function vd(r,n,o,u){const p=u[0]-o[0],y=u[1]-o[1],x=(r[0]-o[0])*y-p*(r[1]-o[1]),w=(n[0]-o[0])*y-p*(n[1]-o[1]);return x>0&&w<0||x<0&&w>0}function Rm(r,n,o){for(const P of o)for(let I=0;I<P.length-1;++I)if((w=[(x=P[I+1])[0]-(y=P[I])[0],x[1]-y[1]])[0]*(T=[(p=n)[0]-(u=r)[0],p[1]-u[1]])[1]-w[1]*T[0]!=0&&vd(u,p,y,x)&&vd(y,x,u,p))return!0;var u,p,y,x,w,T;return!1}function wd(r,n){for(let o=0;o<r.length;++o)if(!eu(r[o],n))return!1;for(let o=0;o<r.length-1;++o)if(Rm(r[o],r[o+1],n))return!1;return!0}function bd(r,n){for(let o=0;o<n.length;o++)if(wd(r,n[o]))return!0;return!1}function kl(r,n,o){const u=[];for(let p=0;p<r.length;p++){const y=[];for(let x=0;x<r[p].length;x++){const w=xd(r[p][x],o);Qc(n,w),y.push(w)}u.push(y)}return u}function Sd(r,n,o){const u=[];for(let p=0;p<r.length;p++){const y=kl(r[p],n,o);u.push(y)}return u}function Td(r,n,o,u){if(r[0]<o[0]||r[0]>o[2]){const p=.5*u;let y=r[0]-o[0]>p?-u:o[0]-r[0]>p?u:0;y===0&&(y=r[0]-o[2]>p?-u:o[2]-r[0]>p?u:0),r[0]+=y}Qc(n,r)}function nu(r,n,o,u){const p=Math.pow(2,u.z)*Vs,y=[u.x*Vs,u.y*Vs],x=[];for(const w of r)for(const T of w){const P=[T.x+y[0],T.y+y[1]];Td(P,n,o,p),x.push(P)}return x}function iu(r,n,o,u){const p=Math.pow(2,u.z)*Vs,y=[u.x*Vs,u.y*Vs],x=[];for(const T of r){const P=[];for(const I of T){const D=[I.x+y[0],I.y+y[1]];Qc(n,D),P.push(D)}x.push(P)}if(n[2]-n[0]<=p/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of x)for(const P of T)Td(P,n,o,p)}var w;return x}class ao{constructor(n,o){this.type=bt,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(jo(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const y=u.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new ao(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new ao(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new ao(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const w=kl(u.coordinates,y,x),T=nu(o.geometry(),p,y,x);if(!Pa(p,y))return!1;for(const P of T)if(!eu(P,w))return!1}if(u.type==="MultiPolygon"){const w=Sd(u.coordinates,y,x),T=nu(o.geometry(),p,y,x);if(!Pa(p,y))return!1;for(const P of T)if(!tu(P,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const w=kl(u.coordinates,y,x),T=iu(o.geometry(),p,y,x);if(!Pa(p,y))return!1;for(const P of T)if(!wd(P,w))return!1}if(u.type==="MultiPolygon"){const w=Sd(u.coordinates,y,x),T=iu(o.geometry(),p,y,x);if(!Pa(p,y))return!1;for(const P of T)if(!bd(P,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class El{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=n[1];return o.scope.has(u)?new El(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Er{constructor(n,o,u,p){this.name=n,this.type=o,this._evaluate=u,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const u=n[0],p=Er.definitions[u];if(!p)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=x.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let T=null;for(const[P,I]of w){T=new Sl(o.registry,Cl,o.path,null,o.scope);const D=[];let j=!1;for(let $=1;$<n.length;$++){const U=n[$],K=Array.isArray(P)?P[$-1]:P.type,te=T.parse(U,1+D.length,K);if(!te){j=!0;break}D.push(te)}if(!j)if(Array.isArray(P)&&P.length!==D.length)T.error(`Expected ${P.length} arguments, but found ${D.length} instead.`);else{for(let $=0;$<D.length;$++){const U=Array.isArray(P)?P[$]:P.type,K=D[$];T.concat($+1).checkSubtype(U,K.type)}if(T.errors.length===0)return new Er(u,y,I,D)}}if(w.length===1)o.errors.push(...T.errors);else{const P=(w.length?w:x).map(([D])=>{return j=D,Array.isArray(j)?`(${j.map(ne).join(", ")})`:`(${ne(j.type)}...)`;var j}).join(" | "),I=[];for(let D=1;D<n.length;D++){const j=o.parse(n[D],1+I.length);if(!j)return null;I.push(ne(j.type))}o.error(`Expected arguments of type ${P}, but found (${I.join(", ")}) instead.`)}return null}static register(n,o){Er.definitions=o;for(const u in o)n[u]=Er}}function Cl(r){if(r instanceof El)return Cl(r.boundExpression);if(r instanceof Er&&r.name==="error"||r instanceof Tl||r instanceof ao)return!1;const n=r instanceof Os||r instanceof kr;let o=!0;return r.eachChild(u=>{o=n?o&&Cl(u):o&&u instanceof oo}),!!o&&Pl(r)&&Al(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Pl(r){if(r instanceof Er&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof ao)return!1;let n=!0;return r.eachChild(o=>{n&&!Pl(o)&&(n=!1)}),n}function Aa(r){if(r instanceof Er&&r.name==="feature-state")return!1;let n=!0;return r.eachChild(o=>{n&&!Aa(o)&&(n=!1)}),n}function Al(r,n){if(r instanceof Er&&n.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(u=>{o&&!Al(u,n)&&(o=!1)}),o}function Oo(r,n){const o=r.length-1;let u,p,y=0,x=o,w=0;for(;y<=x;)if(w=Math.floor((y+x)/2),u=r[w],p=r[w+1],u<=n){if(w===o||n<p)return w;y=w+1}else{if(!(u>n))throw new Ln("Input is not a number.");x=w-1}return 0}class $s{constructor(n,o,u){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[p,y]of u)this.labels.push(p),this.outputs.push(y)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(n[1],1,He);if(!u)return null;const p=[];let y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let x=1;x<n.length;x+=2){const w=x===1?-1/0:n[x],T=n[x+1],P=x,I=x+1;if(typeof w!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=w)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const D=o.parse(T,I,y);if(!D)return null;y=y||D.type,p.push([w,D])}return new $s(y,u,p)}evaluate(n){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return u[0].evaluate(n);const y=o.length;return p>=o[y-1]?u[y-1].evaluate(n):u[Oo(o,p)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Xt(r,n,o){return r+o*(n-r)}function Il(r,n,o){return r.map((u,p)=>Xt(u,n[p],o))}const ar={number:Xt,color:function(r,n,o,u="rgb"){switch(u){case"rgb":{const[p,y,x,w]=Il(r.rgb,n.rgb,o);return new dn(p,y,x,w,!1)}case"hcl":{const[p,y,x,w]=r.hcl,[T,P,I,D]=n.hcl;let j,$;if(isNaN(p)||isNaN(T))isNaN(p)?isNaN(T)?j=NaN:(j=T,x!==1&&x!==0||($=P)):(j=p,I!==1&&I!==0||($=y));else{let _e=T-p;T>p&&_e>180?_e-=360:T<p&&p-T>180&&(_e+=360),j=p+o*_e}const[U,K,te,le]=function([_e,de,be,Ce]){return _e=isNaN(_e)?0:_e*St,yn([be,Math.cos(_e)*de,Math.sin(_e)*de,Ce])}([j,$??Xt(y,P,o),Xt(x,I,o),Xt(w,D,o)]);return new dn(U,K,te,le,!1)}case"lab":{const[p,y,x,w]=yn(Il(r.lab,n.lab,o));return new dn(p,y,x,w,!1)}}},array:Il,padding:function(r,n,o){return new or(Il(r.values,n.values,o))},variableAnchorOffsetCollection:function(r,n,o){const u=r.values,p=n.values;if(u.length!==p.length)throw new Ln(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${n.toString()}`);const y=[];for(let x=0;x<u.length;x+=2){if(u[x]!==p[x])throw new Ln(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${u[x]}, to[${x}]: ${p[x]}`);y.push(u[x]);const[w,T]=u[x+1],[P,I]=p[x+1];y.push([Xt(w,P,o),Xt(T,I,o)])}return new Tr(y)}};class lr{constructor(n,o,u,p,y){this.type=n,this.operator=o,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[x,w]of y)this.labels.push(x),this.outputs.push(w)}static interpolationFactor(n,o,u,p){let y=0;if(n.name==="exponential")y=ru(o,n.base,u,p);else if(n.name==="linear")y=ru(o,1,u,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;y=new re(x[0],x[1],x[2],x[3]).solve(ru(o,1,u,p))}return y}static parse(n,o){let[u,p,y,...x]=n;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some(I=>typeof I!="number"||I<0||I>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,He),!y)return null;const w=[];let T=null;u==="interpolate-hcl"||u==="interpolate-lab"?T=Nn:o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let P=0;P<x.length;P+=2){const I=x[P],D=x[P+1],j=P+3,$=P+4;if(typeof I!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(w.length&&w[w.length-1][0]>=I)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const U=o.parse(D,$,T);if(!U)return null;T=T||U.type,w.push([I,U])}return he(T,He)||he(T,Nn)||he(T,N)||he(T,W)||he(T,ee(He))?new lr(T,u,p,y,w):o.error(`Type ${ne(T)} is not interpolatable.`)}evaluate(n){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return u[0].evaluate(n);const y=o.length;if(p>=o[y-1])return u[y-1].evaluate(n);const x=Oo(o,p),w=lr.interpolationFactor(this.interpolation,p,o[x],o[x+1]),T=u[x].evaluate(n),P=u[x+1].evaluate(n);switch(this.operator){case"interpolate":return ar[this.type.kind](T,P,w);case"interpolate-hcl":return ar.color(T,P,w,"hcl");case"interpolate-lab":return ar.color(T,P,w,"lab")}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function ru(r,n,o,u){const p=u-o,y=r-o;return p===0?0:n===1?y/p:(Math.pow(n,y)-1)/(Math.pow(n,p)-1)}class Ml{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let u=null;const p=o.expectedType;p&&p.kind!=="value"&&(u=p);const y=[];for(const w of n.slice(1)){const T=o.parse(w,1+y.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,y.push(T)}if(!u)throw new Error("No output type");const x=p&&y.some(w=>pe(p,w.type));return new Ml(x?Et:u,y)}evaluate(n){let o,u=null,p=0;for(const y of this.args)if(p++,u=y.evaluate(n),u&&u instanceof xi&&!u.available&&(o||(o=u.name),u=null,p===this.args.length&&(u=o)),u!==null)break;return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}class Ll{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let y=1;y<n.length-1;y+=2){const x=n[y];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);const w=o.parse(n[y+1],y+1);if(!w)return null;u.push([x,w])}const p=o.parse(n[n.length-1],n.length-1,o.expectedType,u);return p?new Ll(u,p):null}outputDefined(){return this.result.outputDefined()}}class su{constructor(n,o,u){this.type=n,this.index=o,this.input=u}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,He),p=o.parse(n[2],2,ee(o.expectedType||Et));return u&&p?new su(p.type.itemType,u,p):null}evaluate(n){const o=this.index.evaluate(n),u=this.input.evaluate(n);if(o<0)throw new Ln(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new Ln(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new Ln(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class ou{constructor(n,o){this.type=bt,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,Et),p=o.parse(n[2],2,Et);return u&&p?ae(u.type,[bt,Tt,He,Jr,Et])?new ou(u,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(u.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!u)return!1;if(!ge(o,["boolean","string","number","null"]))throw new Ln(`Expected first argument to be of type boolean, string, number or null, but found ${ne(En(o))} instead.`);if(!ge(u,["string","array"]))throw new Ln(`Expected second argument to be of type array or string, but found ${ne(En(u))} instead.`);return u.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class zl{constructor(n,o,u){this.type=He,this.needle=n,this.haystack=o,this.fromIndex=u}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,Et),p=o.parse(n[2],2,Et);if(!u||!p)return null;if(!ae(u.type,[bt,Tt,He,Jr,Et]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(u.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,He);return y?new zl(u,p,y):null}return new zl(u,p)}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!ge(o,["boolean","string","number","null"]))throw new Ln(`Expected first argument to be of type boolean, string, number or null, but found ${ne(En(o))} instead.`);if(!ge(u,["string","array"]))throw new Ln(`Expected second argument to be of type array or string, but found ${ne(En(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return u.indexOf(o,p)}return u.indexOf(o)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class au{constructor(n,o,u,p,y,x){this.inputType=n,this.type=o,this.input=u,this.cases=p,this.outputs=y,this.otherwise=x}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let u,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const y={},x=[];for(let P=2;P<n.length-1;P+=2){let I=n[P];const D=n[P+1];Array.isArray(I)||(I=[I]);const j=o.concat(P);if(I.length===0)return j.error("Expected at least one branch label.");for(const U of I){if(typeof U!="number"&&typeof U!="string")return j.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof U=="number"&&Math.floor(U)!==U)return j.error("Numeric branch labels must be integer values.");if(u){if(j.checkSubtype(u,En(U)))return null}else u=En(U);if(y[String(U)]!==void 0)return j.error("Branch labels must be unique.");y[String(U)]=x.length}const $=o.parse(D,P,p);if(!$)return null;p=p||$.type,x.push($)}const w=o.parse(n[1],1,Et);if(!w)return null;const T=o.parse(n[n.length-1],n.length-1,p);return T?w.type.kind!=="value"&&o.concat(1).checkSubtype(u,w.type)?null:new au(u,p,w,y,x,T):null}evaluate(n){const o=this.input.evaluate(n);return(En(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class lu{constructor(n,o,u){this.type=n,this.branches=o,this.otherwise=u}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const w=o.parse(n[x],x,bt);if(!w)return null;const T=o.parse(n[x+1],x+1,u);if(!T)return null;p.push([w,T]),u=u||T.type}const y=o.parse(n[n.length-1],n.length-1,u);if(!y)return null;if(!u)throw new Error("Can't infer output type");return new lu(u,p,y)}evaluate(n){for(const[o,u]of this.branches)if(o.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,u]of this.branches)n(o),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Dl{constructor(n,o,u,p){this.type=n,this.input=o,this.beginIndex=u,this.endIndex=p}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,Et),p=o.parse(n[2],2,He);if(!u||!p)return null;if(!ae(u.type,[ee(Et),Tt,Et]))return o.error(`Expected first argument to be of type array or string, but found ${ne(u.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,He);return y?new Dl(u.type,u,p,y):null}return new Dl(u.type,u,p)}evaluate(n){const o=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!ge(o,["string","array"]))throw new Ln(`Expected first argument to be of type array or string, but found ${ne(En(o))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return o.slice(u,p)}return o.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function kd(r,n){return r==="=="||r==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Ed(r,n,o,u){return u.compare(n,o)===0}function Vo(r,n,o){const u=r!=="=="&&r!=="!=";return class HE{constructor(y,x,w){this.type=bt,this.lhs=y,this.rhs=x,this.collator=w,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const w=y[0];let T=x.parse(y[1],1,Et);if(!T)return null;if(!kd(w,T.type))return x.concat(1).error(`"${w}" comparisons are not supported for type '${ne(T.type)}'.`);let P=x.parse(y[2],2,Et);if(!P)return null;if(!kd(w,P.type))return x.concat(2).error(`"${w}" comparisons are not supported for type '${ne(P.type)}'.`);if(T.type.kind!==P.type.kind&&T.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${ne(T.type)}' and '${ne(P.type)}'.`);u&&(T.type.kind==="value"&&P.type.kind!=="value"?T=new kr(P.type,[T]):T.type.kind!=="value"&&P.type.kind==="value"&&(P=new kr(T.type,[P])));let I=null;if(y.length===4){if(T.type.kind!=="string"&&P.type.kind!=="string"&&T.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(I=x.parse(y[3],3,br),!I)return null}return new HE(T,P,I)}evaluate(y){const x=this.lhs.evaluate(y),w=this.rhs.evaluate(y);if(u&&this.hasUntypedArgument){const T=En(x),P=En(w);if(T.kind!==P.kind||T.kind!=="string"&&T.kind!=="number")throw new Ln(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${P.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=En(x),P=En(w);if(T.kind!=="string"||P.kind!=="string")return n(y,x,w)}return this.collator?o(y,x,w,this.collator.evaluate(y)):n(y,x,w)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Fm=Vo("==",function(r,n,o){return n===o},Ed),Bm=Vo("!=",function(r,n,o){return n!==o},function(r,n,o,u){return!Ed(0,n,o,u)}),Nm=Vo("<",function(r,n,o){return n<o},function(r,n,o,u){return u.compare(n,o)<0}),jm=Vo(">",function(r,n,o){return n>o},function(r,n,o,u){return u.compare(n,o)>0}),Om=Vo("<=",function(r,n,o){return n<=o},function(r,n,o,u){return u.compare(n,o)<=0}),Vm=Vo(">=",function(r,n,o){return n>=o},function(r,n,o,u){return u.compare(n,o)>=0});class cu{constructor(n,o,u,p,y){this.type=Tt,this.number=n,this.locale=o,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const u=o.parse(n[1],1,He);if(!u)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=o.parse(p.locale,1,Tt),!y))return null;let x=null;if(p.currency&&(x=o.parse(p.currency,1,Tt),!x))return null;let w=null;if(p["min-fraction-digits"]&&(w=o.parse(p["min-fraction-digits"],1,He),!w))return null;let T=null;return p["max-fraction-digits"]&&(T=o.parse(p["max-fraction-digits"],1,He),!T)?null:new cu(u,y,x,w,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Rl{constructor(n){this.type=J,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const p=[];let y=!1;for(let x=1;x<=n.length-1;++x){const w=n[x];if(y&&typeof w=="object"&&!Array.isArray(w)){y=!1;let T=null;if(w["font-scale"]&&(T=o.parse(w["font-scale"],1,He),!T))return null;let P=null;if(w["text-font"]&&(P=o.parse(w["text-font"],1,ee(Tt)),!P))return null;let I=null;if(w["text-color"]&&(I=o.parse(w["text-color"],1,Nn),!I))return null;const D=p[p.length-1];D.scale=T,D.font=P,D.textColor=I}else{const T=o.parse(n[x],1,Et);if(!T)return null;const P=T.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new Rl(p)}evaluate(n){return new Ei(this.sections.map(o=>{const u=o.content.evaluate(n);return En(u)===O?new vl("",u,null,null,null):new vl(nn(u),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}}class uu{constructor(n){this.type=O,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const u=o.parse(n[1],1,Tt);return u?new uu(u):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),u=xi.fromString(o);return u&&n.availableImages&&(u.available=n.availableImages.indexOf(o)>-1),u}eachChild(n){n(this.input)}outputDefined(){return!1}}class hu{constructor(n){this.type=He,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=o.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ne(u.type)} instead.`):new hu(u):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Ln(`Expected value to be of type string or array, but found ${ne(En(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const $o={"==":Fm,"!=":Bm,">":jm,"<":Nm,">=":Vm,"<=":Om,array:kr,at:su,boolean:kr,case:lu,coalesce:Ml,collator:Tl,format:Rl,image:uu,in:ou,"index-of":zl,interpolate:lr,"interpolate-hcl":lr,"interpolate-lab":lr,length:hu,let:Ll,literal:oo,match:au,number:kr,"number-format":cu,object:kr,slice:Dl,step:$s,string:kr,"to-boolean":Os,"to-color":Os,"to-number":Os,"to-string":Os,var:El,within:ao};function Cd(r,[n,o,u,p]){n=n.evaluate(r),o=o.evaluate(r),u=u.evaluate(r);const y=p?p.evaluate(r):1,x=wl(n,o,u,y);if(x)throw new Ln(x);return new dn(n/255,o/255,u/255,y,!1)}function Pd(r,n){return r in n}function du(r,n){const o=n[r];return o===void 0?null:o}function lo(r){return{type:r}}function Ad(r){return{result:"success",value:r}}function Us(r){return{result:"error",value:r}}function Uo(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Id(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function pu(r){return!!r.expression&&r.expression.interpolated}function rn(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Cn(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function $m(r){return r}function Yt(r,n){const o=n.type==="color",u=r.stops&&typeof r.stops[0][0]=="object",p=u||!(u||r.property!==void 0),y=r.type||(pu(n)?"exponential":"interval");if(o||n.type==="padding"){const I=o?dn.parse:or.parse;(r=sr({},r)).stops&&(r.stops=r.stops.map(D=>[D[0],I(D[1])])),r.default=I(r.default?r.default:n.default)}if(r.colorSpace&&(x=r.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var x;let w,T,P;if(y==="exponential")w=Ia;else if(y==="interval")w=Tn;else if(y==="categorical"){w=Pn,T=Object.create(null);for(const I of r.stops)T[I[0]]=I[1];P=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=Md}if(u){const I={},D=[];for(let U=0;U<r.stops.length;U++){const K=r.stops[U],te=K[0].zoom;I[te]===void 0&&(I[te]={zoom:te,type:r.type,property:r.property,default:r.default,stops:[]},D.push(te)),I[te].stops.push([K[0].value,K[1]])}const j=[];for(const U of D)j.push([I[U].zoom,Yt(I[U],n)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:lr.interpolationFactor.bind(void 0,$),zoomStops:j.map(U=>U[0]),evaluate:({zoom:U},K)=>Ia({stops:j,base:r.base},n,U).evaluate(U,K)}}if(p){const I=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:lr.interpolationFactor.bind(void 0,I),zoomStops:r.stops.map(D=>D[0]),evaluate:({zoom:D})=>w(r,n,D,T,P)}}return{kind:"source",evaluate(I,D){const j=D&&D.properties?D.properties[r.property]:void 0;return j===void 0?co(r.default,n.default):w(r,n,j,T,P)}}}function co(r,n,o){return r!==void 0?r:n!==void 0?n:o!==void 0?o:void 0}function Pn(r,n,o,u,p){return co(typeof o===p?u[o]:void 0,r.default,n.default)}function Tn(r,n,o){if(rn(o)!=="number")return co(r.default,n.default);const u=r.stops.length;if(u===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[u-1][0])return r.stops[u-1][1];const p=Oo(r.stops.map(y=>y[0]),o);return r.stops[p][1]}function Ia(r,n,o){const u=r.base!==void 0?r.base:1;if(rn(o)!=="number")return co(r.default,n.default);const p=r.stops.length;if(p===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[p-1][0])return r.stops[p-1][1];const y=Oo(r.stops.map(I=>I[0]),o),x=function(I,D,j,$){const U=$-j,K=I-j;return U===0?0:D===1?K/U:(Math.pow(D,K)-1)/(Math.pow(D,U)-1)}(o,u,r.stops[y][0],r.stops[y+1][0]),w=r.stops[y][1],T=r.stops[y+1][1],P=ar[n.type]||$m;return typeof w.evaluate=="function"?{evaluate(...I){const D=w.evaluate.apply(void 0,I),j=T.evaluate.apply(void 0,I);if(D!==void 0&&j!==void 0)return P(D,j,x,r.colorSpace)}}:P(w,T,x,r.colorSpace)}function Md(r,n,o){switch(n.type){case"color":o=dn.parse(o);break;case"formatted":o=Ei.fromString(o.toString());break;case"resolvedImage":o=xi.fromString(o.toString());break;case"padding":o=or.parse(o);break;default:rn(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return co(o,r.default,n.default)}Er.register($o,{error:[{kind:"error"},[Tt],(r,[n])=>{throw new Ln(n.evaluate(r))}],typeof:[Tt,[Et],(r,[n])=>ne(En(n.evaluate(r)))],"to-rgba":[ee(He,4),[Nn],(r,[n])=>{const[o,u,p,y]=n.evaluate(r).rgb;return[255*o,255*u,255*p,y]}],rgb:[Nn,[He,He,He],Cd],rgba:[Nn,[He,He,He,He],Cd],has:{type:bt,overloads:[[[Tt],(r,[n])=>Pd(n.evaluate(r),r.properties())],[[Tt,yi],(r,[n,o])=>Pd(n.evaluate(r),o.evaluate(r))]]},get:{type:Et,overloads:[[[Tt],(r,[n])=>du(n.evaluate(r),r.properties())],[[Tt,yi],(r,[n,o])=>du(n.evaluate(r),o.evaluate(r))]]},"feature-state":[Et,[Tt],(r,[n])=>du(n.evaluate(r),r.featureState||{})],properties:[yi,[],r=>r.properties()],"geometry-type":[Tt,[],r=>r.geometryType()],id:[Et,[],r=>r.id()],zoom:[He,[],r=>r.globals.zoom],"heatmap-density":[He,[],r=>r.globals.heatmapDensity||0],"line-progress":[He,[],r=>r.globals.lineProgress||0],accumulated:[Et,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[He,lo(He),(r,n)=>{let o=0;for(const u of n)o+=u.evaluate(r);return o}],"*":[He,lo(He),(r,n)=>{let o=1;for(const u of n)o*=u.evaluate(r);return o}],"-":{type:He,overloads:[[[He,He],(r,[n,o])=>n.evaluate(r)-o.evaluate(r)],[[He],(r,[n])=>-n.evaluate(r)]]},"/":[He,[He,He],(r,[n,o])=>n.evaluate(r)/o.evaluate(r)],"%":[He,[He,He],(r,[n,o])=>n.evaluate(r)%o.evaluate(r)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(r,[n,o])=>Math.pow(n.evaluate(r),o.evaluate(r))],sqrt:[He,[He],(r,[n])=>Math.sqrt(n.evaluate(r))],log10:[He,[He],(r,[n])=>Math.log(n.evaluate(r))/Math.LN10],ln:[He,[He],(r,[n])=>Math.log(n.evaluate(r))],log2:[He,[He],(r,[n])=>Math.log(n.evaluate(r))/Math.LN2],sin:[He,[He],(r,[n])=>Math.sin(n.evaluate(r))],cos:[He,[He],(r,[n])=>Math.cos(n.evaluate(r))],tan:[He,[He],(r,[n])=>Math.tan(n.evaluate(r))],asin:[He,[He],(r,[n])=>Math.asin(n.evaluate(r))],acos:[He,[He],(r,[n])=>Math.acos(n.evaluate(r))],atan:[He,[He],(r,[n])=>Math.atan(n.evaluate(r))],min:[He,lo(He),(r,n)=>Math.min(...n.map(o=>o.evaluate(r)))],max:[He,lo(He),(r,n)=>Math.max(...n.map(o=>o.evaluate(r)))],abs:[He,[He],(r,[n])=>Math.abs(n.evaluate(r))],round:[He,[He],(r,[n])=>{const o=n.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[He,[He],(r,[n])=>Math.floor(n.evaluate(r))],ceil:[He,[He],(r,[n])=>Math.ceil(n.evaluate(r))],"filter-==":[bt,[Tt,Et],(r,[n,o])=>r.properties()[n.value]===o.value],"filter-id-==":[bt,[Et],(r,[n])=>r.id()===n.value],"filter-type-==":[bt,[Tt],(r,[n])=>r.geometryType()===n.value],"filter-<":[bt,[Tt,Et],(r,[n,o])=>{const u=r.properties()[n.value],p=o.value;return typeof u==typeof p&&u<p}],"filter-id-<":[bt,[Et],(r,[n])=>{const o=r.id(),u=n.value;return typeof o==typeof u&&o<u}],"filter->":[bt,[Tt,Et],(r,[n,o])=>{const u=r.properties()[n.value],p=o.value;return typeof u==typeof p&&u>p}],"filter-id->":[bt,[Et],(r,[n])=>{const o=r.id(),u=n.value;return typeof o==typeof u&&o>u}],"filter-<=":[bt,[Tt,Et],(r,[n,o])=>{const u=r.properties()[n.value],p=o.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[bt,[Et],(r,[n])=>{const o=r.id(),u=n.value;return typeof o==typeof u&&o<=u}],"filter->=":[bt,[Tt,Et],(r,[n,o])=>{const u=r.properties()[n.value],p=o.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[bt,[Et],(r,[n])=>{const o=r.id(),u=n.value;return typeof o==typeof u&&o>=u}],"filter-has":[bt,[Et],(r,[n])=>n.value in r.properties()],"filter-has-id":[bt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[bt,[ee(Tt)],(r,[n])=>n.value.indexOf(r.geometryType())>=0],"filter-id-in":[bt,[ee(Et)],(r,[n])=>n.value.indexOf(r.id())>=0],"filter-in-small":[bt,[Tt,ee(Et)],(r,[n,o])=>o.value.indexOf(r.properties()[n.value])>=0],"filter-in-large":[bt,[Tt,ee(Et)],(r,[n,o])=>function(u,p,y,x){for(;y<=x;){const w=y+x>>1;if(p[w]===u)return!0;p[w]>u?x=w-1:y=w+1}return!1}(r.properties()[n.value],o.value,0,o.value.length-1)],all:{type:bt,overloads:[[[bt,bt],(r,[n,o])=>n.evaluate(r)&&o.evaluate(r)],[lo(bt),(r,n)=>{for(const o of n)if(!o.evaluate(r))return!1;return!0}]]},any:{type:bt,overloads:[[[bt,bt],(r,[n,o])=>n.evaluate(r)||o.evaluate(r)],[lo(bt),(r,n)=>{for(const o of n)if(o.evaluate(r))return!0;return!1}]]},"!":[bt,[bt],(r,[n])=>!n.evaluate(r)],"is-supported-script":[bt,[Tt],(r,[n])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(n.evaluate(r))}],upcase:[Tt,[Tt],(r,[n])=>n.evaluate(r).toUpperCase()],downcase:[Tt,[Tt],(r,[n])=>n.evaluate(r).toLowerCase()],concat:[Tt,lo(Et),(r,n)=>n.map(o=>nn(o.evaluate(r))).join("")],"resolved-locale":[Tt,[br],(r,[n])=>n.evaluate(r).resolvedLocale()]});class fu{constructor(n,o){var u;this.expression=n,this._warningHistory={},this._evaluator=new Jc,this._defaultValue=o?(u=o).type==="color"&&Cn(u.default)?new dn(0,0,0,0):u.type==="color"?dn.parse(u.default)||null:u.type==="padding"?or.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?Tr.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(n,o,u,p,y,x){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,o,u,p,y,x){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ln(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function Fl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in $o}function Bl(r,n){const o=new Sl($o,Cl,[],n?function(p){const y={color:Nn,string:Tt,number:He,enum:Tt,boolean:bt,formatted:J,padding:N,resolvedImage:O,variableAnchorOffsetCollection:W};return p.type==="array"?ee(y[p.value]||Et,p.length):y[p.type]}(n):void 0),u=o.parse(r,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Ad(new fu(u,n)):Us(o.errors)}class mu{constructor(n,o){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!Aa(o.expression)}evaluateWithoutErrorHandling(n,o,u,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(n,o,u,p,y,x)}evaluate(n,o,u,p,y,x){return this._styleExpression.evaluate(n,o,u,p,y,x)}}class Nl{constructor(n,o,u,p){this.kind=n,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!Aa(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,o,u,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(n,o,u,p,y,x)}evaluate(n,o,u,p,y,x){return this._styleExpression.evaluate(n,o,u,p,y,x)}interpolationFactor(n,o,u){return this.interpolationType?lr.interpolationFactor(this.interpolationType,n,o,u):0}}function gu(r,n){const o=Bl(r,n);if(o.result==="error")return o;const u=o.value.expression,p=Pl(u);if(!p&&!Uo(n))return Us([new Sn("","data expressions not supported")]);const y=Al(u,["zoom"]);if(!y&&!Id(n))return Us([new Sn("","zoom expressions not supported")]);const x=La(u);return x||y?x instanceof Sn?Us([x]):x instanceof lr&&!pu(n)?Us([new Sn("",'"interpolate" expressions cannot be used with this property')]):Ad(x?new Nl(p?"camera":"composite",o.value,x.labels,x instanceof lr?x.interpolation:void 0):new mu(p?"constant":"source",o.value)):Us([new Sn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ma{constructor(n,o){this._parameters=n,this._specification=o,sr(this,Yt(this._parameters,this._specification))}static deserialize(n){return new Ma(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function La(r){let n=null;if(r instanceof Ll)n=La(r.result);else if(r instanceof Ml){for(const o of r.args)if(n=La(o),n)break}else(r instanceof $s||r instanceof lr)&&r.input instanceof Er&&r.input.name==="zoom"&&(n=r);return n instanceof Sn||r.eachChild(o=>{const u=La(o);u instanceof Sn?n=u:!n&&u?n=new Sn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&u&&n!==u&&(n=new Sn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function za(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const n of r.slice(1))if(!za(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Um={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yu(r){if(r==null)return{filter:()=>!0,needGeometry:!1};za(r)||(r=jl(r));const n=Bl(r,Um);if(n.result==="error")throw new Error(n.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,u,p)=>n.value.evaluate(o,u,{},p),needGeometry:Ld(r)}}function qm(r,n){return r<n?-1:r>n?1:0}function Ld(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let n=1;n<r.length;n++)if(Ld(r[n]))return!0;return!1}function jl(r){if(!r)return!0;const n=r[0];return r.length<=1?n!=="any":n==="=="?_u(r[1],r[2],"=="):n==="!="?Da(_u(r[1],r[2],"==")):n==="<"||n===">"||n==="<="||n===">="?_u(r[1],r[2],n):n==="any"?(o=r.slice(1),["any"].concat(o.map(jl))):n==="all"?["all"].concat(r.slice(1).map(jl)):n==="none"?["all"].concat(r.slice(1).map(jl).map(Da)):n==="in"?zd(r[1],r.slice(2)):n==="!in"?Da(zd(r[1],r.slice(2))):n==="has"?Dd(r[1]):n==="!has"?Da(Dd(r[1])):n!=="within"||r;var o}function _u(r,n,o){switch(r){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,r,n]}}function zd(r,n){if(n.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",r,["literal",n.sort(qm)]]:["filter-in-small",r,["literal",n]]}}function Dd(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Da(r){return["!",r]}function Ol(r){const n=typeof r;if(n==="number"||n==="boolean"||n==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let p="[";for(const y of r)p+=`${Ol(y)},`;return`${p}]`}const o=Object.keys(r).sort();let u="{";for(let p=0;p<o.length;p++)u+=`${JSON.stringify(o[p])}:${Ol(r[o[p]])},`;return`${u}}`}function Vl(r){let n="";for(const o of ti)n+=`/${Ol(r[o])}`;return n}function Rd(r){const n=r.value;return n?[new Ze(r.key,n,"constants have been deprecated as of v8")]:[]}function zn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function uo(r){if(Array.isArray(r))return r.map(uo);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const n={};for(const o in r)n[o]=uo(r[o]);return n}return zn(r)}function Ui(r){const n=r.key,o=r.value,u=r.valueSpec||{},p=r.objectElementValidators||{},y=r.style,x=r.styleSpec,w=r.validateSpec;let T=[];const P=rn(o);if(P!=="object")return[new Ze(n,o,`object expected, ${P} found`)];for(const I in o){const D=I.split(".")[0],j=u[D]||u["*"];let $;if(p[D])$=p[D];else if(u[D])$=w;else if(p["*"])$=p["*"];else{if(!u["*"]){T.push(new Ze(n,o[I],`unknown property "${I}"`));continue}$=w}T=T.concat($({key:(n&&`${n}.`)+I,value:o[I],valueSpec:j,style:y,styleSpec:x,object:o,objectKey:I,validateSpec:w},o))}for(const I in u)p[I]||u[I].required&&u[I].default===void 0&&o[I]===void 0&&T.push(new Ze(n,o,`missing required property "${I}"`));return T}function qo(r){const n=r.value,o=r.valueSpec,u=r.style,p=r.styleSpec,y=r.key,x=r.arrayElementValidator||r.validateSpec;if(rn(n)!=="array")return[new Ze(y,n,`array expected, ${rn(n)} found`)];if(o.length&&n.length!==o.length)return[new Ze(y,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new Ze(y,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let w={type:o.value,values:o.values};p.$version<7&&(w.function=o.function),rn(o.value)==="object"&&(w=o.value);let T=[];for(let P=0;P<n.length;P++)T=T.concat(x({array:n,arrayIndex:P,value:n[P],valueSpec:w,validateSpec:r.validateSpec,style:u,styleSpec:p,key:`${y}[${P}]`}));return T}function Ra(r){const n=r.key,o=r.value,u=r.valueSpec;let p=rn(o);return p==="number"&&o!=o&&(p="NaN"),p!=="number"?[new Ze(n,o,`number expected, ${p} found`)]:"minimum"in u&&o<u.minimum?[new Ze(n,o,`${o} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&o>u.maximum?[new Ze(n,o,`${o} is greater than the maximum value ${u.maximum}`)]:[]}function $l(r){const n=r.valueSpec,o=zn(r.value.type);let u,p,y,x={};const w=o!=="categorical"&&r.value.property===void 0,T=!w,P=rn(r.value.stops)==="array"&&rn(r.value.stops[0])==="array"&&rn(r.value.stops[0][0])==="object",I=Ui({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function($){if(o==="identity")return[new Ze($.key,$.value,'identity function may not have a "stops" property')];let U=[];const K=$.value;return U=U.concat(qo({key:$.key,value:K,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:D})),rn(K)==="array"&&K.length===0&&U.push(new Ze($.key,K,"array must have at least one stop")),U},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:n,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return o==="identity"&&w&&I.push(new Ze(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||I.push(new Ze(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!pu(r.valueSpec)&&I.push(new Ze(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!Uo(r.valueSpec)?I.push(new Ze(r.key,r.value,"property functions not supported")):w&&!Id(r.valueSpec)&&I.push(new Ze(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!P||r.value.property!==void 0||I.push(new Ze(r.key,r.value,'"property" property is required')),I;function D($){let U=[];const K=$.value,te=$.key;if(rn(K)!=="array")return[new Ze(te,K,`array expected, ${rn(K)} found`)];if(K.length!==2)return[new Ze(te,K,`array length 2 expected, length ${K.length} found`)];if(P){if(rn(K[0])!=="object")return[new Ze(te,K,`object expected, ${rn(K[0])} found`)];if(K[0].zoom===void 0)return[new Ze(te,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Ze(te,K,"object stop key must have value")];if(y&&y>zn(K[0].zoom))return[new Ze(te,K[0].zoom,"stop zoom values must appear in ascending order")];zn(K[0].zoom)!==y&&(y=zn(K[0].zoom),p=void 0,x={}),U=U.concat(Ui({key:`${te}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Ra,value:j}}))}else U=U.concat(j({key:`${te}[0]`,value:K[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},K));return Fl(uo(K[1]))?U.concat([new Ze(`${te}[1]`,K[1],"expressions are not allowed in function stops.")]):U.concat($.validateSpec({key:`${te}[1]`,value:K[1],valueSpec:n,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function j($,U){const K=rn($.value),te=zn($.value),le=$.value!==null?$.value:U;if(u){if(K!==u)return[new Ze($.key,le,`${K} stop domain type must match previous stop domain type ${u}`)]}else u=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new Ze($.key,le,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&o!=="categorical"){let _e=`number expected, ${K} found`;return Uo(n)&&o===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ze($.key,le,_e)]}return o!=="categorical"||K!=="number"||isFinite(te)&&Math.floor(te)===te?o!=="categorical"&&K==="number"&&p!==void 0&&te<p?[new Ze($.key,le,"stop domain values must appear in ascending order")]:(p=te,o==="categorical"&&te in x?[new Ze($.key,le,"stop domain values must be unique")]:(x[te]=!0,[])):[new Ze($.key,le,`integer expected, found ${te}`)]}}function ho(r){const n=(r.expressionContext==="property"?gu:Bl)(uo(r.value),r.valueSpec);if(n.result==="error")return n.value.map(u=>new Ze(`${r.key}${u.key}`,r.value,u.message));const o=n.value.expression||n.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new Ze(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Aa(o))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Aa(o))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Al(o,["zoom","feature-state"]))return[new Ze(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Pl(o))return[new Ze(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fa(r){const n=r.key,o=r.value,u=r.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(zn(o))===-1&&p.push(new Ze(n,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf(zn(o))===-1&&p.push(new Ze(n,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function Zo(r){return za(uo(r.value))?ho(sr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Fd(r)}function Fd(r){const n=r.value,o=r.key;if(rn(n)!=="array")return[new Ze(o,n,`array expected, ${rn(n)} found`)];const u=r.styleSpec;let p,y=[];if(n.length<1)return[new Ze(o,n,"filter array must have at least 1 element")];switch(y=y.concat(Fa({key:`${o}[0]`,value:n[0],valueSpec:u.filter_operator,style:r.style,styleSpec:r.styleSpec})),zn(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&zn(n[1])==="$type"&&y.push(new Ze(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new Ze(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=rn(n[1]),p!=="string"&&y.push(new Ze(`${o}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=rn(n[x]),zn(n[1])==="$type"?y=y.concat(Fa({key:`${o}[${x}]`,value:n[x],valueSpec:u.geometry_type,style:r.style,styleSpec:r.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new Ze(`${o}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)y=y.concat(Fd({key:`${o}[${x}]`,value:n[x],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":p=rn(n[1]),n.length!==2?y.push(new Ze(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new Ze(`${o}[1]`,n[1],`string expected, ${p} found`));break;case"within":p=rn(n[1]),n.length!==2?y.push(new Ze(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="object"&&y.push(new Ze(`${o}[1]`,n[1],`object expected, ${p} found`))}return y}function Bd(r,n){const o=r.key,u=r.validateSpec,p=r.style,y=r.styleSpec,x=r.value,w=r.objectKey,T=y[`${n}_${r.layerType}`];if(!T)return[];const P=w.match(/^(.*)-transition$/);if(n==="paint"&&P&&T[P[1]]&&T[P[1]].transition)return u({key:o,value:x,valueSpec:y.transition,style:p,styleSpec:y});const I=r.valueSpec||T[w];if(!I)return[new Ze(o,x,`unknown property "${w}"`)];let D;if(rn(x)==="string"&&Uo(I)&&!I.tokens&&(D=/^{([^}]+)}$/.exec(x)))return[new Ze(o,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const j=[];return r.layerType==="symbol"&&(w==="text-field"&&p&&!p.glyphs&&j.push(new Ze(o,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Cn(uo(x))&&zn(x.type)==="identity"&&j.push(new Ze(o,x,'"text-font" does not support identity functions'))),j.concat(u({key:r.key,value:x,valueSpec:I,style:p,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:w}))}function Nd(r){return Bd(r,"paint")}function jd(r){return Bd(r,"layout")}function Od(r){let n=[];const o=r.value,u=r.key,p=r.style,y=r.styleSpec;o.type||o.ref||n.push(new Ze(u,o,'either "type" or "ref" is required'));let x=zn(o.type);const w=zn(o.ref);if(o.id){const T=zn(o.id);for(let P=0;P<r.arrayIndex;P++){const I=p.layers[P];zn(I.id)===T&&n.push(new Ze(u,o.id,`duplicate layer id "${o.id}", previously used at line ${I.id.__line__}`))}}if("ref"in o){let T;["type","source","source-layer","filter","layout"].forEach(P=>{P in o&&n.push(new Ze(u,o[P],`"${P}" is prohibited for ref layers`))}),p.layers.forEach(P=>{zn(P.id)===w&&(T=P)}),T?T.ref?n.push(new Ze(u,o.ref,"ref cannot reference another ref layer")):x=zn(T.type):n.push(new Ze(u,o.ref,`ref layer "${w}" not found`))}else if(x!=="background")if(o.source){const T=p.sources&&p.sources[o.source],P=T&&zn(T.type);T?P==="vector"&&x==="raster"?n.push(new Ze(u,o.source,`layer "${o.id}" requires a raster source`)):P!=="raster-dem"&&x==="hillshade"?n.push(new Ze(u,o.source,`layer "${o.id}" requires a raster-dem source`)):P==="raster"&&x!=="raster"?n.push(new Ze(u,o.source,`layer "${o.id}" requires a vector source`)):P!=="vector"||o["source-layer"]?P==="raster-dem"&&x!=="hillshade"?n.push(new Ze(u,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||P==="geojson"&&T.lineMetrics||n.push(new Ze(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ze(u,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new Ze(u,o.source,`source "${o.source}" not found`))}else n.push(new Ze(u,o,'missing required property "source"'));return n=n.concat(Ui({key:u,value:o,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${u}.type`,value:o.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:o,objectKey:"type"}),filter:Zo,layout:T=>Ui({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":P=>jd(sr({layerType:x},P))}}),paint:T=>Ui({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":P=>Nd(sr({layerType:x},P))}})}})),n}function Qr(r){const n=r.value,o=r.key,u=rn(n);return u!=="string"?[new Ze(o,n,`string expected, ${u} found`)]:[]}const Ba={promoteId:function({key:r,value:n}){if(rn(n)==="string")return Qr({key:r,value:n});{const o=[];for(const u in n)o.push(...Qr({key:`${r}.${u}`,value:n[u]}));return o}}};function cr(r){const n=r.value,o=r.key,u=r.styleSpec,p=r.style,y=r.validateSpec;if(!n.type)return[new Ze(o,n,'"type" is required')];const x=zn(n.type);let w;switch(x){case"vector":case"raster":return w=Ui({key:o,value:n,valueSpec:u[`source_${x.replace("-","_")}`],style:r.style,styleSpec:u,objectElementValidators:Ba,validateSpec:y}),w;case"raster-dem":return w=function(T){var P;const I=(P=T.sourceName)!==null&&P!==void 0?P:"",D=T.value,j=T.styleSpec,$=j.source_raster_dem,U=T.style;let K=[];const te=rn(D);if(D===void 0)return K;if(te!=="object")return K.push(new Ze("source_raster_dem",D,`object expected, ${te} found`)),K;const le=zn(D.encoding)==="custom",_e=["redFactor","greenFactor","blueFactor","baseShift"],de=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const be in D)!le&&_e.includes(be)?K.push(new Ze(be,D[be],`In "${I}": "${be}" is only valid when "encoding" is set to "custom". ${de} encoding found`)):$[be]?K=K.concat(T.validateSpec({key:be,value:D[be],valueSpec:$[be],validateSpec:T.validateSpec,style:U,styleSpec:j})):K.push(new Ze(be,D[be],`unknown property "${be}"`));return K}({sourceName:o,value:n,style:r.style,styleSpec:u,validateSpec:y}),w;case"geojson":if(w=Ui({key:o,value:n,valueSpec:u.source_geojson,style:p,styleSpec:u,validateSpec:y,objectElementValidators:Ba}),n.cluster)for(const T in n.clusterProperties){const[P,I]=n.clusterProperties[T],D=typeof P=="string"?[P,["accumulated"],["get",T]]:P;w.push(...ho({key:`${o}.${T}.map`,value:I,validateSpec:y,expressionContext:"cluster-map"})),w.push(...ho({key:`${o}.${T}.reduce`,value:D,validateSpec:y,expressionContext:"cluster-reduce"}))}return w;case"video":return Ui({key:o,value:n,valueSpec:u.source_video,style:p,validateSpec:y,styleSpec:u});case"image":return Ui({key:o,value:n,valueSpec:u.source_image,style:p,validateSpec:y,styleSpec:u});case"canvas":return[new Ze(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fa({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:y,styleSpec:u})}}function Na(r){const n=r.value,o=r.styleSpec,u=o.light,p=r.style;let y=[];const x=rn(n);if(n===void 0)return y;if(x!=="object")return y=y.concat([new Ze("light",n,`object expected, ${x} found`)]),y;for(const w in n){const T=w.match(/^(.*)-transition$/);y=y.concat(T&&u[T[1]]&&u[T[1]].transition?r.validateSpec({key:w,value:n[w],valueSpec:o.transition,validateSpec:r.validateSpec,style:p,styleSpec:o}):u[w]?r.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:r.validateSpec,style:p,styleSpec:o}):[new Ze(w,n[w],`unknown property "${w}"`)])}return y}function Vd(r){const n=r.value,o=r.styleSpec,u=o.terrain,p=r.style;let y=[];const x=rn(n);if(n===void 0)return y;if(x!=="object")return y=y.concat([new Ze("terrain",n,`object expected, ${x} found`)]),y;for(const w in n)y=y.concat(u[w]?r.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:r.validateSpec,style:p,styleSpec:o}):[new Ze(w,n[w],`unknown property "${w}"`)]);return y}function $d(r){let n=[];const o=r.value,u=r.key;if(Array.isArray(o)){const p=[],y=[];for(const x in o)o[x].id&&p.includes(o[x].id)&&n.push(new Ze(u,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),p.push(o[x].id),o[x].url&&y.includes(o[x].url)&&n.push(new Ze(u,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),y.push(o[x].url),n=n.concat(Ui({key:`${u}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return n}return Qr({key:u,value:o})}const Ud={"*":()=>[],array:qo,boolean:function(r){const n=r.value,o=r.key,u=rn(n);return u!=="boolean"?[new Ze(o,n,`boolean expected, ${u} found`)]:[]},number:Ra,color:function(r){const n=r.key,o=r.value,u=rn(o);return u!=="string"?[new Ze(n,o,`color expected, ${u} found`)]:dn.parse(String(o))?[]:[new Ze(n,o,`color expected, "${o}" found`)]},constants:Rd,enum:Fa,filter:Zo,function:$l,layer:Od,object:Ui,source:cr,light:Na,terrain:Vd,string:Qr,formatted:function(r){return Qr(r).length===0?[]:ho(r)},resolvedImage:function(r){return Qr(r).length===0?[]:ho(r)},padding:function(r){const n=r.key,o=r.value;if(rn(o)==="array"){if(o.length<1||o.length>4)return[new Ze(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const u={type:"number"};let p=[];for(let y=0;y<o.length;y++)p=p.concat(r.validateSpec({key:`${n}[${y}]`,value:o[y],validateSpec:r.validateSpec,valueSpec:u}));return p}return Ra({key:n,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const n=r.key,o=r.value,u=rn(o),p=r.styleSpec;if(u!=="array"||o.length<1||o.length%2!=0)return[new Ze(n,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let x=0;x<o.length;x+=2)y=y.concat(Fa({key:`${n}[${x}]`,value:o[x],valueSpec:p.layout_symbol["text-anchor"]})),y=y.concat(qo({key:`${n}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:p}));return y},sprite:$d};function _s(r){const n=r.value,o=r.valueSpec,u=r.styleSpec;return r.validateSpec=_s,o.expression&&Cn(zn(n))?$l(r):o.expression&&Fl(uo(n))?ho(r):o.type&&Ud[o.type]?Ud[o.type](r):Ui(sr({},r,{valueSpec:o.type?u[o.type]:o}))}function qd(r){const n=r.value,o=r.key,u=Qr(r);return u.length||(n.indexOf("{fontstack}")===-1&&u.push(new Ze(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&u.push(new Ze(o,n,'"glyphs" url must include a "{range}" token'))),u}function Cr(r,n=Me){let o=[];return o=o.concat(_s({key:"",value:r,valueSpec:n.$root,styleSpec:n,style:r,validateSpec:_s,objectElementValidators:{glyphs:qd,"*":()=>[]}})),r.constants&&(o=o.concat(Rd({key:"constants",value:r.constants,style:r,styleSpec:n,validateSpec:_s}))),Ul(o)}function xs(r){return function(n){return r({...n,validateSpec:_s})}}function Ul(r){return[].concat(r).sort((n,o)=>n.line-o.line)}function vs(r){return function(...n){return Ul(r.apply(this,n))}}Cr.source=vs(xs(cr)),Cr.sprite=vs(xs($d)),Cr.glyphs=vs(xs(qd)),Cr.light=vs(xs(Na)),Cr.terrain=vs(xs(Vd)),Cr.layer=vs(xs(Od)),Cr.filter=vs(xs(Zo)),Cr.paintProperty=vs(xs(Nd)),Cr.layoutProperty=vs(xs(jd));const ws=Cr,Zm=ws.light,xu=ws.paintProperty,Zd=ws.layoutProperty;function ql(r,n){let o=!1;if(n&&n.length)for(const u of n)r.fire(new ki(new Error(u.message))),o=!0;return o}class Go{constructor(n,o,u){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(o=x[1])+2*(u=x[2]);for(let T=0;T<this.d*this.d;T++){const P=x[3+T],I=x[3+T+1];p.push(P===I?null:x.subarray(P,I))}const w=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],w),this.bboxes=x.subarray(w),this.insert=this._insertReadonly}else{this.d=o+2*u;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=u,this.scale=o/n,this.uid=0;const y=u/o*n;this.min=-y,this.max=n+y}insert(n,o,u,p,y){this._forEachCell(o,u,p,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,u,p,y,x){this.cells[y].push(x)}query(n,o,u,p,y){const x=this.min,w=this.max;if(n<=x&&o<=x&&w<=u&&w<=p&&!y)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(n,o,u,p,this._queryCell,T,{},y),T}}_queryCell(n,o,u,p,y,x,w,T){const P=this.cells[y];if(P!==null){const I=this.keys,D=this.bboxes;for(let j=0;j<P.length;j++){const $=P[j];if(w[$]===void 0){const U=4*$;(T?T(D[U+0],D[U+1],D[U+2],D[U+3]):n<=D[U+2]&&o<=D[U+3]&&u>=D[U+0]&&p>=D[U+1])?(w[$]=!0,x.push(I[$])):w[$]=!1}}}}_forEachCell(n,o,u,p,y,x,w,T){const P=this._convertToCellCoord(n),I=this._convertToCellCoord(o),D=this._convertToCellCoord(u),j=this._convertToCellCoord(p);for(let $=P;$<=D;$++)for(let U=I;U<=j;U++){const K=this.d*U+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(U),this._convertFromCellCoord($+1),this._convertFromCellCoord(U+1)))&&y.call(this,n,o,u,p,K,x,w,T))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let u=0;for(let x=0;x<this.cells.length;x++)u+=this.cells[x].length;const p=new Int32Array(o+u+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let y=o;for(let x=0;x<n.length;x++){const w=n[x];p[3+x]=y,p.set(w,y),y+=w.length}return p[3+n.length]=y,p.set(this.keys,y),y+=this.keys.length,p[3+n.length+1]=y,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer}static serialize(n,o){const u=n.toArrayBuffer();return o&&o.push(u),{buffer:u}}static deserialize(n){return new Go(n.buffer)}}const bs={};function st(r,n,o={}){if(bs[r])throw new Error(`${r} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:r,writeable:!1}),bs[r]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}st("Object",Object),st("TransferableGridIndex",Go),st("Color",dn),st("Error",Error),st("AJAXError",gi),st("ResolvedImage",xi),st("StylePropertyFunction",Ma),st("StyleExpression",fu,{omit:["_evaluator"]}),st("ZoomDependentExpression",Nl),st("ZoomConstantExpression",mu),st("CompoundExpression",Er,{omit:["_evaluate"]});for(const r in $o)$o[r]._classRegistryKey||st(`Expression_${r}`,$o[r]);function Zl(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function qs(r,n){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Zl(r)||at(r))return n&&n.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return n&&n.push(o.buffer),o}if(r instanceof ImageData)return n&&n.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const u of r)o.push(qs(u,n));return o}if(typeof r=="object"){const o=r.constructor,u=o._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");if(!bs[u])throw new Error(`${u} is not registered.`);const p=o.serialize?o.serialize(r,n):{};if(o.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in r){if(!r.hasOwnProperty(y)||bs[u].omit.indexOf(y)>=0)continue;const x=r[y];p[y]=bs[u].shallow.indexOf(y)>=0?x:qs(x,n)}r instanceof Error&&(p.message=r.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof r)}function Wo(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Zl(r)||at(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(Wo);if(typeof r=="object"){const n=r.$name||"Object";if(!bs[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=bs[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(r);const u=Object.create(o.prototype);for(const p of Object.keys(r)){if(p==="$name")continue;const y=r[p];u[p]=bs[n].shallow.indexOf(p)>=0?y:Wo(y)}return u}throw new Error("can't deserialize object of type "+typeof r)}class Gd{constructor(){this.first=!0}update(n,o){const u=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=u,!0))}}const tt={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function vu(r){for(const n of r)if(bu(n.charCodeAt(0)))return!0;return!1}function wu(r){for(const n of r)if(!Gm(n.charCodeAt(0)))return!1;return!0}function Gm(r){return!(tt.Arabic(r)||tt["Arabic Supplement"](r)||tt["Arabic Extended-A"](r)||tt["Arabic Presentation Forms-A"](r)||tt["Arabic Presentation Forms-B"](r))}function bu(r){return!(r!==746&&r!==747&&(r<4352||!(tt["Bopomofo Extended"](r)||tt.Bopomofo(r)||tt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||tt["CJK Compatibility Ideographs"](r)||tt["CJK Compatibility"](r)||tt["CJK Radicals Supplement"](r)||tt["CJK Strokes"](r)||!(!tt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||tt["CJK Unified Ideographs Extension A"](r)||tt["CJK Unified Ideographs"](r)||tt["Enclosed CJK Letters and Months"](r)||tt["Hangul Compatibility Jamo"](r)||tt["Hangul Jamo Extended-A"](r)||tt["Hangul Jamo Extended-B"](r)||tt["Hangul Jamo"](r)||tt["Hangul Syllables"](r)||tt.Hiragana(r)||tt["Ideographic Description Characters"](r)||tt.Kanbun(r)||tt["Kangxi Radicals"](r)||tt["Katakana Phonetic Extensions"](r)||tt.Katakana(r)&&r!==12540||!(!tt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!tt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||tt["Unified Canadian Aboriginal Syllabics"](r)||tt["Unified Canadian Aboriginal Syllabics Extended"](r)||tt["Vertical Forms"](r)||tt["Yijing Hexagram Symbols"](r)||tt["Yi Syllables"](r)||tt["Yi Radicals"](r))))}function Wd(r){return!(bu(r)||function(n){return!!(tt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||tt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||tt["Letterlike Symbols"](n)||tt["Number Forms"](n)||tt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||tt["Control Pictures"](n)&&n!==9251||tt["Optical Character Recognition"](n)||tt["Enclosed Alphanumerics"](n)||tt["Geometric Shapes"](n)||tt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||tt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||tt["CJK Symbols and Punctuation"](n)||tt.Katakana(n)||tt["Private Use Area"](n)||tt["CJK Compatibility Forms"](n)||tt["Small Form Variants"](n)||tt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(r))}function Hd(r){return r>=1424&&r<=2303||tt["Arabic Presentation Forms-A"](r)||tt["Arabic Presentation Forms-B"](r)}function Kd(r,n){return!(!n&&Hd(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||tt.Khmer(r))}function Wm(r){for(const n of r)if(Hd(n.charCodeAt(0)))return!0;return!1}const Su="deferred",Tu="loading",ku="loaded";let Eu=null,qi="unavailable",Zs=null;const ja=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(qi="error"),Eu&&Eu(r)};function Cu(){Oa.fire(new _t("pluginStateChange",{pluginStatus:qi,pluginURL:Zs}))}const Oa=new ms,Pu=function(){return qi},Xd=function(){if(qi!==Su||!Zs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi=Tu,Cu(),Zs&&zt({url:Zs},r=>{r?ja(r):(qi=ku,Cu())})},ur={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qi===ku||ur.applyArabicShaping!=null,isLoading:()=>qi===Tu,setState(r){if(!rt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qi=r.pluginStatus,Zs=r.pluginURL},isParsed(){if(!rt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ur.applyArabicShaping!=null&&ur.processBidirectionalText!=null&&ur.processStyledBidirectionalText!=null},getPluginURL(){if(!rt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Zs}};class vn{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gd,this.transition={})}isSupportedScript(n){return function(o,u){for(const p of o)if(!Kd(p.charCodeAt(0),u))return!1;return!0}(n,ur.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),u=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}}}class Gl{constructor(n,o){this.property=n,this.value=o,this.expression=function(u,p){if(Cn(u))return new Ma(u,p);if(Fl(u)){const y=gu(u,p);if(y.result==="error")throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=u;return p.type==="color"&&typeof u=="string"?y=dn.parse(u):p.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(y=Tr.parse(u)):y=or.parse(u),{kind:"constant",evaluate:()=>y}}}(o===void 0?n.specification.default:o,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,u){return this.property.possiblyEvaluate(this,n,o,u)}}class Au{constructor(n){this.property=n,this.value=new Gl(n,void 0)}transitioned(n,o){return new Jd(this.property,this.value,o,ke({},n.transition,this.transition),n.now)}untransitioned(){return new Jd(this.property,this.value,null,{},0)}}class Yd{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Ct(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].value=new Gl(this._values[n].property,o===null?void 0:Ct(o))}getTransition(n){return Ct(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Au(this._values[n].property)),this._values[n].transition=Ct(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u);const p=this.getTransition(o);p!==void 0&&(n[`${o}-transition`]=p)}return n}transitioned(n,o){const u=new Qd(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(n,o._values[p]);return u}untransitioned(){const n=new Qd(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class Jd{constructor(n,o,u,p,y){this.property=n,this.value=o,this.begin=y+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(n,o,u){const p=n.now||0,y=this.value.possiblyEvaluate(n,o,u),x=this.prior;if(x){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return x.possiblyEvaluate(n,o,u);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,o,u),y,function(T){if(T<=0)return 0;if(T>=1)return 1;const P=T*T,I=P*T;return 4*(T<.5?I:3*(T-P)+I-.75)}(w))}}return y}}class Qd{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,u){const p=new Wl(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,u);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Hm{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Ct(this._values[n].value)}setValue(n,o){this._values[n]=new Gl(this._values[n].property,o===null?void 0:Ct(o))}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u)}return n}possiblyEvaluate(n,o,u){const p=new Wl(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,u);return p}}class zi{constructor(n,o,u){this.property=n,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,u,p){return this.property.evaluate(this.value,this.parameters,n,o,u,p)}}class Wl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class mt{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,u){const p=ar[this.specification.type];return p?p(n,o,u):n}}class xt{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,u,p){return new zi(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},u,p)}:n.expression,o)}interpolate(n,o,u){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new zi(this,{kind:"constant",value:void 0},n.parameters);const p=ar[this.specification.type];if(p){const y=p(n.value.value,o.value.value,u);return new zi(this,{kind:"constant",value:y},n.parameters)}return n}evaluate(n,o,u,p,y,x){return n.kind==="constant"?n.value:n.evaluate(o,u,p,y,x)}}class Va extends xt{possiblyEvaluate(n,o,u,p){if(n.value===void 0)return new zi(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},u,p),x=n.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,w=this._calculate(x,x,x,o);return new zi(this,{kind:"constant",value:w},o)}if(n.expression.kind==="camera"){const y=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new zi(this,{kind:"constant",value:y},o)}return new zi(this,n.expression,o)}evaluate(n,o,u,p,y,x){if(n.kind==="source"){const w=n.evaluate(o,u,p,y,x);return this._calculate(w,w,w,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},u,p),n.evaluate({zoom:Math.floor(o.zoom)},u,p),n.evaluate({zoom:Math.floor(o.zoom)+1},u,p),o):n.value}_calculate(n,o,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:u,to:o}}interpolate(n){return n}}class Iu{constructor(n){this.specification=n}possiblyEvaluate(n,o,u,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},u,p);return this._calculate(y,y,y,o)}return this._calculate(n.expression.evaluate(new vn(Math.floor(o.zoom-1),o)),n.expression.evaluate(new vn(Math.floor(o.zoom),o)),n.expression.evaluate(new vn(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:u,to:o}}interpolate(n){return n}}class Mu{constructor(n){this.specification=n}possiblyEvaluate(n,o,u,p){return!!n.expression.evaluate(o,null,{},u,p)}interpolate(){return!1}}class Un{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const u=n[o];u.specification.overridable&&this.overridableProperties.push(o);const p=this.defaultPropertyValues[o]=new Gl(u,void 0),y=this.defaultTransitionablePropertyValues[o]=new Au(u);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=p.possiblyEvaluate({})}}}st("DataDrivenProperty",xt),st("DataConstantProperty",mt),st("CrossFadedDataDrivenProperty",Va),st("CrossFadedProperty",Iu),st("ColorRampProperty",Mu);const Lu="-transition";class Pr extends ms{constructor(n,o){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),o.layout&&(this._unevaluatedLayout=new Hm(o.layout)),o.paint)){this._transitionablePaint=new Yd(o.paint);for(const u in n.paint)this.setPaintProperty(u,n.paint[u],{validate:!1});for(const u in n.layout)this.setLayoutProperty(u,n.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o,u={}){o!=null&&this._validate(Zd,`layers.${this.id}.layout.${n}`,n,o,u)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith(Lu)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,u={}){if(o!=null&&this._validate(xu,`layers.${this.id}.paint.${n}`,n,o,u))return!1;if(n.endsWith(Lu))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const p=this._transitionablePaint._values[n],y=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(n,w,T)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),At(n,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(n,o,u,p,y={}){return(!y||y.validate!==!1)&&ql(this,n.call(ws,{key:o,layerType:this.type,objectKey:u,value:p,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof zi&&Uo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const ep={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class po{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Dn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function An(r,n=1){let o=0,u=0;return{members:r.map(p=>{const y=ep[p.type].BYTES_PER_ELEMENT,x=o=Ho(o,Math.max(n,y)),w=p.components||1;return u=Math.max(u,y),o+=y*w,{name:p.name,type:p.type,components:w,offset:x}}),size:Ho(o,Math.max(u,n)),alignment:n}}function Ho(r,n){return Math.ceil(r/n)*n}class $a extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const p=2*n;return this.int16[p+0]=o,this.int16[p+1]=u,n}}$a.prototype.bytesPerElement=4,st("StructArrayLayout2i4",$a);class Ua extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,u)}emplace(n,o,u,p){const y=3*n;return this.int16[y+0]=o,this.int16[y+1]=u,this.int16[y+2]=p,n}}Ua.prototype.bytesPerElement=6,st("StructArrayLayout3i6",Ua);class fo extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,p)}emplace(n,o,u,p,y){const x=4*n;return this.int16[x+0]=o,this.int16[x+1]=u,this.int16[x+2]=p,this.int16[x+3]=y,n}}fo.prototype.bytesPerElement=8,st("StructArrayLayout4i8",fo);class zu extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,u,p,y,x)}emplace(n,o,u,p,y,x,w){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=y,this.int16[T+4]=x,this.int16[T+5]=w,n}}zu.prototype.bytesPerElement=12,st("StructArrayLayout2i4i12",zu);class Du extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,u,p,y,x)}emplace(n,o,u,p,y,x,w){const T=4*n,P=8*n;return this.int16[T+0]=o,this.int16[T+1]=u,this.uint8[P+4]=p,this.uint8[P+5]=y,this.uint8[P+6]=x,this.uint8[P+7]=w,n}}Du.prototype.bytesPerElement=8,st("StructArrayLayout2i4ub8",Du);class Ko extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const p=2*n;return this.float32[p+0]=o,this.float32[p+1]=u,n}}Ko.prototype.bytesPerElement=8,st("StructArrayLayout2f8",Ko);class Ru extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x,w,T,P,I){const D=this.length;return this.resize(D+1),this.emplace(D,n,o,u,p,y,x,w,T,P,I)}emplace(n,o,u,p,y,x,w,T,P,I,D){const j=10*n;return this.uint16[j+0]=o,this.uint16[j+1]=u,this.uint16[j+2]=p,this.uint16[j+3]=y,this.uint16[j+4]=x,this.uint16[j+5]=w,this.uint16[j+6]=T,this.uint16[j+7]=P,this.uint16[j+8]=I,this.uint16[j+9]=D,n}}Ru.prototype.bytesPerElement=20,st("StructArrayLayout10ui20",Ru);class Fu extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x,w,T,P,I,D,j){const $=this.length;return this.resize($+1),this.emplace($,n,o,u,p,y,x,w,T,P,I,D,j)}emplace(n,o,u,p,y,x,w,T,P,I,D,j,$){const U=12*n;return this.int16[U+0]=o,this.int16[U+1]=u,this.int16[U+2]=p,this.int16[U+3]=y,this.uint16[U+4]=x,this.uint16[U+5]=w,this.uint16[U+6]=T,this.uint16[U+7]=P,this.int16[U+8]=I,this.int16[U+9]=D,this.int16[U+10]=j,this.int16[U+11]=$,n}}Fu.prototype.bytesPerElement=24,st("StructArrayLayout4i4ui4i24",Fu);class sn extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,u)}emplace(n,o,u,p){const y=3*n;return this.float32[y+0]=o,this.float32[y+1]=u,this.float32[y+2]=p,n}}sn.prototype.bytesPerElement=12,st("StructArrayLayout3f12",sn);class m extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}m.prototype.bytesPerElement=4,st("StructArrayLayout1ul4",m);class i extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x,w,T,P){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,u,p,y,x,w,T,P)}emplace(n,o,u,p,y,x,w,T,P,I){const D=10*n,j=5*n;return this.int16[D+0]=o,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+3]=y,this.int16[D+4]=x,this.int16[D+5]=w,this.uint32[j+3]=T,this.uint16[D+8]=P,this.uint16[D+9]=I,n}}i.prototype.bytesPerElement=20,st("StructArrayLayout6i1ul2ui20",i);class l extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,u,p,y,x)}emplace(n,o,u,p,y,x,w){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=y,this.int16[T+4]=x,this.int16[T+5]=w,n}}l.prototype.bytesPerElement=12,st("StructArrayLayout2i2i2i12",l);class d extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y){const x=this.length;return this.resize(x+1),this.emplace(x,n,o,u,p,y)}emplace(n,o,u,p,y,x){const w=4*n,T=8*n;return this.float32[w+0]=o,this.float32[w+1]=u,this.float32[w+2]=p,this.int16[T+6]=y,this.int16[T+7]=x,n}}d.prototype.bytesPerElement=16,st("StructArrayLayout2f1f2i16",d);class f extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,p)}emplace(n,o,u,p,y){const x=12*n,w=3*n;return this.uint8[x+0]=o,this.uint8[x+1]=u,this.float32[w+1]=p,this.float32[w+2]=y,n}}f.prototype.bytesPerElement=12,st("StructArrayLayout2ub2f12",f);class _ extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,u)}emplace(n,o,u,p){const y=3*n;return this.uint16[y+0]=o,this.uint16[y+1]=u,this.uint16[y+2]=p,n}}_.prototype.bytesPerElement=6,st("StructArrayLayout3ui6",_);class b extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le){const _e=this.length;return this.resize(_e+1),this.emplace(_e,n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le)}emplace(n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le,_e){const de=24*n,be=12*n,Ce=48*n;return this.int16[de+0]=o,this.int16[de+1]=u,this.uint16[de+2]=p,this.uint16[de+3]=y,this.uint32[be+2]=x,this.uint32[be+3]=w,this.uint32[be+4]=T,this.uint16[de+10]=P,this.uint16[de+11]=I,this.uint16[de+12]=D,this.float32[be+7]=j,this.float32[be+8]=$,this.uint8[Ce+36]=U,this.uint8[Ce+37]=K,this.uint8[Ce+38]=te,this.uint32[be+10]=le,this.int16[de+22]=_e,n}}b.prototype.bytesPerElement=48,st("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",b);class S extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le,_e,de,be,Ce,De,nt,dt,et,Je,We,ot){const Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le,_e,de,be,Ce,De,nt,dt,et,Je,We,ot)}emplace(n,o,u,p,y,x,w,T,P,I,D,j,$,U,K,te,le,_e,de,be,Ce,De,nt,dt,et,Je,We,ot,Xe){const je=32*n,yt=16*n;return this.int16[je+0]=o,this.int16[je+1]=u,this.int16[je+2]=p,this.int16[je+3]=y,this.int16[je+4]=x,this.int16[je+5]=w,this.int16[je+6]=T,this.int16[je+7]=P,this.uint16[je+8]=I,this.uint16[je+9]=D,this.uint16[je+10]=j,this.uint16[je+11]=$,this.uint16[je+12]=U,this.uint16[je+13]=K,this.uint16[je+14]=te,this.uint16[je+15]=le,this.uint16[je+16]=_e,this.uint16[je+17]=de,this.uint16[je+18]=be,this.uint16[je+19]=Ce,this.uint16[je+20]=De,this.uint16[je+21]=nt,this.uint16[je+22]=dt,this.uint32[yt+12]=et,this.float32[yt+13]=Je,this.float32[yt+14]=We,this.uint16[je+30]=ot,this.uint16[je+31]=Xe,n}}S.prototype.bytesPerElement=64,st("StructArrayLayout8i15ui1ul2f2ui64",S);class E extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}E.prototype.bytesPerElement=4,st("StructArrayLayout1f4",E);class A extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,u)}emplace(n,o,u,p){const y=3*n;return this.uint16[6*n+0]=o,this.float32[y+1]=u,this.float32[y+2]=p,n}}A.prototype.bytesPerElement=12,st("StructArrayLayout1ui2f12",A);class M extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,u)}emplace(n,o,u,p){const y=4*n;return this.uint32[2*n+0]=o,this.uint16[y+2]=u,this.uint16[y+3]=p,n}}M.prototype.bytesPerElement=8,st("StructArrayLayout1ul2ui8",M);class z extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const p=2*n;return this.uint16[p+0]=o,this.uint16[p+1]=u,n}}z.prototype.bytesPerElement=4,st("StructArrayLayout2ui4",z);class V extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}V.prototype.bytesPerElement=2,st("StructArrayLayout1ui2",V);class Y extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,p)}emplace(n,o,u,p,y){const x=4*n;return this.float32[x+0]=o,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=y,n}}Y.prototype.bytesPerElement=16,st("StructArrayLayout4f16",Y);class X extends po{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new F(this.anchorPointX,this.anchorPointY)}}X.prototype.size=20;class Q extends i{get(n){return new X(this,n)}}st("CollisionBoxArray",Q);class H extends po{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}H.prototype.size=48;class me extends b{get(n){return new H(this,n)}}st("PlacedSymbolArray",me);class Se extends po{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class ie extends S{get(n){return new Se(this,n)}}st("SymbolInstanceArray",ie);class ye extends E{getoffsetX(n){return this.float32[1*n+0]}}st("GlyphOffsetArray",ye);class Pe extends Ua{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}st("SymbolLineVertexArray",Pe);class Ae extends po{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ae.prototype.size=12;class ze extends A{get(n){return new Ae(this,n)}}st("TextAnchorOffsetArray",ze);class Be extends po{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Be.prototype.size=8;class Fe extends M{get(n){return new Be(this,n)}}st("FeatureIndexArray",Fe);class $e extends $a{}class ht extends $a{}class Zt extends $a{}class Ye extends zu{}class vt extends Du{}class pt extends Ko{}class pn extends Ru{}class Vt extends Fu{}class Mt extends sn{}class Gt extends m{}class jn extends l{}class _n extends f{}class vi extends _{}class ni extends z{}const qn=An([{name:"a_pos",components:2,type:"Int16"}],4),{members:hr}=qn;class wn{constructor(n=[]){this.segments=n}prepareSegment(n,o,u,p){let y=this.segments[this.segments.length-1];return n>wn.MAX_VERTEX_ARRAY_LENGTH&&Ut(`Max vertices per segment is ${wn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>wn.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,u,p){return new wn([{vertexOffset:n,primitiveOffset:o,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}function es(r,n){return 256*(r=Ee(Math.floor(r),0,255))+Ee(Math.floor(n),0,255)}wn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,st("SegmentVector",wn);const ts=An([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gs={exports:{}},mo={exports:{}};mo.exports=function(r,n){var o,u,p,y,x,w,T,P;for(u=r.length-(o=3&r.length),p=n,x=3432918353,w=461845907,P=0;P<u;)T=255&r.charCodeAt(P)|(255&r.charCodeAt(++P))<<8|(255&r.charCodeAt(++P))<<16|(255&r.charCodeAt(++P))<<24,++P,p=27492+(65535&(y=5*(65535&(p=(p^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,o){case 3:T^=(255&r.charCodeAt(P+2))<<16;case 2:T^=(255&r.charCodeAt(P+1))<<8;case 1:p^=T=(65535&(T=(T=(65535&(T^=255&r.charCodeAt(P)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295}return p^=r.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Xo=mo.exports,Ci={exports:{}};Ci.exports=function(r,n){for(var o,u=r.length,p=n^u,y=0;u>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++y;switch(u){case 3:p^=(255&r.charCodeAt(y+2))<<16;case 2:p^=(255&r.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&r.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var wi=Xo,Di=Ci.exports;Gs.exports=wi,Gs.exports.murmur3=wi,Gs.exports.murmur2=Di;var go=k(Gs.exports);class On{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,u,p){this.ids.push(ii(n)),this.positions.push(o,u,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=ii(n);let u=0,p=this.ids.length-1;for(;u<p;){const x=u+p>>1;this.ids[x]>=o?p=x:u=x+1}const y=[];for(;this.ids[u]===o;)y.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return y}static serialize(n,o){const u=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Zi(u,p,0,u.length-1),o&&o.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(n){const o=new On;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function ii(r){const n=+r;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:go(String(r))}function Zi(r,n,o,u){for(;o<u;){const p=r[o+u>>1];let y=o-1,x=u+1;for(;;){do y++;while(r[y]<p);do x--;while(r[x]>p);if(y>=x)break;Vn(r,y,x),Vn(n,3*y,3*x),Vn(n,3*y+1,3*x+1),Vn(n,3*y+2,3*x+2)}x-o<u-x?(Zi(r,n,o,x),o=x+1):(Zi(r,n,x+1,u),u=x)}}function Vn(r,n,o){const u=r[n];r[n]=r[o],r[o]=u}st("FeaturePositionMap",On);class yo{constructor(n,o){this.gl=n.gl,this.location=o}}class Hl extends yo{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class tp extends yo{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class np extends yo{constructor(n,o){super(n,o),this.current=dn.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Km=new Float32Array(16);function Bu(r){return[es(255*r.r,255*r.g),es(255*r.b,255*r.a)]}class ns{constructor(n,o,u){this.value=n,this.uniformNames=o.map(p=>`u_${p}`),this.type=u}setUniform(n,o,u){n.set(u.constantOr(this.value))}getBinding(n,o,u){return this.type==="color"?new np(n,o):new Hl(n,o)}}class _o{constructor(n,o){this.uniformNames=o.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setUniform(n,o,u,p){const y=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&n.set(y)}getBinding(n,o,u){return u.substr(0,9)==="u_pattern"?new tp(n,o):new Hl(n,o)}}class is{constructor(n,o,u,p){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,o,u,p,y){const x=this.paintVertexArray.length,w=this.expression.evaluate(new vn(0),o,{},p,[],y);this.paintVertexArray.resize(n),this._setPaintValue(x,n,w)}updatePaintArray(n,o,u,p){const y=this.expression.evaluate({zoom:0},u,p);this._setPaintValue(n,o,y)}_setPaintValue(n,o,u){if(this.type==="color"){const p=Bu(u);for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=n;p<o;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ar{constructor(n,o,u,p,y,x){this.expression=n,this.uniformNames=o.map(w=>`u_${w}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(w=>({name:`a_${w}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,o,u,p,y){const x=this.expression.evaluate(new vn(this.zoom),o,{},p,[],y),w=this.expression.evaluate(new vn(this.zoom+1),o,{},p,[],y),T=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(T,n,x,w)}updatePaintArray(n,o,u,p){const y=this.expression.evaluate({zoom:this.zoom},u,p),x=this.expression.evaluate({zoom:this.zoom+1},u,p);this._setPaintValue(n,o,y,x)}_setPaintValue(n,o,u,p){if(this.type==="color"){const y=Bu(u),x=Bu(p);for(let w=n;w<o;w++)this.paintVertexArray.emplace(w,y[0],y[1],x[0],x[1])}else{for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,p=Ee(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,o,u){return new Hl(n,o)}}class rs{constructor(n,o,u,p,y,x){this.expression=n,this.type=o,this.useIntegerZoom=u,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(n,o,u){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(n,o,u,p,y){this._setPaintValues(n,o,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(n,o,u,p){if(!p||!u)return;const{min:y,mid:x,max:w}=u,T=p[y],P=p[x],I=p[w];if(T&&P&&I)for(let D=n;D<o;D++)this.zoomInPaintVertexArray.emplace(D,P.tl[0],P.tl[1],P.br[0],P.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],P.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,P.tl[0],P.tl[1],P.br[0],P.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],P.pixelRatio,I.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,ts.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,ts.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Nu{constructor(n,o,u){this.binders={},this._buffers=[];const p=[];for(const y in n.paint._values){if(!u(y))continue;const x=n.paint.get(y);if(!(x instanceof zi&&Uo(x.property.specification)))continue;const w=rC(y,n.type),T=x.value,P=x.property.specification.type,I=x.property.useIntegerZoom,D=x.property.specification["property-type"],j=D==="cross-faded"||D==="cross-faded-data-driven";if(T.kind==="constant")this.binders[y]=j?new _o(T.value,w):new ns(T.value,w,P),p.push(`/u_${y}`);else if(T.kind==="source"||j){const $=Fx(y,P,"source");this.binders[y]=j?new rs(T,P,I,o,$,n.id):new is(T,w,P,$),p.push(`/a_${y}`)}else{const $=Fx(y,P,"composite");this.binders[y]=new Ar(T,w,P,I,o,$),p.push(`/z_${y}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof is||o instanceof Ar?o.maxValue:0}populatePaintArrays(n,o,u,p,y){for(const x in this.binders){const w=this.binders[x];(w instanceof is||w instanceof Ar||w instanceof rs)&&w.populatePaintArray(n,o,u,p,y)}}setConstantPatternPositions(n,o){for(const u in this.binders){const p=this.binders[u];p instanceof _o&&p.setConstantPatternPositions(n,o)}}updatePaintArrays(n,o,u,p,y){let x=!1;for(const w in n){const T=o.getPositions(w);for(const P of T){const I=u.feature(P.index);for(const D in this.binders){const j=this.binders[D];if((j instanceof is||j instanceof Ar||j instanceof rs)&&j.expression.isStateDependent===!0){const $=p.paint.get(D);j.expression=$.value,j.updatePaintArray(P.start,P.end,I,n[w],y),x=!0}}}}return x}defines(){const n=[];for(const o in this.binders){const u=this.binders[o];(u instanceof ns||u instanceof _o)&&n.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof is||u instanceof Ar)for(let p=0;p<u.paintVertexAttributes.length;p++)n.push(u.paintVertexAttributes[p].name);else if(u instanceof rs)for(let p=0;p<ts.members.length;p++)n.push(ts.members[p].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof ns||u instanceof _o||u instanceof Ar)for(const p of u.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const u=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof ns||y instanceof _o||y instanceof Ar){for(const x of y.uniformNames)if(o[x]){const w=y.getBinding(n,o[x],x);u.push({name:x,property:p,binding:w})}}}return u}setUniforms(n,o,u,p){for(const{name:y,property:x,binding:w}of o)this.binders[x].setUniform(w,p,u.get(x),y)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const u=this.binders[o];if(n&&u instanceof rs){const p=n.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof is||u instanceof Ar)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(n){for(const o in this.binders){const u=this.binders[o];(u instanceof is||u instanceof Ar||u instanceof rs)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof is||o instanceof Ar||o instanceof rs)&&o.destroy()}}}class Ss{constructor(n,o,u=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Nu(p,o,u);this.needsUpload=!1,this._featureMap=new On,this._bufferOffset=0}populatePaintArrays(n,o,u,p,y,x){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,o,p,y,x);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,u,p){for(const y of u)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,o,y,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function rC(r,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${n}-`,"").replace(/-/g,"_")]}function Fx(r,n,o){const u={color:{source:Ko,composite:Y},number:{source:E,composite:Ko}},p=function(y){return{"line-pattern":{source:pn,composite:pn},"fill-pattern":{source:pn,composite:pn},"fill-extrusion-pattern":{source:pn,composite:pn}}[y]}(r);return p&&p[o]||u[n][o]}st("ConstantBinder",ns),st("CrossFadedConstantBinder",_o),st("SourceExpressionBinder",is),st("CrossFadedCompositeBinder",rs),st("CompositeExpressionBinder",Ar),st("ProgramConfiguration",Nu,{omit:["_buffers"]}),st("ProgramConfigurationSet",Ss);const Yn=8192,Xm=Math.pow(2,14)-1,Bx=-Xm-1;function qa(r){const n=Yn/r.extent,o=r.loadGeometry();for(let u=0;u<o.length;u++){const p=o[u];for(let y=0;y<p.length;y++){const x=p[y],w=Math.round(x.x*n),T=Math.round(x.y*n);x.x=Ee(w,Bx,Xm),x.y=Ee(T,Bx,Xm),(w<x.x||w>x.x+1||T<x.y||T>x.y+1)&&Ut("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Za(r,n){return{type:r.type,id:r.id,properties:r.properties,geometry:n?qa(r):[]}}function ip(r,n,o,u,p){r.emplaceBack(2*n+(u+1)/2,2*o+(p+1)/2)}class Ym{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new ht,this.indexArray=new vi,this.segments=new wn,this.programConfigurations=new Ss(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){const p=this.layers[0],y=[];let x=null,w=!1;p.type==="circle"&&(x=p.layout.get("circle-sort-key"),w=!x.isConstant());for(const{feature:T,id:P,index:I,sourceLayerIndex:D}of n){const j=this.layers[0]._featureFilter.needGeometry,$=Za(T,j);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),$,u))continue;const U=w?x.evaluate($,{},u):void 0,K={id:P,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:j?$.geometry:qa(T),patterns:{},sortKey:U};y.push(K)}w&&y.sort((T,P)=>T.sortKey-P.sortKey);for(const T of y){const{geometry:P,index:I,sourceLayerIndex:D}=T,j=n[I].feature;this.addFeature(T,P,I,u),o.featureIndex.insert(j,P,I,D,this.index)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,hr),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,u,p){for(const y of o)for(const x of y){const w=x.x,T=x.y;if(w<0||w>=Yn||T<0||T>=Yn)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),I=P.vertexLength;ip(this.layoutVertexArray,w,T,-1,-1),ip(this.layoutVertexArray,w,T,1,-1),ip(this.layoutVertexArray,w,T,1,1),ip(this.layoutVertexArray,w,T,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},p)}}function Nx(r,n){for(let o=0;o<r.length;o++)if(Kl(n,r[o]))return!0;for(let o=0;o<n.length;o++)if(Kl(r,n[o]))return!0;return!!Jm(r,n)}function sC(r,n,o){return!!Kl(r,n)||!!Qm(n,r,o)}function jx(r,n){if(r.length===1)return Vx(n,r[0]);for(let o=0;o<n.length;o++){const u=n[o];for(let p=0;p<u.length;p++)if(Kl(r,u[p]))return!0}for(let o=0;o<r.length;o++)if(Vx(n,r[o]))return!0;for(let o=0;o<n.length;o++)if(Jm(r,n[o]))return!0;return!1}function oC(r,n,o){if(r.length>1){if(Jm(r,n))return!0;for(let u=0;u<n.length;u++)if(Qm(n[u],r,o))return!0}for(let u=0;u<r.length;u++)if(Qm(r[u],n,o))return!0;return!1}function Jm(r,n){if(r.length===0||n.length===0)return!1;for(let o=0;o<r.length-1;o++){const u=r[o],p=r[o+1];for(let y=0;y<n.length-1;y++)if(aC(u,p,n[y],n[y+1]))return!0}return!1}function aC(r,n,o,u){return on(r,o,u)!==on(n,o,u)&&on(r,n,o)!==on(r,n,u)}function Qm(r,n,o){const u=o*o;if(n.length===1)return r.distSqr(n[0])<u;for(let p=1;p<n.length;p++)if(Ox(r,n[p-1],n[p])<u)return!0;return!1}function Ox(r,n,o){const u=n.distSqr(o);if(u===0)return r.distSqr(n);const p=((r.x-n.x)*(o.x-n.x)+(r.y-n.y)*(o.y-n.y))/u;return r.distSqr(p<0?n:p>1?o:o.sub(n)._mult(p)._add(n))}function Vx(r,n){let o,u,p,y=!1;for(let x=0;x<r.length;x++){o=r[x];for(let w=0,T=o.length-1;w<o.length;T=w++)u=o[w],p=o[T],u.y>n.y!=p.y>n.y&&n.x<(p.x-u.x)*(n.y-u.y)/(p.y-u.y)+u.x&&(y=!y)}return y}function Kl(r,n){let o=!1;for(let u=0,p=r.length-1;u<r.length;p=u++){const y=r[u],x=r[p];y.y>n.y!=x.y>n.y&&n.x<(x.x-y.x)*(n.y-y.y)/(x.y-y.y)+y.x&&(o=!o)}return o}function lC(r,n,o){const u=o[0],p=o[2];if(r.x<u.x&&n.x<u.x||r.x>p.x&&n.x>p.x||r.y<u.y&&n.y<u.y||r.y>p.y&&n.y>p.y)return!1;const y=on(r,n,o[0]);return y!==on(r,n,o[1])||y!==on(r,n,o[2])||y!==on(r,n,o[3])}function ju(r,n,o){const u=n.paint.get(r).value;return u.kind==="constant"?u.value:o.programConfigurations.get(n.id).getMaxValue(r)}function rp(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function sp(r,n,o,u,p){if(!n[0]&&!n[1])return r;const y=F.convert(n)._mult(p);o==="viewport"&&y._rotate(-u);const x=[];for(let w=0;w<r.length;w++)x.push(r[w].sub(y));return x}let $x,Ux;st("CircleBucket",Ym,{omit:["layers"]});var cC={get paint(){return Ux=Ux||new Un({"circle-radius":new xt(Me.paint_circle["circle-radius"]),"circle-color":new xt(Me.paint_circle["circle-color"]),"circle-blur":new xt(Me.paint_circle["circle-blur"]),"circle-opacity":new xt(Me.paint_circle["circle-opacity"]),"circle-translate":new mt(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new mt(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mt(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mt(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xt(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xt(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xt(Me.paint_circle["circle-stroke-opacity"])})},get layout(){return $x=$x||new Un({"circle-sort-key":new xt(Me.layout_circle["circle-sort-key"])})}},Gi=1e-6,Xl=typeof Float32Array<"u"?Float32Array:Array;function eg(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function qx(r,n,o){var u=n[0],p=n[1],y=n[2],x=n[3],w=n[4],T=n[5],P=n[6],I=n[7],D=n[8],j=n[9],$=n[10],U=n[11],K=n[12],te=n[13],le=n[14],_e=n[15],de=o[0],be=o[1],Ce=o[2],De=o[3];return r[0]=de*u+be*w+Ce*D+De*K,r[1]=de*p+be*T+Ce*j+De*te,r[2]=de*y+be*P+Ce*$+De*le,r[3]=de*x+be*I+Ce*U+De*_e,r[4]=(de=o[4])*u+(be=o[5])*w+(Ce=o[6])*D+(De=o[7])*K,r[5]=de*p+be*T+Ce*j+De*te,r[6]=de*y+be*P+Ce*$+De*le,r[7]=de*x+be*I+Ce*U+De*_e,r[8]=(de=o[8])*u+(be=o[9])*w+(Ce=o[10])*D+(De=o[11])*K,r[9]=de*p+be*T+Ce*j+De*te,r[10]=de*y+be*P+Ce*$+De*le,r[11]=de*x+be*I+Ce*U+De*_e,r[12]=(de=o[12])*u+(be=o[13])*w+(Ce=o[14])*D+(De=o[15])*K,r[13]=de*p+be*T+Ce*j+De*te,r[14]=de*y+be*P+Ce*$+De*le,r[15]=de*x+be*I+Ce*U+De*_e,r}Math.hypot||(Math.hypot=function(){for(var r=0,n=arguments.length;n--;)r+=arguments[n]*arguments[n];return Math.sqrt(r)});var Ou,uC=qx;function op(r,n,o){var u=n[0],p=n[1],y=n[2],x=n[3];return r[0]=o[0]*u+o[4]*p+o[8]*y+o[12]*x,r[1]=o[1]*u+o[5]*p+o[9]*y+o[13]*x,r[2]=o[2]*u+o[6]*p+o[10]*y+o[14]*x,r[3]=o[3]*u+o[7]*p+o[11]*y+o[15]*x,r}Ou=new Xl(4),Xl!=Float32Array&&(Ou[0]=0,Ou[1]=0,Ou[2]=0,Ou[3]=0);class hC extends Pr{constructor(n){super(n,cC)}createBucket(n){return new Ym(n)}queryRadius(n){const o=n;return ju("circle-radius",this,o)+ju("circle-stroke-width",this,o)+rp(this.paint.get("circle-translate"))}queryIntersectsFeature(n,o,u,p,y,x,w,T){const P=sp(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,w),I=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u),D=this.paint.get("circle-pitch-alignment")==="map",j=D?P:function(U,K){return U.map(te=>Zx(te,K))}(P,T),$=D?I*w:I;for(const U of p)for(const K of U){const te=D?K:Zx(K,T);let le=$;const _e=op([],[K.x,K.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?le*=_e[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(le*=x.cameraToCenterDistance/_e[3]),sC(j,te,le))return!0}return!1}}function Zx(r,n){const o=op([],[r.x,r.y,0,1],n);return new F(o[0]/o[3],o[1]/o[3])}class Gx extends Ym{}let Wx;st("HeatmapBucket",Gx,{omit:["layers"]});var dC={get paint(){return Wx=Wx||new Un({"heatmap-radius":new xt(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xt(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mt(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mu(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mt(Me.paint_heatmap["heatmap-opacity"])})}};function tg(r,{width:n,height:o},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*o*u)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*o*u}`)}else p=new Uint8Array(n*o*u);return r.width=n,r.height=o,r.data=p,r}function Hx(r,{width:n,height:o},u){if(n===r.width&&o===r.height)return;const p=tg({},{width:n,height:o},u);ng(r,p,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,n),height:Math.min(r.height,o)},u),r.width=n,r.height=o,r.data=p.data}function ng(r,n,o,u,p,y){if(p.width===0||p.height===0)return n;if(p.width>r.width||p.height>r.height||o.x>r.width-p.width||o.y>r.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||u.x>n.width-p.width||u.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=r.data,w=n.data;if(x===w)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<p.height;T++){const P=((o.y+T)*r.width+o.x)*y,I=((u.y+T)*n.width+u.x)*y;for(let D=0;D<p.width*y;D++)w[I+D]=x[P+D]}return n}class Vu{constructor(n,o){tg(this,n,1,o)}resize(n){Hx(this,n,1)}clone(){return new Vu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,p,y){ng(n,o,u,p,y,1)}}class jr{constructor(n,o){tg(this,n,4,o)}resize(n){Hx(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new jr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,p,y){ng(n,o,u,p,y,4)}}function Kx(r){const n={},o=r.resolution||256,u=r.clips?r.clips.length:1,p=r.image||new jr({width:o,height:u});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const y=(x,w,T)=>{n[r.evaluationKey]=T;const P=r.expression.evaluate(n);p.data[x+w+0]=Math.floor(255*P.r/P.a),p.data[x+w+1]=Math.floor(255*P.g/P.a),p.data[x+w+2]=Math.floor(255*P.b/P.a),p.data[x+w+3]=Math.floor(255*P.a)};if(r.clips)for(let x=0,w=0;x<u;++x,w+=4*o)for(let T=0,P=0;T<o;T++,P+=4){const I=T/(o-1),{start:D,end:j}=r.clips[x];y(w,P,D*(1-I)+j*I)}else for(let x=0,w=0;x<o;x++,w+=4)y(0,w,x/(o-1));return p}st("AlphaImage",Vu),st("RGBAImage",jr);class pC extends Pr{createBucket(n){return new Gx(n)}constructor(n){super(n,dC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xx;var fC={get paint(){return Xx=Xx||new Un({"hillshade-illumination-direction":new mt(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mt(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mt(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mt(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mt(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mt(Me.paint_hillshade["hillshade-accent-color"])})}};class mC extends Pr{constructor(n){super(n,fC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const gC=An([{name:"a_pos",components:2,type:"Int16"}],4),{members:yC}=gC;var ig={exports:{}};function ap(r,n,o){o=o||2;var u,p,y,x,w,T,P,I=n&&n.length,D=I?n[0]*o:r.length,j=Yx(r,0,D,o,!0),$=[];if(!j||j.next===j.prev)return $;if(I&&(j=function(K,te,le,_e){var de,be,Ce,De=[];for(de=0,be=te.length;de<be;de++)(Ce=Yx(K,te[de]*_e,de<be-1?te[de+1]*_e:K.length,_e,!1))===Ce.next&&(Ce.steiner=!0),De.push(kC(Ce));for(De.sort(bC),de=0;de<De.length;de++)le=SC(De[de],le);return le}(r,n,j,o)),r.length>80*o){u=y=r[0],p=x=r[1];for(var U=o;U<D;U+=o)(w=r[U])<u&&(u=w),(T=r[U+1])<p&&(p=T),w>y&&(y=w),T>x&&(x=T);P=(P=Math.max(y-u,x-p))!==0?32767/P:0}return $u(j,$,o,u,p,P,0),$}function Yx(r,n,o,u,p){var y,x;if(p===og(r,n,o,u)>0)for(y=n;y<o;y+=u)x=ev(y,r[y],r[y+1],x);else for(y=o-u;y>=n;y-=u)x=ev(y,r[y],r[y+1],x);return x&&lp(x,x.next)&&(qu(x),x=x.next),x}function Ga(r,n){if(!r)return r;n||(n=r);var o,u=r;do if(o=!1,u.steiner||!lp(u,u.next)&&Zn(u.prev,u,u.next)!==0)u=u.next;else{if(qu(u),(u=n=u.prev)===u.next)break;o=!0}while(o||u!==n);return n}function $u(r,n,o,u,p,y,x){if(r){!x&&y&&function(I,D,j,$){var U=I;do U.z===0&&(U.z=rg(U.x,U.y,D,j,$)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==I);U.prevZ.nextZ=null,U.prevZ=null,function(K){var te,le,_e,de,be,Ce,De,nt,dt=1;do{for(le=K,K=null,be=null,Ce=0;le;){for(Ce++,_e=le,De=0,te=0;te<dt&&(De++,_e=_e.nextZ);te++);for(nt=dt;De>0||nt>0&&_e;)De!==0&&(nt===0||!_e||le.z<=_e.z)?(de=le,le=le.nextZ,De--):(de=_e,_e=_e.nextZ,nt--),be?be.nextZ=de:K=de,de.prevZ=be,be=de;le=_e}be.nextZ=null,dt*=2}while(Ce>1)}(U)}(r,u,p,y);for(var w,T,P=r;r.prev!==r.next;)if(w=r.prev,T=r.next,y?xC(r,u,p,y):_C(r))n.push(w.i/o|0),n.push(r.i/o|0),n.push(T.i/o|0),qu(r),r=T.next,P=T.next;else if((r=T)===P){x?x===1?$u(r=vC(Ga(r),n,o),n,o,u,p,y,2):x===2&&wC(r,n,o,u,p,y):$u(Ga(r),n,o,u,p,y,1);break}}}function _C(r){var n=r.prev,o=r,u=r.next;if(Zn(n,o,u)>=0)return!1;for(var p=n.x,y=o.x,x=u.x,w=n.y,T=o.y,P=u.y,I=p<y?p<x?p:x:y<x?y:x,D=w<T?w<P?w:P:T<P?T:P,j=p>y?p>x?p:x:y>x?y:x,$=w>T?w>P?w:P:T>P?T:P,U=u.next;U!==n;){if(U.x>=I&&U.x<=j&&U.y>=D&&U.y<=$&&Yl(p,w,y,T,x,P,U.x,U.y)&&Zn(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function xC(r,n,o,u){var p=r.prev,y=r,x=r.next;if(Zn(p,y,x)>=0)return!1;for(var w=p.x,T=y.x,P=x.x,I=p.y,D=y.y,j=x.y,$=w<T?w<P?w:P:T<P?T:P,U=I<D?I<j?I:j:D<j?D:j,K=w>T?w>P?w:P:T>P?T:P,te=I>D?I>j?I:j:D>j?D:j,le=rg($,U,n,o,u),_e=rg(K,te,n,o,u),de=r.prevZ,be=r.nextZ;de&&de.z>=le&&be&&be.z<=_e;){if(de.x>=$&&de.x<=K&&de.y>=U&&de.y<=te&&de!==p&&de!==x&&Yl(w,I,T,D,P,j,de.x,de.y)&&Zn(de.prev,de,de.next)>=0||(de=de.prevZ,be.x>=$&&be.x<=K&&be.y>=U&&be.y<=te&&be!==p&&be!==x&&Yl(w,I,T,D,P,j,be.x,be.y)&&Zn(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;de&&de.z>=le;){if(de.x>=$&&de.x<=K&&de.y>=U&&de.y<=te&&de!==p&&de!==x&&Yl(w,I,T,D,P,j,de.x,de.y)&&Zn(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;be&&be.z<=_e;){if(be.x>=$&&be.x<=K&&be.y>=U&&be.y<=te&&be!==p&&be!==x&&Yl(w,I,T,D,P,j,be.x,be.y)&&Zn(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function vC(r,n,o){var u=r;do{var p=u.prev,y=u.next.next;!lp(p,y)&&Jx(p,u,u.next,y)&&Uu(p,y)&&Uu(y,p)&&(n.push(p.i/o|0),n.push(u.i/o|0),n.push(y.i/o|0),qu(u),qu(u.next),u=r=y),u=u.next}while(u!==r);return Ga(u)}function wC(r,n,o,u,p,y){var x=r;do{for(var w=x.next.next;w!==x.prev;){if(x.i!==w.i&&EC(x,w)){var T=Qx(x,w);return x=Ga(x,x.next),T=Ga(T,T.next),$u(x,n,o,u,p,y,0),void $u(T,n,o,u,p,y,0)}w=w.next}x=x.next}while(x!==r)}function bC(r,n){return r.x-n.x}function SC(r,n){var o=function(p,y){var x,w=y,T=p.x,P=p.y,I=-1/0;do{if(P<=w.y&&P>=w.next.y&&w.next.y!==w.y){var D=w.x+(P-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(D<=T&&D>I&&(I=D,x=w.x<w.next.x?w:w.next,D===T))return x}w=w.next}while(w!==y);if(!x)return null;var j,$=x,U=x.x,K=x.y,te=1/0;w=x;do T>=w.x&&w.x>=U&&T!==w.x&&Yl(P<K?T:I,P,U,K,P<K?I:T,P,w.x,w.y)&&(j=Math.abs(P-w.y)/(T-w.x),Uu(w,p)&&(j<te||j===te&&(w.x>x.x||w.x===x.x&&TC(x,w)))&&(x=w,te=j)),w=w.next;while(w!==$);return x}(r,n);if(!o)return n;var u=Qx(o,r);return Ga(u,u.next),Ga(o,o.next)}function TC(r,n){return Zn(r.prev,r,n.prev)<0&&Zn(n.next,r,r.next)<0}function rg(r,n,o,u,p){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function kC(r){var n=r,o=r;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==r);return o}function Yl(r,n,o,u,p,y,x,w){return(p-x)*(n-w)>=(r-x)*(y-w)&&(r-x)*(u-w)>=(o-x)*(n-w)&&(o-x)*(y-w)>=(p-x)*(u-w)}function EC(r,n){return r.next.i!==n.i&&r.prev.i!==n.i&&!function(o,u){var p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==u.i&&p.next.i!==u.i&&Jx(p,p.next,o,u))return!0;p=p.next}while(p!==o);return!1}(r,n)&&(Uu(r,n)&&Uu(n,r)&&function(o,u){var p=o,y=!1,x=(o.x+u.x)/2,w=(o.y+u.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&x<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==o);return y}(r,n)&&(Zn(r.prev,r,n.prev)||Zn(r,n.prev,n))||lp(r,n)&&Zn(r.prev,r,r.next)>0&&Zn(n.prev,n,n.next)>0)}function Zn(r,n,o){return(n.y-r.y)*(o.x-n.x)-(n.x-r.x)*(o.y-n.y)}function lp(r,n){return r.x===n.x&&r.y===n.y}function Jx(r,n,o,u){var p=up(Zn(r,n,o)),y=up(Zn(r,n,u)),x=up(Zn(o,u,r)),w=up(Zn(o,u,n));return p!==y&&x!==w||!(p!==0||!cp(r,o,n))||!(y!==0||!cp(r,u,n))||!(x!==0||!cp(o,r,u))||!(w!==0||!cp(o,n,u))}function cp(r,n,o){return n.x<=Math.max(r.x,o.x)&&n.x>=Math.min(r.x,o.x)&&n.y<=Math.max(r.y,o.y)&&n.y>=Math.min(r.y,o.y)}function up(r){return r>0?1:r<0?-1:0}function Uu(r,n){return Zn(r.prev,r,r.next)<0?Zn(r,n,r.next)>=0&&Zn(r,r.prev,n)>=0:Zn(r,n,r.prev)<0||Zn(r,r.next,n)<0}function Qx(r,n){var o=new sg(r.i,r.x,r.y),u=new sg(n.i,n.x,n.y),p=r.next,y=n.prev;return r.next=n,n.prev=r,o.next=p,p.prev=o,u.next=o,o.prev=u,y.next=u,u.prev=y,u}function ev(r,n,o,u){var p=new sg(r,n,o);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function qu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function sg(r,n,o){this.i=r,this.x=n,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function og(r,n,o,u){for(var p=0,y=n,x=o-u;y<o;y+=u)p+=(r[x]-r[y])*(r[y+1]+r[x+1]),x=y;return p}ig.exports=ap,ig.exports.default=ap,ap.deviation=function(r,n,o,u){var p=n&&n.length,y=Math.abs(og(r,0,p?n[0]*o:r.length,o));if(p)for(var x=0,w=n.length;x<w;x++)y-=Math.abs(og(r,n[x]*o,x<w-1?n[x+1]*o:r.length,o));var T=0;for(x=0;x<u.length;x+=3){var P=u[x]*o,I=u[x+1]*o,D=u[x+2]*o;T+=Math.abs((r[P]-r[D])*(r[I+1]-r[P+1])-(r[P]-r[I])*(r[D+1]-r[P+1]))}return y===0&&T===0?0:Math.abs((T-y)/y)},ap.flatten=function(r){for(var n=r[0][0].length,o={vertices:[],holes:[],dimensions:n},u=0,p=0;p<r.length;p++){for(var y=0;y<r[p].length;y++)for(var x=0;x<n;x++)o.vertices.push(r[p][y][x]);p>0&&o.holes.push(u+=r[p-1].length)}return o};var tv=k(ig.exports);function CC(r,n,o,u,p){nv(r,n,o||0,u||r.length-1,p||PC)}function nv(r,n,o,u,p){for(;u>o;){if(u-o>600){var y=u-o+1,x=n-o+1,w=Math.log(y),T=.5*Math.exp(2*w/3),P=.5*Math.sqrt(w*T*(y-T)/y)*(x-y/2<0?-1:1);nv(r,n,Math.max(o,Math.floor(n-x*T/y+P)),Math.min(u,Math.floor(n+(y-x)*T/y+P)),p)}var I=r[n],D=o,j=u;for(Zu(r,o,n),p(r[u],I)>0&&Zu(r,o,u);D<j;){for(Zu(r,D,j),D++,j--;p(r[D],I)<0;)D++;for(;p(r[j],I)>0;)j--}p(r[o],I)===0?Zu(r,o,j):Zu(r,++j,u),j<=n&&(o=j+1),n<=j&&(u=j-1)}}function Zu(r,n,o){var u=r[n];r[n]=r[o],r[o]=u}function PC(r,n){return r<n?-1:r>n?1:0}function ag(r,n){const o=r.length;if(o<=1)return[r];const u=[];let p,y;for(let x=0;x<o;x++){const w=Ve(r[x]);w!==0&&(r[x].area=Math.abs(w),y===void 0&&(y=w<0),y===w<0?(p&&u.push(p),p=[r[x]]):p.push(r[x]))}if(p&&u.push(p),n>1)for(let x=0;x<u.length;x++)u[x].length<=n||(CC(u[x],n,1,u[x].length-1,AC),u[x]=u[x].slice(0,n));return u}function AC(r,n){return n.area-r.area}function lg(r,n,o){const u=o.patternDependencies;let p=!1;for(const y of n){const x=y.paint.get(`${r}-pattern`);x.isConstant()||(p=!0);const w=x.constantOr(null);w&&(p=!0,u[w.to]=!0,u[w.from]=!0)}return p}function cg(r,n,o,u,p){const y=p.patternDependencies;for(const x of n){const w=x.paint.get(`${r}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:u-1},o,{},p.availableImages),P=w.evaluate({zoom:u},o,{},p.availableImages),I=w.evaluate({zoom:u+1},o,{},p.availableImages);T=T&&T.name?T.name:T,P=P&&P.name?P.name:P,I=I&&I.name?I.name:I,y[T]=!0,y[P]=!0,y[I]=!0,o.patterns[x.id]={min:T,mid:P,max:I}}}return o}class ug{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Zt,this.indexArray=new vi,this.indexArray2=new ni,this.programConfigurations=new Ss(n.layers,n.zoom),this.segments=new wn,this.segments2=new wn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.hasPattern=lg("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),y=!p.isConstant(),x=[];for(const{feature:w,id:T,index:P,sourceLayerIndex:I}of n){const D=this.layers[0]._featureFilter.needGeometry,j=Za(w,D);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),j,u))continue;const $=y?p.evaluate(j,{},u,o.availableImages):void 0,U={id:T,properties:w.properties,type:w.type,sourceLayerIndex:I,index:P,geometry:D?j.geometry:qa(w),patterns:{},sortKey:$};x.push(U)}y&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:P,sourceLayerIndex:I}=w;if(this.hasPattern){const D=cg("fill",this.layers,w,this.zoom,o);this.patternFeatures.push(D)}else this.addFeature(w,T,P,u,{});o.featureIndex.insert(n[P].feature,T,P,I,this.index)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,u)}addFeatures(n,o,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,yC),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,u,p,y){for(const x of ag(o,500)){let w=0;for(const $ of x)w+=$.length;const T=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),P=T.vertexLength,I=[],D=[];for(const $ of x){if($.length===0)continue;$!==x[0]&&D.push(I.length/2);const U=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),K=U.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(K+$.length-1,K),I.push($[0].x),I.push($[0].y);for(let te=1;te<$.length;te++)this.layoutVertexArray.emplaceBack($[te].x,$[te].y),this.indexArray2.emplaceBack(K+te-1,K+te),I.push($[te].x),I.push($[te].y);U.vertexLength+=$.length,U.primitiveLength+=$.length}const j=tv(I,D);for(let $=0;$<j.length;$+=3)this.indexArray.emplaceBack(P+j[$],P+j[$+1],P+j[$+2]);T.vertexLength+=w,T.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,y,p)}}let iv,rv;st("FillBucket",ug,{omit:["layers","patternFeatures"]});var IC={get paint(){return rv=rv||new Un({"fill-antialias":new mt(Me.paint_fill["fill-antialias"]),"fill-opacity":new xt(Me.paint_fill["fill-opacity"]),"fill-color":new xt(Me.paint_fill["fill-color"]),"fill-outline-color":new xt(Me.paint_fill["fill-outline-color"]),"fill-translate":new mt(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new mt(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Va(Me.paint_fill["fill-pattern"])})},get layout(){return iv=iv||new Un({"fill-sort-key":new xt(Me.layout_fill["fill-sort-key"])})}};class MC extends Pr{constructor(n){super(n,IC)}recalculate(n,o){super.recalculate(n,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new ug(n)}queryRadius(){return rp(this.paint.get("fill-translate"))}queryIntersectsFeature(n,o,u,p,y,x,w){return jx(sp(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,w),p)}isTileClipped(){return!0}}const LC=An([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),zC=An([{name:"a_centroid",components:2,type:"Int16"}],4),{members:DC}=LC;var Yo={},RC=L,sv=Jl;function Jl(r,n,o,u,p){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=u,this._values=p,r.readFields(FC,this,n)}function FC(r,n,o){r==1?n.id=o.readVarint():r==2?function(u,p){for(var y=u.readVarint()+u.pos;u.pos<y;){var x=p._keys[u.readVarint()],w=p._values[u.readVarint()];p.properties[x]=w}}(o,n):r==3?n.type=o.readVarint():r==4&&(n._geometry=o.pos)}function BC(r){for(var n,o,u=0,p=0,y=r.length,x=y-1;p<y;x=p++)u+=((o=r[x]).x-(n=r[p]).x)*(n.y+o.y);return u}Jl.types=["Unknown","Point","LineString","Polygon"],Jl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var n,o=r.readVarint()+r.pos,u=1,p=0,y=0,x=0,w=[];r.pos<o;){if(p<=0){var T=r.readVarint();u=7&T,p=T>>3}if(p--,u===1||u===2)y+=r.readSVarint(),x+=r.readSVarint(),u===1&&(n&&w.push(n),n=[]),n.push(new RC(y,x));else{if(u!==7)throw new Error("unknown command "+u);n&&n.push(n[0].clone())}}return n&&w.push(n),w},Jl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var n=r.readVarint()+r.pos,o=1,u=0,p=0,y=0,x=1/0,w=-1/0,T=1/0,P=-1/0;r.pos<n;){if(u<=0){var I=r.readVarint();o=7&I,u=I>>3}if(u--,o===1||o===2)(p+=r.readSVarint())<x&&(x=p),p>w&&(w=p),(y+=r.readSVarint())<T&&(T=y),y>P&&(P=y);else if(o!==7)throw new Error("unknown command "+o)}return[x,T,w,P]},Jl.prototype.toGeoJSON=function(r,n,o){var u,p,y=this.extent*Math.pow(2,o),x=this.extent*r,w=this.extent*n,T=this.loadGeometry(),P=Jl.types[this.type];function I($){for(var U=0;U<$.length;U++){var K=$[U];$[U]=[360*(K.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+w)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(u=0;u<T.length;u++)D[u]=T[u][0];I(T=D);break;case 2:for(u=0;u<T.length;u++)I(T[u]);break;case 3:for(T=function($){var U=$.length;if(U<=1)return[$];for(var K,te,le=[],_e=0;_e<U;_e++){var de=BC($[_e]);de!==0&&(te===void 0&&(te=de<0),te===de<0?(K&&le.push(K),K=[$[_e]]):K.push($[_e]))}return K&&le.push(K),le}(T),u=0;u<T.length;u++)for(p=0;p<T[u].length;p++)I(T[u][p])}T.length===1?T=T[0]:P="Multi"+P;var j={type:"Feature",geometry:{type:P,coordinates:T},properties:this.properties};return"id"in this&&(j.id=this.id),j};var NC=sv,ov=av;function av(r,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(jC,this,n),this.length=this._features.length}function jC(r,n,o){r===15?n.version=o.readVarint():r===1?n.name=o.readString():r===5?n.extent=o.readVarint():r===2?n._features.push(o.pos):r===3?n._keys.push(o.readString()):r===4&&n._values.push(function(u){for(var p=null,y=u.readVarint()+u.pos;u.pos<y;){var x=u.readVarint()>>3;p=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return p}(o))}av.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var n=this._pbf.readVarint()+this._pbf.pos;return new NC(this._pbf,n,this.extent,this._keys,this._values)};var OC=ov;function VC(r,n,o){if(r===3){var u=new OC(o,o.readVarint()+o.pos);u.length&&(n[u.name]=u)}}Yo.VectorTile=function(r,n){this.layers=r.readFields(VC,{},n)},Yo.VectorTileFeature=sv,Yo.VectorTileLayer=ov;const $C=Yo.VectorTileFeature.types,hg=Math.pow(2,13);function Gu(r,n,o,u,p,y,x,w){r.emplaceBack(n,o,2*Math.floor(u*hg)+x,p*hg*2,y*hg*2,Math.round(w))}class dg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Ye,this.centroidVertexArray=new $e,this.indexArray=new vi,this.programConfigurations=new Ss(n.layers,n.zoom),this.segments=new wn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.features=[],this.hasPattern=lg("fill-extrusion",this.layers,o);for(const{feature:p,id:y,index:x,sourceLayerIndex:w}of n){const T=this.layers[0]._featureFilter.needGeometry,P=Za(p,T);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),P,u))continue;const I={id:y,sourceLayerIndex:w,index:x,geometry:T?P.geometry:qa(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(cg("fill-extrusion",this.layers,I,this.zoom,o)):this.addFeature(I,I.geometry,x,u,{}),o.featureIndex.insert(p,I.geometry,x,w,this.index,!0)}}addFeatures(n,o,u){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,o,u)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,DC),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,zC.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,u,p,y){const x={x:0,y:0,vertexCount:0};for(const w of ag(o,500)){let T=0;for(const U of w)T+=U.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const U of w){if(U.length===0||qC(U))continue;let K=0;for(let te=0;te<U.length;te++){const le=U[te];if(te>=1){const _e=U[te-1];if(!UC(le,_e)){P.vertexLength+4>wn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const de=le.sub(_e)._perp()._unit(),be=_e.dist(le);K+be>32768&&(K=0),Gu(this.layoutVertexArray,le.x,le.y,de.x,de.y,0,0,K),Gu(this.layoutVertexArray,le.x,le.y,de.x,de.y,0,1,K),x.x+=2*le.x,x.y+=2*le.y,x.vertexCount+=2,K+=be,Gu(this.layoutVertexArray,_e.x,_e.y,de.x,de.y,0,0,K),Gu(this.layoutVertexArray,_e.x,_e.y,de.x,de.y,0,1,K),x.x+=2*_e.x,x.y+=2*_e.y,x.vertexCount+=2;const Ce=P.vertexLength;this.indexArray.emplaceBack(Ce,Ce+2,Ce+1),this.indexArray.emplaceBack(Ce+1,Ce+2,Ce+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+T>wn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),$C[n.type]!=="Polygon")continue;const I=[],D=[],j=P.vertexLength;for(const U of w)if(U.length!==0){U!==w[0]&&D.push(I.length/2);for(let K=0;K<U.length;K++){const te=U[K];Gu(this.layoutVertexArray,te.x,te.y,0,0,1,1,0),x.x+=te.x,x.y+=te.y,x.vertexCount+=1,I.push(te.x),I.push(te.y)}}const $=tv(I,D);for(let U=0;U<$.length;U+=3)this.indexArray.emplaceBack(j+$[U],j+$[U+2],j+$[U+1]);P.primitiveLength+=$.length/3,P.vertexLength+=T}for(let w=0;w<x.vertexCount;w++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,y,p)}}function UC(r,n){return r.x===n.x&&(r.x<0||r.x>Yn)||r.y===n.y&&(r.y<0||r.y>Yn)}function qC(r){return r.every(n=>n.x<0)||r.every(n=>n.x>Yn)||r.every(n=>n.y<0)||r.every(n=>n.y>Yn)}let lv;st("FillExtrusionBucket",dg,{omit:["layers","features"]});var ZC={get paint(){return lv=lv||new Un({"fill-extrusion-opacity":new mt(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xt(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mt(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mt(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Va(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xt(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xt(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mt(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class GC extends Pr{constructor(n){super(n,ZC)}createBucket(n){return new dg(n)}queryRadius(){return rp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,o,u,p,y,x,w,T){const P=sp(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,w),I=this.paint.get("fill-extrusion-height").evaluate(o,u),D=this.paint.get("fill-extrusion-base").evaluate(o,u),j=function(U,K,te,le){const _e=[];for(const de of U){const be=[de.x,de.y,0,1];op(be,be,K),_e.push(new F(be[0]/be[3],be[1]/be[3]))}return _e}(P,T),$=function(U,K,te,le){const _e=[],de=[],be=le[8]*K,Ce=le[9]*K,De=le[10]*K,nt=le[11]*K,dt=le[8]*te,et=le[9]*te,Je=le[10]*te,We=le[11]*te;for(const ot of U){const Xe=[],je=[];for(const yt of ot){const ft=yt.x,Bt=yt.y,bn=le[0]*ft+le[4]*Bt+le[12],kn=le[1]*ft+le[5]*Bt+le[13],si=le[2]*ft+le[6]*Bt+le[14],Ir=le[3]*ft+le[7]*Bt+le[15],Wi=si+De,Jn=Ir+nt,bi=bn+dt,Ai=kn+et,Hi=si+Je,Ki=Ir+We,oi=new F((bn+be)/Jn,(kn+Ce)/Jn);oi.z=Wi/Jn,Xe.push(oi);const ai=new F(bi/Ki,Ai/Ki);ai.z=Hi/Ki,je.push(ai)}_e.push(Xe),de.push(je)}return[_e,de]}(p,D,I,T);return function(U,K,te){let le=1/0;jx(te,K)&&(le=cv(te,K[0]));for(let _e=0;_e<K.length;_e++){const de=K[_e],be=U[_e];for(let Ce=0;Ce<de.length-1;Ce++){const De=de[Ce],nt=[De,de[Ce+1],be[Ce+1],be[Ce],De];Nx(te,nt)&&(le=Math.min(le,cv(te,nt)))}}return le!==1/0&&le}($[0],$[1],j)}}function Wu(r,n){return r.x*n.x+r.y*n.y}function cv(r,n){if(r.length===1){let o=0;const u=n[o++];let p;for(;!p||u.equals(p);)if(p=n[o++],!p)return 1/0;for(;o<n.length;o++){const y=n[o],x=r[0],w=p.sub(u),T=y.sub(u),P=x.sub(u),I=Wu(w,w),D=Wu(w,T),j=Wu(T,T),$=Wu(P,w),U=Wu(P,T),K=I*j-D*D,te=(j*$-D*U)/K,le=(I*U-D*$)/K,_e=u.z*(1-te-le)+p.z*te+y.z*le;if(isFinite(_e))return _e}return 1/0}{let o=1/0;for(const u of n)o=Math.min(o,u.z);return o}}const WC=An([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:HC}=WC,KC=An([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:XC}=KC,YC=Yo.VectorTileFeature.types,JC=Math.cos(Math.PI/180*37.5),uv=Math.pow(2,14)/.5;class pg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new vt,this.layoutVertexArray2=new pt,this.indexArray=new vi,this.programConfigurations=new Ss(n.layers,n.zoom),this.segments=new wn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.hasPattern=lg("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),y=!p.isConstant(),x=[];for(const{feature:w,id:T,index:P,sourceLayerIndex:I}of n){const D=this.layers[0]._featureFilter.needGeometry,j=Za(w,D);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),j,u))continue;const $=y?p.evaluate(j,{},u):void 0,U={id:T,properties:w.properties,type:w.type,sourceLayerIndex:I,index:P,geometry:D?j.geometry:qa(w),patterns:{},sortKey:$};x.push(U)}y&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:P,sourceLayerIndex:I}=w;if(this.hasPattern){const D=cg("line",this.layers,w,this.zoom,o);this.patternFeatures.push(D)}else this.addFeature(w,T,P,u,{});o.featureIndex.insert(n[P].feature,T,P,I,this.index)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,u)}addFeatures(n,o,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,XC)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,HC),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,u,p,y){const x=this.layers[0].layout,w=x.get("line-join").evaluate(n,{}),T=x.get("line-cap"),P=x.get("line-miter-limit"),I=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const D of o)this.addLine(D,n,w,T,P,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,y,p)}addLine(n,o,u,p,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<n.length-1;le++)this.totalDistance+=n[le].dist(n[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=YC[o.type]==="Polygon";let T=n.length;for(;T>=2&&n[T-1].equals(n[T-2]);)T--;let P=0;for(;P<T-1&&n[P].equals(n[P+1]);)P++;if(T<(w?3:2))return;u==="bevel"&&(y=1.05);const I=this.overscaling<=16?15*Yn/(512*this.overscaling):0,D=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let j,$,U,K,te;this.e1=this.e2=-1,w&&(j=n[T-2],te=n[P].sub(j)._unit()._perp());for(let le=P;le<T;le++){if(U=le===T-1?w?n[P+1]:void 0:n[le+1],U&&n[le].equals(U))continue;te&&(K=te),j&&($=j),j=n[le],te=U?U.sub(j)._unit()._perp():K,K=K||te;let _e=K.add(te);_e.x===0&&_e.y===0||_e._unit();const de=K.x*te.x+K.y*te.y,be=_e.x*te.x+_e.y*te.y,Ce=be!==0?1/be:1/0,De=2*Math.sqrt(2-2*be),nt=be<JC&&$&&U,dt=K.x*te.y-K.y*te.x>0;if(nt&&le>P){const We=j.dist($);if(We>2*I){const ot=j.sub(j.sub($)._mult(I/We)._round());this.updateDistance($,ot),this.addCurrentVertex(ot,K,0,0,D),$=ot}}const et=$&&U;let Je=et?u:w?"butt":p;if(et&&Je==="round"&&(Ce<x?Je="miter":Ce<=2&&(Je="fakeround")),Je==="miter"&&Ce>y&&(Je="bevel"),Je==="bevel"&&(Ce>2&&(Je="flipbevel"),Ce<y&&(Je="miter")),$&&this.updateDistance($,j),Je==="miter")_e._mult(Ce),this.addCurrentVertex(j,_e,0,0,D);else if(Je==="flipbevel"){if(Ce>100)_e=te.mult(-1);else{const We=Ce*K.add(te).mag()/K.sub(te).mag();_e._perp()._mult(We*(dt?-1:1))}this.addCurrentVertex(j,_e,0,0,D),this.addCurrentVertex(j,_e.mult(-1),0,0,D)}else if(Je==="bevel"||Je==="fakeround"){const We=-Math.sqrt(Ce*Ce-1),ot=dt?We:0,Xe=dt?0:We;if($&&this.addCurrentVertex(j,K,ot,Xe,D),Je==="fakeround"){const je=Math.round(180*De/Math.PI/20);for(let yt=1;yt<je;yt++){let ft=yt/je;if(ft!==.5){const bn=ft-.5;ft+=ft*bn*(ft-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*bn*bn+(.848013+de*(.215638*de-1.06021)))}const Bt=te.sub(K)._mult(ft)._add(K)._unit()._mult(dt?-1:1);this.addHalfVertex(j,Bt.x,Bt.y,!1,dt,0,D)}}U&&this.addCurrentVertex(j,te,-ot,-Xe,D)}else if(Je==="butt")this.addCurrentVertex(j,_e,0,0,D);else if(Je==="square"){const We=$?1:-1;this.addCurrentVertex(j,_e,We,We,D)}else Je==="round"&&($&&(this.addCurrentVertex(j,K,0,0,D),this.addCurrentVertex(j,K,1,1,D,!0)),U&&(this.addCurrentVertex(j,te,-1,-1,D,!0),this.addCurrentVertex(j,te,0,0,D)));if(nt&&le<T-1){const We=j.dist(U);if(We>2*I){const ot=j.add(U.sub(j)._mult(I/We)._round());this.updateDistance(j,ot),this.addCurrentVertex(ot,te,0,0,D),j=ot}}}}addCurrentVertex(n,o,u,p,y,x=!1){const w=o.y*p-o.x,T=-o.y-o.x*p;this.addHalfVertex(n,o.x+o.y*u,o.y-o.x*u,x,!1,u,y),this.addHalfVertex(n,w,T,x,!0,-p,y),this.distance>uv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,u,p,y,x))}addHalfVertex({x:n,y:o},u,p,y,x,w,T){const P=.5*(this.lineClips?this.scaledDistance*(uv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(o<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),T.primitiveLength++),x?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}}let hv,dv;st("LineBucket",pg,{omit:["layers","patternFeatures"]});var pv={get paint(){return dv=dv||new Un({"line-opacity":new xt(Me.paint_line["line-opacity"]),"line-color":new xt(Me.paint_line["line-color"]),"line-translate":new mt(Me.paint_line["line-translate"]),"line-translate-anchor":new mt(Me.paint_line["line-translate-anchor"]),"line-width":new xt(Me.paint_line["line-width"]),"line-gap-width":new xt(Me.paint_line["line-gap-width"]),"line-offset":new xt(Me.paint_line["line-offset"]),"line-blur":new xt(Me.paint_line["line-blur"]),"line-dasharray":new Iu(Me.paint_line["line-dasharray"]),"line-pattern":new Va(Me.paint_line["line-pattern"]),"line-gradient":new Mu(Me.paint_line["line-gradient"])})},get layout(){return hv=hv||new Un({"line-cap":new mt(Me.layout_line["line-cap"]),"line-join":new xt(Me.layout_line["line-join"]),"line-miter-limit":new mt(Me.layout_line["line-miter-limit"]),"line-round-limit":new mt(Me.layout_line["line-round-limit"]),"line-sort-key":new xt(Me.layout_line["line-sort-key"])})}};class QC extends xt{possiblyEvaluate(n,o){return o=new vn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,u,p){return o=ke({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,u,p)}}let hp;class eP extends Pr{constructor(n){super(n,pv),this.gradientVersion=0,hp||(hp=new QC(pv.paint.properties["line-width"].specification),hp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof $s,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,o){super.recalculate(n,o),this.paint._values["line-floorwidth"]=hp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new pg(n)}queryRadius(n){const o=n,u=fv(ju("line-width",this,o),ju("line-gap-width",this,o)),p=ju("line-offset",this,o);return u/2+Math.abs(p)+rp(this.paint.get("line-translate"))}queryIntersectsFeature(n,o,u,p,y,x,w){const T=sp(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,w),P=w/2*fv(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),I=this.paint.get("line-offset").evaluate(o,u);return I&&(p=function(D,j){const $=[];for(let U=0;U<D.length;U++){const K=D[U],te=[];for(let le=0;le<K.length;le++){const _e=K[le-1],de=K[le],be=K[le+1],Ce=le===0?new F(0,0):de.sub(_e)._unit()._perp(),De=le===K.length-1?new F(0,0):be.sub(de)._unit()._perp(),nt=Ce._add(De)._unit(),dt=nt.x*De.x+nt.y*De.y;dt!==0&&nt._mult(1/dt),te.push(nt._mult(j)._add(de))}$.push(te)}return $}(p,I*w)),function(D,j,$){for(let U=0;U<j.length;U++){const K=j[U];if(D.length>=3){for(let te=0;te<K.length;te++)if(Kl(D,K[te]))return!0}if(oC(D,K,$))return!0}return!1}(T,p,P)}isTileClipped(){return!0}}function fv(r,n){return n>0?n+2*r:r}const tP=An([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nP=An([{name:"a_projected_pos",components:3,type:"Float32"}],4);An([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const iP=An([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);An([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const mv=An([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),rP=An([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function sP(r,n,o){return r.sections.forEach(u=>{u.text=function(p,y,x){const w=y.layout.get("text-transform").evaluate(x,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),ur.applyArabicShaping&&(p=ur.applyArabicShaping(p)),p}(u.text,n,o)}),r}An([{name:"triangle",components:3,type:"Uint16"}]),An([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),An([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),An([{type:"Float32",name:"offsetX"}]),An([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),An([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Hu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ri=24,gv=fn,yv=function(r,n,o,u,p){var y,x,w=8*p-u-1,T=(1<<w)-1,P=T>>1,I=-7,D=o?p-1:0,j=o?-1:1,$=r[n+D];for(D+=j,y=$&(1<<-I)-1,$>>=-I,I+=w;I>0;y=256*y+r[n+D],D+=j,I-=8);for(x=y&(1<<-I)-1,y>>=-I,I+=u;I>0;x=256*x+r[n+D],D+=j,I-=8);if(y===0)y=1-P;else{if(y===T)return x?NaN:1/0*($?-1:1);x+=Math.pow(2,u),y-=P}return($?-1:1)*x*Math.pow(2,y-u)},_v=function(r,n,o,u,p,y){var x,w,T,P=8*y-p-1,I=(1<<P)-1,D=I>>1,j=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=u?0:y-1,U=u?1:-1,K=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,x=I):(x=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-x))<1&&(x--,T*=2),(n+=x+D>=1?j/T:j*Math.pow(2,1-D))*T>=2&&(x++,T/=2),x+D>=I?(w=0,x=I):x+D>=1?(w=(n*T-1)*Math.pow(2,p),x+=D):(w=n*Math.pow(2,D-1)*Math.pow(2,p),x=0));p>=8;r[o+$]=255&w,$+=U,w/=256,p-=8);for(x=x<<p|w,P+=p;P>0;r[o+$]=255&x,$+=U,x/=256,P-=8);r[o+$-U]|=128*K};function fn(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}fn.Varint=0,fn.Fixed64=1,fn.Bytes=2,fn.Fixed32=5;var fg=4294967296,xv=1/fg,vv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xo(r){return r.type===fn.Bytes?r.readVarint()+r.pos:r.pos+1}function Ql(r,n,o){return o?4294967296*n+(r>>>0):4294967296*(n>>>0)+(r>>>0)}function wv(r,n,o){var u=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(u);for(var p=o.pos-1;p>=r;p--)o.buf[p+u]=o.buf[p]}function oP(r,n){for(var o=0;o<r.length;o++)n.writeVarint(r[o])}function aP(r,n){for(var o=0;o<r.length;o++)n.writeSVarint(r[o])}function lP(r,n){for(var o=0;o<r.length;o++)n.writeFloat(r[o])}function cP(r,n){for(var o=0;o<r.length;o++)n.writeDouble(r[o])}function uP(r,n){for(var o=0;o<r.length;o++)n.writeBoolean(r[o])}function hP(r,n){for(var o=0;o<r.length;o++)n.writeFixed32(r[o])}function dP(r,n){for(var o=0;o<r.length;o++)n.writeSFixed32(r[o])}function pP(r,n){for(var o=0;o<r.length;o++)n.writeFixed64(r[o])}function fP(r,n){for(var o=0;o<r.length;o++)n.writeSFixed64(r[o])}function dp(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+16777216*r[n+3]}function ec(r,n,o){r[o]=n,r[o+1]=n>>>8,r[o+2]=n>>>16,r[o+3]=n>>>24}function bv(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+(r[n+3]<<24)}fn.prototype={destroy:function(){this.buf=null},readFields:function(r,n,o){for(o=o||this.length;this.pos<o;){var u=this.readVarint(),p=u>>3,y=this.pos;this.type=7&u,r(p,n,this),this.pos===y&&this.skip(u)}return n},readMessage:function(r,n){return this.readFields(r,n,this.readVarint()+this.pos)},readFixed32:function(){var r=dp(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=bv(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=dp(this.buf,this.pos)+dp(this.buf,this.pos+4)*fg;return this.pos+=8,r},readSFixed64:function(){var r=dp(this.buf,this.pos)+bv(this.buf,this.pos+4)*fg;return this.pos+=8,r},readFloat:function(){var r=yv(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=yv(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var n,o,u=this.buf;return n=127&(o=u[this.pos++]),o<128?n:(n|=(127&(o=u[this.pos++]))<<7,o<128?n:(n|=(127&(o=u[this.pos++]))<<14,o<128?n:(n|=(127&(o=u[this.pos++]))<<21,o<128?n:function(p,y,x){var w,T,P=x.buf;if(w=(112&(T=P[x.pos++]))>>4,T<128||(w|=(127&(T=P[x.pos++]))<<3,T<128)||(w|=(127&(T=P[x.pos++]))<<10,T<128)||(w|=(127&(T=P[x.pos++]))<<17,T<128)||(w|=(127&(T=P[x.pos++]))<<24,T<128)||(w|=(1&(T=P[x.pos++]))<<31,T<128))return Ql(p,w,y);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(o=u[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,n=this.pos;return this.pos=r,r-n>=12&&vv?function(o,u,p){return vv.decode(o.subarray(u,p))}(this.buf,n,r):function(o,u,p){for(var y="",x=u;x<p;){var w,T,P,I=o[x],D=null,j=I>239?4:I>223?3:I>191?2:1;if(x+j>p)break;j===1?I<128&&(D=I):j===2?(192&(w=o[x+1]))==128&&(D=(31&I)<<6|63&w)<=127&&(D=null):j===3?(T=o[x+2],(192&(w=o[x+1]))==128&&(192&T)==128&&((D=(15&I)<<12|(63&w)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):j===4&&(T=o[x+2],P=o[x+3],(192&(w=o[x+1]))==128&&(192&T)==128&&(192&P)==128&&((D=(15&I)<<18|(63&w)<<12|(63&T)<<6|63&P)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,j=1):D>65535&&(D-=65536,y+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),y+=String.fromCharCode(D),x+=j}return y}(this.buf,n,r)},readBytes:function(){var r=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,r);return this.pos=r,n},readPackedVarint:function(r,n){if(this.type!==fn.Bytes)return r.push(this.readVarint(n));var o=xo(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(n));return r},readPackedSVarint:function(r){if(this.type!==fn.Bytes)return r.push(this.readSVarint());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==fn.Bytes)return r.push(this.readBoolean());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==fn.Bytes)return r.push(this.readFloat());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==fn.Bytes)return r.push(this.readDouble());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==fn.Bytes)return r.push(this.readFixed32());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==fn.Bytes)return r.push(this.readSFixed32());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==fn.Bytes)return r.push(this.readFixed64());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==fn.Bytes)return r.push(this.readSFixed64());var n=xo(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed64());return r},skip:function(r){var n=7&r;if(n===fn.Varint)for(;this.buf[this.pos++]>127;);else if(n===fn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===fn.Fixed32)this.pos+=4;else{if(n!==fn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(r,n){this.writeVarint(r<<3|n)},realloc:function(r){for(var n=this.length||16;n<this.pos+r;)n*=2;if(n!==this.length){var o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),ec(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),ec(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),ec(this.buf,-1&r,this.pos),ec(this.buf,Math.floor(r*xv),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),ec(this.buf,-1&r,this.pos),ec(this.buf,Math.floor(r*xv),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(n,o){var u,p;if(n>=0?(u=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(u=~(-n%4294967296))?u=u+1|0:(u=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,x,w){w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,w.buf[w.pos]=127&(y>>>=7)}(u,0,o),function(y,x){var w=(7&y)<<4;x.buf[x.pos++]|=w|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(p,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var n=this.pos;this.pos=function(u,p,y){for(var x,w,T=0;T<p.length;T++){if((x=p.charCodeAt(T))>55295&&x<57344){if(!w){x>56319||T+1===p.length?(u[y++]=239,u[y++]=191,u[y++]=189):w=x;continue}if(x<56320){u[y++]=239,u[y++]=191,u[y++]=189,w=x;continue}x=w-55296<<10|x-56320|65536,w=null}else w&&(u[y++]=239,u[y++]=191,u[y++]=189,w=null);x<128?u[y++]=x:(x<2048?u[y++]=x>>6|192:(x<65536?u[y++]=x>>12|224:(u[y++]=x>>18|240,u[y++]=x>>12&63|128),u[y++]=x>>6&63|128),u[y++]=63&x|128)}return y}(this.buf,r,this.pos);var o=this.pos-n;o>=128&&wv(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),_v(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),_v(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var n=r.length;this.writeVarint(n),this.realloc(n);for(var o=0;o<n;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,n){this.pos++;var o=this.pos;r(n,this);var u=this.pos-o;u>=128&&wv(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeMessage:function(r,n,o){this.writeTag(r,fn.Bytes),this.writeRawMessage(n,o)},writePackedVarint:function(r,n){n.length&&this.writeMessage(r,oP,n)},writePackedSVarint:function(r,n){n.length&&this.writeMessage(r,aP,n)},writePackedBoolean:function(r,n){n.length&&this.writeMessage(r,uP,n)},writePackedFloat:function(r,n){n.length&&this.writeMessage(r,lP,n)},writePackedDouble:function(r,n){n.length&&this.writeMessage(r,cP,n)},writePackedFixed32:function(r,n){n.length&&this.writeMessage(r,hP,n)},writePackedSFixed32:function(r,n){n.length&&this.writeMessage(r,dP,n)},writePackedFixed64:function(r,n){n.length&&this.writeMessage(r,pP,n)},writePackedSFixed64:function(r,n){n.length&&this.writeMessage(r,fP,n)},writeBytesField:function(r,n){this.writeTag(r,fn.Bytes),this.writeBytes(n)},writeFixed32Field:function(r,n){this.writeTag(r,fn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(r,n){this.writeTag(r,fn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(r,n){this.writeTag(r,fn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(r,n){this.writeTag(r,fn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(r,n){this.writeTag(r,fn.Varint),this.writeVarint(n)},writeSVarintField:function(r,n){this.writeTag(r,fn.Varint),this.writeSVarint(n)},writeStringField:function(r,n){this.writeTag(r,fn.Bytes),this.writeString(n)},writeFloatField:function(r,n){this.writeTag(r,fn.Fixed32),this.writeFloat(n)},writeDoubleField:function(r,n){this.writeTag(r,fn.Fixed64),this.writeDouble(n)},writeBooleanField:function(r,n){this.writeVarintField(r,!!n)}};var mg=k(gv);const gg=3;function mP(r,n,o){r===1&&o.readMessage(gP,n)}function gP(r,n,o){if(r===3){const{id:u,bitmap:p,width:y,height:x,left:w,top:T,advance:P}=o.readMessage(yP,{});n.push({id:u,bitmap:new Vu({width:y+2*gg,height:x+2*gg},p),metrics:{width:y,height:x,left:w,top:T,advance:P}})}}function yP(r,n,o){r===1?n.id=o.readVarint():r===2?n.bitmap=o.readBytes():r===3?n.width=o.readVarint():r===4?n.height=o.readVarint():r===5?n.left=o.readSVarint():r===6?n.top=o.readSVarint():r===7&&(n.advance=o.readVarint())}const Sv=gg;function Tv(r){let n=0,o=0;for(const x of r)n+=x.w*x.h,o=Math.max(o,x.w);r.sort((x,w)=>w.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let p=0,y=0;for(const x of r)for(let w=u.length-1;w>=0;w--){const T=u[w];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,y=Math.max(y,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===T.w&&x.h===T.h){const P=u.pop();w<u.length&&(u[w]=P)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(u.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:p,h:y,fill:n/(p*y)||0}}const dr=1;class yg{constructor(n,{pixelRatio:o,version:u,stretchX:p,stretchY:y,content:x}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=p,this.stretchY=y,this.content=x,this.version=u}get tl(){return[this.paddedRect.x+dr,this.paddedRect.y+dr]}get br(){return[this.paddedRect.x+this.paddedRect.w-dr,this.paddedRect.y+this.paddedRect.h-dr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*dr)/this.pixelRatio,(this.paddedRect.h-2*dr)/this.pixelRatio]}}class kv{constructor(n,o){const u={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,u,y),this.addImages(o,p,y);const{w:x,h:w}=Tv(y),T=new jr({width:x||1,height:w||1});for(const P in n){const I=n[P],D=u[P].paddedRect;jr.copy(I.data,T,{x:0,y:0},{x:D.x+dr,y:D.y+dr},I.data)}for(const P in o){const I=o[P],D=p[P].paddedRect,j=D.x+dr,$=D.y+dr,U=I.data.width,K=I.data.height;jr.copy(I.data,T,{x:0,y:0},{x:j,y:$},I.data),jr.copy(I.data,T,{x:0,y:K-1},{x:j,y:$-1},{width:U,height:1}),jr.copy(I.data,T,{x:0,y:0},{x:j,y:$+K},{width:U,height:1}),jr.copy(I.data,T,{x:U-1,y:0},{x:j-1,y:$},{width:1,height:K}),jr.copy(I.data,T,{x:0,y:0},{x:j+U,y:$},{width:1,height:K})}this.image=T,this.iconPositions=u,this.patternPositions=p}addImages(n,o,u){for(const p in n){const y=n[p],x={x:0,y:0,w:y.data.width+2*dr,h:y.data.height+2*dr};u.push(x),o[p]=new yg(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in n.updatedImages)this.patchUpdatedImage(this.iconPositions[u],n.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],n.getImage(u),o)}patchUpdatedImage(n,o,u){if(!n||!o||n.version===o.version)return;n.version=o.version;const[p,y]=n.tl;u.update(o.data,void 0,{x:p,y})}}var Jo;st("ImagePosition",yg),st("ImageAtlas",kv),c.ai=void 0,(Jo=c.ai||(c.ai={}))[Jo.none=0]="none",Jo[Jo.horizontal=1]="horizontal",Jo[Jo.vertical=2]="vertical",Jo[Jo.horizontalOnly=3]="horizontalOnly";const Ku=-17;class Xu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,o){const u=new Xu;return u.scale=n||1,u.fontStack=o,u}static forImage(n){const o=new Xu;return o.imageName=n,o}}class tc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const u=new tc;for(let p=0;p<n.sections.length;p++){const y=n.sections[p];y.image?u.addImageSection(y):u.addTextSection(y,o)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let o="";for(let u=0;u<n.length;u++){const p=n.charCodeAt(u+1)||null,y=n.charCodeAt(u-1)||null;o+=p&&Wd(p)&&!Hu[n[u+1]]||y&&Wd(y)&&!Hu[n[u-1]]||!Hu[n[u]]?n[u]:Hu[n[u]]}return o}(this.text)}trim(){let n=0;for(let u=0;u<this.text.length&&fp[this.text.charCodeAt(u)];u++)n++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&fp[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const u=new tc;return u.text=this.text.substring(n,o),u.sectionIndex=this.sectionIndex.slice(n,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(Xu.forText(n.scale,n.fontStack||o));const u=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(u)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void Ut("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Xu.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Ut("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function pp(r,n,o,u,p,y,x,w,T,P,I,D,j,$,U,K){const te=tc.fromFeature(r,p);let le;D===c.ai.vertical&&te.verticalizePunctuation();const{processBidirectionalText:_e,processStyledBidirectionalText:de}=ur;if(_e&&te.sections.length===1){le=[];const De=_e(te.toString(),_g(te,P,y,n,u,$,U));for(const nt of De){const dt=new tc;dt.text=nt,dt.sections=te.sections;for(let et=0;et<nt.length;et++)dt.sectionIndex.push(0);le.push(dt)}}else if(de){le=[];const De=de(te.text,te.sectionIndex,_g(te,P,y,n,u,$,U));for(const nt of De){const dt=new tc;dt.text=nt[0],dt.sectionIndex=nt[1],dt.sections=te.sections,le.push(dt)}}else le=function(De,nt){const dt=[],et=De.text;let Je=0;for(const We of nt)dt.push(De.substring(Je,We)),Je=We;return Je<et.length&&dt.push(De.substring(Je,et.length)),dt}(te,_g(te,P,y,n,u,$,U));const be=[],Ce={positionedLines:be,text:te.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(De,nt,dt,et,Je,We,ot,Xe,je,yt,ft,Bt){let bn=0,kn=Ku,si=0,Ir=0;const Wi=Xe==="right"?1:Xe==="left"?0:.5;let Jn=0;for(const oi of Je){oi.trim();const ai=oi.getMaxScale(),Ri=(ai-1)*ri,Xi={positionedGlyphs:[],lineOffset:0};De.positionedLines[Jn]=Xi;const Fi=Xi.positionedGlyphs;let pr=0;if(!oi.length()){kn+=We,++Jn;continue}for(let li=0;li<oi.length();li++){const Kt=oi.getSection(li),Bi=oi.getSectionIndex(li),Ii=oi.getCharCode(li);let ci=0,ss=null,Ts=null,ks=null,vo=ri;const os=!(je===c.ai.horizontal||!ft&&!bu(Ii)||ft&&(fp[Ii]||(bi=Ii,tt.Arabic(bi)||tt["Arabic Supplement"](bi)||tt["Arabic Extended-A"](bi)||tt["Arabic Presentation Forms-A"](bi)||tt["Arabic Presentation Forms-B"](bi))));if(Kt.imageName){const Vr=et[Kt.imageName];if(!Vr)continue;ks=Kt.imageName,De.iconsInText=De.iconsInText||!0,Ts=Vr.paddedRect;const mr=Vr.displaySize;Kt.scale=Kt.scale*ri/Bt,ss={width:mr[0],height:mr[1],left:dr,top:-Sv,advance:os?mr[1]:mr[0]},ci=Ri+(ri-mr[1]*Kt.scale),vo=ss.advance;const wo=os?mr[0]*Kt.scale-ri*ai:mr[1]*Kt.scale-ri*ai;wo>0&&wo>pr&&(pr=wo)}else{const Vr=dt[Kt.fontStack],mr=Vr&&Vr[Ii];if(mr&&mr.rect)Ts=mr.rect,ss=mr.metrics;else{const wo=nt[Kt.fontStack],th=wo&&wo[Ii];if(!th)continue;ss=th.metrics}ci=(ai-Kt.scale)*ri}os?(De.verticalizable=!0,Fi.push({glyph:Ii,imageName:ks,x:bn,y:kn+ci,vertical:os,scale:Kt.scale,fontStack:Kt.fontStack,sectionIndex:Bi,metrics:ss,rect:Ts}),bn+=vo*Kt.scale+yt):(Fi.push({glyph:Ii,imageName:ks,x:bn,y:kn+ci,vertical:os,scale:Kt.scale,fontStack:Kt.fontStack,sectionIndex:Bi,metrics:ss,rect:Ts}),bn+=ss.advance*Kt.scale+yt)}Fi.length!==0&&(si=Math.max(bn-yt,si),vP(Fi,0,Fi.length-1,Wi,pr)),bn=0;const fr=We*ai+pr;Xi.lineOffset=Math.max(pr,Ri),kn+=fr,Ir=Math.max(fr,Ir),++Jn}var bi;const Ai=kn-Ku,{horizontalAlign:Hi,verticalAlign:Ki}=xg(ot);(function(oi,ai,Ri,Xi,Fi,pr,fr,li,Kt){const Bi=(ai-Ri)*Fi;let Ii=0;Ii=pr!==fr?-li*Xi-Ku:(-Xi*Kt+.5)*fr;for(const ci of oi)for(const ss of ci.positionedGlyphs)ss.x+=Bi,ss.y+=Ii})(De.positionedLines,Wi,Hi,Ki,si,Ir,We,Ai,Je.length),De.top+=-Ki*Ai,De.bottom=De.top+Ai,De.left+=-Hi*si,De.right=De.left+si}(Ce,n,o,u,le,x,w,T,D,P,j,K),!function(De){for(const nt of De)if(nt.positionedGlyphs.length!==0)return!1;return!0}(be)&&Ce}const fp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_P={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ev(r,n,o,u,p,y){if(n.imageName){const x=u[n.imageName];return x?x.displaySize[0]*n.scale*ri/y+p:0}{const x=o[n.fontStack],w=x&&x[r];return w?w.metrics.advance*n.scale+p:0}}function Cv(r,n,o,u){const p=Math.pow(r-n,2);return u?r<n?p/2:2*p:p+Math.abs(o)*o}function xP(r,n,o){let u=0;return r===10&&(u-=1e4),o&&(u+=150),r!==40&&r!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function Pv(r,n,o,u,p,y){let x=null,w=Cv(n,o,p,y);for(const T of u){const P=Cv(n-T.x,o,p,y)+T.badness;P<=w&&(x=T,w=P)}return{index:r,x:n,priorBreak:x,badness:w}}function Av(r){return r?Av(r.priorBreak).concat(r.index):[]}function _g(r,n,o,u,p,y,x){if(y!=="point")return[];if(!r)return[];const w=[],T=function(j,$,U,K,te,le){let _e=0;for(let de=0;de<j.length();de++){const be=j.getSection(de);_e+=Ev(j.getCharCode(de),be,K,te,$,le)}return _e/Math.max(1,Math.ceil(_e/U))}(r,n,o,u,p,x),P=r.text.indexOf("")>=0;let I=0;for(let j=0;j<r.length();j++){const $=r.getSection(j),U=r.getCharCode(j);if(fp[U]||(I+=Ev(U,$,u,p,n,x)),j<r.length()-1){const K=!((D=U)<11904||!(tt["Bopomofo Extended"](D)||tt.Bopomofo(D)||tt["CJK Compatibility Forms"](D)||tt["CJK Compatibility Ideographs"](D)||tt["CJK Compatibility"](D)||tt["CJK Radicals Supplement"](D)||tt["CJK Strokes"](D)||tt["CJK Symbols and Punctuation"](D)||tt["CJK Unified Ideographs Extension A"](D)||tt["CJK Unified Ideographs"](D)||tt["Enclosed CJK Letters and Months"](D)||tt["Halfwidth and Fullwidth Forms"](D)||tt.Hiragana(D)||tt["Ideographic Description Characters"](D)||tt["Kangxi Radicals"](D)||tt["Katakana Phonetic Extensions"](D)||tt.Katakana(D)||tt["Vertical Forms"](D)||tt["Yi Radicals"](D)||tt["Yi Syllables"](D)));(_P[U]||K||$.imageName)&&w.push(Pv(j+1,I,T,w,xP(U,r.getCharCode(j+1),K&&P),!1))}}var D;return Av(Pv(r.length(),I,T,w,0,!0))}function xg(r){let n=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function vP(r,n,o,u,p){if(!u&&!p)return;const y=r[o],x=(r[o].x+y.metrics.advance*y.scale)*u;for(let w=n;w<=o;w++)r[w].x-=x,r[w].y+=p}function wP(r,n,o){const{horizontalAlign:u,verticalAlign:p}=xg(o),y=n[0]-r.displaySize[0]*u,x=n[1]-r.displaySize[1]*p;return{image:r,top:x,bottom:x+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function Iv(r,n,o,u,p,y){const x=r.image;let w;if(x.content){const te=x.content,le=x.pixelRatio||1;w=[te[0]/le,te[1]/le,x.displaySize[0]-te[2]/le,x.displaySize[1]-te[3]/le]}const T=n.left*y,P=n.right*y;let I,D,j,$;o==="width"||o==="both"?($=p[0]+T-u[3],D=p[0]+P+u[1]):($=p[0]+(T+P-x.displaySize[0])/2,D=$+x.displaySize[0]);const U=n.top*y,K=n.bottom*y;return o==="height"||o==="both"?(I=p[1]+U-u[0],j=p[1]+K+u[2]):(I=p[1]+(U+K-x.displaySize[1])/2,j=I+x.displaySize[1]),{image:x,top:I,right:D,bottom:j,left:$,collisionPadding:w}}const Yu=255,Ws=128,Qo=Yu*Ws;function Mv(r,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new vn(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=o;let y=0;for(;y<u.length&&u[y]<=r;)y++;y=Math.max(0,y-1);let x=y;for(;x<u.length&&u[x]<r+1;)x++;x=Math.min(u.length-1,x);const w=u[y],T=u[x];return o.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:T,minSize:o.evaluate(new vn(w)),maxSize:o.evaluate(new vn(T)),interpolationType:p}}}function vg(r,n,o){let u="never";const p=r.get(n);return p?u=p:r.get(o)&&(u="always"),u}const bP=Yo.VectorTileFeature.types,SP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mp(r,n,o,u,p,y,x,w,T,P,I,D,j){const $=w?Math.min(Qo,Math.round(w[0])):0,U=w?Math.min(Qo,Math.round(w[1])):0;r.emplaceBack(n,o,Math.round(32*u),Math.round(32*p),y,x,($<<1)+(T?1:0),U,16*P,16*I,256*D,256*j)}function wg(r,n,o){r.emplaceBack(n.x,n.y,o),r.emplaceBack(n.x,n.y,o),r.emplaceBack(n.x,n.y,o),r.emplaceBack(n.x,n.y,o)}function TP(r){for(const n of r.sections)if(Wm(n.text))return!0;return!1}class bg{constructor(n){this.layoutVertexArray=new Vt,this.indexArray=new vi,this.programConfigurations=n,this.segments=new wn,this.dynamicLayoutVertexArray=new Mt,this.opacityVertexArray=new Gt,this.hasVisibleVertices=!1,this.placedSymbolArray=new me}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,tP.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,nP.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,SP,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}st("SymbolBuffers",bg);class Sg{constructor(n,o,u){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new u,this.segments=new wn,this.collisionVertexArray=new _n}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,iP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}st("CollisionBuffers",Sg);class nc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=eg([]),this.placementViewportMatrix=eg([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mv(this.zoom,o["text-size"]),this.iconSizeData=Mv(this.zoom,o["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=vg(u,"text-overlap","text-allow-overlap")!=="never"||vg(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(x=>c.ai[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new bg(new Ss(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new bg(new Ss(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new ye,this.lineVertexArray=new Pe,this.symbolInstances=new ie,this.textAnchorOffsets=new ze}calculateGlyphDependencies(n,o,u,p,y){for(let x=0;x<n.length;x++)if(o[n.charCodeAt(x)]=!0,(u||p)&&y){const w=Hu[n.charAt(x)];w&&(o[w.charCodeAt(0)]=!0)}}populate(n,o,u){const p=this.layers[0],y=p.layout,x=y.get("text-font"),w=y.get("text-field"),T=y.get("icon-image"),P=(w.value.kind!=="constant"||w.value.value instanceof Ei&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),I=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,D=y.get("symbol-sort-key");if(this.features=[],!P&&!I)return;const j=o.iconDependencies,$=o.glyphDependencies,U=o.availableImages,K=new vn(this.zoom);for(const{feature:te,id:le,index:_e,sourceLayerIndex:de}of n){const be=p._featureFilter.needGeometry,Ce=Za(te,be);if(!p._featureFilter.filter(K,Ce,u))continue;let De,nt;if(be||(Ce.geometry=qa(te)),P){const et=p.getValueAndResolveTokens("text-field",Ce,u,U),Je=Ei.factory(et);TP(Je)&&(this.hasRTLText=!0),(!this.hasRTLText||Pu()==="unavailable"||this.hasRTLText&&ur.isParsed())&&(De=sP(Je,p,Ce))}if(I){const et=p.getValueAndResolveTokens("icon-image",Ce,u,U);nt=et instanceof xi?et:xi.fromString(et)}if(!De&&!nt)continue;const dt=this.sortFeaturesByKey?D.evaluate(Ce,{},u):void 0;if(this.features.push({id:le,text:De,icon:nt,index:_e,sourceLayerIndex:de,geometry:Ce.geometry,properties:te.properties,type:bP[te.type],sortKey:dt}),nt&&(j[nt.name]=!0),De){const et=x.evaluate(Ce,{},u).join(","),Je=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.ai.vertical)>=0;for(const We of De.sections)if(We.image)j[We.image.name]=!0;else{const ot=vu(De.toString()),Xe=We.fontStack||et,je=$[Xe]=$[Xe]||{};this.calculateGlyphDependencies(We.text,je,Je,this.allowVerticalPlacement,ot)}}}y.get("symbol-placement")==="line"&&(this.features=function(te){const le={},_e={},de=[];let be=0;function Ce(et){de.push(te[et]),be++}function De(et,Je,We){const ot=_e[et];return delete _e[et],_e[Je]=ot,de[ot].geometry[0].pop(),de[ot].geometry[0]=de[ot].geometry[0].concat(We[0]),ot}function nt(et,Je,We){const ot=le[Je];return delete le[Je],le[et]=ot,de[ot].geometry[0].shift(),de[ot].geometry[0]=We[0].concat(de[ot].geometry[0]),ot}function dt(et,Je,We){const ot=We?Je[0][Je[0].length-1]:Je[0][0];return`${et}:${ot.x}:${ot.y}`}for(let et=0;et<te.length;et++){const Je=te[et],We=Je.geometry,ot=Je.text?Je.text.toString():null;if(!ot){Ce(et);continue}const Xe=dt(ot,We),je=dt(ot,We,!0);if(Xe in _e&&je in le&&_e[Xe]!==le[je]){const yt=nt(Xe,je,We),ft=De(Xe,je,de[yt].geometry);delete le[Xe],delete _e[je],_e[dt(ot,de[ft].geometry,!0)]=ft,de[yt].geometry=null}else Xe in _e?De(Xe,je,We):je in le?nt(Xe,je,We):(Ce(et),le[Xe]=be-1,_e[je]=be-1)}return de.filter(et=>et.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,le)=>te.sortKey-le.sortKey)}update(n,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const u=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(o[n.segment+1]),y=n.dist(o[n.segment]);const x={};for(let w=n.segment+1;w<o.length;w++)x[w]={x:o[w].x,y:o[w].y,tileUnitDistanceFromAnchor:p},w<o.length-1&&(p+=o[w+1].dist(o[w]));for(let w=n.segment||0;w>=0;w--)x[w]={x:o[w].x,y:o[w].y,tileUnitDistanceFromAnchor:y},w>0&&(y+=o[w-1].dist(o[w]));for(let w=0;w<o.length;w++){const T=x[w];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,o,u,p,y,x,w,T,P,I,D,j){const $=n.indexArray,U=n.layoutVertexArray,K=n.segments.prepareSegment(4*o.length,U,$,this.canOverlap?x.sortKey:void 0),te=this.glyphOffsetArray.length,le=K.vertexLength,_e=this.allowVerticalPlacement&&w===c.ai.vertical?Math.PI/2:0,de=x.text&&x.text.sections;for(let be=0;be<o.length;be++){const{tl:Ce,tr:De,bl:nt,br:dt,tex:et,pixelOffsetTL:Je,pixelOffsetBR:We,minFontScaleX:ot,minFontScaleY:Xe,glyphOffset:je,isSDF:yt,sectionIndex:ft}=o[be],Bt=K.vertexLength,bn=je[1];mp(U,T.x,T.y,Ce.x,bn+Ce.y,et.x,et.y,u,yt,Je.x,Je.y,ot,Xe),mp(U,T.x,T.y,De.x,bn+De.y,et.x+et.w,et.y,u,yt,We.x,Je.y,ot,Xe),mp(U,T.x,T.y,nt.x,bn+nt.y,et.x,et.y+et.h,u,yt,Je.x,We.y,ot,Xe),mp(U,T.x,T.y,dt.x,bn+dt.y,et.x+et.w,et.y+et.h,u,yt,We.x,We.y,ot,Xe),wg(n.dynamicLayoutVertexArray,T,_e),$.emplaceBack(Bt,Bt+1,Bt+2),$.emplaceBack(Bt+1,Bt+2,Bt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(je[0]),be!==o.length-1&&ft===o[be+1].sectionIndex||n.programConfigurations.populatePaintArrays(U.length,x,x.index,{},j,de&&de[ft])}n.placedSymbolArray.emplaceBack(T.x,T.y,te,this.glyphOffsetArray.length-te,le,P,I,T.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],w,0,!1,0,D)}_addCollisionDebugVertex(n,o,u,p,y,x){return o.emplaceBack(0,0),n.emplaceBack(u.x,u.y,p,y,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,o,u,p,y,x,w){const T=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),P=T.vertexLength,I=y.layoutVertexArray,D=y.collisionVertexArray,j=w.anchorX,$=w.anchorY;this._addCollisionDebugVertex(I,D,x,j,$,new F(n,o)),this._addCollisionDebugVertex(I,D,x,j,$,new F(u,o)),this._addCollisionDebugVertex(I,D,x,j,$,new F(u,p)),this._addCollisionDebugVertex(I,D,x,j,$,new F(n,p)),T.vertexLength+=4;const U=y.indexArray;U.emplaceBack(P,P+1),U.emplaceBack(P+1,P+2),U.emplaceBack(P+2,P+3),U.emplaceBack(P+3,P),T.primitiveLength+=4}addDebugCollisionBoxes(n,o,u,p){for(let y=n;y<o;y++){const x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Sg(jn,mv.members,ni),this.iconCollisionBox=new Sg(jn,mv.members,ni);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,u,p,y,x,w,T,P){const I={};for(let D=o;D<u;D++){const j=n.get(D);I.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.textFeatureIndex=j.featureIndex;break}for(let D=p;D<y;D++){const j=n.get(D);I.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.verticalTextFeatureIndex=j.featureIndex;break}for(let D=x;D<w;D++){const j=n.get(D);I.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.iconFeatureIndex=j.featureIndex;break}for(let D=T;D<P;D++){const j=n.get(D);I.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},I.verticalIconFeatureIndex=j.featureIndex;break}return I}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const u=n.placedSymbolArray.get(o),p=u.vertexStartIndex+4*u.numGlyphs;for(let y=u.vertexStartIndex;y<p;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),u=Math.cos(n),p=[],y=[],x=[];for(let w=0;w<this.symbolInstances.length;++w){x.push(w);const T=this.symbolInstances.get(w);p.push(0|Math.round(o*T.anchorX+u*T.anchorY)),y.push(T.featureIndex)}return x.sort((w,T)=>p[w]-p[T]||y[T]-y[w]),x}addToSortKeyRanges(n,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((p,y,x)=>{p>=0&&x.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Lv,zv;st("SymbolBucket",nc,{omit:["layers","collisionBoxArray","features","compareText"]}),nc.MAX_GLYPHS=65535,nc.addDynamicAttributes=wg;var Tg={get paint(){return zv=zv||new Un({"icon-opacity":new xt(Me.paint_symbol["icon-opacity"]),"icon-color":new xt(Me.paint_symbol["icon-color"]),"icon-halo-color":new xt(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new xt(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xt(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new mt(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new mt(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new xt(Me.paint_symbol["text-opacity"]),"text-color":new xt(Me.paint_symbol["text-color"],{runtimeType:Nn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new xt(Me.paint_symbol["text-halo-color"]),"text-halo-width":new xt(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new xt(Me.paint_symbol["text-halo-blur"]),"text-translate":new mt(Me.paint_symbol["text-translate"]),"text-translate-anchor":new mt(Me.paint_symbol["text-translate-anchor"])})},get layout(){return Lv=Lv||new Un({"symbol-placement":new mt(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new mt(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mt(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xt(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mt(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mt(Me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new mt(Me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new mt(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new mt(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mt(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new xt(Me.layout_symbol["icon-size"]),"icon-text-fit":new mt(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mt(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new xt(Me.layout_symbol["icon-image"]),"icon-rotate":new xt(Me.layout_symbol["icon-rotate"]),"icon-padding":new xt(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new mt(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new xt(Me.layout_symbol["icon-offset"]),"icon-anchor":new xt(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mt(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mt(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mt(Me.layout_symbol["text-rotation-alignment"]),"text-field":new xt(Me.layout_symbol["text-field"]),"text-font":new xt(Me.layout_symbol["text-font"]),"text-size":new xt(Me.layout_symbol["text-size"]),"text-max-width":new xt(Me.layout_symbol["text-max-width"]),"text-line-height":new mt(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new xt(Me.layout_symbol["text-letter-spacing"]),"text-justify":new xt(Me.layout_symbol["text-justify"]),"text-radial-offset":new xt(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mt(Me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new xt(Me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new xt(Me.layout_symbol["text-anchor"]),"text-max-angle":new mt(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new mt(Me.layout_symbol["text-writing-mode"]),"text-rotate":new xt(Me.layout_symbol["text-rotate"]),"text-padding":new mt(Me.layout_symbol["text-padding"]),"text-keep-upright":new mt(Me.layout_symbol["text-keep-upright"]),"text-transform":new xt(Me.layout_symbol["text-transform"]),"text-offset":new xt(Me.layout_symbol["text-offset"]),"text-allow-overlap":new mt(Me.layout_symbol["text-allow-overlap"]),"text-overlap":new mt(Me.layout_symbol["text-overlap"]),"text-ignore-placement":new mt(Me.layout_symbol["text-ignore-placement"]),"text-optional":new mt(Me.layout_symbol["text-optional"])})}};class Dv{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Jr,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}st("FormatSectionOverride",Dv,{omit:["defaultValue"]});class gp extends Pr{constructor(n){super(n,Tg)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const y of u)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,u,p){const y=this.layout.get(n).evaluate(o,{},u,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||Fl(x.value)||!y?y:function(w,T){return T.replace(/{([^{}]+)}/g,(P,I)=>w&&I in w?String(w[I]):"")}(o.properties,y)}createBucket(n){return new nc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Tg.paint.overridableProperties){if(!gp.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),u=new Dv(o),p=new fu(u,o.property.specification);let y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new mu("source",p):new Nl("composite",p,o.value.zoomStops),this.paint._values[n]=new zi(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&gp.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const u=n.get("text-field"),p=Tg.paint.properties[o];let y=!1;const x=w=>{for(const T of w)if(p.overrides&&p.overrides.hasOverride(T))return void(y=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Ei)x(u.value.value.sections);else if(u.value.kind==="source"){const w=P=>{y||(P instanceof oo&&En(P.value)===J?x(P.value.sections):P instanceof Rl?x(P.sections):P.eachChild(w))},T=u.value;T._styleExpression&&w(T._styleExpression.expression)}return y}}let Rv;var kP={get paint(){return Rv=Rv||new Un({"background-color":new mt(Me.paint_background["background-color"]),"background-pattern":new Iu(Me.paint_background["background-pattern"]),"background-opacity":new mt(Me.paint_background["background-opacity"])})}};class EP extends Pr{constructor(n){super(n,kP)}}let Fv;var CP={get paint(){return Fv=Fv||new Un({"raster-opacity":new mt(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new mt(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mt(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mt(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new mt(Me.paint_raster["raster-saturation"]),"raster-contrast":new mt(Me.paint_raster["raster-contrast"]),"raster-resampling":new mt(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new mt(Me.paint_raster["raster-fade-duration"])})}};class PP extends Pr{constructor(n){super(n,CP)}}class AP extends Pr{constructor(n){super(n,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class IP{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const kg=63710088e-1;class ea{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ea(Ie(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,u=this.lat*o,p=n.lat*o,y=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((n.lng-this.lng)*o);return kg*Math.acos(Math.min(y,1))}static convert(n){if(n instanceof ea)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new ea(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new ea(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bv=2*Math.PI*kg;function Nv(r){return Bv*Math.cos(r*Math.PI/180)}function jv(r){return(180+r)/360}function Ov(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Vv(r,n){return r/Nv(n)}function $v(r){return 360*r-180}function Eg(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class yp{constructor(n,o,u=0){this.x=+n,this.y=+o,this.z=+u}static fromLngLat(n,o=0){const u=ea.convert(n);return new yp(jv(u.lng),Ov(u.lat),Vv(o,u.lat))}toLngLat(){return new ea($v(this.x),Eg(this.y))}toAltitude(){return this.z*Nv(Eg(this.y))}meterInMercatorCoordinateUnits(){return 1/Bv*(n=Eg(this.y),1/Math.cos(n*Math.PI/180));var n}}function Uv(r,n,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[r*u-2*Math.PI*6378137/2,n*u-2*Math.PI*6378137/2]}class Cg{constructor(n,o,u){if(n<0||n>25||u<0||u>=Math.pow(2,n)||o<0||o>=Math.pow(2,n))throw new Error(`x=${o}, y=${u}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=u,this.key=Ju(0,n,n,o,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,u){const p=(x=this.y,w=this.z,T=Uv(256*(y=this.x),256*(x=Math.pow(2,w)-x-1),w),P=Uv(256*(y+1),256*(x+1),w),T[0]+","+T[1]+","+P[0]+","+P[1]);var y,x,w,T,P;const I=function(D,j,$){let U,K="";for(let te=D;te>0;te--)U=1<<te-1,K+=(j&U?1:0)+($&U?2:0);return K}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new F((n.x*o-this.x)*Yn,(n.y*o-this.y)*Yn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qv{constructor(n,o){this.wrap=n,this.canonical=o,this.key=Ju(n,o.z,o.z,o.x,o.y)}}class Or{constructor(n,o,u,p,y){if(n<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${u}`);this.overscaledZ=n,this.wrap=o,this.canonical=new Cg(u,+p,+y),this.key=Ju(o,n,u,p,y)}clone(){return new Or(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new Or(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Or(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-n;return n>this.canonical.z?Ju(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):Ju(this.wrap*+o,n,n,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new Or(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Or(o,this.wrap,o,u,p),new Or(o,this.wrap,o,u+1,p),new Or(o,this.wrap,o,u,p+1),new Or(o,this.wrap,o,u+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Or(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Or(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new yp(n.x-this.wrap,n.y))}}function Ju(r,n,o,u,p){(r*=2)<0&&(r=-1*r-1);const y=1<<o;return(y*y*r+y*p+u).toString(36)+o.toString(36)+n.toString(36)}st("CanonicalTileID",Cg),st("OverscaledTileID",Or,{omit:["posMatrix"]});class Zv{constructor(n,o,u,p=1,y=1,x=1,w=0){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Ut(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const T=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=y,this.blueFactor=x,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<T;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(T,P)]=this.data[this._idx(T-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,T)]=this.data[this._idx(P,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<T;P++)for(let I=0;I<T;I++){const D=this.get(P,I);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(n,o){const u=new Uint8Array(this.data.buffer),p=4*this._idx(n,o);return this.unpack(u[p],u[p+1],u[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}unpack(n,o,u){return n*this.redFactor+o*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new jr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,y=o*this.dim+this.dim,x=u*this.dim,w=u*this.dim+this.dim;switch(o){case-1:p=y-1;break;case 1:y=p+1}switch(u){case-1:x=w-1;break;case 1:w=x+1}const T=-o*this.dim,P=-u*this.dim;for(let I=x;I<w;I++)for(let D=p;D<y;D++)this.data[this._idx(D,I)]=n.data[this._idx(D+T,I+P)]}}st("DEMData",Zv);class Gv{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const u=n[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Wv{constructor(n,o,u,p,y){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=u,n._y=p,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class Hv{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Go(Yn,16,0),this.grid3D=new Go(Yn,16,0),this.featureIndexArray=new Fe,this.promoteId=o}insert(n,o,u,p,y,x){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,y);const T=x?this.grid3D:this.grid;for(let P=0;P<o.length;P++){const I=o[P],D=[1/0,1/0,-1/0,-1/0];for(let j=0;j<I.length;j++){const $=I[j];D[0]=Math.min(D[0],$.x),D[1]=Math.min(D[1],$.y),D[2]=Math.max(D[2],$.x),D[3]=Math.max(D[3],$.y)}D[0]<Yn&&D[1]<Yn&&D[2]>=0&&D[3]>=0&&T.insert(w,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Yo.VectorTile(new mg(this.rawTileData)).layers,this.sourceLayerCoder=new Gv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,u,p){this.loadVTLayers();const y=n.params||{},x=Yn/n.tileSize/n.scale,w=yu(y.filter),T=n.queryGeometry,P=n.queryPadding*x,I=Xv(T),D=this.grid.query(I.minX-P,I.minY-P,I.maxX+P,I.maxY+P),j=Xv(n.cameraQueryGeometry),$=this.grid3D.query(j.minX-P,j.minY-P,j.maxX+P,j.maxY+P,(te,le,_e,de)=>function(be,Ce,De,nt,dt){for(const Je of be)if(Ce<=Je.x&&De<=Je.y&&nt>=Je.x&&dt>=Je.y)return!0;const et=[new F(Ce,De),new F(Ce,dt),new F(nt,dt),new F(nt,De)];if(be.length>2){for(const Je of et)if(Kl(be,Je))return!0}for(let Je=0;Je<be.length-1;Je++)if(lC(be[Je],be[Je+1],et))return!0;return!1}(n.cameraQueryGeometry,te-P,le-P,_e+P,de+P));for(const te of $)D.push(te);D.sort(MP);const U={};let K;for(let te=0;te<D.length;te++){const le=D[te];if(le===K)continue;K=le;const _e=this.featureIndexArray.get(le);let de=null;this.loadMatchingFeature(U,_e.bucketIndex,_e.sourceLayerIndex,_e.featureIndex,w,y.layers,y.availableImages,o,u,p,(be,Ce,De)=>(de||(de=qa(be)),Ce.queryIntersectsFeature(T,be,De,de,this.z,n.transform,x,n.pixelPosMatrix)))}return U}loadMatchingFeature(n,o,u,p,y,x,w,T,P,I,D){const j=this.bucketLayerIDs[o];if(x&&!function(te,le){for(let _e=0;_e<te.length;_e++)if(le.indexOf(te[_e])>=0)return!0;return!1}(x,j))return;const $=this.sourceLayerCoder.decode(u),U=this.vtLayers[$].feature(p);if(y.needGeometry){const te=Za(U,!0);if(!y.filter(new vn(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!y.filter(new vn(this.tileID.overscaledZ),U))return;const K=this.getId(U,$);for(let te=0;te<j.length;te++){const le=j[te];if(x&&x.indexOf(le)<0)continue;const _e=T[le];if(!_e)continue;let de={};K&&I&&(de=I.getState(_e.sourceLayer||"_geojsonTileLayer",K));const be=ke({},P[le]);be.paint=Kv(be.paint,_e.paint,U,de,w),be.layout=Kv(be.layout,_e.layout,U,de,w);const Ce=!D||D(U,_e,de);if(!Ce)continue;const De=new Wv(U,this.z,this.x,this.y,K);De.layer=be;let nt=n[le];nt===void 0&&(nt=n[le]=[]),nt.push({featureIndex:p,feature:De,intersectionZ:Ce})}}lookupSymbolFeatures(n,o,u,p,y,x,w,T){const P={};this.loadVTLayers();const I=yu(y);for(const D of n)this.loadMatchingFeature(P,u,p,D,I,x,w,T,o);return P}hasLayer(n){for(const o of this.bucketLayerIDs)for(const u of o)if(n===u)return!0;return!1}getId(n,o){let u=n.id;return this.promoteId&&(u=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof u=="boolean"&&(u=Number(u))),u}}function Kv(r,n,o,u,p){return Oe(r,(y,x)=>{const w=n instanceof Wl?n.get(x):null;return w&&w.evaluate?w.evaluate(o,u,p):w})}function Xv(r){let n=1/0,o=1/0,u=-1/0,p=-1/0;for(const y of r)n=Math.min(n,y.x),o=Math.min(o,y.y),u=Math.max(u,y.x),p=Math.max(p,y.y);return{minX:n,minY:o,maxX:u,maxY:p}}function MP(r,n){return n-r}function Yv(r,n,o,u,p){const y=[];for(let x=0;x<r.length;x++){const w=r[x];let T;for(let P=0;P<w.length-1;P++){let I=w[P],D=w[P+1];I.x<n&&D.x<n||(I.x<n?I=new F(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x<n&&(D=new F(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y<o&&D.y<o||(I.y<o?I=new F(I.x+(o-I.y)/(D.y-I.y)*(D.x-I.x),o)._round():D.y<o&&(D=new F(I.x+(o-I.y)/(D.y-I.y)*(D.x-I.x),o)._round()),I.x>=u&&D.x>=u||(I.x>=u?I=new F(u,I.y+(u-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x>=u&&(D=new F(u,I.y+(u-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y>=p&&D.y>=p||(I.y>=p?I=new F(I.x+(p-I.y)/(D.y-I.y)*(D.x-I.x),p)._round():D.y>=p&&(D=new F(I.x+(p-I.y)/(D.y-I.y)*(D.x-I.x),p)._round()),T&&I.equals(T[T.length-1])||(T=[I],y.push(T)),T.push(D)))))}}return y}st("FeatureIndex",Hv,{omit:["rawTileData","sourceLayerCoder"]});class ta extends F{constructor(n,o,u,p){super(n,o),this.angle=u,p!==void 0&&(this.segment=p)}clone(){return new ta(this.x,this.y,this.angle,this.segment)}}function Jv(r,n,o,u,p){if(n.segment===void 0||o===0)return!0;let y=n,x=n.segment+1,w=0;for(;w>-o/2;){if(x--,x<0)return!1;w-=r[x].dist(y),y=r[x]}w+=r[x].dist(r[x+1]),x++;const T=[];let P=0;for(;w<o/2;){const I=r[x],D=r[x+1];if(!D)return!1;let j=r[x-1].angleTo(I)-I.angleTo(D);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:j}),P+=j;w-T[0].distance>u;)P-=T.shift().angleDelta;if(P>p)return!1;x++,w+=I.dist(D)}return!0}function Qv(r){let n=0;for(let o=0;o<r.length-1;o++)n+=r[o].dist(r[o+1]);return n}function e1(r,n,o){return r?.6*n*o:0}function t1(r,n){return Math.max(r?r.right-r.left:0,n?n.right-n.left:0)}function LP(r,n,o,u,p,y){const x=e1(o,p,y),w=t1(o,u)*y;let T=0;const P=Qv(r)/2;for(let I=0;I<r.length-1;I++){const D=r[I],j=r[I+1],$=D.dist(j);if(T+$>P){const U=(P-T)/$,K=ar.number(D.x,j.x,U),te=ar.number(D.y,j.y,U),le=new ta(K,te,j.angleTo(D),I);return le._round(),!x||Jv(r,le,w,x,n)?le:void 0}T+=$}}function zP(r,n,o,u,p,y,x,w,T){const P=e1(u,y,x),I=t1(u,p),D=I*x,j=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return n-D<n/4&&(n=D+n/4),n1(r,j?n/2*w%n:(I/2+2*y)*x*w%n,n,P,o,D,j,!1,T)}function n1(r,n,o,u,p,y,x,w,T){const P=y/2,I=Qv(r);let D=0,j=n-o,$=[];for(let U=0;U<r.length-1;U++){const K=r[U],te=r[U+1],le=K.dist(te),_e=te.angleTo(K);for(;j+o<D+le;){j+=o;const de=(j-D)/le,be=ar.number(K.x,te.x,de),Ce=ar.number(K.y,te.y,de);if(be>=0&&be<T&&Ce>=0&&Ce<T&&j-P>=0&&j+P<=I){const De=new ta(be,Ce,_e,U);De._round(),u&&!Jv(r,De,y,u,p)||$.push(De)}}D+=le}return w||$.length||x||($=n1(r,D/2,o,u,p,y,x,!0,T)),$}st("Anchor",ta);const ic=dr;function i1(r,n,o,u){const p=[],y=r.image,x=y.pixelRatio,w=y.paddedRect.w-2*ic,T=y.paddedRect.h-2*ic,P=r.right-r.left,I=r.bottom-r.top,D=y.stretchX||[[0,w]],j=y.stretchY||[[0,T]],$=(We,ot)=>We+ot[1]-ot[0],U=D.reduce($,0),K=j.reduce($,0),te=w-U,le=T-K;let _e=0,de=U,be=0,Ce=K,De=0,nt=te,dt=0,et=le;if(y.content&&u){const We=y.content;_e=_p(D,0,We[0]),be=_p(j,0,We[1]),de=_p(D,We[0],We[2]),Ce=_p(j,We[1],We[3]),De=We[0]-_e,dt=We[1]-be,nt=We[2]-We[0]-de,et=We[3]-We[1]-Ce}const Je=(We,ot,Xe,je)=>{const yt=xp(We.stretch-_e,de,P,r.left),ft=vp(We.fixed-De,nt,We.stretch,U),Bt=xp(ot.stretch-be,Ce,I,r.top),bn=vp(ot.fixed-dt,et,ot.stretch,K),kn=xp(Xe.stretch-_e,de,P,r.left),si=vp(Xe.fixed-De,nt,Xe.stretch,U),Ir=xp(je.stretch-be,Ce,I,r.top),Wi=vp(je.fixed-dt,et,je.stretch,K),Jn=new F(yt,Bt),bi=new F(kn,Bt),Ai=new F(kn,Ir),Hi=new F(yt,Ir),Ki=new F(ft/x,bn/x),oi=new F(si/x,Wi/x),ai=n*Math.PI/180;if(ai){const Fi=Math.sin(ai),pr=Math.cos(ai),fr=[pr,-Fi,Fi,pr];Jn._matMult(fr),bi._matMult(fr),Hi._matMult(fr),Ai._matMult(fr)}const Ri=We.stretch+We.fixed,Xi=ot.stretch+ot.fixed;return{tl:Jn,tr:bi,bl:Hi,br:Ai,tex:{x:y.paddedRect.x+ic+Ri,y:y.paddedRect.y+ic+Xi,w:Xe.stretch+Xe.fixed-Ri,h:je.stretch+je.fixed-Xi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ki,pixelOffsetBR:oi,minFontScaleX:nt/x/P,minFontScaleY:et/x/I,isSDF:o}};if(u&&(y.stretchX||y.stretchY)){const We=r1(D,te,U),ot=r1(j,le,K);for(let Xe=0;Xe<We.length-1;Xe++){const je=We[Xe],yt=We[Xe+1];for(let ft=0;ft<ot.length-1;ft++)p.push(Je(je,ot[ft],yt,ot[ft+1]))}}else p.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return p}function _p(r,n,o){let u=0;for(const p of r)u+=Math.max(n,Math.min(o,p[1]))-Math.max(n,Math.min(o,p[0]));return u}function r1(r,n,o){const u=[{fixed:-ic,stretch:0}];for(const[p,y]of r){const x=u[u.length-1];u.push({fixed:p-x.stretch,stretch:x.stretch}),u.push({fixed:p-x.stretch,stretch:x.stretch+(y-p)})}return u.push({fixed:n+ic,stretch:o}),u}function xp(r,n,o,u){return r/n*o+u}function vp(r,n,o,u){return r-n*o/u}class wp{constructor(n,o,u,p,y,x,w,T,P,I){if(this.boxStartIndex=n.length,P){let D=x.top,j=x.bottom;const $=x.collisionPadding;$&&(D-=$[1],j+=$[3]);let U=j-D;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{let D=x.top*w-T[0],j=x.bottom*w+T[2],$=x.left*w-T[3],U=x.right*w+T[1];const K=x.collisionPadding;if(K&&($-=K[0]*w,D-=K[1]*w,U+=K[2]*w,j+=K[3]*w),I){const te=new F($,D),le=new F(U,D),_e=new F($,j),de=new F(U,j),be=I*Math.PI/180;te._rotate(be),le._rotate(be),_e._rotate(be),de._rotate(be),$=Math.min(te.x,le.x,_e.x,de.x),U=Math.max(te.x,le.x,_e.x,de.x),D=Math.min(te.y,le.y,_e.y,de.y),j=Math.max(te.y,le.y,_e.y,de.y)}n.emplaceBack(o.x,o.y,$,D,U,j,u,p,y)}this.boxEndIndex=n.length}}class DP{constructor(n=[],o=RP){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:u}=this,p=o[n];for(;n>0;){const y=n-1>>1,x=o[y];if(u(p,x)>=0)break;o[n]=x,n=y}o[n]=p}_down(n){const{data:o,compare:u}=this,p=this.length>>1,y=o[n];for(;n<p;){let x=1+(n<<1),w=o[x];const T=x+1;if(T<this.length&&u(o[T],w)<0&&(x=T,w=o[T]),u(w,y)>=0)break;o[n]=w,n=x}o[n]=y}}function RP(r,n){return r<n?-1:r>n?1:0}function FP(r,n=1,o=!1){let u=1/0,p=1/0,y=-1/0,x=-1/0;const w=r[0];for(let $=0;$<w.length;$++){const U=w[$];(!$||U.x<u)&&(u=U.x),(!$||U.y<p)&&(p=U.y),(!$||U.x>y)&&(y=U.x),(!$||U.y>x)&&(x=U.y)}const T=Math.min(y-u,x-p);let P=T/2;const I=new DP([],BP);if(T===0)return new F(u,p);for(let $=u;$<y;$+=T)for(let U=p;U<x;U+=T)I.push(new rc($+P,U+P,P,r));let D=function($){let U=0,K=0,te=0;const le=$[0];for(let _e=0,de=le.length,be=de-1;_e<de;be=_e++){const Ce=le[_e],De=le[be],nt=Ce.x*De.y-De.x*Ce.y;K+=(Ce.x+De.x)*nt,te+=(Ce.y+De.y)*nt,U+=3*nt}return new rc(K/U,te/U,0,$)}(r),j=I.length;for(;I.length;){const $=I.pop();($.d>D.d||!D.d)&&(D=$,o&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,j)),$.max-D.d<=n||(P=$.h/2,I.push(new rc($.p.x-P,$.p.y-P,P,r)),I.push(new rc($.p.x+P,$.p.y-P,P,r)),I.push(new rc($.p.x-P,$.p.y+P,P,r)),I.push(new rc($.p.x+P,$.p.y+P,P,r)),j+=4)}return o&&(console.log(`num probes: ${j}`),console.log(`best distance: ${D.d}`)),D.p}function BP(r,n){return n.max-r.max}function rc(r,n,o,u){this.p=new F(r,n),this.h=o,this.d=function(p,y){let x=!1,w=1/0;for(let T=0;T<y.length;T++){const P=y[T];for(let I=0,D=P.length,j=D-1;I<D;j=I++){const $=P[I],U=P[j];$.y>p.y!=U.y>p.y&&p.x<(U.x-$.x)*(p.y-$.y)/(U.y-$.y)+$.x&&(x=!x),w=Math.min(w,Ox(p,$,U))}}return(x?1:-1)*Math.sqrt(w)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Pi;c.aq=void 0,(Pi=c.aq||(c.aq={}))[Pi.center=1]="center",Pi[Pi.left=2]="left",Pi[Pi.right=3]="right",Pi[Pi.top=4]="top",Pi[Pi.bottom=5]="bottom",Pi[Pi["top-left"]=6]="top-left",Pi[Pi["top-right"]=7]="top-right",Pi[Pi["bottom-left"]=8]="bottom-left",Pi[Pi["bottom-right"]=9]="bottom-right";const na=7,Pg=Number.POSITIVE_INFINITY;function s1(r,n){return n[1]!==Pg?function(o,u,p){let y=0,x=0;switch(u=Math.abs(u),p=Math.abs(p),o){case"top-right":case"top-left":case"top":x=p-na;break;case"bottom-right":case"bottom-left":case"bottom":x=-p+na}switch(o){case"top-right":case"bottom-right":case"right":y=-u;break;case"top-left":case"bottom-left":case"left":y=u}return[y,x]}(r,n[0],n[1]):function(o,u){let p=0,y=0;u<0&&(u=0);const x=u/Math.SQRT2;switch(o){case"top-right":case"top-left":y=x-na;break;case"bottom-right":case"bottom-left":y=-x+na;break;case"bottom":y=-u+na;break;case"top":y=u-na}switch(o){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=u;break;case"right":p=-u}return[p,y]}(r,n[0])}function o1(r,n,o){var u;const p=r.layout,y=(u=p.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(n,{},o);if(y){const w=y.values,T=[];for(let P=0;P<w.length;P+=2){const I=T[P]=w[P],D=w[P+1].map(j=>j*ri);I.startsWith("top")?D[1]-=na:I.startsWith("bottom")&&(D[1]+=na),T[P+1]=D}return new Tr(T)}const x=p.get("text-variable-anchor");if(x){let w;w=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},o)*ri,Pg]:p.get("text-offset").evaluate(n,{},o).map(P=>P*ri);const T=[];for(const P of x)T.push(P,s1(P,w));return new Tr(T)}return null}function Ag(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function NP(r,n,o,u,p,y,x,w,T,P,I){let D=y.textMaxSize.evaluate(n,{});D===void 0&&(D=x);const j=r.layers[0].layout,$=j.get("icon-offset").evaluate(n,{},I),U=l1(o.horizontal),K=x/24,te=r.tilePixelRatio*K,le=r.tilePixelRatio*D/24,_e=r.tilePixelRatio*w,de=r.tilePixelRatio*j.get("symbol-spacing"),be=j.get("text-padding")*r.tilePixelRatio,Ce=function(je,yt,ft,Bt=1){const bn=je.get("icon-padding").evaluate(yt,{},ft),kn=bn&&bn.values;return[kn[0]*Bt,kn[1]*Bt,kn[2]*Bt,kn[3]*Bt]}(j,n,I,r.tilePixelRatio),De=j.get("text-max-angle")/180*Math.PI,nt=j.get("text-rotation-alignment")!=="viewport"&&j.get("symbol-placement")!=="point",dt=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",et=j.get("symbol-placement"),Je=de/2,We=j.get("icon-text-fit");let ot;u&&We!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(ot=Iv(u,o.vertical,We,j.get("icon-text-fit-padding"),$,K)),U&&(u=Iv(u,U,We,j.get("icon-text-fit-padding"),$,K)));const Xe=(je,yt)=>{yt.x<0||yt.x>=Yn||yt.y<0||yt.y>=Yn||function(ft,Bt,bn,kn,si,Ir,Wi,Jn,bi,Ai,Hi,Ki,oi,ai,Ri,Xi,Fi,pr,fr,li,Kt,Bi,Ii,ci,ss){const Ts=ft.addToLineVertexArray(Bt,bn);let ks,vo,os,Vr,mr=0,wo=0,th=0,d1=0,Bg=-1,Ng=-1;const bo={};let p1=go("");if(ft.allowVerticalPlacement&&kn.vertical){const Ni=Jn.layout.get("text-rotate").evaluate(Kt,{},ci)+90;os=new wp(bi,Bt,Ai,Hi,Ki,kn.vertical,oi,ai,Ri,Ni),Wi&&(Vr=new wp(bi,Bt,Ai,Hi,Ki,Wi,Fi,pr,Ri,Ni))}if(si){const Ni=Jn.layout.get("icon-rotate").evaluate(Kt,{}),$r=Jn.layout.get("icon-text-fit")!=="none",Wa=i1(si,Ni,Ii,$r),Cs=Wi?i1(Wi,Ni,Ii,$r):void 0;vo=new wp(bi,Bt,Ai,Hi,Ki,si,Fi,pr,!1,Ni),mr=4*Wa.length;const Ha=ft.iconSizeData;let Hs=null;Ha.kind==="source"?(Hs=[Ws*Jn.layout.get("icon-size").evaluate(Kt,{})],Hs[0]>Qo&&Ut(`${ft.layerIds[0]}: Value for "icon-size" is >= ${Yu}. Reduce your "icon-size".`)):Ha.kind==="composite"&&(Hs=[Ws*Bi.compositeIconSizes[0].evaluate(Kt,{},ci),Ws*Bi.compositeIconSizes[1].evaluate(Kt,{},ci)],(Hs[0]>Qo||Hs[1]>Qo)&&Ut(`${ft.layerIds[0]}: Value for "icon-size" is >= ${Yu}. Reduce your "icon-size".`)),ft.addSymbols(ft.icon,Wa,Hs,li,fr,Kt,c.ai.none,Bt,Ts.lineStartIndex,Ts.lineLength,-1,ci),Bg=ft.icon.placedSymbolArray.length-1,Cs&&(wo=4*Cs.length,ft.addSymbols(ft.icon,Cs,Hs,li,fr,Kt,c.ai.vertical,Bt,Ts.lineStartIndex,Ts.lineLength,-1,ci),Ng=ft.icon.placedSymbolArray.length-1)}const f1=Object.keys(kn.horizontal);for(const Ni of f1){const $r=kn.horizontal[Ni];if(!ks){p1=go($r.text);const Cs=Jn.layout.get("text-rotate").evaluate(Kt,{},ci);ks=new wp(bi,Bt,Ai,Hi,Ki,$r,oi,ai,Ri,Cs)}const Wa=$r.positionedLines.length===1;if(th+=a1(ft,Bt,$r,Ir,Jn,Ri,Kt,Xi,Ts,kn.vertical?c.ai.horizontal:c.ai.horizontalOnly,Wa?f1:[Ni],bo,Bg,Bi,ci),Wa)break}kn.vertical&&(d1+=a1(ft,Bt,kn.vertical,Ir,Jn,Ri,Kt,Xi,Ts,c.ai.vertical,["vertical"],bo,Ng,Bi,ci));const VP=ks?ks.boxStartIndex:ft.collisionBoxArray.length,$P=ks?ks.boxEndIndex:ft.collisionBoxArray.length,UP=os?os.boxStartIndex:ft.collisionBoxArray.length,qP=os?os.boxEndIndex:ft.collisionBoxArray.length,ZP=vo?vo.boxStartIndex:ft.collisionBoxArray.length,GP=vo?vo.boxEndIndex:ft.collisionBoxArray.length,WP=Vr?Vr.boxStartIndex:ft.collisionBoxArray.length,HP=Vr?Vr.boxEndIndex:ft.collisionBoxArray.length;let Es=-1;const Sp=(Ni,$r)=>Ni&&Ni.circleDiameter?Math.max(Ni.circleDiameter,$r):$r;Es=Sp(ks,Es),Es=Sp(os,Es),Es=Sp(vo,Es),Es=Sp(Vr,Es);const m1=Es>-1?1:0;m1&&(Es*=ss/ri),ft.glyphOffsetArray.length>=nc.MAX_GLYPHS&&Ut("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Kt.sortKey!==void 0&&ft.addToSortKeyRanges(ft.symbolInstances.length,Kt.sortKey);const KP=o1(Jn,Kt,ci),[XP,YP]=function(Ni,$r){const Wa=Ni.length,Cs=$r==null?void 0:$r.values;if((Cs==null?void 0:Cs.length)>0)for(let Ha=0;Ha<Cs.length;Ha+=2){const Hs=Cs[Ha+1];Ni.emplaceBack(c.aq[Cs[Ha]],Hs[0],Hs[1])}return[Wa,Ni.length]}(ft.textAnchorOffsets,KP);ft.symbolInstances.emplaceBack(Bt.x,Bt.y,bo.right>=0?bo.right:-1,bo.center>=0?bo.center:-1,bo.left>=0?bo.left:-1,bo.vertical||-1,Bg,Ng,p1,VP,$P,UP,qP,ZP,GP,WP,HP,Ai,th,d1,mr,wo,m1,0,oi,Es,XP,YP)}(r,yt,je,o,u,p,ot,r.layers[0],r.collisionBoxArray,n.index,n.sourceLayerIndex,r.index,te,[be,be,be,be],nt,T,_e,Ce,dt,$,n,y,P,I,x)};if(et==="line")for(const je of Yv(n.geometry,0,0,Yn,Yn)){const yt=zP(je,de,De,o.vertical||U,u,24,le,r.overscaling,Yn);for(const ft of yt)U&&jP(r,U.text,Je,ft)||Xe(je,ft)}else if(et==="line-center"){for(const je of n.geometry)if(je.length>1){const yt=LP(je,De,o.vertical||U,u,24,le);yt&&Xe(je,yt)}}else if(n.type==="Polygon")for(const je of ag(n.geometry,0)){const yt=FP(je,16);Xe(je[0],new ta(yt.x,yt.y,0))}else if(n.type==="LineString")for(const je of n.geometry)Xe(je,new ta(je[0].x,je[0].y,0));else if(n.type==="Point")for(const je of n.geometry)for(const yt of je)Xe([yt],new ta(yt.x,yt.y,0))}function a1(r,n,o,u,p,y,x,w,T,P,I,D,j,$,U){const K=function(_e,de,be,Ce,De,nt,dt,et){const Je=Ce.layout.get("text-rotate").evaluate(nt,{})*Math.PI/180,We=[];for(const ot of de.positionedLines)for(const Xe of ot.positionedGlyphs){if(!Xe.rect)continue;const je=Xe.rect||{};let yt=Sv+1,ft=!0,Bt=1,bn=0;const kn=(De||et)&&Xe.vertical,si=Xe.metrics.advance*Xe.scale/2;if(et&&de.verticalizable&&(bn=ot.lineOffset/2-(Xe.imageName?-(ri-Xe.metrics.width*Xe.scale)/2:(Xe.scale-1)*ri)),Xe.imageName){const li=dt[Xe.imageName];ft=li.sdf,Bt=li.pixelRatio,yt=dr/Bt}const Ir=De?[Xe.x+si,Xe.y]:[0,0];let Wi=De?[0,0]:[Xe.x+si+be[0],Xe.y+be[1]-bn],Jn=[0,0];kn&&(Jn=Wi,Wi=[0,0]);const bi=Xe.metrics.isDoubleResolution?2:1,Ai=(Xe.metrics.left-yt)*Xe.scale-si+Wi[0],Hi=(-Xe.metrics.top-yt)*Xe.scale+Wi[1],Ki=Ai+je.w/bi*Xe.scale/Bt,oi=Hi+je.h/bi*Xe.scale/Bt,ai=new F(Ai,Hi),Ri=new F(Ki,Hi),Xi=new F(Ai,oi),Fi=new F(Ki,oi);if(kn){const li=new F(-si,si-Ku),Kt=-Math.PI/2,Bi=ri/2-si,Ii=new F(5-Ku-Bi,-(Xe.imageName?Bi:0)),ci=new F(...Jn);ai._rotateAround(Kt,li)._add(Ii)._add(ci),Ri._rotateAround(Kt,li)._add(Ii)._add(ci),Xi._rotateAround(Kt,li)._add(Ii)._add(ci),Fi._rotateAround(Kt,li)._add(Ii)._add(ci)}if(Je){const li=Math.sin(Je),Kt=Math.cos(Je),Bi=[Kt,-li,li,Kt];ai._matMult(Bi),Ri._matMult(Bi),Xi._matMult(Bi),Fi._matMult(Bi)}const pr=new F(0,0),fr=new F(0,0);We.push({tl:ai,tr:Ri,bl:Xi,br:Fi,tex:je,writingMode:de.writingMode,glyphOffset:Ir,sectionIndex:Xe.sectionIndex,isSDF:ft,pixelOffsetTL:pr,pixelOffsetBR:fr,minFontScaleX:0,minFontScaleY:0})}return We}(0,o,w,p,y,x,u,r.allowVerticalPlacement),te=r.textSizeData;let le=null;te.kind==="source"?(le=[Ws*p.layout.get("text-size").evaluate(x,{})],le[0]>Qo&&Ut(`${r.layerIds[0]}: Value for "text-size" is >= ${Yu}. Reduce your "text-size".`)):te.kind==="composite"&&(le=[Ws*$.compositeTextSizes[0].evaluate(x,{},U),Ws*$.compositeTextSizes[1].evaluate(x,{},U)],(le[0]>Qo||le[1]>Qo)&&Ut(`${r.layerIds[0]}: Value for "text-size" is >= ${Yu}. Reduce your "text-size".`)),r.addSymbols(r.text,K,le,w,y,x,P,n,T.lineStartIndex,T.lineLength,j,U);for(const _e of I)D[_e]=r.text.placedSymbolArray.length-1;return 4*K.length}function l1(r){for(const n in r)return r[n];return null}function jP(r,n,o,u){const p=r.compareText;if(n in p){const y=p[n];for(let x=y.length-1;x>=0;x--)if(u.dist(y[x])<o)return!0}else p[n]=[];return p[n].push(u),!1}const c1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ig{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=c1[15&u];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Ig(w,x,y,n)}constructor(n,o=64,u=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=c1.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+w+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=o,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Mg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:w}=this,T=[0,y.length-1,0],P=[];for(;T.length;){const I=T.pop()||0,D=T.pop()||0,j=T.pop()||0;if(D-j<=w){for(let te=j;te<=D;te++){const le=x[2*te],_e=x[2*te+1];le>=n&&le<=u&&_e>=o&&_e<=p&&P.push(y[te])}continue}const $=j+D>>1,U=x[2*$],K=x[2*$+1];U>=n&&U<=u&&K>=o&&K<=p&&P.push(y[$]),(I===0?n<=U:o<=K)&&(T.push(j),T.push($-1),T.push(1-I)),(I===0?u>=U:p>=K)&&(T.push($+1),T.push(D),T.push(1-I))}return P}within(n,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:x}=this,w=[0,p.length-1,0],T=[],P=u*u;for(;w.length;){const I=w.pop()||0,D=w.pop()||0,j=w.pop()||0;if(D-j<=x){for(let te=j;te<=D;te++)h1(y[2*te],y[2*te+1],n,o)<=P&&T.push(p[te]);continue}const $=j+D>>1,U=y[2*$],K=y[2*$+1];h1(U,K,n,o)<=P&&T.push(p[$]),(I===0?n-u<=U:o-u<=K)&&(w.push(j),w.push($-1),w.push(1-I)),(I===0?n+u>=U:o+u>=K)&&(w.push($+1),w.push(D),w.push(1-I))}return T}}function Mg(r,n,o,u,p,y){if(p-u<=o)return;const x=u+p>>1;u1(r,n,x,u,p,y),Mg(r,n,o,u,x-1,1-y),Mg(r,n,o,x+1,p,1-y)}function u1(r,n,o,u,p,y){for(;p>u;){if(p-u>600){const P=p-u+1,I=o-u+1,D=Math.log(P),j=.5*Math.exp(2*D/3),$=.5*Math.sqrt(D*j*(P-j)/P)*(I-P/2<0?-1:1);u1(r,n,o,Math.max(u,Math.floor(o-I*j/P+$)),Math.min(p,Math.floor(o+(P-I)*j/P+$)),y)}const x=n[2*o+y];let w=u,T=p;for(Qu(r,n,u,o),n[2*p+y]>x&&Qu(r,n,u,p);w<T;){for(Qu(r,n,w,T),w++,T--;n[2*w+y]<x;)w++;for(;n[2*T+y]>x;)T--}n[2*u+y]===x?Qu(r,n,u,T):(T++,Qu(r,n,T,p)),T<=o&&(u=T+1),o<=T&&(p=T-1)}}function Qu(r,n,o,u){Lg(r,o,u),Lg(n,2*o,2*u),Lg(n,2*o+1,2*u+1)}function Lg(r,n,o){const u=r[n];r[n]=r[o],r[o]=u}function h1(r,n,o,u){const p=r-o,y=n-u;return p*p+y*y}var zg;c.bh=void 0,(zg=c.bh||(c.bh={})).create="create",zg.load="load",zg.fullLoad="fullLoad";let bp=null,eh=[];const Dg=1e3/60,Rg="loadTime",Fg="fullLoadTime",OP={mark(r){performance.mark(r)},frame(r){const n=r;bp!=null&&eh.push(n-bp),bp=n},clearMetrics(){bp=null,eh=[],performance.clearMeasures(Rg),performance.clearMeasures(Fg);for(const r in c.bh)performance.clearMarks(c.bh[r])},getPerformanceMetrics(){performance.measure(Rg,c.bh.create,c.bh.load),performance.measure(Fg,c.bh.create,c.bh.fullLoad);const r=performance.getEntriesByName(Rg)[0].duration,n=performance.getEntriesByName(Fg)[0].duration,o=eh.length,u=1/(eh.reduce((y,x)=>y+x,0)/o/1e3),p=eh.filter(y=>y>Dg).reduce((y,x)=>y+(x-Dg)/Dg,0);return{loadTime:r,fullLoadTime:n,fps:u,percentDroppedFrames:p/(o+p)*100,totalFrames:o}}};c.$=function(r,n,o){var u,p,y,x,w,T,P,I,D,j,$,U,K=o[0],te=o[1],le=o[2];return n===r?(r[12]=n[0]*K+n[4]*te+n[8]*le+n[12],r[13]=n[1]*K+n[5]*te+n[9]*le+n[13],r[14]=n[2]*K+n[6]*te+n[10]*le+n[14],r[15]=n[3]*K+n[7]*te+n[11]*le+n[15]):(p=n[1],y=n[2],x=n[3],w=n[4],T=n[5],P=n[6],I=n[7],D=n[8],j=n[9],$=n[10],U=n[11],r[0]=u=n[0],r[1]=p,r[2]=y,r[3]=x,r[4]=w,r[5]=T,r[6]=P,r[7]=I,r[8]=D,r[9]=j,r[10]=$,r[11]=U,r[12]=u*K+w*te+D*le+n[12],r[13]=p*K+T*te+j*le+n[13],r[14]=y*K+P*te+$*le+n[14],r[15]=x*K+I*te+U*le+n[15]),r},c.A=Xl,c.B=ar,c.C=class{constructor(r,n,o){this.receive=u=>{const p=u.data,y=p.id;if(y&&(!p.targetMapId||this.mapId===p.targetMapId))if(p.type==="<cancel>"){delete this.tasks[y];const x=this.cancelCallbacks[y];delete this.cancelCallbacks[y],x&&x()}else rt()||p.mustQueue?(this.tasks[y]=p,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,p)},this.process=()=>{if(!this.taskQueue.length)return;const u=this.taskQueue.shift(),p=this.tasks[u];delete this.tasks[u],this.taskQueue.length&&this.invoker.trigger(),p&&this.processTask(u,p)},this.target=r,this.parent=n,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new IP(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=rt()?r:window}send(r,n,o,u,p=!1){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[y]=o);const x=[],w={id:y,type:r,hasCallback:!!o,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:qs(n,x)};return this.target.postMessage(w,{transfer:x}),{cancel:()=>{o&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}processTask(r,n){if(n.type==="<response>"){const o=this.callbacks[r];delete this.callbacks[r],o&&(n.error?o(Wo(n.error)):o(null,Wo(n.data)))}else{let o=!1;const u=[],p=n.hasCallback?(w,T)=>{o=!0,delete this.cancelCallbacks[r];const P={id:r,type:"<response>",sourceMapId:this.mapId,error:w?qs(w):null,data:qs(T,u)};this.target.postMessage(P,{transfer:u})}:w=>{o=!0};let y=null;const x=Wo(n.data);if(this.parent[n.type])y=this.parent[n.type](n.sourceMapId,x,p);else if("getWorkerSource"in this.parent){const w=n.type.split(".");y=this.parent.getWorkerSource(n.sourceMapId,w[0],x.source)[w[1]](x,p)}else p(new Error(`Could not find function ${n.type}`));!o&&y&&y.cancel&&(this.cancelCallbacks[r]=y.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.D=mt,c.E=ms,c.F=function(r,n){const o={};for(let u=0;u<n.length;u++){const p=n[u];p in r&&(o[p]=r[p])}return o},c.G=jv,c.H=Ov,c.I=yg,c.J=q,c.K=G,c.L=ea,c.M=wt,c.N=Yn,c.O=Or,c.P=F,c.Q=An,c.R=jr,c.S=wn,c.T=Yd,c.U=yp,c.V=class extends fo{},c.W=Cg,c.X=function(r,n){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let u=0;u<r.length;u++){const p=window.document.createElement("source");qt(r[u])||(o.crossOrigin="Anonymous"),p.src=r[u],o.appendChild(p)}return{cancel:()=>{}}},c.Y=Ze,c.Z=function(){var r=new Xl(16);return Xl!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},c._=C,c.a=at,c.a$=class extends V{},c.a0=function(r,n,o){var u=o[0],p=o[1],y=o[2];return r[0]=n[0]*u,r[1]=n[1]*u,r[2]=n[2]*u,r[3]=n[3]*u,r[4]=n[4]*p,r[5]=n[5]*p,r[6]=n[6]*p,r[7]=n[7]*p,r[8]=n[8]*y,r[9]=n[9]*y,r[10]=n[10]*y,r[11]=n[11]*y,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r},c.a1=qx,c.a2=function(){return it++},c.a3=Q,c.a4=nc,c.a5=function(){ur.isLoading()||ur.isLoaded()||Pu()!=="deferred"||Xd()},c.a6=yu,c.a7=Za,c.a8=vn,c.a9=Wv,c.aA=ja,c.aB=function(r){r=r.slice();const n=Object.create(null);for(let o=0;o<r.length;o++)n[r[o].id]=r[o];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=di(r[o],n[r[o].ref]));return r},c.aC=function(r){if(r.type==="custom")return new AP(r);switch(r.type){case"background":return new EP(r);case"circle":return new hC(r);case"fill":return new MC(r);case"fill-extrusion":return new GC(r);case"heatmap":return new pC(r);case"hillshade":return new mC(r);case"line":return new eP(r);case"raster":return new PP(r);case"symbol":return new gp(r)}},c.aD=Ct,c.aE=function(r,n){if(!r)return[{command:Ht.setStyle,args:[n]}];let o=[];try{if(!ln(r.version,n.version))return[{command:Ht.setStyle,args:[n]}];ln(r.center,n.center)||o.push({command:Ht.setCenter,args:[n.center]}),ln(r.zoom,n.zoom)||o.push({command:Ht.setZoom,args:[n.zoom]}),ln(r.bearing,n.bearing)||o.push({command:Ht.setBearing,args:[n.bearing]}),ln(r.pitch,n.pitch)||o.push({command:Ht.setPitch,args:[n.pitch]}),ln(r.sprite,n.sprite)||o.push({command:Ht.setSprite,args:[n.sprite]}),ln(r.glyphs,n.glyphs)||o.push({command:Ht.setGlyphs,args:[n.glyphs]}),ln(r.transition,n.transition)||o.push({command:Ht.setTransition,args:[n.transition]}),ln(r.light,n.light)||o.push({command:Ht.setLight,args:[n.light]});const u={},p=[];(function(x,w,T,P){let I;for(I in w=w||{},x=x||{})Object.prototype.hasOwnProperty.call(x,I)&&(Object.prototype.hasOwnProperty.call(w,I)||Fr(I,T,P));for(I in w)Object.prototype.hasOwnProperty.call(w,I)&&(Object.prototype.hasOwnProperty.call(x,I)?ln(x[I],w[I])||(x[I].type==="geojson"&&w[I].type==="geojson"&&so(x,w,I)?T.push({command:Ht.setGeoJSONSourceData,args:[I,w[I].data]}):wr(I,w,T,P)):rr(I,w,T))})(r.sources,n.sources,p,u);const y=[];r.layers&&r.layers.forEach(x=>{u[x.source]?o.push({command:Ht.removeLayer,args:[x.id]}):y.push(x)}),o=o.concat(p),function(x,w,T){w=w||[];const P=(x=x||[]).map(Br),I=w.map(Br),D=x.reduce(Nr,{}),j=w.reduce(Nr,{}),$=P.slice(),U=Object.create(null);let K,te,le,_e,de,be,Ce;for(K=0,te=0;K<P.length;K++)le=P[K],Object.prototype.hasOwnProperty.call(j,le)?te++:(T.push({command:Ht.removeLayer,args:[le]}),$.splice($.indexOf(le,te),1));for(K=0,te=0;K<I.length;K++)le=I[I.length-1-K],$[$.length-1-K]!==le&&(Object.prototype.hasOwnProperty.call(D,le)?(T.push({command:Ht.removeLayer,args:[le]}),$.splice($.lastIndexOf(le,$.length-te),1)):te++,be=$[$.length-K],T.push({command:Ht.addLayer,args:[j[le],be]}),$.splice($.length-K,0,le),U[le]=!0);for(K=0;K<I.length;K++)if(le=I[K],_e=D[le],de=j[le],!U[le]&&!ln(_e,de))if(ln(_e.source,de.source)&&ln(_e["source-layer"],de["source-layer"])&&ln(_e.type,de.type)){for(Ce in gs(_e.layout,de.layout,T,le,null,Ht.setLayoutProperty),gs(_e.paint,de.paint,T,le,null,Ht.setPaintProperty),ln(_e.filter,de.filter)||T.push({command:Ht.setFilter,args:[le,de.filter]}),ln(_e.minzoom,de.minzoom)&&ln(_e.maxzoom,de.maxzoom)||T.push({command:Ht.setLayerZoomRange,args:[le,de.minzoom,de.maxzoom]}),_e)Object.prototype.hasOwnProperty.call(_e,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?gs(_e[Ce],de[Ce],T,le,Ce.slice(6),Ht.setPaintProperty):ln(_e[Ce],de[Ce])||T.push({command:Ht.setLayerProperty,args:[le,Ce,de[Ce]]}));for(Ce in de)Object.prototype.hasOwnProperty.call(de,Ce)&&!Object.prototype.hasOwnProperty.call(_e,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?gs(_e[Ce],de[Ce],T,le,Ce.slice(6),Ht.setPaintProperty):ln(_e[Ce],de[Ce])||T.push({command:Ht.setLayerProperty,args:[le,Ce,de[Ce]]}))}else T.push({command:Ht.removeLayer,args:[le]}),be=$[$.lastIndexOf(le)+1],T.push({command:Ht.addLayer,args:[de,be]})}(y,n.layers,o)}catch(u){console.warn("Unable to compute style diff:",u),o=[{command:Ht.setStyle,args:[n]}]}return o},c.aF=function(r){const n=[],o=r.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},c.aG=function r(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let u=0;u<n.length;u++)if(!r(n[u],o[u]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const u in n)if(!r(n[u],o[u]))return!1;return!0}return n===o},c.aH=Oe,c.aI=At,c.aJ=Oa,c.aK=function(r){return r({pluginStatus:qi,pluginURL:Zs}),Oa.on("pluginStateChange",r),r},c.aL=class extends yo{constructor(r,n){super(r,n),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},c.aM=Hl,c.aN=class extends yo{constructor(r,n){super(r,n),this.current=Km}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let n=1;n<16;n++)if(r[n]!==this.current[n]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},c.aO=tp,c.aP=class extends yo{constructor(r,n){super(r,n),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},c.aQ=class extends yo{constructor(r,n){super(r,n),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},c.aR=np,c.aS=function(r,n,o,u,p,y,x){var w=1/(n-o),T=1/(u-p),P=1/(y-x);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*P,r[11]=0,r[12]=(n+o)*w,r[13]=(p+u)*T,r[14]=(x+y)*P,r[15]=1,r},c.aT=dn,c.aU=uC,c.aV=class extends d{},c.aW=rP,c.aX=class extends _{},c.aY=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},c.aZ=Kx,c.a_=$e,c.aa=function(r){const n={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,p,y)=>{const x=p||y;return n[u]=!x||x.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},c.ab=function(r,n){const o=[];for(const u in r)u in n||o.push(u);return o},c.ac=function(r){if(Re==null){const n=r.navigator?r.navigator.userAgent:null;Re=!!r.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Re},c.ad=Ee,c.ae=function(r,n,o){var u=Math.sin(o),p=Math.cos(o),y=n[0],x=n[1],w=n[2],T=n[3],P=n[4],I=n[5],D=n[6],j=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=y*p+P*u,r[1]=x*p+I*u,r[2]=w*p+D*u,r[3]=T*p+j*u,r[4]=P*p-y*u,r[5]=I*p-x*u,r[6]=D*p-w*u,r[7]=j*p-T*u,r},c.af=function(r){var n=new Xl(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n},c.ag=op,c.ah=function(r,n){let o=0,u=0;if(r.kind==="constant")u=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:x}=r,w=p?Ee(lr.interpolationFactor(p,n,y,x),0,1):0;r.kind==="camera"?u=ar.number(r.minSize,r.maxSize,w):o=w}return{uSizeT:o,uSize:u}},c.aj=function(r,{uSize:n,uSizeT:o},{lowerSize:u,upperSize:p}){return r.kind==="source"?u/Ws:r.kind==="composite"?ar.number(u/Ws,p/Ws,o):n},c.ak=wg,c.al=function(r,n,o,u){const p=n.y-r.y,y=n.x-r.x,x=u.y-o.y,w=u.x-o.x,T=x*y-w*p;if(T===0)return null;const P=(w*(r.y-o.y)-x*(r.x-o.x))/T;return new F(r.x+P*y,r.y+P*p)},c.am=Yv,c.an=Nx,c.ao=eg,c.ap=ri,c.ar=vg,c.as=function(r,n){var o=n[0],u=n[1],p=n[2],y=n[3],x=n[4],w=n[5],T=n[6],P=n[7],I=n[8],D=n[9],j=n[10],$=n[11],U=n[12],K=n[13],te=n[14],le=n[15],_e=o*w-u*x,de=o*T-p*x,be=o*P-y*x,Ce=u*T-p*w,De=u*P-y*w,nt=p*P-y*T,dt=I*K-D*U,et=I*te-j*U,Je=I*le-$*U,We=D*te-j*K,ot=D*le-$*K,Xe=j*le-$*te,je=_e*Xe-de*ot+be*We+Ce*Je-De*et+nt*dt;return je?(r[0]=(w*Xe-T*ot+P*We)*(je=1/je),r[1]=(p*ot-u*Xe-y*We)*je,r[2]=(K*nt-te*De+le*Ce)*je,r[3]=(j*De-D*nt-$*Ce)*je,r[4]=(T*Je-x*Xe-P*et)*je,r[5]=(o*Xe-p*Je+y*et)*je,r[6]=(te*be-U*nt-le*de)*je,r[7]=(I*nt-j*be+$*de)*je,r[8]=(x*ot-w*Je+P*dt)*je,r[9]=(u*Je-o*ot-y*dt)*je,r[10]=(U*De-K*be+le*_e)*je,r[11]=(D*be-I*De-$*_e)*je,r[12]=(w*et-x*We-T*dt)*je,r[13]=(o*We-u*et+p*dt)*je,r[14]=(K*de-U*Ce-te*_e)*je,r[15]=(I*Ce-D*de+j*_e)*je,r):null},c.at=Ag,c.au=xg,c.av=Ig,c.aw=function(){const r={},n=Me.$version;for(const o in Me.$root){const u=Me.$root[o];if(u.required){let p=null;p=o==="version"?n:u.type==="array"?[]:{},p!=null&&(r[o]=p)}}return r},c.ax=Ht,c.ay=Gd,c.az=Lt,c.b=function(r,n){const o=new Blob([new Uint8Array(r)],{type:"image/png"});createImageBitmap(o).then(u=>{n(null,u)}).catch(u=>{n(new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},c.b0=vi,c.b1=function(r,n){var o=r[0],u=r[1],p=r[2],y=r[3],x=r[4],w=r[5],T=r[6],P=r[7],I=r[8],D=r[9],j=r[10],$=r[11],U=r[12],K=r[13],te=r[14],le=r[15],_e=n[0],de=n[1],be=n[2],Ce=n[3],De=n[4],nt=n[5],dt=n[6],et=n[7],Je=n[8],We=n[9],ot=n[10],Xe=n[11],je=n[12],yt=n[13],ft=n[14],Bt=n[15];return Math.abs(o-_e)<=Gi*Math.max(1,Math.abs(o),Math.abs(_e))&&Math.abs(u-de)<=Gi*Math.max(1,Math.abs(u),Math.abs(de))&&Math.abs(p-be)<=Gi*Math.max(1,Math.abs(p),Math.abs(be))&&Math.abs(y-Ce)<=Gi*Math.max(1,Math.abs(y),Math.abs(Ce))&&Math.abs(x-De)<=Gi*Math.max(1,Math.abs(x),Math.abs(De))&&Math.abs(w-nt)<=Gi*Math.max(1,Math.abs(w),Math.abs(nt))&&Math.abs(T-dt)<=Gi*Math.max(1,Math.abs(T),Math.abs(dt))&&Math.abs(P-et)<=Gi*Math.max(1,Math.abs(P),Math.abs(et))&&Math.abs(I-Je)<=Gi*Math.max(1,Math.abs(I),Math.abs(Je))&&Math.abs(D-We)<=Gi*Math.max(1,Math.abs(D),Math.abs(We))&&Math.abs(j-ot)<=Gi*Math.max(1,Math.abs(j),Math.abs(ot))&&Math.abs($-Xe)<=Gi*Math.max(1,Math.abs($),Math.abs(Xe))&&Math.abs(U-je)<=Gi*Math.max(1,Math.abs(U),Math.abs(je))&&Math.abs(K-yt)<=Gi*Math.max(1,Math.abs(K),Math.abs(yt))&&Math.abs(te-ft)<=Gi*Math.max(1,Math.abs(te),Math.abs(ft))&&Math.abs(le-Bt)<=Gi*Math.max(1,Math.abs(le),Math.abs(Bt))},c.b2=function(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r},c.b3=function(r,n,o){return r[0]=n[0]*o[0],r[1]=n[1]*o[1],r[2]=n[2]*o[2],r[3]=n[3]*o[3],r},c.b4=function(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]+r[3]*n[3]},c.b5=Ie,c.b6=qv,c.b7=Vv,c.b8=function(r,n,o,u,p){var y,x=1/Math.tan(n/2);return r[0]=x/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,p!=null&&p!==1/0?(r[10]=(p+u)*(y=1/(u-p)),r[14]=2*p*u*y):(r[10]=-1,r[14]=-2*u),r},c.b9=function(r,n,o){var u=Math.sin(o),p=Math.cos(o),y=n[4],x=n[5],w=n[6],T=n[7],P=n[8],I=n[9],D=n[10],j=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=y*p+P*u,r[5]=x*p+I*u,r[6]=w*p+D*u,r[7]=T*p+j*u,r[8]=P*p-y*u,r[9]=I*p-x*u,r[10]=D*p-w*u,r[11]=j*p-T*u,r},c.bA=L,c.bB=gv,c.bC=Bl,c.bD=ur,c.ba=fe,c.bb=xe,c.bc=function(r,n){return r[0]=n[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},c.bd=class extends Ua{},c.be=kg,c.bf=$v,c.bg=OP,c.bi=gi,c.bj=function(r,n,o=!1){if(qi===Su||qi===Tu||qi===ku)throw new Error("setRTLTextPlugin cannot be called multiple times.");Zs=an.resolveURL(r),qi=Su,Eu=n,Cu(),o||Xd()},c.bk=Pu,c.bl=function(r,n){const o={};for(let p=0;p<r.length;p++){const y=n&&n[r[p].id]||Vl(r[p]);n&&(n[r[p].id]=y);let x=o[y];x||(x=o[y]=[]),x.push(r[p])}const u=[];for(const p in o)u.push(o[p]);return u},c.bm=st,c.bn=Gv,c.bo=Hv,c.bp=kv,c.bq=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Yn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const n=r.bucket.layers[0],o=n.layout,u=n._unevaluatedLayout._values,p={layoutIconSize:u["icon-size"].possiblyEvaluate(new vn(r.bucket.zoom+1),r.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new vn(r.bucket.zoom+1),r.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new vn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=r.bucket.textSizeData;p.compositeTextSizes=[u["text-size"].possiblyEvaluate(new vn(P),r.canonical),u["text-size"].possiblyEvaluate(new vn(I),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=r.bucket.iconSizeData;p.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new vn(P),r.canonical),u["icon-size"].possiblyEvaluate(new vn(I),r.canonical)]}const y=o.get("text-line-height")*ri,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",w=o.get("text-keep-upright"),T=o.get("text-size");for(const P of r.bucket.features){const I=o.get("text-font").evaluate(P,{},r.canonical).join(","),D=T.evaluate(P,{},r.canonical),j=p.layoutTextSize.evaluate(P,{},r.canonical),$=p.layoutIconSize.evaluate(P,{},r.canonical),U={horizontal:{},vertical:void 0},K=P.text;let te,le=[0,0];if(K){const be=K.toString(),Ce=o.get("text-letter-spacing").evaluate(P,{},r.canonical)*ri,De=wu(be)?Ce:0,nt=o.get("text-anchor").evaluate(P,{},r.canonical),dt=o1(n,P,r.canonical);if(!dt){const Xe=o.get("text-radial-offset").evaluate(P,{},r.canonical);le=Xe?s1(nt,[Xe*ri,Pg]):o.get("text-offset").evaluate(P,{},r.canonical).map(je=>je*ri)}let et=x?"center":o.get("text-justify").evaluate(P,{},r.canonical);const Je=o.get("symbol-placement"),We=Je==="point"?o.get("text-max-width").evaluate(P,{},r.canonical)*ri:0,ot=()=>{r.bucket.allowVerticalPlacement&&vu(be)&&(U.vertical=pp(K,r.glyphMap,r.glyphPositions,r.imagePositions,I,We,y,nt,"left",De,le,c.ai.vertical,!0,Je,j,D))};if(!x&&dt){const Xe=new Set;if(et==="auto")for(let yt=0;yt<dt.values.length;yt+=2)Xe.add(Ag(dt.values[yt]));else Xe.add(et);let je=!1;for(const yt of Xe)if(!U.horizontal[yt])if(je)U.horizontal[yt]=U.horizontal[0];else{const ft=pp(K,r.glyphMap,r.glyphPositions,r.imagePositions,I,We,y,"center",yt,De,le,c.ai.horizontal,!1,Je,j,D);ft&&(U.horizontal[yt]=ft,je=ft.positionedLines.length===1)}ot()}else{et==="auto"&&(et=Ag(nt));const Xe=pp(K,r.glyphMap,r.glyphPositions,r.imagePositions,I,We,y,nt,et,De,le,c.ai.horizontal,!1,Je,j,D);Xe&&(U.horizontal[et]=Xe),ot(),vu(be)&&x&&w&&(U.vertical=pp(K,r.glyphMap,r.glyphPositions,r.imagePositions,I,We,y,nt,et,De,le,c.ai.vertical,!1,Je,j,D))}}let _e=!1;if(P.icon&&P.icon.name){const be=r.imageMap[P.icon.name];be&&(te=wP(r.imagePositions[P.icon.name],o.get("icon-offset").evaluate(P,{},r.canonical),o.get("icon-anchor").evaluate(P,{},r.canonical)),_e=!!be.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=_e:r.bucket.sdfIcons!==_e&&Ut("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(be.pixelRatio!==r.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const de=l1(U.horizontal)||U.vertical;r.bucket.iconsInText=!!de&&de.iconsInText,(de||te)&&NP(r.bucket,P,U,te,r.imageMap,p,j,$,le,_e,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},c.br=pg,c.bs=ug,c.bt=dg,c.bu=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},c.bv=mg,c.bw=Yo,c.bx=function(r,n,o,u,p){return C(this,void 0,void 0,function*(){if(G())try{return yield wt(r,n,o,u,p)}catch{}return function(y,x,w,T,P){const I=y.width,D=y.height;Rt&&Ft||(Rt=new OffscreenCanvas(I,D),Ft=Rt.getContext("2d",{willReadFrequently:!0})),Rt.width=I,Rt.height=D,Ft.drawImage(y,0,0,I,D);const j=Ft.getImageData(x,w,T,P);return Ft.clearRect(0,0,I,D),j.data}(r,n,o,u,p)})},c.by=Zv,c.bz=k,c.c=gn,c.d=function(r,n){const o=new Image;o.onload=()=>{n(null,o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=Ne})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(r)],{type:"image/png"});o.src=r.byteLength?URL.createObjectURL(u):Ne},c.e=ke,c.f=function(r,n){return ut(ke(r,{type:"json"}),n)},c.g=tn,c.h=an,c.i=rt,c.j=ki,c.k=_t,c.l=zt,c.m=ut,c.n=function(r){return new mg(r).readFields(mP,[])},c.o=function(r,n,o){if(!r.length)return o(null,[]);let u=r.length;const p=new Array(r.length);let y=null;r.forEach((x,w)=>{n(x,(T,P)=>{T&&(y=T),p[w]=P,--u==0&&o(y,p)})})},c.p=Tv,c.q=Vu,c.r=Un,c.s=qt,c.t=Zm,c.u=tt,c.v=Me,c.w=Ut,c.x=ql,c.y=ws,c.z=function([r,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(n)*Math.sin(o),y:r*Math.sin(n)*Math.sin(o),z:r*Math.cos(o)}}}),g(["./shared"],function(c){class C{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,O){for(const ee of N){this._layerConfigs[ee.id]=ee;const ne=this._layers[ee.id]=c.aC(ee);ne._featureFilter=c.a6(ne.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(const ee of O)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const W=c.bl(Object.values(this._layerConfigs),this.keyCache);for(const ee of W){const ne=ee.map(ve=>this._layers[ve.id]),we=ne[0];if(we.visibility==="none")continue;const pe=we.source||"";let ae=this.familiesBySource[pe];ae||(ae=this.familiesBySource[pe]={});const ge=we.sourceLayer||"_geojsonTileLayer";let he=ae[ge];he||(he=ae[ge]=[]),he.push(ne)}}}class k{constructor(N){const O={},W=[];for(const pe in N){const ae=N[pe],ge=O[pe]={};for(const he in ae){const ve=ae[+he];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Te={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};W.push(Te),ge[he]={rect:Te,metrics:ve.metrics}}}const{w:ee,h:ne}=c.p(W),we=new c.q({width:ee||1,height:ne||1});for(const pe in N){const ae=N[pe];for(const ge in ae){const he=ae[+ge];if(!he||he.bitmap.width===0||he.bitmap.height===0)continue;const ve=O[pe][ge].rect;c.q.copy(he.bitmap,we,{x:0,y:0},{x:ve.x+1,y:ve.y+1},he.bitmap)}}this.image=we,this.positions=O}}c.bm("GlyphAtlas",k);class L{constructor(N){this.tileID=new c.O(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(N,O,W,ee,ne){this.status="parsing",this.data=N,this.collisionBoxArray=new c.a3;const we=new c.bn(Object.keys(N.layers).sort()),pe=new c.bo(this.tileID,this.promoteId);pe.bucketLayerIDs=[];const ae={},ge={featureIndex:pe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},he=O.familiesBySource[this.source];for(const Ot in he){const Dt=N.layers[Ot];if(!Dt)continue;Dt.version===1&&c.w(`Vector tile source "${this.source}" layer "${Ot}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pi=we.encode(Ot),yn=[];for(let Xn=0;Xn<Dt.length;Xn++){const _i=Dt.feature(Xn),Sr=pe.getId(_i,Ot);yn.push({feature:_i,id:Sr,index:Xn,sourceLayerIndex:pi})}for(const Xn of he[Ot]){const _i=Xn[0];_i.source!==this.source&&c.w(`layer.source = ${_i.source} does not equal this.source = ${this.source}`),_i.minzoom&&this.zoom<Math.floor(_i.minzoom)||_i.maxzoom&&this.zoom>=_i.maxzoom||_i.visibility!=="none"&&(B(Xn,this.zoom,W),(ae[_i.id]=_i.createBucket({index:pe.bucketLayerIDs.length,layers:Xn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pi,sourceID:this.source})).populate(yn,ge,this.tileID.canonical),pe.bucketLayerIDs.push(Xn.map(Sr=>Sr.id)))}}let ve,Te,Qe,Ge;const Ue=c.aH(ge.glyphDependencies,Ot=>Object.keys(Ot).map(Number));this.inFlightDependencies.forEach(Ot=>Ot==null?void 0:Ot.cancel()),this.inFlightDependencies=[];const ct=++this.dependencySentinel;Object.keys(Ue).length?this.inFlightDependencies.push(ee.send("getGlyphs",{uid:this.uid,stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"},(Ot,Dt)=>{ct===this.dependencySentinel&&(ve||(ve=Ot,Te=Dt,cn.call(this)))})):Te={};const St=Object.keys(ge.iconDependencies);St.length?this.inFlightDependencies.push(ee.send("getImages",{icons:St,source:this.source,tileID:this.tileID,type:"icons"},(Ot,Dt)=>{ct===this.dependencySentinel&&(ve||(ve=Ot,Qe=Dt,cn.call(this)))})):Qe={};const Jt=Object.keys(ge.patternDependencies);function cn(){if(ve)return ne(ve);if(Te&&Qe&&Ge){const Ot=new k(Te),Dt=new c.bp(Qe,Ge);for(const pi in ae){const yn=ae[pi];yn instanceof c.a4?(B(yn.layers,this.zoom,W),c.bq({bucket:yn,glyphMap:Te,glyphPositions:Ot.positions,imageMap:Qe,imagePositions:Dt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):yn.hasPattern&&(yn instanceof c.br||yn instanceof c.bs||yn instanceof c.bt)&&(B(yn.layers,this.zoom,W),yn.addFeatures(ge,this.tileID.canonical,Dt.patternPositions))}this.status="done",ne(null,{buckets:Object.values(ae).filter(pi=>!pi.isEmpty()),featureIndex:pe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ot.image,imageAtlas:Dt,glyphMap:this.returnDependencies?Te:null,iconMap:this.returnDependencies?Qe:null,glyphPositions:this.returnDependencies?Ot.positions:null})}}Jt.length?this.inFlightDependencies.push(ee.send("getImages",{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"},(Ot,Dt)=>{ct===this.dependencySentinel&&(ve||(ve=Ot,Ge=Dt,cn.call(this)))})):Ge={},cn.call(this)}}function B(J,N,O){const W=new c.a8(N);for(const ee of J)ee.recalculate(W,O)}function F(J,N){const O=c.l(J.request,(W,ee,ne,we)=>{if(W)N(W);else if(ee)try{const pe=new c.bw.VectorTile(new c.bv(ee));N(null,{vectorTile:pe,rawData:ee,cacheControl:ne,expires:we})}catch(pe){const ae=new Uint8Array(ee);let ge=`Unable to parse the tile at ${J.request.url}, `;ge+=ae[0]===31&&ae[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${pe.messge}`,N(new Error(ge))}});return()=>{O.cancel(),N()}}class oe{constructor(N,O,W,ee){this.actor=N,this.layerIndex=O,this.availableImages=W,this.loadVectorData=ee||F,this.fetching={},this.loading={},this.loaded={}}loadTile(N,O){const W=N.uid;this.loading||(this.loading={});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new c.bu(N.request),ne=this.loading[W]=new L(N);ne.abort=this.loadVectorData(N,(we,pe)=>{if(delete this.loading[W],we||!pe)return ne.status="done",this.loaded[W]=ne,O(we);const ae=pe.rawData,ge={};pe.expires&&(ge.expires=pe.expires),pe.cacheControl&&(ge.cacheControl=pe.cacheControl);const he={};if(ee){const ve=ee.finish();ve&&(he.resourceTiming=JSON.parse(JSON.stringify(ve)))}ne.vectorTile=pe.vectorTile,ne.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,(ve,Te)=>{if(delete this.fetching[W],ve||!Te)return O(ve);O(null,c.e({rawTileData:ae.slice(0)},Te,ge,he))}),this.loaded=this.loaded||{},this.loaded[W]=ne,this.fetching[W]={rawTileData:ae,cacheControl:ge,resourceTiming:he}})}reloadTile(N,O){const W=this.loaded,ee=N.uid;if(W&&W[ee]){const ne=W[ee];ne.showCollisionBoxes=N.showCollisionBoxes,ne.status==="parsing"?ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,(we,pe)=>{if(we||!pe)return O(we,pe);let ae;if(this.fetching[ee]){const{rawTileData:ge,cacheControl:he,resourceTiming:ve}=this.fetching[ee];delete this.fetching[ee],ae=c.e({rawTileData:ge.slice(0)},pe,he,ve)}else ae=pe;O(null,ae)}):ne.status==="done"&&(ne.vectorTile?ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,O):O())}}abortTile(N,O){const W=this.loading,ee=N.uid;W&&W[ee]&&W[ee].abort&&(W[ee].abort(),delete W[ee]),O()}removeTile(N,O){const W=this.loaded,ee=N.uid;W&&W[ee]&&delete W[ee],O()}}class se{constructor(){this.loaded={}}loadTile(N,O){return c._(this,void 0,void 0,function*(){const{uid:W,encoding:ee,rawImageData:ne,redFactor:we,greenFactor:pe,blueFactor:ae,baseShift:ge}=N,he=ne.width+2,ve=ne.height+2,Te=c.a(ne)?new c.R({width:he,height:ve},yield c.bx(ne,-1,-1,he,ve)):ne,Qe=new c.by(W,Te,ee,we,pe,ae,ge);this.loaded=this.loaded||{},this.loaded[W]=Qe,O(null,Qe)})}removeTile(N){const O=this.loaded,W=N.uid;O&&O[W]&&delete O[W]}}function re(J,N){if(J.length!==0){ue(J[0],N);for(var O=1;O<J.length;O++)ue(J[O],!N)}}function ue(J,N){for(var O=0,W=0,ee=0,ne=J.length,we=ne-1;ee<ne;we=ee++){var pe=(J[ee][0]-J[we][0])*(J[we][1]+J[ee][1]),ae=O+pe;W+=Math.abs(O)>=Math.abs(pe)?O-ae+pe:pe-ae+O,O=ae}O+W>=0!=!!N&&J.reverse()}var Z=c.bz(function J(N,O){var W,ee=N&&N.type;if(ee==="FeatureCollection")for(W=0;W<N.features.length;W++)J(N.features[W],O);else if(ee==="GeometryCollection")for(W=0;W<N.geometries.length;W++)J(N.geometries[W],O);else if(ee==="Feature")J(N.geometry,O);else if(ee==="Polygon")re(N.coordinates,O);else if(ee==="MultiPolygon")for(W=0;W<N.coordinates.length;W++)re(N.coordinates[W],O);return N});const q=c.bw.VectorTileFeature.prototype.toGeoJSON;var G={exports:{}},fe=c.bA,xe=c.bw.VectorTileFeature,Ee=Ie;function Ie(J,N){this.options=N||{},this.features=J,this.length=J.length}function ke(J,N){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=N||4096}Ie.prototype.feature=function(J){return new ke(this.features[J],this.options.extent)},ke.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var N=0;N<J.length;N++){for(var O=J[N],W=[],ee=0;ee<O.length;ee++)W.push(new fe(O[ee][0],O[ee][1]));this.geometry.push(W)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,N=1/0,O=-1/0,W=1/0,ee=-1/0,ne=0;ne<J.length;ne++)for(var we=J[ne],pe=0;pe<we.length;pe++){var ae=we[pe];N=Math.min(N,ae.x),O=Math.max(O,ae.x),W=Math.min(W,ae.y),ee=Math.max(ee,ae.y)}return[N,W,O,ee]},ke.prototype.toGeoJSON=xe.prototype.toGeoJSON;var it=c.bB,Oe=Ee;function At(J){var N=new it;return function(O,W){for(var ee in O.layers)W.writeMessage(3,Ct,O.layers[ee])}(J,N),N.finish()}function Ct(J,N){var O;N.writeVarintField(15,J.version||1),N.writeStringField(1,J.name||""),N.writeVarintField(5,J.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<J.length;O++)W.feature=J.feature(O),N.writeMessage(2,It,W);var ee=W.keys;for(O=0;O<ee.length;O++)N.writeStringField(3,ee[O]);var ne=W.values;for(O=0;O<ne.length;O++)N.writeMessage(4,Re,ne[O])}function It(J,N){var O=J.feature;O.id!==void 0&&N.writeVarintField(1,O.id),N.writeMessage(2,Ut,J),N.writeVarintField(3,O.type),N.writeMessage(4,rt,O)}function Ut(J,N){var O=J.feature,W=J.keys,ee=J.values,ne=J.keycache,we=J.valuecache;for(var pe in O.properties){var ae=O.properties[pe],ge=ne[pe];if(ae!==null){ge===void 0&&(W.push(pe),ne[pe]=ge=W.length-1),N.writeVarint(ge);var he=typeof ae;he!=="string"&&he!=="boolean"&&he!=="number"&&(ae=JSON.stringify(ae));var ve=he+":"+ae,Te=we[ve];Te===void 0&&(ee.push(ae),we[ve]=Te=ee.length-1),N.writeVarint(Te)}}}function on(J,N){return(N<<3)+(7&J)}function Ve(J){return J<<1^J>>31}function rt(J,N){for(var O=J.loadGeometry(),W=J.type,ee=0,ne=0,we=O.length,pe=0;pe<we;pe++){var ae=O[pe],ge=1;W===1&&(ge=ae.length),N.writeVarint(on(1,ge));for(var he=W===3?ae.length-1:ae.length,ve=0;ve<he;ve++){ve===1&&W!==1&&N.writeVarint(on(2,he-1));var Te=ae[ve].x-ee,Qe=ae[ve].y-ne;N.writeVarint(Ve(Te)),N.writeVarint(Ve(Qe)),ee+=Te,ne+=Qe}W===3&&N.writeVarint(on(7,1))}}function Re(J,N){var O=typeof J;O==="string"?N.writeStringField(1,J):O==="boolean"?N.writeBooleanField(7,J):O==="number"&&(J%1!=0?N.writeDoubleField(3,J):J<0?N.writeSVarintField(6,J):N.writeVarintField(5,J))}G.exports=At,G.exports.fromVectorTileJs=At,G.exports.fromGeojsonVt=function(J,N){N=N||{};var O={};for(var W in J)O[W]=new Oe(J[W].features,N),O[W].name=W,O[W].version=N.version,O[W].extent=N.extent;return At({layers:O})},G.exports.GeoJSONWrapper=Oe;var at=c.bz(G.exports);const Ne={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},wt=Math.fround||(Rt=new Float32Array(1),J=>(Rt[0]=+J,Rt[0]));var Rt;const Ft=3,Nt=5,hn=6;class an{constructor(N){this.options=Object.assign(Object.create(Ne),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:O,minZoom:W,maxZoom:ee}=this.options;O&&console.time("total time");const ne=`prepare ${N.length} points`;O&&console.time(ne),this.points=N;const we=[];for(let ae=0;ae<N.length;ae++){const ge=N[ae];if(!ge.geometry)continue;const[he,ve]=ge.geometry.coordinates,Te=wt(Lt(he)),Qe=wt(tn(ve));we.push(Te,Qe,1/0,ae,-1,1),this.options.reduce&&we.push(0)}let pe=this.trees[ee+1]=this._createTree(we);O&&console.timeEnd(ne);for(let ae=ee;ae>=W;ae--){const ge=+Date.now();pe=this.trees[ae]=this._createTree(this._cluster(pe,ae)),O&&console.log("z%d: %d clusters in %dms",ae,pe.numItems,+Date.now()-ge)}return O&&console.timeEnd("total time"),this}getClusters(N,O){let W=((N[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,N[1]));let ne=N[2]===180?180:((N[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)W=-180,ne=180;else if(W>ne){const ve=this.getClusters([W,ee,180,we],O),Te=this.getClusters([-180,ee,ne,we],O);return ve.concat(Te)}const pe=this.trees[this._limitZoom(O)],ae=pe.range(Lt(W),tn(we),Lt(ne),tn(ee)),ge=pe.data,he=[];for(const ve of ae){const Te=this.stride*ve;he.push(ge[Te+Nt]>1?gn(ge,Te,this.clusterProps):this.points[ge[Te+Ft]])}return he}getChildren(N){const O=this._getOriginId(N),W=this._getOriginZoom(N),ee="No cluster with the specified id.",ne=this.trees[W];if(!ne)throw new Error(ee);const we=ne.data;if(O*this.stride>=we.length)throw new Error(ee);const pe=this.options.radius/(this.options.extent*Math.pow(2,W-1)),ae=ne.within(we[O*this.stride],we[O*this.stride+1],pe),ge=[];for(const he of ae){const ve=he*this.stride;we[ve+4]===N&&ge.push(we[ve+Nt]>1?gn(we,ve,this.clusterProps):this.points[we[ve+Ft]])}if(ge.length===0)throw new Error(ee);return ge}getLeaves(N,O,W){const ee=[];return this._appendLeaves(ee,N,O=O||10,W=W||0,0),ee}getTile(N,O,W){const ee=this.trees[this._limitZoom(N)],ne=Math.pow(2,N),{extent:we,radius:pe}=this.options,ae=pe/we,ge=(W-ae)/ne,he=(W+1+ae)/ne,ve={features:[]};return this._addTileFeatures(ee.range((O-ae)/ne,ge,(O+1+ae)/ne,he),ee.data,O,W,ne,ve),O===0&&this._addTileFeatures(ee.range(1-ae/ne,ge,1,he),ee.data,ne,W,ne,ve),O===ne-1&&this._addTileFeatures(ee.range(0,ge,ae/ne,he),ee.data,-1,W,ne,ve),ve.features.length?ve:null}getClusterExpansionZoom(N){let O=this._getOriginZoom(N)-1;for(;O<=this.options.maxZoom;){const W=this.getChildren(N);if(O++,W.length!==1)break;N=W[0].properties.cluster_id}return O}_appendLeaves(N,O,W,ee,ne){const we=this.getChildren(O);for(const pe of we){const ae=pe.properties;if(ae&&ae.cluster?ne+ae.point_count<=ee?ne+=ae.point_count:ne=this._appendLeaves(N,ae.cluster_id,W,ee,ne):ne<ee?ne++:N.push(pe),N.length===W)break}return ne}_createTree(N){const O=new c.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<N.length;W+=this.stride)O.add(N[W],N[W+1]);return O.finish(),O.data=N,O}_addTileFeatures(N,O,W,ee,ne,we){for(const pe of N){const ae=pe*this.stride,ge=O[ae+Nt]>1;let he,ve,Te;if(ge)he=gi(O,ae,this.clusterProps),ve=O[ae],Te=O[ae+1];else{const Ue=this.points[O[ae+Ft]];he=Ue.properties;const[ct,St]=Ue.geometry.coordinates;ve=Lt(ct),Te=tn(St)}const Qe={type:1,geometry:[[Math.round(this.options.extent*(ve*ne-W)),Math.round(this.options.extent*(Te*ne-ee))]],tags:he};let Ge;Ge=ge||this.options.generateId?O[ae+Ft]:this.points[O[ae+Ft]].id,Ge!==void 0&&(Qe.id=Ge),we.features.push(Qe)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,O){const{radius:W,extent:ee,reduce:ne,minPoints:we}=this.options,pe=W/(ee*Math.pow(2,O)),ae=N.data,ge=[],he=this.stride;for(let ve=0;ve<ae.length;ve+=he){if(ae[ve+2]<=O)continue;ae[ve+2]=O;const Te=ae[ve],Qe=ae[ve+1],Ge=N.within(ae[ve],ae[ve+1],pe),Ue=ae[ve+Nt];let ct=Ue;for(const St of Ge){const Jt=St*he;ae[Jt+2]>O&&(ct+=ae[Jt+Nt])}if(ct>Ue&&ct>=we){let St,Jt=Te*Ue,cn=Qe*Ue,Ot=-1;const Dt=((ve/he|0)<<5)+(O+1)+this.points.length;for(const pi of Ge){const yn=pi*he;if(ae[yn+2]<=O)continue;ae[yn+2]=O;const Xn=ae[yn+Nt];Jt+=ae[yn]*Xn,cn+=ae[yn+1]*Xn,ae[yn+4]=Dt,ne&&(St||(St=this._map(ae,ve,!0),Ot=this.clusterProps.length,this.clusterProps.push(St)),ne(St,this._map(ae,yn)))}ae[ve+4]=Dt,ge.push(Jt/ct,cn/ct,1/0,Dt,-1,ct),ne&&ge.push(Ot)}else{for(let St=0;St<he;St++)ge.push(ae[ve+St]);if(ct>1)for(const St of Ge){const Jt=St*he;if(!(ae[Jt+2]<=O)){ae[Jt+2]=O;for(let cn=0;cn<he;cn++)ge.push(ae[Jt+cn])}}}}return ge}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,O,W){if(N[O+Nt]>1){const we=this.clusterProps[N[O+hn]];return W?Object.assign({},we):we}const ee=this.points[N[O+Ft]].properties,ne=this.options.map(ee);return W&&ne===ee?Object.assign({},ne):ne}}function gn(J,N,O){return{type:"Feature",id:J[N+Ft],properties:gi(J,N,O),geometry:{type:"Point",coordinates:[(W=J[N],360*(W-.5)),qe(J[N+1])]}};var W}function gi(J,N,O){const W=J[N+Nt],ee=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,ne=J[N+hn],we=ne===-1?{}:Object.assign({},O[ne]);return Object.assign(we,{cluster:!0,cluster_id:J[N+Ft],point_count:W,point_count_abbreviated:ee})}function Lt(J){return J/360+.5}function tn(J){const N=Math.sin(J*Math.PI/180),O=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return O<0?0:O>1?1:O}function qe(J){const N=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function ut(J,N,O,W){for(var ee,ne=W,we=O-N>>1,pe=O-N,ae=J[N],ge=J[N+1],he=J[O],ve=J[O+1],Te=N+3;Te<O;Te+=3){var Qe=zt(J[Te],J[Te+1],ae,ge,he,ve);if(Qe>ne)ee=Te,ne=Qe;else if(Qe===ne){var Ge=Math.abs(Te-we);Ge<pe&&(ee=Te,pe=Ge)}}ne>W&&(ee-N>3&&ut(J,N,ee,W),J[ee+2]=ne,O-ee>3&&ut(J,ee,O,W))}function zt(J,N,O,W,ee,ne){var we=ee-O,pe=ne-W;if(we!==0||pe!==0){var ae=((J-O)*we+(N-W)*pe)/(we*we+pe*pe);ae>1?(O=ee,W=ne):ae>0&&(O+=we*ae,W+=pe*ae)}return(we=J-O)*we+(pe=N-W)*pe}function qt(J,N,O,W){var ee={id:J===void 0?null:J,type:N,geometry:O,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ne){var we=ne.geometry,pe=ne.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")en(ne,we);else if(pe==="Polygon"||pe==="MultiLineString")for(var ae=0;ae<we.length;ae++)en(ne,we[ae]);else if(pe==="MultiPolygon")for(ae=0;ae<we.length;ae++)for(var ge=0;ge<we[ae].length;ge++)en(ne,we[ae][ge])}(ee),ee}function en(J,N){for(var O=0;O<N.length;O+=3)J.minX=Math.min(J.minX,N[O]),J.minY=Math.min(J.minY,N[O+1]),J.maxX=Math.max(J.maxX,N[O]),J.maxY=Math.max(J.maxY,N[O+1])}function jt(J,N,O,W){if(N.geometry){var ee=N.geometry.coordinates,ne=N.geometry.type,we=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2),pe=[],ae=N.id;if(O.promoteId?ae=N.properties[O.promoteId]:O.generateId&&(ae=W||0),ne==="Point")_t(ee,pe);else if(ne==="MultiPoint")for(var ge=0;ge<ee.length;ge++)_t(ee[ge],pe);else if(ne==="LineString")ki(ee,pe,we,!1);else if(ne==="MultiLineString"){if(O.lineMetrics){for(ge=0;ge<ee.length;ge++)ki(ee[ge],pe=[],we,!1),J.push(qt(ae,"LineString",pe,N.properties));return}ms(ee,pe,we,!1)}else if(ne==="Polygon")ms(ee,pe,we,!0);else{if(ne!=="MultiPolygon"){if(ne==="GeometryCollection"){for(ge=0;ge<N.geometry.geometries.length;ge++)jt(J,{id:ae,geometry:N.geometry.geometries[ge],properties:N.properties},O,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<ee.length;ge++){var he=[];ms(ee[ge],he,we,!0),pe.push(he)}}J.push(qt(ae,ne,pe,N.properties))}}function _t(J,N){N.push(Me(J[0])),N.push(ti(J[1])),N.push(0)}function ki(J,N,O,W){for(var ee,ne,we=0,pe=0;pe<J.length;pe++){var ae=Me(J[pe][0]),ge=ti(J[pe][1]);N.push(ae),N.push(ge),N.push(0),pe>0&&(we+=W?(ee*ge-ae*ne)/2:Math.sqrt(Math.pow(ae-ee,2)+Math.pow(ge-ne,2))),ee=ae,ne=ge}var he=N.length-3;N[2]=1,ut(N,0,he,O),N[he+2]=1,N.size=Math.abs(we),N.start=0,N.end=N.size}function ms(J,N,O,W){for(var ee=0;ee<J.length;ee++){var ne=[];ki(J[ee],ne,O,W),N.push(ne)}}function Me(J){return J/360+.5}function ti(J){var N=Math.sin(J*Math.PI/180),O=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return O<0?0:O>1?1:O}function di(J,N,O,W,ee,ne,we,pe){if(W/=N,ne>=(O/=N)&&we<W)return J;if(we<O||ne>=W)return null;for(var ae=[],ge=0;ge<J.length;ge++){var he=J[ge],ve=he.geometry,Te=he.type,Qe=ee===0?he.minX:he.minY,Ge=ee===0?he.maxX:he.maxY;if(Qe>=O&&Ge<W)ae.push(he);else if(!(Ge<O||Qe>=W)){var Ue=[];if(Te==="Point"||Te==="MultiPoint")ln(ve,Ue,O,W,ee);else if(Te==="LineString")Ht(ve,Ue,O,W,ee,!1,pe.lineMetrics);else if(Te==="MultiLineString")Fr(ve,Ue,O,W,ee,!1);else if(Te==="Polygon")Fr(ve,Ue,O,W,ee,!0);else if(Te==="MultiPolygon")for(var ct=0;ct<ve.length;ct++){var St=[];Fr(ve[ct],St,O,W,ee,!0),St.length&&Ue.push(St)}if(Ue.length){if(pe.lineMetrics&&Te==="LineString"){for(ct=0;ct<Ue.length;ct++)ae.push(qt(he.id,Te,Ue[ct],he.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(Ue.length===1?(Te="LineString",Ue=Ue[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=Ue.length===3?"Point":"MultiPoint"),ae.push(qt(he.id,Te,Ue,he.tags))}}}return ae.length?ae:null}function ln(J,N,O,W,ee){for(var ne=0;ne<J.length;ne+=3){var we=J[ne+ee];we>=O&&we<=W&&(N.push(J[ne]),N.push(J[ne+1]),N.push(J[ne+2]))}}function Ht(J,N,O,W,ee,ne,we){for(var pe,ae,ge=rr(J),he=ee===0?so:gs,ve=J.start,Te=0;Te<J.length-3;Te+=3){var Qe=J[Te],Ge=J[Te+1],Ue=J[Te+2],ct=J[Te+3],St=J[Te+4],Jt=ee===0?Qe:Ge,cn=ee===0?ct:St,Ot=!1;we&&(pe=Math.sqrt(Math.pow(Qe-ct,2)+Math.pow(Ge-St,2))),Jt<O?cn>O&&(ae=he(ge,Qe,Ge,ct,St,O),we&&(ge.start=ve+pe*ae)):Jt>W?cn<W&&(ae=he(ge,Qe,Ge,ct,St,W),we&&(ge.start=ve+pe*ae)):wr(ge,Qe,Ge,Ue),cn<O&&Jt>=O&&(ae=he(ge,Qe,Ge,ct,St,O),Ot=!0),cn>W&&Jt<=W&&(ae=he(ge,Qe,Ge,ct,St,W),Ot=!0),!ne&&Ot&&(we&&(ge.end=ve+pe*ae),N.push(ge),ge=rr(J)),we&&(ve+=pe)}var Dt=J.length-3;Qe=J[Dt],Ge=J[Dt+1],Ue=J[Dt+2],(Jt=ee===0?Qe:Ge)>=O&&Jt<=W&&wr(ge,Qe,Ge,Ue),Dt=ge.length-3,ne&&Dt>=3&&(ge[Dt]!==ge[0]||ge[Dt+1]!==ge[1])&&wr(ge,ge[0],ge[1],ge[2]),ge.length&&N.push(ge)}function rr(J){var N=[];return N.size=J.size,N.start=J.start,N.end=J.end,N}function Fr(J,N,O,W,ee,ne){for(var we=0;we<J.length;we++)Ht(J[we],N,O,W,ee,ne,!1)}function wr(J,N,O,W){J.push(N),J.push(O),J.push(W)}function so(J,N,O,W,ee,ne){var we=(ne-N)/(W-N);return J.push(ne),J.push(O+(ee-O)*we),J.push(1),we}function gs(J,N,O,W,ee,ne){var we=(ne-O)/(ee-O);return J.push(N+(W-N)*we),J.push(ne),J.push(1),we}function Br(J,N){for(var O=[],W=0;W<J.length;W++){var ee,ne=J[W],we=ne.type;if(we==="Point"||we==="MultiPoint"||we==="LineString")ee=Nr(ne.geometry,N);else if(we==="MultiLineString"||we==="Polygon"){ee=[];for(var pe=0;pe<ne.geometry.length;pe++)ee.push(Nr(ne.geometry[pe],N))}else if(we==="MultiPolygon")for(ee=[],pe=0;pe<ne.geometry.length;pe++){for(var ae=[],ge=0;ge<ne.geometry[pe].length;ge++)ae.push(Nr(ne.geometry[pe][ge],N));ee.push(ae)}O.push(qt(ne.id,we,ee,ne.tags))}return O}function Nr(J,N){var O=[];O.size=J.size,J.start!==void 0&&(O.start=J.start,O.end=J.end);for(var W=0;W<J.length;W+=3)O.push(J[W]+N,J[W+1],J[W+2]);return O}function Ze(J,N){if(J.transformed)return J;var O,W,ee,ne=1<<J.z,we=J.x,pe=J.y;for(O=0;O<J.features.length;O++){var ae=J.features[O],ge=ae.geometry,he=ae.type;if(ae.geometry=[],he===1)for(W=0;W<ge.length;W+=2)ae.geometry.push(sr(ge[W],ge[W+1],N,ne,we,pe));else for(W=0;W<ge.length;W++){var ve=[];for(ee=0;ee<ge[W].length;ee+=2)ve.push(sr(ge[W][ee],ge[W][ee+1],N,ne,we,pe));ae.geometry.push(ve)}}return J.transformed=!0,J}function sr(J,N,O,W,ee,ne){return[Math.round(O*(J*W-ee)),Math.round(O*(N*W-ne))]}function Sn(J,N,O,W,ee){for(var ne=N===ee.maxZoom?0:ee.tolerance/((1<<N)*ee.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:O,y:W,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pe=0;pe<J.length;pe++){we.numFeatures++,ys(we,J[pe],ne,ee);var ae=J[pe].minX,ge=J[pe].minY,he=J[pe].maxX,ve=J[pe].maxY;ae<we.minX&&(we.minX=ae),ge<we.minY&&(we.minY=ge),he>we.maxX&&(we.maxX=he),ve>we.maxY&&(we.maxY=ve)}return we}function ys(J,N,O,W){var ee=N.geometry,ne=N.type,we=[];if(ne==="Point"||ne==="MultiPoint")for(var pe=0;pe<ee.length;pe+=3)we.push(ee[pe]),we.push(ee[pe+1]),J.numPoints++,J.numSimplified++;else if(ne==="LineString")Jr(we,ee,J,O,!1,!1);else if(ne==="MultiLineString"||ne==="Polygon")for(pe=0;pe<ee.length;pe++)Jr(we,ee[pe],J,O,ne==="Polygon",pe===0);else if(ne==="MultiPolygon")for(var ae=0;ae<ee.length;ae++){var ge=ee[ae];for(pe=0;pe<ge.length;pe++)Jr(we,ge[pe],J,O,!0,pe===0)}if(we.length){var he=N.tags||null;if(ne==="LineString"&&W.lineMetrics){for(var ve in he={},N.tags)he[ve]=N.tags[ve];he.mapbox_clip_start=ee.start/ee.size,he.mapbox_clip_end=ee.end/ee.size}var Te={geometry:we,type:ne==="Polygon"||ne==="MultiPolygon"?3:ne==="LineString"||ne==="MultiLineString"?2:1,tags:he};N.id!==null&&(Te.id=N.id),J.features.push(Te)}}function Jr(J,N,O,W,ee,ne){var we=W*W;if(W>0&&N.size<(ee?we:W))O.numPoints+=N.length/3;else{for(var pe=[],ae=0;ae<N.length;ae+=3)(W===0||N[ae+2]>we)&&(O.numSimplified++,pe.push(N[ae]),pe.push(N[ae+1])),O.numPoints++;ee&&function(ge,he){for(var ve=0,Te=0,Qe=ge.length,Ge=Qe-2;Te<Qe;Ge=Te,Te+=2)ve+=(ge[Te]-ge[Ge])*(ge[Te+1]+ge[Ge+1]);if(ve>0===he)for(Te=0,Qe=ge.length;Te<Qe/2;Te+=2){var Ue=ge[Te],ct=ge[Te+1];ge[Te]=ge[Qe-2-Te],ge[Te+1]=ge[Qe-1-Te],ge[Qe-2-Te]=Ue,ge[Qe-1-Te]=ct}}(pe,ne),J.push(pe)}}function He(J,N){var O=(N=this.options=function(ee,ne){for(var we in ne)ee[we]=ne[we];return ee}(Object.create(this.options),N)).debug;if(O&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function(ee,ne){var we=[];if(ee.type==="FeatureCollection")for(var pe=0;pe<ee.features.length;pe++)jt(we,ee.features[pe],ne,pe);else jt(we,ee.type==="Feature"?ee:{geometry:ee},ne);return we}(J,N);this.tiles={},this.tileCoords=[],O&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),W=function(ee,ne){var we=ne.buffer/ne.extent,pe=ee,ae=di(ee,1,-1-we,we,0,-1,2,ne),ge=di(ee,1,1-we,2+we,0,-1,2,ne);return(ae||ge)&&(pe=di(ee,1,-we,1+we,0,-1,2,ne)||[],ae&&(pe=Br(ae,1).concat(pe)),ge&&(pe=pe.concat(Br(ge,-1)))),pe}(W,N),W.length&&this.splitTile(W,0,0,0),O&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Tt(J,N,O){return 32*((1<<J)*O+N)+J}function bt(J,N){return N?J.properties[N]:J.id}function Nn(J,N){if(J==null)return!0;if(J.type==="Feature")return bt(J,N)!=null;if(J.type==="FeatureCollection"){const O=new Set;for(const W of J.features){const ee=bt(W,N);if(ee==null||O.has(ee))return!1;O.add(ee)}return!0}return!1}function yi(J,N){const O=new Map;if(J!=null)if(J.type==="Feature")O.set(bt(J,N),J);else for(const W of J.features)O.set(bt(W,N),W);return O}He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},He.prototype.splitTile=function(J,N,O,W,ee,ne,we){for(var pe=[J,N,O,W],ae=this.options,ge=ae.debug;pe.length;){W=pe.pop(),O=pe.pop(),N=pe.pop(),J=pe.pop();var he=1<<N,ve=Tt(N,O,W),Te=this.tiles[ve];if(!Te&&(ge>1&&console.time("creation"),Te=this.tiles[ve]=Sn(J,N,O,W,ae),this.tileCoords.push({z:N,x:O,y:W}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,O,W,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var Qe="z"+N;this.stats[Qe]=(this.stats[Qe]||0)+1,this.total++}if(Te.source=J,ee){if(N===ae.maxZoom||N===ee)continue;var Ge=1<<ee-N;if(O!==Math.floor(ne/Ge)||W!==Math.floor(we/Ge))continue}else if(N===ae.indexMaxZoom||Te.numPoints<=ae.indexMaxPoints)continue;if(Te.source=null,J.length!==0){ge>1&&console.time("clipping");var Ue,ct,St,Jt,cn,Ot,Dt=.5*ae.buffer/ae.extent,pi=.5-Dt,yn=.5+Dt,Xn=1+Dt;Ue=ct=St=Jt=null,cn=di(J,he,O-Dt,O+yn,0,Te.minX,Te.maxX,ae),Ot=di(J,he,O+pi,O+Xn,0,Te.minX,Te.maxX,ae),J=null,cn&&(Ue=di(cn,he,W-Dt,W+yn,1,Te.minY,Te.maxY,ae),ct=di(cn,he,W+pi,W+Xn,1,Te.minY,Te.maxY,ae),cn=null),Ot&&(St=di(Ot,he,W-Dt,W+yn,1,Te.minY,Te.maxY,ae),Jt=di(Ot,he,W+pi,W+Xn,1,Te.minY,Te.maxY,ae),Ot=null),ge>1&&console.timeEnd("clipping"),pe.push(Ue||[],N+1,2*O,2*W),pe.push(ct||[],N+1,2*O,2*W+1),pe.push(St||[],N+1,2*O+1,2*W),pe.push(Jt||[],N+1,2*O+1,2*W+1)}}},He.prototype.getTile=function(J,N,O){var W=this.options,ee=W.extent,ne=W.debug;if(J<0||J>24)return null;var we=1<<J,pe=Tt(J,N=(N%we+we)%we,O);if(this.tiles[pe])return Ze(this.tiles[pe],ee);ne>1&&console.log("drilling down to z%d-%d-%d",J,N,O);for(var ae,ge=J,he=N,ve=O;!ae&&ge>0;)ge--,he=Math.floor(he/2),ve=Math.floor(ve/2),ae=this.tiles[Tt(ge,he,ve)];return ae&&ae.source?(ne>1&&console.log("found parent tile z%d-%d-%d",ge,he,ve),ne>1&&console.time("drilling down"),this.splitTile(ae.source,ge,he,ve,J,N,O),ne>1&&console.timeEnd("drilling down"),this.tiles[pe]?Ze(this.tiles[pe],ee):null):null};class Et extends oe{constructor(N,O,W,ee){super(N,O,W),this._dataUpdateable=new Map,this.loadGeoJSON=(ne,we)=>{const{promoteId:pe}=ne;if(ne.request)return c.f(ne.request,(ae,ge,he,ve)=>{this._dataUpdateable=Nn(ge,pe)?yi(ge,pe):void 0,we(ae,ge,he,ve)});if(typeof ne.data=="string")try{const ae=JSON.parse(ne.data);this._dataUpdateable=Nn(ae,pe)?yi(ae,pe):void 0,we(null,ae)}catch{we(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}else ne.dataDiff?this._dataUpdateable?(function(ae,ge,he){var ve,Te,Qe,Ge;if(ge.removeAll&&ae.clear(),ge.remove)for(const Ue of ge.remove)ae.delete(Ue);if(ge.add)for(const Ue of ge.add){const ct=bt(Ue,he);ct!=null&&ae.set(ct,Ue)}if(ge.update)for(const Ue of ge.update){let ct=ae.get(Ue.id);if(ct==null)continue;const St=!Ue.removeAllProperties&&(((ve=Ue.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((Te=Ue.addOrUpdateProperties)===null||Te===void 0?void 0:Te.length)>0);if((Ue.newGeometry||Ue.removeAllProperties||St)&&(ct=Object.assign({},ct),ae.set(Ue.id,ct),St&&(ct.properties=Object.assign({},ct.properties))),Ue.newGeometry&&(ct.geometry=Ue.newGeometry),Ue.removeAllProperties)ct.properties={};else if(((Qe=Ue.removeProperties)===null||Qe===void 0?void 0:Qe.length)>0)for(const Jt of Ue.removeProperties)Object.prototype.hasOwnProperty.call(ct.properties,Jt)&&delete ct.properties[Jt];if(((Ge=Ue.addOrUpdateProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const{key:Jt,value:cn}of Ue.addOrUpdateProperties)ct.properties[Jt]=cn}}(this._dataUpdateable,ne.dataDiff,pe),we(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):we(new Error(`Cannot update existing geojson data in ${ne.source}`)):we(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,ee&&(this.loadGeoJSON=ee)}loadGeoJSONTile(N,O){const W=N.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);const ee=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ee)return O(null,null);const ne=new class{constructor(pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.N,this.length=pe.length,this._features=pe}feature(pe){return new class{constructor(ae){this._feature=ae,this.extent=c.N,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const ge of this._feature.geometry)ae.push([new c.P(ge[0],ge[1])]);return ae}{const ae=[];for(const ge of this._feature.geometry){const he=[];for(const ve of ge)he.push(new c.P(ve[0],ve[1]));ae.push(he)}return ae}}toGeoJSON(ae,ge,he){return q.call(this,ae,ge,he)}}(this._features[pe])}}(ee.features);let we=at(ne);we.byteOffset===0&&we.byteLength===we.buffer.byteLength||(we=new Uint8Array(we)),O(null,{vectorTile:ne,rawData:we.buffer})}loadData(N,O){var W;(W=this._pendingRequest)===null||W===void 0||W.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new c.bu(N.request);this._pendingCallback=O,this._pendingRequest=this.loadGeoJSON(N,(ne,we)=>{if(delete this._pendingCallback,delete this._pendingRequest,ne||!we)return O(ne);if(typeof we!="object")return O(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{Z(we,!0);try{if(N.filter){const ae=c.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ae.result==="error")throw new Error(ae.value.map(he=>`${he.key}: ${he.message}`).join(", "));we={type:"FeatureCollection",features:we.features.filter(he=>ae.value.evaluate({zoom:0},he))}}this._geoJSONIndex=N.cluster?new an(function({superclusterOptions:ae,clusterProperties:ge}){if(!ge||!ae)return ae;const he={},ve={},Te={accumulated:null,zoom:0},Qe={properties:null},Ge=Object.keys(ge);for(const Ue of Ge){const[ct,St]=ge[Ue],Jt=c.bC(St),cn=c.bC(typeof ct=="string"?[ct,["accumulated"],["get",Ue]]:ct);he[Ue]=Jt.value,ve[Ue]=cn.value}return ae.map=Ue=>{Qe.properties=Ue;const ct={};for(const St of Ge)ct[St]=he[St].evaluate(Te,Qe);return ct},ae.reduce=(Ue,ct)=>{Qe.properties=ct;for(const St of Ge)Te.accumulated=Ue[St],Ue[St]=ve[St].evaluate(Te,Qe)},ae}(N)).load(we.features):function(ae,ge){return new He(ae,ge)}(we,N.geojsonVtOptions)}catch(ae){return O(ae)}this.loaded={};const pe={};if(ee){const ae=ee.finish();ae&&(pe.resourceTiming={},pe.resourceTiming[N.source]=JSON.parse(JSON.stringify(ae)))}O(null,pe)}})}reloadTile(N,O){const W=this.loaded;return W&&W[N.uid]?super.reloadTile(N,O):this.loadTile(N,O)}removeSource(N,O){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),O()}getClusterExpansionZoom(N,O){try{O(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(W){O(W)}}getClusterChildren(N,O){try{O(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(W){O(W)}}getClusterLeaves(N,O){try{O(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(W){O(W)}}}class br{constructor(N){this.self=N,this.actor=new c.C(N,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:oe,geojson:Et},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(O,W)=>{if(this.workerSourceTypes[O])throw new Error(`Worker source with name "${O}" already registered.`);this.workerSourceTypes[O]=W},this.self.registerRTLTextPlugin=O=>{if(c.bD.isParsed())throw new Error("RTL text plugin already registered.");c.bD.applyArabicShaping=O.applyArabicShaping,c.bD.processBidirectionalText=O.processBidirectionalText,c.bD.processStyledBidirectionalText=O.processStyledBidirectionalText}}setReferrer(N,O){this.referrer=O}setImages(N,O,W){this.availableImages[N]=O;for(const ee in this.workerSources[N]){const ne=this.workerSources[N][ee];for(const we in ne)ne[we].availableImages=O}W()}setLayers(N,O,W){this.getLayerIndex(N).replace(O),W()}updateLayers(N,O,W){this.getLayerIndex(N).update(O.layers,O.removedIds),W()}loadTile(N,O,W){this.getWorkerSource(N,O.type,O.source).loadTile(O,W)}loadDEMTile(N,O,W){this.getDEMWorkerSource(N,O.source).loadTile(O,W)}reloadTile(N,O,W){this.getWorkerSource(N,O.type,O.source).reloadTile(O,W)}abortTile(N,O,W){this.getWorkerSource(N,O.type,O.source).abortTile(O,W)}removeTile(N,O,W){this.getWorkerSource(N,O.type,O.source).removeTile(O,W)}removeDEMTile(N,O){this.getDEMWorkerSource(N,O.source).removeTile(O)}removeSource(N,O,W){if(!this.workerSources[N]||!this.workerSources[N][O.type]||!this.workerSources[N][O.type][O.source])return;const ee=this.workerSources[N][O.type][O.source];delete this.workerSources[N][O.type][O.source],ee.removeSource!==void 0?ee.removeSource(O,W):W()}loadWorkerSource(N,O,W){try{this.self.importScripts(O.url),W()}catch(ee){W(ee.toString())}}syncRTLPluginState(N,O,W){try{c.bD.setState(O);const ee=c.bD.getPluginURL();if(c.bD.isLoaded()&&!c.bD.isParsed()&&ee!=null){this.self.importScripts(ee);const ne=c.bD.isParsed();W(ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),ne)}}catch(ee){W(ee.toString())}}getAvailableImages(N){let O=this.availableImages[N];return O||(O=[]),O}getLayerIndex(N){let O=this.layerIndexes[N];return O||(O=this.layerIndexes[N]=new C),O}getWorkerSource(N,O,W){return this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][O]||(this.workerSources[N][O]={}),this.workerSources[N][O][W]||(this.workerSources[N][O][W]=new this.workerSourceTypes[O]({send:(ee,ne,we)=>{this.actor.send(ee,ne,we,N)}},this.getLayerIndex(N),this.getAvailableImages(N))),this.workerSources[N][O][W]}getDEMWorkerSource(N,O){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][O]||(this.demWorkerSources[N][O]=new se),this.demWorkerSources[N][O]}}return c.i()&&(self.worker=new br(self)),br}),g(["./shared"],function(c){var C="3.6.2";class k{static testProp(i){if(!k.docStyle)return i[0];for(let l=0;l<i.length;l++)if(i[l]in k.docStyle)return i[l];return i[0]}static create(i,l,d){const f=window.document.createElement(i);return l!==void 0&&(f.className=l),d&&d.appendChild(f),f}static createNS(i,l){return window.document.createElementNS(i,l)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(i,l){i.style[k.transformProp]=l}static addEventListener(i,l,d,f={}){i.addEventListener(l,d,"passive"in f?f:f.capture)}static removeEventListener(i,l,d,f={}){i.removeEventListener(l,d,"passive"in f?f:f.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",k.suppressClickInternal,!0)},0)}static mousePos(i,l){const d=i.getBoundingClientRect();return new c.P(l.clientX-d.left-i.clientLeft,l.clientY-d.top-i.clientTop)}static touchPos(i,l){const d=i.getBoundingClientRect(),f=[];for(let _=0;_<l.length;_++)f.push(new c.P(l[_].clientX-d.left-i.clientLeft,l[_].clientY-d.top-i.clientTop));return f}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);const L={supported:!1,testSupport:function(m){!oe&&F&&(se?re(m):B=m)}};let B,F,oe=!1,se=!1;function re(m){const i=m.createTexture();m.bindTexture(m.TEXTURE_2D,i);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,F),m.isContextLost())return;L.supported=!0}catch{}m.deleteTexture(i),oe=!0}var ue,Z;typeof document<"u"&&(F=document.createElement("img"),F.onload=function(){B&&re(B),B=null,se=!0},F.onerror=function(){oe=!0,B=null},F.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let i,l,d,f;m.resetRequestQueue=()=>{i=[],l=0,d=0,f={}},m.addThrottleControl=A=>{const M=d++;return f[M]=A,M},m.removeThrottleControl=A=>{delete f[A],S()},m.getImage=(A,M,z=!0)=>{L.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*");const V={requestParameters:A,supportImageRefresh:z,callback:M,cancelled:!1,completed:!1,cancel:()=>{V.completed||V.cancelled||(V.cancelled=!0,V.innerRequest&&(V.innerRequest.cancel(),l--),S())}};return i.push(V),S(),V};const _=A=>{const{requestParameters:M,supportImageRefresh:z,callback:V}=A;return c.e(M,{type:"image"}),(z!==!1||c.i()||c.g(M.url)||M.headers&&!Object.keys(M.headers).reduce((Y,X)=>Y&&X==="accept",!0)?c.m:E)(M,(Y,X,Q,H)=>{b(A,V,Y,X,Q,H)})},b=(A,M,z,V,Y,X)=>{z?M(z):V instanceof HTMLImageElement||c.a(V)?M(null,V):V&&((Q,H)=>{typeof createImageBitmap=="function"?c.b(Q,H):c.d(Q,H)})(V,(Q,H)=>{Q!=null?M(Q):H!=null&&M(null,H,{cacheControl:Y,expires:X})}),A.cancelled||(A.completed=!0,l--,S())},S=()=>{const A=(()=>{const M=Object.keys(f);let z=!1;if(M.length>0){for(const V of M)if(z=f[V](),z)break}return z})()?c.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=l;M<A&&i.length>0;M++){const z=i.shift();if(z.cancelled){M--;continue}const V=_(z);l++,z.innerRequest=V}},E=(A,M)=>{const z=new Image,V=A.url;let Y=!1;const X=A.credentials;return X&&X==="include"?z.crossOrigin="use-credentials":(X&&X==="same-origin"||!c.s(V))&&(z.crossOrigin="anonymous"),z.fetchPriority="high",z.onload=()=>{M(null,z),z.onerror=z.onload=null},z.onerror=()=>{Y||M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),z.onerror=z.onload=null},z.src=V,{cancel:()=>{Y=!0,z.src=""}}}}(ue||(ue={})),ue.resetRequestQueue(),function(m){m.Glyphs="Glyphs",m.Image="Image",m.Source="Source",m.SpriteImage="SpriteImage",m.SpriteJSON="SpriteJSON",m.Style="Style",m.Tile="Tile",m.Unknown="Unknown"}(Z||(Z={}));class q{constructor(i){this._transformRequestFn=i}transformRequest(i,l){return this._transformRequestFn&&this._transformRequestFn(i,l)||{url:i}}normalizeSpriteURL(i,l,d){const f=function(_){const b=_.match(G);if(!b)throw new Error(`Unable to parse URL "${_}"`);return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}(i);return f.path+=`${l}${d}`,function(_){const b=_.params.length?`?${_.params.join("&")}`:"";return`${_.protocol}://${_.authority}${_.path}${b}`}(f)}setTransformRequest(i){this._transformRequestFn=i}}const G=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function fe(m){var i=new c.A(3);return i[0]=m[0],i[1]=m[1],i[2]=m[2],i}var xe,Ee=function(m,i,l){return m[0]=i[0]-l[0],m[1]=i[1]-l[1],m[2]=i[2]-l[2],m};xe=new c.A(3),c.A!=Float32Array&&(xe[0]=0,xe[1]=0,xe[2]=0);var Ie=function(m){var i=m[0],l=m[1];return i*i+l*l};function ke(m){const i=[];if(typeof m=="string")i.push({id:"default",url:m});else if(m&&m.length>0){const l=[];for(const{id:d,url:f}of m){const _=`${d}${f}`;l.indexOf(_)===-1&&(l.push(_),i.push({id:d,url:f}))}}return i}function it(m,i,l,d,f){if(d)return void m(d);if(f!==Object.values(i).length||f!==Object.values(l).length)return;const _={};for(const b in i){_[b]={};const S=c.h.getImageCanvasContext(l[b]),E=i[b];for(const A in E){const{width:M,height:z,x:V,y:Y,sdf:X,pixelRatio:Q,stretchX:H,stretchY:me,content:Se}=E[A];_[b][A]={data:null,pixelRatio:Q,sdf:X,stretchX:H,stretchY:me,content:Se,spriteData:{width:M,height:z,x:V,y:Y,context:S}}}}m(null,_)}(function(){var m=new c.A(2);c.A!=Float32Array&&(m[0]=0,m[1]=0)})();class Oe{constructor(i,l,d,f){this.context=i,this.format=d,this.texture=i.gl.createTexture(),this.update(l,f)}update(i,l,d){const{width:f,height:_}=i,b=!(this.size&&this.size[0]===f&&this.size[1]===_||d),{context:S}=this,{gl:E}=S;if(this.useMipmap=!!(l&&l.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!l||l.premultiply!==!1)),b)this.size=[f,_],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.a(i)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,i):E.texImage2D(E.TEXTURE_2D,0,this.format,f,_,0,this.format,E.UNSIGNED_BYTE,i.data);else{const{x:A,y:M}=d||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.a(i)?E.texSubImage2D(E.TEXTURE_2D,0,A,M,E.RGBA,E.UNSIGNED_BYTE,i):E.texSubImage2D(E.TEXTURE_2D,0,A,M,f,_,E.RGBA,E.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(i,l,d){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),d!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=_.LINEAR),i!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,d||i),this.filter=i),l!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,l),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function At(m){const{userImage:i}=m;return!!(i&&i.render&&i.render())&&(m.data.replace(new Uint8Array(i.data.buffer)),!0)}class Ct extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:l,callback:d}of this.requestors)this._notify(l,d);this.requestors=[]}}getImage(i){const l=this.images[i];if(l&&!l.data&&l.spriteData){const d=l.spriteData;l.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),l.spriteData=null}return l}addImage(i,l){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,l)&&(this.images[i]=l)}_validate(i,l){let d=!0;const f=l.data||l.spriteData;return this._validateStretch(l.stretchX,f&&f.width)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchX" value`))),d=!1),this._validateStretch(l.stretchY,f&&f.height)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchY" value`))),d=!1),this._validateContent(l.content,l)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "content" value`))),d=!1),d}_validateStretch(i,l){if(!i)return!0;let d=0;for(const f of i){if(f[0]<d||f[1]<f[0]||l<f[1])return!1;d=f[1]}return!0}_validateContent(i,l){if(!i)return!0;if(i.length!==4)return!1;const d=l.spriteData,f=d&&d.width||l.data.width,_=d&&d.height||l.data.height;return!(i[0]<0||f<i[0]||i[1]<0||_<i[1]||i[2]<0||f<i[2]||i[3]<0||_<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,l,d=!0){const f=this.getImage(i);if(d&&(f.data.width!==l.data.width||f.data.height!==l.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=f.version+1,this.images[i]=l,this.updatedImages[i]=!0}removeImage(i){const l=this.images[i];delete this.images[i],delete this.patterns[i],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,l){let d=!0;if(!this.isLoaded())for(const f of i)this.images[f]||(d=!1);this.isLoaded()||d?this._notify(i,l):this.requestors.push({ids:i,callback:l})}_notify(i,l){const d={};for(const f of i){let _=this.getImage(f);_||(this.fire(new c.k("styleimagemissing",{id:f})),_=this.getImage(f)),_?d[f]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,d)}getPixelSize(){const{width:i,height:l}=this.atlasImage;return{width:i,height:l}}getPattern(i){const l=this.patterns[i],d=this.getImage(i);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},_=new c.I(f,d);this.patterns[i]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const l=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Oe(i,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const _ in this.patterns)i.push(this.patterns[_].bin);const{w:l,h:d}=c.p(i),f=this.atlasImage;f.resize({width:l||1,height:d||1});for(const _ in this.patterns){const{bin:b}=this.patterns[_],S=b.x+1,E=b.y+1,A=this.getImage(_).data,M=A.width,z=A.height;c.R.copy(A,f,{x:0,y:0},{x:S,y:E},{width:M,height:z}),c.R.copy(A,f,{x:0,y:z-1},{x:S,y:E-1},{width:M,height:1}),c.R.copy(A,f,{x:0,y:0},{x:S,y:E+z},{width:M,height:1}),c.R.copy(A,f,{x:M-1,y:0},{x:S-1,y:E},{width:1,height:z}),c.R.copy(A,f,{x:0,y:0},{x:S+M,y:E},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const l of i){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const d=this.getImage(l);d||c.w(`Image with ID: "${l}" was not found`),At(d)&&this.updateImage(l,d)}}}const It=1e20;function Ut(m,i,l,d,f,_,b,S,E){for(let A=i;A<i+d;A++)on(m,l*_+A,_,f,b,S,E);for(let A=l;A<l+f;A++)on(m,A*_+i,1,d,b,S,E)}function on(m,i,l,d,f,_,b){_[0]=0,b[0]=-It,b[1]=It,f[0]=m[i];for(let S=1,E=0,A=0;S<d;S++){f[S]=m[i+S*l];const M=S*S;do{const z=_[E];A=(f[S]-f[z]+M-z*z)/(S-z)/2}while(A<=b[E]&&--E>-1);E++,_[E]=S,b[E]=A,b[E+1]=It}for(let S=0,E=0;S<d;S++){for(;b[E+1]<S;)E++;const A=_[E],M=S-A;m[i+S*l]=f[A]+M*M}}class Ve{constructor(i,l){this.requestManager=i,this.localIdeographFontFamily=l,this.entries={}}setURL(i){this.url=i}getGlyphs(i,l){const d=[];for(const f in i)for(const _ of i[f])d.push({stack:f,id:_});c.o(d,({stack:f,id:_},b)=>{let S=this.entries[f];S||(S=this.entries[f]={glyphs:{},requests:{},ranges:{}});let E=S.glyphs[_];if(E!==void 0)return void b(null,{stack:f,id:_,glyph:E});if(E=this._tinySDF(S,f,_),E)return S.glyphs[_]=E,void b(null,{stack:f,id:_,glyph:E});const A=Math.floor(_/256);if(256*A>65535)return void b(new Error("glyphs > 65535 not supported"));if(S.ranges[A])return void b(null,{stack:f,id:_,glyph:E});if(!this.url)return void b(new Error("glyphsUrl is not set"));let M=S.requests[A];M||(M=S.requests[A]=[],Ve.loadGlyphRange(f,A,this.url,this.requestManager,(z,V)=>{if(V){for(const Y in V)this._doesCharSupportLocalGlyph(+Y)||(S.glyphs[+Y]=V[+Y]);S.ranges[A]=!0}for(const Y of M)Y(z,V);delete S.requests[A]})),M.push((z,V)=>{z?b(z):V&&b(null,{stack:f,id:_,glyph:V[_]||null})})},(f,_)=>{if(f)l(f);else if(_){const b={};for(const{stack:S,id:E,glyph:A}of _)(b[S]||(b[S]={}))[E]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};l(null,b)}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](i)||c.u["Hangul Syllables"](i)||c.u.Hiragana(i)||c.u.Katakana(i))}_tinySDF(i,l,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let _=i.tinySDF;if(!_){let S="400";/bold/i.test(l)?S="900":/medium/i.test(l)?S="500":/light/i.test(l)&&(S="200"),_=i.tinySDF=new Ve.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:S})}const b=_.draw(String.fromCharCode(d));return{id:d,bitmap:new c.q({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ve.loadGlyphRange=function(m,i,l,d,f){const _=256*i,b=_+255,S=d.transformRequest(l.replace("{fontstack}",m).replace("{range}",`${_}-${b}`),Z.Glyphs);c.l(S,(E,A)=>{if(E)f(E);else if(A){const M={};for(const z of c.n(A))M[z.id]=z;f(null,M)}})},Ve.TinySDF=class{constructor({fontSize:m=24,buffer:i=3,radius:l=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:b="normal"}={}){this.buffer=i,this.cutoff=d,this.radius=l;const S=this.size=m+4*i,E=this._createCanvas(S),A=this.ctx=E.getContext("2d",{willReadFrequently:!0});A.font=`${b} ${_} ${m}px ${f}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(m){const i=document.createElement("canvas");return i.width=i.height=m,i}draw(m){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(m),b=Math.ceil(l),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),E=Math.min(this.size-this.buffer,b+Math.ceil(d)),A=S+2*this.buffer,M=E+2*this.buffer,z=Math.max(A*M,0),V=new Uint8ClampedArray(z),Y={data:V,width:A,height:M,glyphWidth:S,glyphHeight:E,glyphTop:b,glyphLeft:0,glyphAdvance:i};if(S===0||E===0)return Y;const{ctx:X,buffer:Q,gridInner:H,gridOuter:me}=this;X.clearRect(Q,Q,S,E),X.fillText(m,Q,Q+b);const Se=X.getImageData(Q,Q,S,E);me.fill(It,0,z),H.fill(0,0,z);for(let ie=0;ie<E;ie++)for(let ye=0;ye<S;ye++){const Pe=Se.data[4*(ie*S+ye)+3]/255;if(Pe===0)continue;const Ae=(ie+Q)*A+ye+Q;if(Pe===1)me[Ae]=0,H[Ae]=It;else{const ze=.5-Pe;me[Ae]=ze>0?ze*ze:0,H[Ae]=ze<0?ze*ze:0}}Ut(me,0,0,A,M,A,this.f,this.v,this.z),Ut(H,Q,Q,S,E,A,this.f,this.v,this.z);for(let ie=0;ie<z;ie++){const ye=Math.sqrt(me[ie])-Math.sqrt(H[ie]);V[ie]=Math.round(255-255*(ye/this.radius+this.cutoff))}return Y}};class rt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(i,l){return c.z(i.expression.evaluate(l))}interpolate(i,l,d){return{x:c.B.number(i.x,l.x,d),y:c.B.number(i.y,l.y,d),z:c.B.number(i.z,l.z,d)}}}let Re;class at extends c.E{constructor(i){super(),Re=Re||new c.r({anchor:new c.D(c.v.light.anchor),position:new rt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Re),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,l={}){if(!this._validate(c.t,i,l))for(const d in i){const f=i[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,l,d){return(!d||d.validate!==!1)&&c.x(this,i.call(c.y,c.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}}class Ne{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,l){const d=i.join(",")+String(l);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(i,l)),this.dashEntry[d]}getDashRanges(i,l,d){const f=[];let _=i.length%2==1?-i[i.length-1]*d:0,b=i[0]*d,S=!0;f.push({left:_,right:b,isDash:S,zeroLength:i[0]===0});let E=i[0];for(let A=1;A<i.length;A++){S=!S;const M=i[A];_=E*d,E+=M,b=E*d,f.push({left:_,right:b,isDash:S,zeroLength:M===0})}return f}addRoundDash(i,l,d){const f=l/2;for(let _=-d;_<=d;_++){const b=this.width*(this.nextRow+d+_);let S=0,E=i[S];for(let A=0;A<this.width;A++){A/E.right>1&&(E=i[++S]);const M=Math.abs(A-E.left),z=Math.abs(A-E.right),V=Math.min(M,z);let Y;const X=_/d*(f+1);if(E.isDash){const Q=f-Math.abs(X);Y=Math.sqrt(V*V+Q*Q)}else Y=f-Math.sqrt(V*V+X*X);this.data[b+A]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(i){for(let S=i.length-1;S>=0;--S){const E=i[S],A=i[S+1];E.zeroLength?i.splice(S,1):A&&A.isDash===E.isDash&&(A.left=E.left,i.splice(S,1))}const l=i[0],d=i[i.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const f=this.width*this.nextRow;let _=0,b=i[_];for(let S=0;S<this.width;S++){S/b.right>1&&(b=i[++_]);const E=Math.abs(S-b.left),A=Math.abs(S-b.right),M=Math.min(E,A);this.data[f+S]=Math.max(0,Math.min(255,(b.isDash?M:-M)+128))}}addDash(i,l){const d=l?7:0,f=2*d+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let _=0;for(let S=0;S<i.length;S++)_+=i[S];if(_!==0){const S=this.width/_,E=this.getDashRanges(i,this.width,S);l?this.addRoundDash(E,S,d):this.addRegularDash(E)}const b={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:_};return this.nextRow+=f,this.dirty=!0,b}bind(i){const l=i.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}class wt{constructor(i,l,d){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=d;const f=this.workerPool.acquire(d);for(let _=0;_<f.length;_++){const b=new c.C(f[_],l,d);b.name=`Worker ${_}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,l,d){c.o(this.actors,(f,_)=>{f.send(i,l,_)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}}function Rt(m,i,l){const d=function(f,_){if(f)return l(f);if(_){const b=c.F(c.e(_,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(b.vectorLayers=_.vector_layers,b.vectorLayerIds=b.vectorLayers.map(S=>S.id)),l(null,b)}};return m.url?c.f(i.transformRequest(m.url,Z.Source),d):c.h.frame(()=>d(null,m))}class Ft{constructor(i,l){i&&(l?this.setSouthWest(i).setNorthEast(l):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof c.L?new c.L(i.lng,i.lat):c.L.convert(i),this}setSouthWest(i){return this._sw=i instanceof c.L?new c.L(i.lng,i.lat):c.L.convert(i),this}extend(i){const l=this._sw,d=this._ne;let f,_;if(i instanceof c.L)f=i,_=i;else{if(!(i instanceof Ft))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Ft.convert(i)):this.extend(c.L.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(c.L.convert(i)):this;if(f=i._sw,_=i._ne,!f||!_)return this}return l||d?(l.lng=Math.min(f.lng,l.lng),l.lat=Math.min(f.lat,l.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new c.L(f.lng,f.lat),this._ne=new c.L(_.lng,_.lat)),this}getCenter(){return new c.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.L(this.getWest(),this.getNorth())}getSouthEast(){return new c.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:d}=c.L.convert(i);let f=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(i){return i instanceof Ft?i:i&&new Ft(i)}static fromLngLat(i,l=0){const d=360*l/40075017,f=d/Math.cos(Math.PI/180*i.lat);return new Ft(new c.L(i.lng-f,i.lat-d),new c.L(i.lng+f,i.lat+d))}}class Nt{constructor(i,l,d){this.bounds=Ft.convert(this.validateBounds(i)),this.minzoom=l||0,this.maxzoom=d||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const l=Math.pow(2,i.z),d=Math.floor(c.G(this.bounds.getWest())*l),f=Math.floor(c.H(this.bounds.getNorth())*l),_=Math.ceil(c.G(this.bounds.getEast())*l),b=Math.ceil(c.H(this.bounds.getSouth())*l);return i.x>=d&&i.x<_&&i.y>=f&&i.y<b}}class hn extends c.E{constructor(i,l,d,f){if(super(),this.load=()=>{this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,(_,b)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),_?this.fire(new c.j(_)):b&&(c.e(this,b),b.bounds&&(this.tileBounds=new Nt(b.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>c.e({},this._options),this.id=i,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.F(l,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(i,l){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(d,Z.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function _(b,S){return delete i.request,i.aborted?l(null):b&&b.status!==404?l(b):(S&&S.resourceTiming&&(i.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&i.setExpiryData(S),i.loadVectorData(S,this.map.painter),l(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}f.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=l:i.request=i.actor.send("reloadTile",f,_.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",f,_.bind(this)))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class an extends c.E{constructor(i,l,d,f){super(),this.id=i,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},l),c.e(this,c.F(l,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,(i,l)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new c.j(i)):l&&(c.e(this,l),l.bounds&&(this.tileBounds=new Nt(l.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}serialize(){return c.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,l){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.request=ue.getImage(this.map._requestManager.transformRequest(d,Z.Tile),(f,_,b)=>{if(delete i.request,i.aborted)i.state="unloaded",l(null);else if(f)i.state="errored",l(f);else if(_){this.map._refreshExpiredTiles&&b&&i.setExpiryData(b);const S=this.map.painter.context,E=S.gl;i.texture=this.map.painter.getTileTexture(_.width),i.texture?i.texture.update(_,{useMipmap:!0}):(i.texture=new Oe(S,_,E.RGBA,{useMipmap:!0}),i.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),S.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax)),i.state="loaded",l(null)}},this.map._refreshExpiredTiles)}abortTile(i,l){i.request&&(i.request.cancel(),delete i.request),l()}unloadTile(i,l){i.texture&&this.map.painter.saveTileTexture(i.texture),l()}hasTransition(){return!1}}class gn extends an{constructor(i,l,d,f){super(i,l,d,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(i,l){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(d,Z.Tile);function _(b,S){b&&(i.state="errored",l(b)),S&&(i.dem=S,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded",l(null))}i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.request=ue.getImage(f,(b,S,E)=>c._(this,void 0,void 0,function*(){if(delete i.request,i.aborted)i.state="unloaded",l(null);else if(b)i.state="errored",l(b);else if(S){this.map._refreshExpiredTiles&&i.setExpiryData(E);const A=c.a(S)&&c.J()?S:yield function(z){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.K()){const V=z.width+2,Y=z.height+2;try{return new c.R({width:V,height:Y},yield c.M(z,-1,-1,V,Y))}catch{}}return c.h.getImageData(z,1)})}(S),M={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",M,_))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(i){const l=i.canonical,d=Math.pow(2,l.z),f=(l.x-1+d)%d,_=l.x===0?i.wrap-1:i.wrap,b=(l.x+1+d)%d,S=l.x+1===d?i.wrap+1:i.wrap,E={};return E[new c.O(i.overscaledZ,_,l.z,f,l.y).key]={backfilled:!1},E[new c.O(i.overscaledZ,S,l.z,b,l.y).key]={backfilled:!1},l.y>0&&(E[new c.O(i.overscaledZ,_,l.z,f,l.y-1).key]={backfilled:!1},E[new c.O(i.overscaledZ,i.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},E[new c.O(i.overscaledZ,S,l.z,b,l.y-1).key]={backfilled:!1}),l.y+1<d&&(E[new c.O(i.overscaledZ,_,l.z,f,l.y+1).key]={backfilled:!1},E[new c.O(i.overscaledZ,i.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},E[new c.O(i.overscaledZ,S,l.z,b,l.y+1).key]={backfilled:!1}),E}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})}}class gi extends c.E{constructor(i,l,d,f){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>c.e({},this._options,{type:this.type,data:this._data}),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=l.data,this._options=c.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const _=c.N/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*_,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*_,extent:c.N,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.N,radius:(l.clusterRadius||50)*_,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},l),this}getClusterChildren(i,l){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},l),this}getClusterLeaves(i,l,d,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:l,offset:d},f),this}_updateWorkerData(i){const l=c.e({},this.workerOptions);i?l.dataDiff=i:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest(c.h.resolveURL(this._data),Z.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,l,(d,f)=>{if(this._pendingLoads--,this._removed||f&&f.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let _=null;if(f&&f.resourceTiming&&f.resourceTiming[this.id]&&(_=f.resourceTiming[this.id].slice(0)),d)return void this.fire(new c.j(d));const b={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&c.e(b,{resourceTiming:_}),this.fire(new c.k("data",Object.assign(Object.assign({},b),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},b),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(i,l){const d=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const f={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request=this.actor.send(d,f,(_,b)=>(delete i.request,i.unloadVectorData(),i.aborted?l(null):_?l(_):(i.loadVectorData(b,this.map.painter,d==="reloadTile"),l(null))))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Lt=c.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tn extends c.E{constructor(i,l,d,f){super(),this.load=(_,b)=>{this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=ue.getImage(this.map._requestManager.transformRequest(this.url,Z.Image),(S,E)=>{this._request=null,this._loaded=!0,S?this.fire(new c.j(S)):E&&(this.image=E,_&&(this.coordinates=_),b&&b(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const _=this.map.painter.context,b=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,Lt.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Oe(_,this.image,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE));let S=!1;for(const E in this.tiles){const A=this.tiles[E];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,S=!0)}S&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=i,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=l}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(i){this.coordinates=i;const l=i.map(c.U.fromLngLat);this.tileID=function(f){let _=1/0,b=1/0,S=-1/0,E=-1/0;for(const V of f)_=Math.min(_,V.x),b=Math.min(b,V.y),S=Math.max(S,V.x),E=Math.max(E,V.y);const A=Math.max(S-_,E-b),M=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),z=Math.pow(2,M);return new c.W(M,Math.floor((_+S)/2*z),Math.floor((b+E)/2*z))}(l),this.minzoom=this.maxzoom=this.tileID.z;const d=l.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new c.V,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,c.N,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,c.N),this._boundsArray.emplaceBack(d[2].x,d[2].y,c.N,c.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(i,l){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},l(null)):(i.state="errored",l(null))}hasTransition(){return!1}}class qe extends tn{constructor(i,l,d,f){super(i,l,d,f),this.load=()=>{this._loaded=!1;const _=this.options;this.urls=[];for(const b of _.urls)this.urls.push(this.map._requestManager.transformRequest(b,Z.Source).url);c.X(this.urls,(b,S)=>{this._loaded=!0,b?this.fire(new c.j(b)):S&&(this.video=S,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,b=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,Lt.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE),b.texSubImage2D(b.TEXTURE_2D,0,0,0,b.RGBA,b.UNSIGNED_BYTE,this.video)):(this.texture=new Oe(_,this.video,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE));let S=!1;for(const E in this.tiles){const A=this.tiles[E];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,S=!0)}S&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=l}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const l=this.video.seekable;i<l.start(0)||i>l.end(0)?this.fire(new c.j(new c.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ut extends tn{constructor(i,l,d,f){super(i,l,d,f),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const b=this.map.painter.context,S=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Lt.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Oe(b,this.canvas,S.RGBA,{premultiply:!0});let E=!1;for(const A in this.tiles){const M=this.tiles[A];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,E=!0)}E&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(b=>typeof b!="number"))||this.fire(new c.j(new c.Y(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.Y(`sources.${i}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new c.j(new c.Y(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.Y(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.Y(`sources.${i}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const zt={},qt=m=>{switch(m){case"geojson":return gi;case"image":return tn;case"raster":return an;case"raster-dem":return gn;case"vector":return hn;case"video":return qe;case"canvas":return ut}return zt[m]};function en(m,i){const l=c.Z();return c.$(l,l,[1,1,0]),c.a0(l,l,[.5*m.width,.5*m.height,1]),c.a1(l,l,m.calculatePosMatrix(i.toUnwrapped()))}function jt(m,i,l,d,f,_){const b=function(z,V,Y){if(z)for(const X of z){const Q=V[X];if(Q&&Q.source===Y&&Q.type==="fill-extrusion")return!0}else for(const X in V){const Q=V[X];if(Q.source===Y&&Q.type==="fill-extrusion")return!0}return!1}(f&&f.layers,i,m.id),S=_.maxPitchScaleFactor(),E=m.tilesIn(d,S,b);E.sort(_t);const A=[];for(const z of E)A.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(i,l,m._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,f,_,S,en(m.transform,z.tileID))});const M=function(z){const V={},Y={};for(const X of z){const Q=X.queryResults,H=X.wrappedTileID,me=Y[H]=Y[H]||{};for(const Se in Q){const ie=Q[Se],ye=me[Se]=me[Se]||{},Pe=V[Se]=V[Se]||[];for(const Ae of ie)ye[Ae.featureIndex]||(ye[Ae.featureIndex]=!0,Pe.push(Ae))}}return V}(A);for(const z in M)M[z].forEach(V=>{const Y=V.feature,X=m.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=X});return M}function _t(m,i){const l=m.tileID,d=i.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}class ki{constructor(i,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=c.a2(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const l=i+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,l,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(f,_){const b={};if(!_)return b;for(const S of f){const E=S.layerIds.map(A=>_.getLayer(A)).filter(Boolean);if(E.length!==0){S.layers=E,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(A=>E.filter(M=>M.id===A)[0]));for(const A of E)b[A.id]=S}}return b}(i.buckets,l.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a4){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a4&&_.hasRTLText){this.hasRTLText=!0,c.a5();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(f).queryRadius(_))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new c.a3}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(i)}const l=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Oe(i,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Oe(i,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,l,d,f,_,b,S,E,A,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:b,tileSize:this.tileSize,pixelPosMatrix:M,transform:E,params:S,queryPadding:this.queryPadding*A},i,l,d):{}}querySourceFeatures(i,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),_=l&&l.sourceLayer?l.sourceLayer:"",b=f._geojsonTileLayer||f[_];if(!b)return;const S=c.a6(l&&l.filter),{z:E,x:A,y:M}=this.tileID.canonical,z={z:E,x:A,y:M};for(let V=0;V<b.length;V++){const Y=b.feature(V);if(S.needGeometry){const H=c.a7(Y,!0);if(!S.filter(new c.a8(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!S.filter(new c.a8(this.tileID.overscaledZ),Y))continue;const X=d.getId(Y,_),Q=new c.a9(Y,E,A,M,X);Q.tile=z,i.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const l=this.expirationTime;if(i.cacheControl){const d=c.aa(i.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(l)if(this.expirationTime<l)f=!0;else{const _=this.expirationTime-l;_?this.expirationTime=d+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!l.style.hasLayer(f))continue;const _=this.buckets[f],b=_.layers[0].sourceLayer||"_geojsonTileLayer",S=d[b],E=i[b];if(!S||!E||Object.keys(E).length===0)continue;_.update(E,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=l&&l.style&&l.style.getLayer(f);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=c.h.now()+i}setDependencies(i,l){const d={};for(const f of l)d[f]=!0;this.dependencies[i]=d}hasDependency(i,l){for(const d of i){const f=this.dependencies[d];if(f){for(const _ of l)if(f[_])return!0}}return!1}}class ms{constructor(i,l){this.max=i,this.onRemove=l,this.reset()}reset(){for(const i in this.data)for(const l of this.data[i])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(i,l,d){const f=i.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:l,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(i,_)},d)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const l=this.data[i].shift();return l.timeout&&clearTimeout(l.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),l.value}getByKey(i){const l=this.data[i];return l?l[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,l){if(!this.has(i))return this;const d=i.wrapped().key,f=l===void 0?0:this.data[d].indexOf(l),_=this.data[d][f];return this.data[d].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(i){const l=[];for(const d in this.data)for(const f of this.data[d])i(f.value)||l.push(f);for(const d of l)this.remove(d.value.tileID,d)}}class Me{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,l,d){const f=String(l);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][f]=this.stateChanges[i][f]||{},c.e(this.stateChanges[i][f],d),this.deletedStates[i]===null){this.deletedStates[i]={};for(const _ in this.state[i])_!==f&&(this.deletedStates[i][_]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][f]===null){this.deletedStates[i][f]={};for(const _ in this.state[i][f])d[_]||(this.deletedStates[i][f][_]=null)}else for(const _ in d)this.deletedStates[i]&&this.deletedStates[i][f]&&this.deletedStates[i][f][_]===null&&delete this.deletedStates[i][f][_]}removeFeatureState(i,l,d){if(this.deletedStates[i]===null)return;const f=String(l);if(this.deletedStates[i]=this.deletedStates[i]||{},d&&l!==void 0)this.deletedStates[i][f]!==null&&(this.deletedStates[i][f]=this.deletedStates[i][f]||{},this.deletedStates[i][f][d]=null);else if(l!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][f])for(d in this.deletedStates[i][f]={},this.stateChanges[i][f])this.deletedStates[i][f][d]=null;else this.deletedStates[i][f]=null;else this.deletedStates[i]=null}getState(i,l){const d=String(l),f=c.e({},(this.state[i]||{})[d],(this.stateChanges[i]||{})[d]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const _=this.deletedStates[i][l];if(_===null)return{};for(const b in _)delete f[b]}return f}initializeTileState(i,l){i.setFeatureState(this.state,l)}coalesceChanges(i,l){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),c.e(this.state[f][b],this.stateChanges[f][b]),_[b]=this.state[f][b];d[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const b in this.state[f])_[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const S of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][S];_[b]=this.state[f][b]}d[f]=d[f]||{},c.e(d[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in i)i[f].setFeatureState(d,l)}}class ti extends c.E{constructor(i,l,d){super(),this.id=i,this.dispatcher=d,this.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,b,S)=>{const E=new(qt(_.type))(f,_,b,S);if(E.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${E.id}`);return E})(i,l,d,this),this._tiles={},this._cache=new ms(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Me,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const l=this._tiles[i];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,l){return this._source.loadTile(i,l)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){this._source.abortTile&&this._source.abortTile(i,()=>{}),this._source.fire(new c.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(i),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(di).map(i=>i.key)}getRenderableIds(i){const l=[];for(const d in this._tiles)this._isIdRenderable(d,i)&&l.push(this._tiles[d]);return i?l.sort((d,f)=>{const _=d.tileID,b=f.tileID,S=new c.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),E=new c.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-b.overscaledZ||E.y-S.y||E.x-S.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(di).map(d=>d.key)}hasRenderableParent(i){const l=this.findLoadedParent(i,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(i,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(l||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,l){const d=this._tiles[i];d&&(d.state!=="loading"&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,i,l)))}_tileLoaded(i,l,d,f){if(f)return i.state="errored",void(f.status!==404?this._source.fire(new c.j(f,{tile:i})):this.update(this.transform,this.terrain));i.timeAdded=c.h.now(),d==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(l,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const l=this.getRenderableIds();for(let f=0;f<l.length;f++){const _=l[f];if(i.neighboringTiles&&i.neighboringTiles[_]){const b=this.getTileByID(_);d(i,b),d(b,i)}}function d(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let b=_.tileID.canonical.x-f.tileID.canonical.x;const S=_.tileID.canonical.y-f.tileID.canonical.y,E=Math.pow(2,f.tileID.canonical.z),A=_.tileID.key;b===0&&S===0||Math.abs(S)>1||(Math.abs(b)>1&&(Math.abs(b+E)===1?b+=E:Math.abs(b-E)===1&&(b-=E)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,b,S),f.neighboringTiles&&f.neighboringTiles[A]&&(f.neighboringTiles[A].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,l,d,f){for(const _ in this._tiles){let b=this._tiles[_];if(f[_]||!b.hasData()||b.tileID.overscaledZ<=l||b.tileID.overscaledZ>d)continue;let S=b.tileID;for(;b&&b.tileID.overscaledZ>l+1;){const A=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[A.key],b&&b.hasData()&&(S=A)}let E=S;for(;E.overscaledZ>l;)if(E=E.scaledTo(E.overscaledZ-1),i[E.key]){f[S.key]=S;break}}}findLoadedParent(i,l){if(i.key in this._loadedParentTiles){const d=this._loadedParentTiles[i.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=i.overscaledZ-1;d>=l;d--){const f=i.scaledTo(d),_=this._getLoadedTile(f);if(_)return _}}_getLoadedTile(i){const l=this._tiles[i.key];return l&&l.hasData()?l:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const l=Math.ceil(i.width/this._source.tileSize)+1,d=Math.ceil(i.height/this._source.tileSize)+1,f=Math.floor(l*d*(this._maxTileCacheZoomLevels===null?c.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(i){const l=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,l){const d={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+l),d[_.tileID.key]=_}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}update(i,l){if(this.transform=i,this.terrain=l,!this._sourceLoaded||this._paused)return;let d;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new c.O(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(d=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l}),this._source.hasTile&&(d=d.filter(M=>this._source.hasTile(M)))):d=[];const f=i.coveringZoomLevel(this._source),_=Math.max(f-ti.maxOverzooming,this._source.minzoom),b=Math.max(f+ti.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const z of d)if(z.canonical.z>this._source.minzoom){const V=z.scaledTo(z.canonical.z-1);M[V.key]=V;const Y=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));M[Y.key]=Y}d=d.concat(Object.values(M))}const S=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(d,f);if(ln(this._source.type)){const M={},z={},V=Object.keys(E),Y=c.h.now();for(const X of V){const Q=E[X],H=this._tiles[X];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=Y)continue;const me=this.findLoadedParent(Q,_);me&&(this._addTile(me.tileID),M[me.tileID.key]=me.tileID),z[X]=Q}this._retainLoadedChildren(z,f,b,E);for(const X in M)E[X]||(this._coveredTiles[X]=!0,E[X]=M[X]);if(l){const X={},Q={};for(const H of d)this._tiles[H.key].hasData()?X[H.key]=H:Q[H.key]=H;for(const H in Q){const me=Q[H].children(this._source.maxzoom);this._tiles[me[0].key]&&this._tiles[me[1].key]&&this._tiles[me[2].key]&&this._tiles[me[3].key]&&(X[me[0].key]=E[me[0].key]=me[0],X[me[1].key]=E[me[1].key]=me[1],X[me[2].key]=E[me[2].key]=me[2],X[me[3].key]=E[me[3].key]=me[3],delete Q[H])}for(const H in Q){const me=this.findLoadedParent(Q[H],this._source.minzoom);if(me){X[me.tileID.key]=E[me.tileID.key]=me.tileID;for(const Se in X)X[Se].isChildOf(me.tileID)&&delete X[Se]}}for(const H in this._tiles)X[H]||(this._coveredTiles[H]=!0)}}for(const M in E)this._tiles[M].clearFadeHold();const A=c.ab(this._tiles,E);for(const M of A){const z=this._tiles[M];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,l){const d={},f={},_=Math.max(l-ti.maxOverzooming,this._source.minzoom),b=Math.max(l+ti.maxUnderzooming,this._source.minzoom),S={};for(const E of i){const A=this._addTile(E);d[E.key]=E,A.hasData()||l<this._source.maxzoom&&(S[E.key]=E)}this._retainLoadedChildren(S,l,b,d);for(const E of i){let A=this._tiles[E.key];if(A.hasData())continue;if(l+1>this._source.maxzoom){const z=E.children(this._source.maxzoom)[0],V=this.getTile(z);if(V&&V.hasData()){d[z.key]=z;continue}}else{const z=E.children(this._source.maxzoom);if(d[z[0].key]&&d[z[1].key]&&d[z[2].key]&&d[z[3].key])continue}let M=A.wasRequested();for(let z=E.overscaledZ-1;z>=_;--z){const V=E.scaledTo(z);if(f[V.key])break;if(f[V.key]=!0,A=this.getTile(V),!A&&M&&(A=this._addTile(V)),A){const Y=A.hasData();if((M||Y)&&(d[V.key]=V),M=A.wasRequested(),Y)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const l=[];let d,f=this._tiles[i].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}l.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;f=_}for(const _ of l)this._loadedParentTiles[_]=d}}_addTile(i){let l=this._tiles[i.key];if(l)return l;l=this._cache.getAndRemove(i),l&&(this._setTileReloadTimer(i.key,l),l.tileID=i,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,l)));const d=l;return l||(l=new ki(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,i.key,l.state))),l.uses++,this._tiles[i.key]=l,d||this._source.fire(new c.k("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(i,l){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const d=l.getExpiryTimeout();d&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},d))}_removeTile(i){const l=this._tiles[i];l&&(l.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,l,d){const f=[],_=this.transform;if(!_)return f;const b=d?_.getCameraQueryGeometry(i):i,S=i.map(X=>_.pointCoordinate(X,this.terrain)),E=b.map(X=>_.pointCoordinate(X,this.terrain)),A=this.getIds();let M=1/0,z=1/0,V=-1/0,Y=-1/0;for(const X of E)M=Math.min(M,X.x),z=Math.min(z,X.y),V=Math.max(V,X.x),Y=Math.max(Y,X.y);for(let X=0;X<A.length;X++){const Q=this._tiles[A[X]];if(Q.holdingForFade())continue;const H=Q.tileID,me=Math.pow(2,_.zoom-Q.tileID.overscaledZ),Se=l*Q.queryPadding*c.N/Q.tileSize/me,ie=[H.getTilePoint(new c.U(M,z)),H.getTilePoint(new c.U(V,Y))];if(ie[0].x-Se<c.N&&ie[0].y-Se<c.N&&ie[1].x+Se>=0&&ie[1].y+Se>=0){const ye=S.map(Ae=>H.getTilePoint(Ae)),Pe=E.map(Ae=>H.getTilePoint(Ae));f.push({tile:Q,tileID:H,queryGeometry:ye,cameraQueryGeometry:Pe,scale:me})}}return f}getVisibleCoordinates(i){const l=this.getRenderableIds(i).map(d=>this._tiles[d].tileID);for(const d of l)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(ln(this._source.type)){const i=c.h.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=i)return!0}return!1}setFeatureState(i,l,d){this._state.updateState(i=i||"_geojsonTileLayer",l,d)}removeFeatureState(i,l,d){this._state.removeFeatureState(i=i||"_geojsonTileLayer",l,d)}getFeatureState(i,l){return this._state.getState(i=i||"_geojsonTileLayer",l)}setDependencies(i,l,d){const f=this._tiles[i];f&&f.setDependencies(l,d)}reloadTilesForDependencies(i,l){for(const d in this._tiles)this._tiles[d].hasDependency(i,l)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(i,l))}}function di(m,i){const l=Math.abs(2*m.wrap)-+(m.wrap<0),d=Math.abs(2*i.wrap)-+(i.wrap<0);return m.overscaledZ-i.overscaledZ||d-l||i.canonical.y-m.canonical.y||i.canonical.x-m.canonical.x}function ln(m){return m==="raster"||m==="image"||m==="video"}ti.maxOverzooming=10,ti.maxUnderzooming=3;const Ht="mapboxgl_preloaded_worker_pool";class rr{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<rr.workerCount;)this.workers.push(new Worker(c.c.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ht]}numActive(){return Object.keys(this.active).length}}const Fr=Math.floor(c.h.hardwareConcurrency/2);let wr;function so(){return wr||(wr=new rr),wr}rr.workerCount=c.ac(globalThis)?Math.max(Math.min(Fr,3),1):1;class gs{constructor(i,l){this.reset(i,l)}reset(i,l){this.points=i||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=c.ad(i,0,1);let l=1,d=this._distances[l];const f=i*this.paddedLength+this.padding;for(;d<f&&l<this._distances.length;)d=this._distances[++l];const _=l-1,b=this._distances[_],S=d-b,E=S>0?(f-b)/S:0;return this.points[_].mult(1-E).add(this.points[l].mult(E))}}function Br(m,i){let l=!0;return m==="always"||m!=="never"&&i!=="never"||(l=!1),l}class Nr{constructor(i,l,d){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(i/d),this.yCellCount=Math.ceil(l/d);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=l,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,l,d,f,_){this._forEachCell(l,d,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(i,l,d,f){this._forEachCell(l-f,d-f,l+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(l),this.circles.push(d),this.circles.push(f)}_insertBoxCell(i,l,d,f,_,b){this.boxCells[_].push(b)}_insertCircleCell(i,l,d,f,_,b){this.circleCells[_].push(b)}_query(i,l,d,f,_,b,S){if(d<0||i>this.width||f<0||l>this.height)return[];const E=[];if(i<=0&&l<=0&&this.width<=d&&this.height<=f){if(_)return[{key:null,x1:i,y1:l,x2:d,y2:f}];for(let A=0;A<this.boxKeys.length;A++)E.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const M=this.circles[3*A],z=this.circles[3*A+1],V=this.circles[3*A+2];E.push({key:this.circleKeys[A],x1:M-V,y1:z-V,x2:M+V,y2:z+V})}}else this._forEachCell(i,l,d,f,this._queryCell,E,{hitTest:_,overlapMode:b,seenUids:{box:{},circle:{}}},S);return E}query(i,l,d,f){return this._query(i,l,d,f,!1,null)}hitTest(i,l,d,f,_,b){return this._query(i,l,d,f,!0,_,b).length>0}hitTestCircle(i,l,d,f,_){const b=i-d,S=i+d,E=l-d,A=l+d;if(S<0||b>this.width||A<0||E>this.height)return!1;const M=[];return this._forEachCell(b,E,S,A,this._queryCellCircle,M,{hitTest:!0,overlapMode:f,circle:{x:i,y:l,radius:d},seenUids:{box:{},circle:{}}},_),M.length>0}_queryCell(i,l,d,f,_,b,S,E){const{seenUids:A,hitTest:M,overlapMode:z}=S,V=this.boxCells[_];if(V!==null){const X=this.bboxes;for(const Q of V)if(!A.box[Q]){A.box[Q]=!0;const H=4*Q,me=this.boxKeys[Q];if(i<=X[H+2]&&l<=X[H+3]&&d>=X[H+0]&&f>=X[H+1]&&(!E||E(me))&&(!M||!Br(z,me.overlapMode))&&(b.push({key:me,x1:X[H],y1:X[H+1],x2:X[H+2],y2:X[H+3]}),M))return!0}}const Y=this.circleCells[_];if(Y!==null){const X=this.circles;for(const Q of Y)if(!A.circle[Q]){A.circle[Q]=!0;const H=3*Q,me=this.circleKeys[Q];if(this._circleAndRectCollide(X[H],X[H+1],X[H+2],i,l,d,f)&&(!E||E(me))&&(!M||!Br(z,me.overlapMode))){const Se=X[H],ie=X[H+1],ye=X[H+2];if(b.push({key:me,x1:Se-ye,y1:ie-ye,x2:Se+ye,y2:ie+ye}),M)return!0}}}return!1}_queryCellCircle(i,l,d,f,_,b,S,E){const{circle:A,seenUids:M,overlapMode:z}=S,V=this.boxCells[_];if(V!==null){const X=this.bboxes;for(const Q of V)if(!M.box[Q]){M.box[Q]=!0;const H=4*Q,me=this.boxKeys[Q];if(this._circleAndRectCollide(A.x,A.y,A.radius,X[H+0],X[H+1],X[H+2],X[H+3])&&(!E||E(me))&&!Br(z,me.overlapMode))return b.push(!0),!0}}const Y=this.circleCells[_];if(Y!==null){const X=this.circles;for(const Q of Y)if(!M.circle[Q]){M.circle[Q]=!0;const H=3*Q,me=this.circleKeys[Q];if(this._circlesCollide(X[H],X[H+1],X[H+2],A.x,A.y,A.radius)&&(!E||E(me))&&!Br(z,me.overlapMode))return b.push(!0),!0}}}_forEachCell(i,l,d,f,_,b,S,E){const A=this._convertToXCellCoord(i),M=this._convertToYCellCoord(l),z=this._convertToXCellCoord(d),V=this._convertToYCellCoord(f);for(let Y=A;Y<=z;Y++)for(let X=M;X<=V;X++)if(_.call(this,i,l,d,f,this.xCellCount*X+Y,b,S,E))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,l,d,f,_,b){const S=f-i,E=_-l,A=d+b;return A*A>S*S+E*E}_circleAndRectCollide(i,l,d,f,_,b,S){const E=(b-f)/2,A=Math.abs(i-(f+E));if(A>E+d)return!1;const M=(S-_)/2,z=Math.abs(l-(_+M));if(z>M+d)return!1;if(A<=E||z<=M)return!0;const V=A-E,Y=z-M;return V*V+Y*Y<=d*d}}function Ze(m,i,l,d,f){const _=c.Z();return i?(c.a0(_,_,[1/f,1/f,1]),l||c.ae(_,_,d.angle)):c.a1(_,d.labelPlaneMatrix,m),_}function sr(m,i,l,d,f){if(i){const _=c.af(m);return c.a0(_,_,[f,f,1]),l||c.ae(_,_,-d.angle),_}return d.glCoordMatrix}function Sn(m,i,l){let d;l?(d=[m.x,m.y,l(m.x,m.y),1],c.ag(d,d,i)):(d=[m.x,m.y,0,1],ee(d,d,i));const f=d[3];return{point:new c.P(d[0]/f,d[1]/f),signedDistanceFromCamera:f}}function ys(m,i){return .5+m/i*.5}function Jr(m,i){const l=m[0]/m[3],d=m[1]/m[3];return l>=-i[0]&&l<=i[0]&&d>=-i[1]&&d<=i[1]}function He(m,i,l,d,f,_,b,S,E,A){const M=d?m.textSizeData:m.iconSizeData,z=c.ah(M,l.transform.zoom),V=[256/l.width*2+1,256/l.height*2+1],Y=d?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;Y.clear();const X=m.lineVertexArray,Q=d?m.text.placedSymbolArray:m.icon.placedSymbolArray,H=l.transform.width/l.transform.height;let me=!1;for(let Se=0;Se<Q.length;Se++){const ie=Q.get(Se);if(ie.hidden||ie.writingMode===c.ai.vertical&&!me){W(ie.numGlyphs,Y);continue}let ye;if(me=!1,A?(ye=[ie.anchorX,ie.anchorY,A(ie.anchorX,ie.anchorY),1],c.ag(ye,ye,i)):(ye=[ie.anchorX,ie.anchorY,0,1],ee(ye,ye,i)),!Jr(ye,V)){W(ie.numGlyphs,Y);continue}const Pe=ys(l.transform.cameraToCenterDistance,ye[3]),Ae=c.aj(M,z,ie),ze=b?Ae/Pe:Ae*Pe,Be=new c.P(ie.anchorX,ie.anchorY),Fe=Sn(Be,f,A).point,$e={projections:{},offsets:{}},ht=Nn(ie,ze,!1,S,i,f,_,m.glyphOffsetArray,X,Y,Fe,Be,$e,H,E,A);me=ht.useVertical,(ht.notEnoughRoom||me||ht.needsFlipping&&Nn(ie,ze,!0,S,i,f,_,m.glyphOffsetArray,X,Y,Fe,Be,$e,H,E,A).notEnoughRoom)&&W(ie.numGlyphs,Y)}d?m.text.dynamicLayoutVertexBuffer.updateData(Y):m.icon.dynamicLayoutVertexBuffer.updateData(Y)}function Tt(m,i,l,d,f,_,b,S,E,A,M,z,V){const Y=S.glyphStartIndex+S.numGlyphs,X=S.lineStartIndex,Q=S.lineStartIndex+S.lineLength,H=i.getoffsetX(S.glyphStartIndex),me=i.getoffsetX(Y-1),Se=N(m*H,l,d,f,_,b,S.segment,X,Q,E,A,M,z,V);if(!Se)return null;const ie=N(m*me,l,d,f,_,b,S.segment,X,Q,E,A,M,z,V);return ie?{first:Se,last:ie}:null}function bt(m,i,l,d){return m===c.ai.horizontal&&Math.abs(l.y-i.y)>Math.abs(l.x-i.x)*d?{useVertical:!0}:(m===c.ai.vertical?i.y<l.y:i.x>l.x)?{needsFlipping:!0}:null}function Nn(m,i,l,d,f,_,b,S,E,A,M,z,V,Y,X,Q){const H=i/24,me=m.lineOffsetX*H,Se=m.lineOffsetY*H;let ie;if(m.numGlyphs>1){const ye=m.glyphStartIndex+m.numGlyphs,Pe=m.lineStartIndex,Ae=m.lineStartIndex+m.lineLength,ze=Tt(H,S,me,Se,l,M,z,m,E,_,V,X,Q);if(!ze)return{notEnoughRoom:!0};const Be=Sn(ze.first.point,b,Q).point,Fe=Sn(ze.last.point,b,Q).point;if(d&&!l){const $e=bt(m.writingMode,Be,Fe,Y);if($e)return $e}ie=[ze.first];for(let $e=m.glyphStartIndex+1;$e<ye-1;$e++)ie.push(N(H*S.getoffsetX($e),me,Se,l,M,z,m.segment,Pe,Ae,E,_,V,X,Q));ie.push(ze.last)}else{if(d&&!l){const Pe=Sn(z,f,Q).point,Ae=m.lineStartIndex+m.segment+1,ze=new c.P(E.getx(Ae),E.gety(Ae)),Be=Sn(ze,f,Q),Fe=Be.signedDistanceFromCamera>0?Be.point:yi(z,ze,Pe,1,f,Q),$e=bt(m.writingMode,Pe,Fe,Y);if($e)return $e}const ye=N(H*S.getoffsetX(m.glyphStartIndex),me,Se,l,M,z,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,E,_,V,X,Q);if(!ye)return{notEnoughRoom:!0};ie=[ye]}for(const ye of ie)c.ak(A,ye.point,ye.angle);return{}}function yi(m,i,l,d,f,_){const b=Sn(m.add(m.sub(i)._unit()),f,_).point,S=l.sub(b);return l.add(S._mult(d/S.mag()))}function Et(m,i){const{projectionCache:l,lineVertexArray:d,labelPlaneMatrix:f,tileAnchorPoint:_,distanceFromAnchor:b,getElevation:S,previousVertex:E,direction:A,absOffsetX:M}=i;if(l.projections[m])return l.projections[m];const z=new c.P(d.getx(m),d.gety(m)),V=Sn(z,f,S);if(V.signedDistanceFromCamera>0)return l.projections[m]=V.point,V.point;const Y=m-A;return yi(b===0?_:new c.P(d.getx(Y),d.gety(Y)),z,E,M-b+1,f,S)}function br(m,i,l){return m._unit()._perp()._mult(i*l)}function J(m,i,l,d,f,_,b,S){const{projectionCache:E,direction:A}=S;if(E.offsets[m])return E.offsets[m];const M=l.add(i);if(m+A<d||m+A>=f)return E.offsets[m]=M,M;const z=Et(m+A,S),V=br(z.sub(l),b,A),Y=l.add(V),X=z.add(V);return E.offsets[m]=c.al(_,M,Y,X)||M,E.offsets[m]}function N(m,i,l,d,f,_,b,S,E,A,M,z,V,Y){const X=d?m-i:m+i;let Q=X>0?1:-1,H=0;d&&(Q*=-1,H=Math.PI),Q<0&&(H+=Math.PI);let me,Se,ie=Q>0?S+b:S+b+1,ye=f,Pe=f,Ae=0,ze=0;const Be=Math.abs(X),Fe=[];let $e;for(;Ae+ze<=Be;){if(ie+=Q,ie<S||ie>=E)return null;Ae+=ze,Pe=ye,Se=me;const Ye={projectionCache:z,lineVertexArray:A,labelPlaneMatrix:M,tileAnchorPoint:_,distanceFromAnchor:Ae,getElevation:Y,previousVertex:Pe,direction:Q,absOffsetX:Be};if(ye=Et(ie,Ye),l===0)Fe.push(Pe),$e=ye.sub(Pe);else{let vt;const pt=ye.sub(Pe);vt=pt.mag()===0?br(Et(ie+Q,Ye).sub(ye),l,Q):br(pt,l,Q),Se||(Se=Pe.add(vt)),me=J(ie,vt,ye,S,E,Se,l,Ye),Fe.push(Se),$e=me.sub(Se)}ze=$e.mag()}const ht=$e._mult((Be-Ae)/ze)._add(Se||Pe),Zt=H+Math.atan2(ye.y-Pe.y,ye.x-Pe.x);return Fe.push(ht),{point:ht,angle:V?Zt:0,path:Fe}}const O=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function W(m,i){for(let l=0;l<m;l++){const d=i.length;i.resize(d+4),i.float32.set(O,3*d)}}function ee(m,i,l){const d=i[0],f=i[1];return m[0]=l[0]*d+l[4]*f+l[12],m[1]=l[1]*d+l[5]*f+l[13],m[3]=l[3]*d+l[7]*f+l[15],m}const ne=100;class we{constructor(i,l=new Nr(i.width+200,i.height+200,25),d=new Nr(i.width+200,i.height+200,25)){this.transform=i,this.grid=l,this.ignoredGrid=d,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+ne,this.screenBottomBoundary=i.height+ne,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,l,d,f,_,b){const S=this.projectAndGetPerspectiveRatio(f,i.anchorPointX,i.anchorPointY,b),E=d*S.perspectiveRatio,A=i.x1*E+S.point.x,M=i.y1*E+S.point.y,z=i.x2*E+S.point.x,V=i.y2*E+S.point.y;return!this.isInsideGrid(A,M,z,V)||l!=="always"&&this.grid.hitTest(A,M,z,V,l,_)||S.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[A,M,z,V],offscreen:this.isOffscreen(A,M,z,V)}}placeCollisionCircles(i,l,d,f,_,b,S,E,A,M,z,V,Y,X){const Q=[],H=new c.P(l.anchorX,l.anchorY),me=Sn(H,b,X),Se=ys(this.transform.cameraToCenterDistance,me.signedDistanceFromCamera),ie=(M?_/Se:_*Se)/c.ap,ye=Sn(H,S,X).point,Pe=Tt(ie,f,l.lineOffsetX*ie,l.lineOffsetY*ie,!1,ye,H,l,d,S,{projections:{},offsets:{}},!1,X);let Ae=!1,ze=!1,Be=!0;if(Pe){const Fe=.5*V*Se+Y,$e=new c.P(-100,-100),ht=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Zt=new gs,Ye=Pe.first,vt=Pe.last;let pt=[];for(let Mt=Ye.path.length-1;Mt>=1;Mt--)pt.push(Ye.path[Mt]);for(let Mt=1;Mt<vt.path.length;Mt++)pt.push(vt.path[Mt]);const pn=2.5*Fe;if(E){const Mt=pt.map(Gt=>Sn(Gt,E,X));pt=Mt.some(Gt=>Gt.signedDistanceFromCamera<=0)?[]:Mt.map(Gt=>Gt.point)}let Vt=[];if(pt.length>0){const Mt=pt[0].clone(),Gt=pt[0].clone();for(let jn=1;jn<pt.length;jn++)Mt.x=Math.min(Mt.x,pt[jn].x),Mt.y=Math.min(Mt.y,pt[jn].y),Gt.x=Math.max(Gt.x,pt[jn].x),Gt.y=Math.max(Gt.y,pt[jn].y);Vt=Mt.x>=$e.x&&Gt.x<=ht.x&&Mt.y>=$e.y&&Gt.y<=ht.y?[pt]:Gt.x<$e.x||Mt.x>ht.x||Gt.y<$e.y||Mt.y>ht.y?[]:c.am([pt],$e.x,$e.y,ht.x,ht.y)}for(const Mt of Vt){Zt.reset(Mt,.25*Fe);let Gt=0;Gt=Zt.length<=.5*Fe?1:Math.ceil(Zt.paddedLength/pn)+1;for(let jn=0;jn<Gt;jn++){const _n=jn/Math.max(Gt-1,1),vi=Zt.lerp(_n),ni=vi.x+ne,qn=vi.y+ne;Q.push(ni,qn,Fe,0);const hr=ni-Fe,wn=qn-Fe,es=ni+Fe,ts=qn+Fe;if(Be=Be&&this.isOffscreen(hr,wn,es,ts),ze=ze||this.isInsideGrid(hr,wn,es,ts),i!=="always"&&this.grid.hitTestCircle(ni,qn,Fe,i,z)&&(Ae=!0,!A))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!A&&Ae||!ze||Se<this.perspectiveRatioCutoff?[]:Q,offscreen:Be,collisionDetected:Ae}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let d=1/0,f=1/0,_=-1/0,b=-1/0;for(const M of i){const z=new c.P(M.x+ne,M.y+ne);d=Math.min(d,z.x),f=Math.min(f,z.y),_=Math.max(_,z.x),b=Math.max(b,z.y),l.push(z)}const S=this.grid.query(d,f,_,b).concat(this.ignoredGrid.query(d,f,_,b)),E={},A={};for(const M of S){const z=M.key;if(E[z.bucketInstanceId]===void 0&&(E[z.bucketInstanceId]={}),E[z.bucketInstanceId][z.featureIndex])continue;const V=[new c.P(M.x1,M.y1),new c.P(M.x2,M.y1),new c.P(M.x2,M.y2),new c.P(M.x1,M.y2)];c.an(l,V)&&(E[z.bucketInstanceId][z.featureIndex]=!0,A[z.bucketInstanceId]===void 0&&(A[z.bucketInstanceId]=[]),A[z.bucketInstanceId].push(z.featureIndex))}return A}insertCollisionBox(i,l,d,f,_,b){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:l},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,l,d,f,_,b){const S=d?this.ignoredGrid:this.grid,E={bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:l};for(let A=0;A<i.length;A+=4)S.insertCircle(E,i[A],i[A+1],i[A+2])}projectAndGetPerspectiveRatio(i,l,d,f){let _;return f?(_=[l,d,f(l,d),1],c.ag(_,_,i)):(_=[l,d,0,1],ee(_,_,i)),{point:new c.P((_[0]/_[3]+1)/2*this.transform.width+ne,(-_[1]/_[3]+1)/2*this.transform.height+ne),perspectiveRatio:.5+this.transform.cameraToCenterDistance/_[3]*.5}}isOffscreen(i,l,d,f){return d<ne||i>=this.screenRightBoundary||f<ne||l>this.screenBottomBoundary}isInsideGrid(i,l,d,f){return d>=0&&i<this.gridRightBoundary&&f>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const i=c.ao([]);return c.$(i,i,[-100,-100,0]),i}}function pe(m,i,l){return i*(c.N/(m.tileSize*Math.pow(2,l-m.tileID.overscaledZ)))}class ae{constructor(i,l,d,f){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?l:-l))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class ge{constructor(i,l,d,f,_){this.text=new ae(i?i.text:null,l,d,_),this.icon=new ae(i?i.icon:null,l,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class he{constructor(i,l,d){this.text=i,this.icon=l,this.skipFade=d}}class ve{constructor(){this.invProjMatrix=c.Z(),this.viewportMatrix=c.Z(),this.circles=[]}}class Te{constructor(i,l,d,f,_){this.bucketInstanceId=i,this.featureIndex=l,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=_}}class Qe{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const l=++this.maxGroupID;this.collisionGroups[i]={ID:l,predicate:d=>d.collisionGroupID===l}}return this.collisionGroups[i]}}function Ge(m,i,l,d,f){const{horizontalAlign:_,verticalAlign:b}=c.au(m);return new c.P(-(_-.5)*i+d[0]*f,-(b-.5)*l+d[1]*f)}function Ue(m,i,l,d,f,_){const{x1:b,x2:S,y1:E,y2:A,anchorPointX:M,anchorPointY:z}=m,V=new c.P(i,l);return d&&V._rotate(f?_:-_),{x1:b+V.x,y1:E+V.y,x2:S+V.x,y2:A+V.y,anchorPointX:M,anchorPointY:z}}class ct{constructor(i,l,d,f,_){this.transform=i.clone(),this.terrain=l,this.collisionIndex=new we(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Qe(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,l,d,f){const _=d.getBucket(l),b=d.latestFeatureIndex;if(!_||!b||l.id!==_.layerIds[0])return;const S=d.collisionBoxArray,E=_.layers[0].layout,A=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),M=d.tileSize/c.N,z=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),V=E.get("text-pitch-alignment")==="map",Y=E.get("text-rotation-alignment")==="map",X=pe(d,1,this.transform.zoom),Q=Ze(z,V,Y,this.transform,X);let H=null;if(V){const Se=sr(z,V,Y,this.transform,X);H=c.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[_.bucketInstanceId]=new Te(_.bucketInstanceId,b,_.sourceLayerIndex,_.index,d.tileID);const me={bucket:_,layout:E,posMatrix:z,textLabelPlaneMatrix:Q,labelToScreenMatrix:H,scale:A,textPixelRatio:M,holdingForFade:d.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:c.ah(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const Se of _.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:ye,symbolInstanceEnd:Pe}=Se;i.push({sortKey:ie,symbolInstanceStart:ye,symbolInstanceEnd:Pe,parameters:me})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:me})}attemptAnchorPlacement(i,l,d,f,_,b,S,E,A,M,z,V,Y,X,Q,H){const me=c.aq[i.textAnchor],Se=[i.textOffset0,i.textOffset1],ie=Ge(me,d,f,Se,_),ye=this.collisionIndex.placeCollisionBox(Ue(l,ie.x,ie.y,b,S,this.transform.angle),z,E,A,M.predicate,H);if((!Q||this.collisionIndex.placeCollisionBox(Ue(Q,ie.x,ie.y,b,S,this.transform.angle),z,E,A,M.predicate,H).box.length!==0)&&ye.box.length>0){let Pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Pe=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:Se,width:d,height:f,anchor:me,textBoxScale:_,prevAnchor:Pe},this.markUsedJustification(Y,me,V,X),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,X,V),this.placedOrientations[V.crossTileID]=X),{shift:ie,placedGlyphBoxes:ye}}}placeLayerBucketPart(i,l,d){const{bucket:f,layout:_,posMatrix:b,textLabelPlaneMatrix:S,labelToScreenMatrix:E,textPixelRatio:A,holdingForFade:M,collisionBoxArray:z,partiallyEvaluatedTextSize:V,collisionGroup:Y}=i.parameters,X=_.get("text-optional"),Q=_.get("icon-optional"),H=c.ar(_,"text-overlap","text-allow-overlap"),me=H==="always",Se=c.ar(_,"icon-overlap","icon-allow-overlap"),ie=Se==="always",ye=_.get("text-rotation-alignment")==="map",Pe=_.get("text-pitch-alignment")==="map",Ae=_.get("icon-text-fit")!=="none",ze=_.get("symbol-z-order")==="viewport-y",Be=me&&(ie||!f.hasIconData()||Q),Fe=ie&&(me||!f.hasTextData()||X);!f.collisionArrays&&z&&f.deserializeCollisionBoxes(z);const $e=this.retainedQueryData[f.bucketInstanceId].tileID,ht=this.terrain?(Ye,vt)=>this.terrain.getElevation($e,Ye,vt):null,Zt=(Ye,vt)=>{var pt,pn;if(l[Ye.crossTileID])return;if(M)return void(this.placements[Ye.crossTileID]=new he(!1,!1,!1));let Vt=!1,Mt=!1,Gt=!0,jn=null,_n={box:null,offscreen:null},vi={box:null,offscreen:null},ni=null,qn=null,hr=null,wn=0,es=0,ts=0;vt.textFeatureIndex?wn=vt.textFeatureIndex:Ye.useRuntimeCollisionCircles&&(wn=Ye.featureIndex),vt.verticalTextFeatureIndex&&(es=vt.verticalTextFeatureIndex);const Gs=vt.textBox;if(Gs){const Ci=On=>{let ii=c.ai.horizontal;if(f.allowVerticalPlacement&&!On&&this.prevPlacement){const Zi=this.prevPlacement.placedOrientations[Ye.crossTileID];Zi&&(this.placedOrientations[Ye.crossTileID]=Zi,ii=Zi,this.markUsedOrientation(f,ii,Ye))}return ii},wi=(On,ii)=>{if(f.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&vt.verticalTextBox){for(const Zi of f.writingModes)if(Zi===c.ai.vertical?(_n=ii(),vi=_n):_n=On(),_n&&_n.box&&_n.box.length)break}else _n=On()},Di=Ye.textAnchorOffsetStartIndex,go=Ye.textAnchorOffsetEndIndex;if(go===Di){const On=(ii,Zi)=>{const Vn=this.collisionIndex.placeCollisionBox(ii,H,A,b,Y.predicate,ht);return Vn&&Vn.box&&Vn.box.length&&(this.markUsedOrientation(f,Zi,Ye),this.placedOrientations[Ye.crossTileID]=Zi),Vn};wi(()=>On(Gs,c.ai.horizontal),()=>{const ii=vt.verticalTextBox;return f.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&ii?On(ii,c.ai.vertical):{box:null,offscreen:null}}),Ci(_n&&_n.box&&_n.box.length)}else{let On=c.aq[(pn=(pt=this.prevPlacement)===null||pt===void 0?void 0:pt.variableOffsets[Ye.crossTileID])===null||pn===void 0?void 0:pn.anchor];const ii=(Vn,yo,Hl)=>{const tp=Vn.x2-Vn.x1,np=Vn.y2-Vn.y1,Km=Ye.textBoxScale,Bu=Ae&&Se==="never"?yo:null;let ns={box:[],offscreen:!1},_o=H==="never"?1:2,is="never";On&&_o++;for(let Ar=0;Ar<_o;Ar++){for(let rs=Di;rs<go;rs++){const Nu=f.textAnchorOffsets.get(rs);if(On&&Nu.textAnchor!==On)continue;const Ss=this.attemptAnchorPlacement(Nu,Vn,tp,np,Km,ye,Pe,A,b,Y,is,Ye,f,Hl,Bu,ht);if(Ss&&(ns=Ss.placedGlyphBoxes,ns&&ns.box&&ns.box.length))return Vt=!0,jn=Ss.shift,ns}On?On=null:is=H}return ns};wi(()=>ii(Gs,vt.iconBox,c.ai.horizontal),()=>{const Vn=vt.verticalTextBox;return f.allowVerticalPlacement&&!(_n&&_n.box&&_n.box.length)&&Ye.numVerticalGlyphVertices>0&&Vn?ii(Vn,vt.verticalIconBox,c.ai.vertical):{box:null,offscreen:null}}),_n&&(Vt=_n.box,Gt=_n.offscreen);const Zi=Ci(_n&&_n.box);if(!Vt&&this.prevPlacement){const Vn=this.prevPlacement.variableOffsets[Ye.crossTileID];Vn&&(this.variableOffsets[Ye.crossTileID]=Vn,this.markUsedJustification(f,Vn.anchor,Ye,Zi))}}}if(ni=_n,Vt=ni&&ni.box&&ni.box.length>0,Gt=ni&&ni.offscreen,Ye.useRuntimeCollisionCircles){const Ci=f.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),wi=c.aj(f.textSizeData,V,Ci),Di=_.get("text-padding");qn=this.collisionIndex.placeCollisionCircles(H,Ci,f.lineVertexArray,f.glyphOffsetArray,wi,b,S,E,d,Pe,Y.predicate,Ye.collisionCircleDiameter,Di,ht),qn.circles.length&&qn.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),Vt=me||qn.circles.length>0&&!qn.collisionDetected,Gt=Gt&&qn.offscreen}if(vt.iconFeatureIndex&&(ts=vt.iconFeatureIndex),vt.iconBox){const Ci=wi=>{const Di=Ae&&jn?Ue(wi,jn.x,jn.y,ye,Pe,this.transform.angle):wi;return this.collisionIndex.placeCollisionBox(Di,Se,A,b,Y.predicate,ht)};vi&&vi.box&&vi.box.length&&vt.verticalIconBox?(hr=Ci(vt.verticalIconBox),Mt=hr.box.length>0):(hr=Ci(vt.iconBox),Mt=hr.box.length>0),Gt=Gt&&hr.offscreen}const mo=X||Ye.numHorizontalGlyphVertices===0&&Ye.numVerticalGlyphVertices===0,Xo=Q||Ye.numIconVertices===0;if(mo||Xo?Xo?mo||(Mt=Mt&&Vt):Vt=Mt&&Vt:Mt=Vt=Mt&&Vt,Vt&&ni&&ni.box&&this.collisionIndex.insertCollisionBox(ni.box,H,_.get("text-ignore-placement"),f.bucketInstanceId,vi&&vi.box&&es?es:wn,Y.ID),Mt&&hr&&this.collisionIndex.insertCollisionBox(hr.box,Se,_.get("icon-ignore-placement"),f.bucketInstanceId,ts,Y.ID),qn&&(Vt&&this.collisionIndex.insertCollisionCircles(qn.circles,H,_.get("text-ignore-placement"),f.bucketInstanceId,wn,Y.ID),d)){const Ci=f.bucketInstanceId;let wi=this.collisionCircleArrays[Ci];wi===void 0&&(wi=this.collisionCircleArrays[Ci]=new ve);for(let Di=0;Di<qn.circles.length;Di+=4)wi.circles.push(qn.circles[Di+0]),wi.circles.push(qn.circles[Di+1]),wi.circles.push(qn.circles[Di+2]),wi.circles.push(qn.collisionDetected?1:0)}if(Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ye.crossTileID]=new he(Vt||Be,Mt||Fe,Gt||f.justReloaded),l[Ye.crossTileID]=!0};if(ze){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ye=f.getSortedSymbolIndexes(this.transform.angle);for(let vt=Ye.length-1;vt>=0;--vt){const pt=Ye[vt];Zt(f.symbolInstances.get(pt),f.collisionArrays[pt])}}else for(let Ye=i.symbolInstanceStart;Ye<i.symbolInstanceEnd;Ye++)Zt(f.symbolInstances.get(Ye),f.collisionArrays[Ye]);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const Ye=this.collisionCircleArrays[f.bucketInstanceId];c.as(Ye.invProjMatrix,b),Ye.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}markUsedJustification(i,l,d,f){let _;_=f===c.ai.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.at(l)];const b=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const S of b)S>=0&&(i.text.placedSymbolArray.get(S).crossTileID=_>=0&&S!==_?0:d.crossTileID)}markUsedOrientation(i,l,d){const f=l===c.ai.horizontal||l===c.ai.horizontalOnly?l:0,_=l===c.ai.vertical?l:0,b=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const S of b)i.text.placedSymbolArray.get(S).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let d=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const f=l?l.symbolFadeChange(i):1,_=l?l.opacities:{},b=l?l.variableOffsets:{},S=l?l.placedOrientations:{};for(const E in this.placements){const A=this.placements[E],M=_[E];M?(this.opacities[E]=new ge(M,f,A.text,A.icon),d=d||A.text!==M.text.placed||A.icon!==M.icon.placed):(this.opacities[E]=new ge(null,f,A.text,A.icon,A.skipFade),d=d||A.text||A.icon)}for(const E in _){const A=_[E];if(!this.opacities[E]){const M=new ge(A,f,!1,!1);M.isHidden()||(this.opacities[E]=M,d=d||A.text.placed||A.icon.placed)}}for(const E in b)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=b[E]);for(const E in S)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=S[E]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:i)}updateLayerOpacities(i,l){const d={};for(const f of l){const _=f.getBucket(i);_&&f.latestFeatureIndex&&i.id===_.layerIds[0]&&this.updateBucketOpacities(_,d,f.collisionBoxArray)}}updateBucketOpacities(i,l,d){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const f=i.layers[0],_=f.layout,b=new ge(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),E=_.get("icon-allow-overlap"),A=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),M=_.get("text-rotation-alignment")==="map",z=_.get("text-pitch-alignment")==="map",V=_.get("icon-text-fit")!=="none",Y=new ge(null,0,S&&(E||!i.hasIconData()||_.get("icon-optional")),E&&(S||!i.hasTextData()||_.get("text-optional")),!0);!i.collisionArrays&&d&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(d);const X=(Q,H,me)=>{for(let Se=0;Se<H/4;Se++)Q.opacityVertexArray.emplaceBack(me);Q.hasVisibleVertices=Q.hasVisibleVertices||me!==Sr};for(let Q=0;Q<i.symbolInstances.length;Q++){const H=i.symbolInstances.get(Q),{numHorizontalGlyphVertices:me,numVerticalGlyphVertices:Se,crossTileID:ie}=H;let ye=this.opacities[ie];l[ie]?ye=b:ye||(ye=Y,this.opacities[ie]=ye),l[ie]=!0;const Pe=H.numIconVertices>0,Ae=this.placedOrientations[H.crossTileID],ze=Ae===c.ai.vertical,Be=Ae===c.ai.horizontal||Ae===c.ai.horizontalOnly;if(me>0||Se>0){const Fe=_i(ye.text);X(i.text,me,ze?Sr:Fe),X(i.text,Se,Be?Sr:Fe);const $e=ye.text.isHidden();[H.rightJustifiedTextSymbolIndex,H.centerJustifiedTextSymbolIndex,H.leftJustifiedTextSymbolIndex].forEach(Ye=>{Ye>=0&&(i.text.placedSymbolArray.get(Ye).hidden=$e||ze?1:0)}),H.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(H.verticalPlacedTextSymbolIndex).hidden=$e||Be?1:0);const ht=this.variableOffsets[H.crossTileID];ht&&this.markUsedJustification(i,ht.anchor,H,Ae);const Zt=this.placedOrientations[H.crossTileID];Zt&&(this.markUsedJustification(i,"left",H,Zt),this.markUsedOrientation(i,Zt,H))}if(Pe){const Fe=_i(ye.icon),$e=!(V&&H.verticalPlacedIconSymbolIndex&&ze);H.placedIconSymbolIndex>=0&&(X(i.icon,H.numIconVertices,$e?Fe:Sr),i.icon.placedSymbolArray.get(H.placedIconSymbolIndex).hidden=ye.icon.isHidden()),H.verticalPlacedIconSymbolIndex>=0&&(X(i.icon,H.numVerticalIconVertices,$e?Sr:Fe),i.icon.placedSymbolArray.get(H.verticalPlacedIconSymbolIndex).hidden=ye.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Fe=i.collisionArrays[Q];if(Fe){let $e=new c.P(0,0);if(Fe.textBox||Fe.verticalTextBox){let Zt=!0;if(A){const Ye=this.variableOffsets[ie];Ye?($e=Ge(Ye.anchor,Ye.width,Ye.height,Ye.textOffset,Ye.textBoxScale),M&&$e._rotate(z?this.transform.angle:-this.transform.angle)):Zt=!1}Fe.textBox&&St(i.textCollisionBox.collisionVertexArray,ye.text.placed,!Zt||ze,$e.x,$e.y),Fe.verticalTextBox&&St(i.textCollisionBox.collisionVertexArray,ye.text.placed,!Zt||Be,$e.x,$e.y)}const ht=!!(!Be&&Fe.verticalIconBox);Fe.iconBox&&St(i.iconCollisionBox.collisionVertexArray,ye.icon.placed,ht,V?$e.x:0,V?$e.y:0),Fe.verticalIconBox&&St(i.iconCollisionBox.collisionVertexArray,ye.icon.placed,!ht,V?$e.x:0,V?$e.y:0)}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Q.invProjMatrix,i.placementViewportMatrix=Q.viewportMatrix,i.collisionCircleArray=Q.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,l){const d=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*d>i}setStale(){this.stale=!0}}function St(m,i,l,d,f){m.emplaceBack(i?1:0,l?1:0,d||0,f||0),m.emplaceBack(i?1:0,l?1:0,d||0,f||0),m.emplaceBack(i?1:0,l?1:0,d||0,f||0),m.emplaceBack(i?1:0,l?1:0,d||0,f||0)}const Jt=Math.pow(2,25),cn=Math.pow(2,24),Ot=Math.pow(2,17),Dt=Math.pow(2,16),pi=Math.pow(2,9),yn=Math.pow(2,8),Xn=Math.pow(2,1);function _i(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const i=m.placed?1:0,l=Math.floor(127*m.opacity);return l*Jt+i*cn+l*Ot+i*Dt+l*pi+i*yn+l*Xn+i}const Sr=0;class yd{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,l,d,f,_){const b=this._bucketParts;for(;this._currentTileIndex<i.length;)if(l.getBucketParts(b,f,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((S,E)=>S.sortKey-E.sortKey));this._currentPartIndex<b.length;)if(l.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,_())return!0;return!1}}class Bo{constructor(i,l,d,f,_,b,S,E){this.placement=new ct(i,l,b,S,E),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(i,l,d){const f=c.h.now(),_=()=>!this._forceFullPlacement&&c.h.now()-f>2;for(;this._currentPlacementIndex>=0;){const b=l[i[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=S)&&(!b.maxzoom||b.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new yd(b)),this._inProgressLayer.continuePlacement(d[b.source],this.placement,this._showCollisionBoxes,b,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const No=512/c.N/2;class Lm{constructor(i,l,d){this.tileID=i,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let _=0;_<l.length;_++){const b=l.get(_),S=b.key,E=f.get(S);E?E.push(b):f.set(S,[b])}for(const[_,b]of f){const S={positions:b.map(E=>({x:Math.floor(E.anchorX*No),y:Math.floor(E.anchorY*No)})),crossTileIDs:b.map(E=>E.crossTileID)};if(S.positions.length>128){const E=new c.av(S.positions.length,16,Uint16Array);for(const{x:A,y:M}of S.positions)E.add(A,M);E.finish(),delete S.positions,S.index=E}this._symbolsByKey[_]=S}}getScaledCoordinates(i,l){const{x:d,y:f,z:_}=this.tileID.canonical,{x:b,y:S,z:E}=l.canonical,A=No/Math.pow(2,E-_),M=(S*c.N+i.anchorY)*A,z=f*c.N*No;return{x:Math.floor((b*c.N+i.anchorX)*A-d*c.N*No),y:Math.floor(M-z)}}findMatches(i,l,d){const f=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let _=0;_<i.length;_++){const b=i.get(_);if(b.crossTileID)continue;const S=this._symbolsByKey[b.key];if(!S)continue;const E=this.getScaledCoordinates(b,l);if(S.index){const A=S.index.range(E.x-f,E.y-f,E.x+f,E.y+f).sort();for(const M of A){const z=S.crossTileIDs[M];if(!d[z]){d[z]=!0,b.crossTileID=z;break}}}else if(S.positions)for(let A=0;A<S.positions.length;A++){const M=S.positions[A],z=S.crossTileIDs[A];if(Math.abs(M.x-E.x)<=f&&Math.abs(M.y-E.y)<=f&&!d[z]){d[z]=!0,b.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class dn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const l=Math.round((i-this.lng)/360);if(l!==0)for(const d in this.indexes){const f=this.indexes[d],_={};for(const b in f){const S=f[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+l),_[S.tileID.key]=S}this.indexes[d]=_}this.lng=i}addBucket(i,l,d){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let _=0;_<l.symbolInstances.length;_++)l.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const f=this.usedCrossTileIDs[i.overscaledZ];for(const _ in this.indexes){const b=this.indexes[_];if(Number(_)>i.overscaledZ)for(const S in b){const E=b[S];E.tileID.isChildOf(i)&&E.findMatches(l.symbolInstances,i,f)}else{const S=b[i.scaledTo(Number(_)).key];S&&S.findMatches(l.symbolInstances,i,f)}}for(let _=0;_<l.symbolInstances.length;_++){const b=l.symbolInstances.get(_);b.crossTileID||(b.crossTileID=d.generate(),f[b.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Lm(i,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(i,l){for(const d of l.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[i][f]}removeStaleBuckets(i){let l=!1;for(const d in this.indexes){const f=this.indexes[d];for(const _ in f)i[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[_]),delete f[_],l=!0)}return l}}class vl{constructor(){this.layerIndexes={},this.crossTileIDs=new dn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,l,d){let f=this.layerIndexes[i.id];f===void 0&&(f=this.layerIndexes[i.id]=new Xc);let _=!1;const b={};f.handleWrapJump(d);for(const S of l){const E=S.getBucket(i);E&&i.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(S.tileID,E,this.crossTileIDs)&&(_=!0),b[E.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(_=!0),_}pruneUnusedLayers(i){const l={};i.forEach(d=>{l[d]=!0});for(const d in this.layerIndexes)l[d]||delete this.layerIndexes[d]}}const Ei=(m,i)=>c.x(m,i&&i.filter(l=>l.identifier!=="source.canvas")),or=c.F(c.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),zm=c.F(c.ax,["setCenter","setZoom","setBearing","setPitch"]),Tr=c.aw();class xi extends c.E{constructor(i,l={}){super(),this.map=i,this.dispatcher=new wt(so(),this,i._getMapId()),this.imageManager=new Ct,this.imageManager.setEventedParent(this),this.glyphManager=new Ve(i._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Ne(256,512),this.crossTileSymbolIndex=new vl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.az());const d=this;this._rtlTextPluginCallback=xi.registerForPluginStateChange(f=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:f.pluginStatus,pluginURL:f.pluginURL},(_,b)=>{if(c.aA(_),b&&b.every(S=>S))for(const S in d.sourceCaches){const E=d.sourceCaches[S].getSource().type;E!=="vector"&&E!=="geojson"||d.sourceCaches[S].reload()}})}),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const _=this.sourceCaches[f.sourceId];if(!_)return;const b=_.getSource();if(b&&b.vectorLayerIds)for(const S in this._layers){const E=this._layers[S];E.source===b.id&&this._validateLayer(E)}})}loadURL(i,l={},d){this.fire(new c.k("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const f=this.map._requestManager.transformRequest(i,Z.Style);this._request=c.f(f,(_,b)=>{this._request=null,_?this.fire(new c.j(_)):b&&this._load(b,l,d)})}loadJSON(i,l={},d){this.fire(new c.k("dataloading",{dataType:"style"})),this._request=c.h.frame(()=>{this._request=null,l.validate=l.validate!==!1,this._load(i,l,d)})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Tr,{validate:!1})}_load(i,l,d){var f;const _=l.transformStyle?l.transformStyle(d,i):i;if(!l.validate||!Ei(this,c.y(_))){this._loaded=!0,this.stylesheet=_;for(const b in _.sources)this.addSource(b,_.sources[b],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new at(this.stylesheet.light),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const i=c.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",i),this._order=i.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of i){const d=c.aC(l);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(i,l=!1,d=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(f,_,b,S){const E=ke(f),A=E.length,M=b>1?"@2x":"",z={},V={},Y={};for(const{id:X,url:Q}of E){const H=_.transformRequest(_.normalizeSpriteURL(Q,M,".json"),Z.SpriteJSON),me=`${X}_${H.url}`;z[me]=c.f(H,(ye,Pe)=>{delete z[me],V[X]=Pe,it(S,V,Y,ye,A)});const Se=_.transformRequest(_.normalizeSpriteURL(Q,M,".png"),Z.SpriteImage),ie=`${X}_${Se.url}`;z[ie]=ue.getImage(Se,(ye,Pe)=>{delete z[ie],Y[X]=Pe,it(S,V,Y,ye,A)})}return{cancel(){for(const X of Object.values(z))X.cancel()}}}(i,this.map._requestManager,this.map.getPixelRatio(),(f,_)=>{if(this._spriteRequest=null,f)this.fire(new c.j(f));else if(_)for(const b in _){this._spritesImagesIds[b]=[];const S=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(E=>!(E in _)):[];for(const E of S)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in _[b]){const A=b==="default"?E:`${b}:${E}`;this._spritesImagesIds[b].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,_[b][E],!1):this.imageManager.addImage(A,_[b][E]),l&&(this._changedImages[A]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(i){const l=this.sourceCaches[i.source];if(!l)return;const d=i.sourceLayer;if(!d)return;const f=l.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i){const l=this._serializedAllLayers();if(!i||i.length===0)return Object.values(l);const d=[];for(const f of i)l[f]&&d.push(l[f]);return d}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const l=Object.keys(this._layers);for(const d of l){const f=this._layers[d];f.type!=="custom"&&(i[d]=f.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const l=this._changed;if(this._changed){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const b in this._updatedSources){const S=this._updatedSources[b];if(S==="reload")this._reloadSource(b);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];d[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(i,this._availableImages),!_.isHidden(i.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in d){const _=this.sourceCaches[f];d[f]!==_.used&&_.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(i),this.z=i.zoom,l&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(i),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,l={}){this._checkLoaded();const d=this.serialize();if(i=l.transformStyle?l.transformStyle(d,i):i,Ei(this,c.y(i)))return!1;(i=c.aD(i)).layers=c.aB(i.layers);const f=c.aE(d,i).filter(b=>!(b.command in zm));if(f.length===0)return!1;const _=f.filter(b=>!(b.command in or));if(_.length>0)throw new Error(`Unimplemented: ${_.map(b=>b.command).join(", ")}.`);for(const b of f)b.command!=="setTransition"&&this[b.command].apply(this,b.args);return this.stylesheet=i,this._serializedLayers=null,!0}addImage(i,l){if(this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,l),this._afterImageUpdated(i)}updateImage(i,l){this.imageManager.updateImage(i,l)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,l,d={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.y.source,`sources.${i}`,l,null,d))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const f=this.sourceCaches[i]=new ti(i,l,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:i})),f.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===i)return this.fire(new c.j(new Error(`Source "${i}" cannot be removed while layer "${d}" is using it.`)));const l=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],l.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,l){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const d=this.sourceCaches[i].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(l),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,l,d={}){this._checkLoaded();const f=i.id;if(this.getLayer(f))return void this.fire(new c.j(new Error(`Layer "${f}" already exists on this map.`)));let _;if(i.type==="custom"){if(Ei(this,c.aF(i)))return;_=c.aC(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(f,i.source),i=c.aD(i),i=c.e(i,{source:f})),this._validate(c.y.layer,`layers.${f}`,i,{arrayIndex:-1},d))return;_=c.aC(i),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const b=l?this._order.indexOf(l):this._order.length;if(l&&b===-1)this.fire(new c.j(new Error(`Cannot add layer "${f}" before non-existing layer "${l}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const S=this._removedLayers[f];delete this._removedLayers[f],S.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(i,l){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new c.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===l)return;const d=this._order.indexOf(i);this._order.splice(d,1);const f=l?this._order.indexOf(l):this._order.length;l&&f===-1?this.fire(new c.j(new Error(`Cannot move layer "${i}" before non-existing layer "${l}".`))):(this._order.splice(f,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const l=this._layers[i];if(!l)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${i}".`)));l.setEventedParent(null);const d=this._order.indexOf(i);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=l,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],l.onRemove&&l.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,l,d){this._checkLoaded();const f=this.getLayer(i);f?f.minzoom===l&&f.maxzoom===d||(l!=null&&(f.minzoom=l),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,l,d={}){this._checkLoaded();const f=this.getLayer(i);if(f){if(!c.aG(f.filter,l))return l==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(c.y.filter,`layers.${f.id}.filter`,l,null,d)||(f.filter=c.aD(l),this._updateLayer(f)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return c.aD(this.getLayer(i).filter)}setLayoutProperty(i,l,d,f={}){this._checkLoaded();const _=this.getLayer(i);_?c.aG(_.getLayoutProperty(l),d)||(_.setLayoutProperty(l,d,f),this._updateLayer(_)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,l){const d=this.getLayer(i);if(d)return d.getLayoutProperty(l);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,l,d,f={}){this._checkLoaded();const _=this.getLayer(i);_?c.aG(_.getPaintProperty(l),d)||(_.setPaintProperty(l,d,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,l){return this.getLayer(i).getPaintProperty(l)}setFeatureState(i,l){this._checkLoaded();const d=i.source,f=i.sourceLayer,_=this.sourceCaches[d];if(_===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const b=_.getSource().type;b==="geojson"&&f?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,i.id,l)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,l){this._checkLoaded();const d=i.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const _=f.getSource().type,b=_==="vector"?i.sourceLayer:void 0;_!=="vector"||b?l&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,i.id,l):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const l=i.source,d=i.sourceLayer,f=this.sourceCaches[l];if(f!==void 0)return f.getSource().type!=="vector"||d?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,i.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=c.aH(this.sourceCaches,_=>_.serialize()),l=this._serializeByIds(this._order),d=this.map.getTerrain()||void 0,f=this.stylesheet;return c.aI({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:i,layers:l,terrain:d},_=>_!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const l=b=>this._layers[b].type==="fill-extrusion",d={},f=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(l(S)){d[S]=b;for(const E of i){const A=E[S];if(A)for(const M of A)f.push(M)}}}f.sort((b,S)=>S.intersectionZ-b.intersectionZ);const _=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(l(S))for(let E=f.length-1;E>=0;E--){const A=f[E].feature;if(d[A.layer.id]<b)break;_.push(A),f.pop()}else for(const E of i){const A=E[S];if(A)for(const M of A)_.push(M.feature)}}return _}queryRenderedFeatures(i,l,d){l&&l.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",l.filter,null,l);const f={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const S of l.layers){const E=this._layers[S];if(!E)return this.fire(new c.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];f[E.source]=!0}}const _=[];l.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const S in this.sourceCaches)l.layers&&!f[S]||_.push(jt(this.sourceCaches[S],this._layers,b,i,l,d));return this.placement&&_.push(function(S,E,A,M,z,V,Y){const X={},Q=V.queryRenderedSymbols(M),H=[];for(const me of Object.keys(Q).map(Number))H.push(Y[me]);H.sort(_t);for(const me of H){const Se=me.featureIndex.lookupSymbolFeatures(Q[me.bucketInstanceId],E,me.bucketIndex,me.sourceLayerIndex,z.filter,z.layers,z.availableImages,S);for(const ie in Se){const ye=X[ie]=X[ie]||[],Pe=Se[ie];Pe.sort((Ae,ze)=>{const Be=me.featureSortOrder;if(Be){const Fe=Be.indexOf(Ae.featureIndex);return Be.indexOf(ze.featureIndex)-Fe}return ze.featureIndex-Ae.featureIndex});for(const Ae of Pe)ye.push(Ae)}}for(const me in X)X[me].forEach(Se=>{const ie=Se.feature,ye=A[S[me].source].getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=ye});return X}(this._layers,b,this.sourceCaches,i,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(i,l){l&&l.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",l.filter,null,l);const d=this.sourceCaches[i];return d?function(f,_){const b=f.getRenderableIds().map(A=>f.getTileByID(A)),S=[],E={};for(let A=0;A<b.length;A++){const M=b[A],z=M.tileID.canonical.key;E[z]||(E[z]=!0,M.querySourceFeatures(S,_))}return S}(d,l):[]}addSourceType(i,l,d){return qt(i)?d(new Error(`A source type called "${i}" already exists.`)):(((f,_)=>{zt[f]=_})(i,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:l.workerSourceURL},d):d(null,null))}getLight(){return this.light.getLight()}setLight(i,l={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const b in i)if(!c.aG(i[b],d[b])){f=!0;break}if(!f)return;const _={now:c.h.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,l),this.light.updateTransitions(_)}_validate(i,l,d,f,_={}){return(!_||_.validate!==!1)&&Ei(this,i.call(c.y,c.e({key:l,style:this.serialize(),value:d,styleSpec:c.v},f)))}_remove(i=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const d=this.sourceCaches[l];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const l in this.sourceCaches)this.sourceCaches[l].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,l,d,f,_=!1){let b=!1,S=!1;const E={};for(const A of this._order){const M=this._layers[A];if(M.type!=="symbol")continue;if(!E[M.source]){const V=this.sourceCaches[M.source];E[M.source]=V.getRenderableIds(!0).map(Y=>V.getTileByID(Y)).sort((Y,X)=>X.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(X.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(M,E[M.source],i.center.lng);b=b||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.h.now(),i.zoom))&&(this.pauseablePlacement=new Bo(i,this.map.terrain,this._order,_,l,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.h.now()),S=!0),b&&this.pauseablePlacement.placement.setStale()),S||b)for(const A of this._order){const M=this._layers[A];M.type==="symbol"&&this.placement.updateLayerOpacities(M,E[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.h.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,l,d){this.imageManager.getImages(l.icons,d),this._updateTilesForChangedImages();const f=this.sourceCaches[l.source];f&&f.setDependencies(l.tileID.key,l.type,l.icons)}getGlyphs(i,l,d){this.glyphManager.getGlyphs(l.stacks,d);const f=this.sourceCaches[l.source];f&&f.setDependencies(l.tileID.key,l.type,[""])}getResource(i,l,d){return c.m(l,d)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,l={}){this._checkLoaded(),i&&this._validate(c.y.glyphs,"glyphs",i,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,l,d={},f){this._checkLoaded();const _=[{id:i,url:l}],b=[...ke(this.stylesheet.sprite),..._];this._validate(c.y.sprite,"sprite",b,null,d)||(this.stylesheet.sprite=b,this._loadSprite(_,!0,f))}removeSprite(i){this._checkLoaded();const l=ke(this.stylesheet.sprite);if(l.find(d=>d.id===i)){if(this._spritesImagesIds[i])for(const d of this._spritesImagesIds[i])this.imageManager.removeImage(d),this._changedImages[d]=!0;l.splice(l.findIndex(d=>d.id===i),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return ke(this.stylesheet.sprite)}setSprite(i,l={},d){this._checkLoaded(),i&&this._validate(c.y.sprite,"sprite",i,null,l)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,d):(this._unloadSprite(),d&&d(null)))}}xi.registerForPluginStateChange=c.aK;var wl=c.Q([{name:"a_pos",type:"Int16",components:2}]),jo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const En={prelude:nn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:nn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:nn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:nn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:nn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:nn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:nn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:nn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:nn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:nn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:nn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:nn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:nn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:nn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:nn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:nn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:nn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:nn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:nn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:nn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:nn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:nn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:nn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:nn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:nn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:nn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:nn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",jo),terrainDepth:nn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",jo),terrainCoords:nn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",jo)};function nn(m,i){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=i.match(/attribute ([\w]+) ([\w]+)/g),f=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=_?_.concat(f):f,S={};return{fragmentSource:m=m.replace(l,(E,A,M,z,V)=>(S[V]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${M} ${z} ${V};
#else
uniform ${M} ${z} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${M} ${z} ${V} = u_${V};
#endif
`)),vertexSource:i=i.replace(l,(E,A,M,z,V)=>{const Y=z==="float"?"vec2":"vec4",X=V.match(/color/)?"color":Y;return S[V]?A==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${M} ${Y} a_${V};
varying ${M} ${z} ${V};
#else
uniform ${M} ${z} u_${V};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${M} ${z} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${X}(a_${V}, u_${V}_t);
#else
    ${M} ${z} ${V} = u_${V};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${M} ${Y} a_${V};
#else
uniform ${M} ${z} u_${V};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${M} ${z} ${V} = a_${V};
#else
    ${M} ${z} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${M} ${z} ${V} = unpack_mix_${X}(a_${V}, u_${V}_t);
#else
    ${M} ${z} ${V} = u_${V};
#endif
`}),staticAttributes:d,staticUniforms:b}}class oo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,l,d,f,_,b,S,E,A){this.context=i;let M=this.boundPaintVertexBuffers.length!==f.length;for(let z=0;!M&&z<f.length;z++)this.boundPaintVertexBuffers[z]!==f[z]&&(M=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==d||M||this.boundIndexBuffer!==_||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==A?this.freshBind(l,d,f,_,b,S,E,A):(i.bindVertexArray.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),E&&E.bind(),A&&A.bind())}freshBind(i,l,d,f,_,b,S,E){const A=i.numAttributes,M=this.context,z=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=E,l.enableAttributes(z,i);for(const V of d)V.enableAttributes(z,i);b&&b.enableAttributes(z,i),S&&S.enableAttributes(z,i),E&&E.enableAttributes(z,i),l.bind(),l.setVertexAttribPointers(z,i,_);for(const V of d)V.bind(),V.setVertexAttribPointers(z,i,_);b&&(b.bind(),b.setVertexAttribPointers(z,i,_)),f&&f.bind(),S&&(S.bind(),S.setVertexAttribPointers(z,i,_)),E&&(E.bind(),E.setVertexAttribPointers(z,i,_)),M.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Ln(m){const i=[];for(let l=0;l<m.length;l++){if(m[l]===null)continue;const d=m[l].split(" ");i.push(d.pop())}return i}class bl{constructor(i,l,d,f,_,b){const S=i.gl;this.program=S.createProgram();const E=Ln(l.staticAttributes),A=d?d.getBinderAttributes():[],M=E.concat(A),z=En.prelude.staticUniforms?Ln(En.prelude.staticUniforms):[],V=l.staticUniforms?Ln(l.staticUniforms):[],Y=d?d.getBinderUniforms():[],X=z.concat(V).concat(Y),Q=[];for(const Ae of X)Q.indexOf(Ae)<0&&Q.push(Ae);const H=d?d.defines():[];_&&H.push("#define OVERDRAW_INSPECTOR;"),b&&H.push("#define TERRAIN3D;");const me=H.concat(En.prelude.fragmentSource,l.fragmentSource).join(`
`),Se=H.concat(En.prelude.vertexSource,l.vertexSource).join(`
`),ie=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ie,me),S.compileShader(ie),!S.getShaderParameter(ie,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(ie)}`);S.attachShader(this.program,ie);const ye=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ye,Se),S.compileShader(ye),!S.getShaderParameter(ye,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(ye)}`);S.attachShader(this.program,ye),this.attributes={};const Pe={};this.numAttributes=M.length;for(let Ae=0;Ae<this.numAttributes;Ae++)M[Ae]&&(S.bindAttribLocation(this.program,Ae,M[Ae]),this.attributes[M[Ae]]=Ae);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(ye),S.deleteShader(ie);for(let Ae=0;Ae<Q.length;Ae++){const ze=Q[Ae];if(ze&&!Pe[ze]){const Be=S.getUniformLocation(this.program,ze);Be&&(Pe[ze]=Be)}}this.fixedUniforms=f(i,Pe),this.terrainUniforms=((Ae,ze)=>({u_depth:new c.aL(Ae,ze.u_depth),u_terrain:new c.aL(Ae,ze.u_terrain),u_terrain_dim:new c.aM(Ae,ze.u_terrain_dim),u_terrain_matrix:new c.aN(Ae,ze.u_terrain_matrix),u_terrain_unpack:new c.aO(Ae,ze.u_terrain_unpack),u_terrain_exaggeration:new c.aM(Ae,ze.u_terrain_exaggeration)}))(i,Pe),this.binderUniforms=d?d.getUniforms(i,Pe):[]}draw(i,l,d,f,_,b,S,E,A,M,z,V,Y,X,Q,H,me,Se){const ie=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(d),i.setStencilMode(f),i.setColorMode(_),i.setCullFace(b),E){i.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,E.depthTexture),i.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,E.texture);for(const Pe in this.terrainUniforms)this.terrainUniforms[Pe].set(E[Pe])}for(const Pe in this.fixedUniforms)this.fixedUniforms[Pe].set(S[Pe]);Q&&Q.setUniforms(i,this.binderUniforms,Y,{zoom:X});let ye=0;switch(l){case ie.LINES:ye=2;break;case ie.TRIANGLES:ye=3;break;case ie.LINE_STRIP:ye=1}for(const Pe of V.get()){const Ae=Pe.vaos||(Pe.vaos={});(Ae[A]||(Ae[A]=new oo)).bind(i,this,M,Q?Q.getPaintVertexBuffers():[],z,Pe.vertexOffset,H,me,Se),ie.drawElements(l,Pe.primitiveLength*ye,ie.UNSIGNED_SHORT,Pe.primitiveOffset*ye*2)}}}function kr(m,i,l){const d=1/pe(l,1,i.transform.tileZoom),f=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,i.transform.tileZoom)/f,b=_*(l.tileID.canonical.x+l.tileID.wrap*f),S=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S]}}const Yc=(m,i,l,d)=>{const f=i.style.light,_=f.properties.get("position"),b=[_.x,_.y,_.z],S=function(){var A=new c.A(9);return c.A!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A}();f.properties.get("anchor")==="viewport"&&function(A,M){var z=Math.sin(M),V=Math.cos(M);A[0]=V,A[1]=z,A[2]=0,A[3]=-z,A[4]=V,A[5]=0,A[6]=0,A[7]=0,A[8]=1}(S,-i.transform.angle),function(A,M,z){var V=M[0],Y=M[1],X=M[2];A[0]=V*z[0]+Y*z[3]+X*z[6],A[1]=V*z[1]+Y*z[4]+X*z[7],A[2]=V*z[2]+Y*z[5]+X*z[8]}(b,b,S);const E=f.properties.get("color");return{u_matrix:m,u_lightpos:b,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+l,u_opacity:d}},Os=(m,i,l,d,f,_,b)=>c.e(Yc(m,i,l,d),kr(_,i,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),_d=m=>({u_matrix:m}),Jc=(m,i,l,d)=>c.e(_d(m),kr(l,i,d)),Sl=(m,i)=>({u_matrix:m,u_world:i}),Tl=(m,i,l,d,f)=>c.e(Jc(m,i,l,d),{u_world:f}),Vs=(m,i,l,d)=>{const f=m.transform;let _,b;if(d.paint.get("circle-pitch-alignment")==="map"){const S=pe(l,1,f.zoom);_=!0,b=[S,S]}else _=!1,b=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(i.posMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:b}},Qc=(m,i,l)=>{const d=pe(l,1,i.zoom),f=Math.pow(2,i.zoom-l.tileID.overscaledZ),_=l.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:i.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[i.pixelsToGLUnits[0]/(d*f),i.pixelsToGLUnits[1]/(d*f)],u_overscale_factor:_}},Pa=(m,i,l=1)=>({u_matrix:m,u_color:i,u_overlay:0,u_overlay_scale:l}),xd=m=>({u_matrix:m}),Dm=(m,i,l,d)=>({u_matrix:m,u_extrude_scale:pe(i,1,l),u_intensity:d});function eu(m,i){const l=Math.pow(2,i.canonical.z),d=i.canonical.y;return[new c.U(0,d/l).toLngLat().lat,new c.U(0,(d+1)/l).toLngLat().lat]}const tu=(m,i,l,d)=>{const f=m.transform;return{u_matrix:kl(m,i,l,d),u_ratio:1/pe(i,1,f.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},vd=(m,i,l,d,f)=>c.e(tu(m,i,l,f),{u_image:0,u_image_height:d}),Rm=(m,i,l,d,f)=>{const _=m.transform,b=bd(i,_);return{u_matrix:kl(m,i,l,f),u_texsize:i.imageAtlasTexture.size,u_ratio:1/pe(i,1,_.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[b,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},wd=(m,i,l,d,f,_)=>{const b=m.lineAtlas,S=bd(i,m.transform),E=l.layout.get("line-cap")==="round",A=b.getDash(d.from,E),M=b.getDash(d.to,E),z=A.width*f.fromScale,V=M.width*f.toScale;return c.e(tu(m,i,l,_),{u_patternscale_a:[S/z,-A.height/2],u_patternscale_b:[S/V,-M.height/2],u_sdfgamma:b.width/(256*Math.min(z,V)*m.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:M.y,u_mix:f.t})};function bd(m,i){return 1/pe(m,1,i.tileZoom)}function kl(m,i,l,d){return m.translatePosMatrix(d?d.posMatrix:i.tileID.posMatrix,i,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Sd=(m,i,l,d,f)=>{return{u_matrix:m,u_tl_parent:i,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(b=f.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(_=f.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Td(f.paint.get("raster-hue-rotate"))};var _,b};function Td(m){m*=Math.PI/180;const i=Math.sin(m),l=Math.cos(m);return[(2*l+1)/3,(-Math.sqrt(3)*i-l+1)/3,(Math.sqrt(3)*i-l+1)/3]}const nu=(m,i,l,d,f,_,b,S,E,A)=>{const M=f.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:M.cameraToCenterDistance,u_pitch:M.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:M.width/M.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:b,u_coord_matrix:S,u_is_text:+E,u_pitch_with_map:+d,u_texsize:A,u_texture:0}},iu=(m,i,l,d,f,_,b,S,E,A,M)=>{const z=f.transform;return c.e(nu(m,i,l,d,f,_,b,S,E,A),{u_gamma_scale:d?Math.cos(z._pitch)*z.cameraToCenterDistance:1,u_device_pixel_ratio:f.pixelRatio,u_is_halo:+M})},ao=(m,i,l,d,f,_,b,S,E,A)=>c.e(iu(m,i,l,d,f,_,b,S,!0,E,!0),{u_texsize_icon:A,u_texture_icon:1}),El=(m,i,l)=>({u_matrix:m,u_opacity:i,u_color:l}),Er=(m,i,l,d,f,_)=>c.e(function(b,S,E,A){const M=E.imageManager.getPattern(b.from.toString()),z=E.imageManager.getPattern(b.to.toString()),{width:V,height:Y}=E.imageManager.getPixelSize(),X=Math.pow(2,A.tileID.overscaledZ),Q=A.tileSize*Math.pow(2,E.transform.tileZoom)/X,H=Q*(A.tileID.canonical.x+A.tileID.wrap*X),me=Q*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[V,Y],u_mix:S.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/pe(A,1,E.transform.tileZoom),u_pixel_coord_upper:[H>>16,me>>16],u_pixel_coord_lower:[65535&H,65535&me]}}(d,_,l,f),{u_matrix:m,u_opacity:i}),Cl={fillExtrusion:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_lightpos:new c.aP(m,i.u_lightpos),u_lightintensity:new c.aM(m,i.u_lightintensity),u_lightcolor:new c.aP(m,i.u_lightcolor),u_vertical_gradient:new c.aM(m,i.u_vertical_gradient),u_opacity:new c.aM(m,i.u_opacity)}),fillExtrusionPattern:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_lightpos:new c.aP(m,i.u_lightpos),u_lightintensity:new c.aM(m,i.u_lightintensity),u_lightcolor:new c.aP(m,i.u_lightcolor),u_vertical_gradient:new c.aM(m,i.u_vertical_gradient),u_height_factor:new c.aM(m,i.u_height_factor),u_image:new c.aL(m,i.u_image),u_texsize:new c.aQ(m,i.u_texsize),u_pixel_coord_upper:new c.aQ(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,i.u_pixel_coord_lower),u_scale:new c.aP(m,i.u_scale),u_fade:new c.aM(m,i.u_fade),u_opacity:new c.aM(m,i.u_opacity)}),fill:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix)}),fillPattern:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_image:new c.aL(m,i.u_image),u_texsize:new c.aQ(m,i.u_texsize),u_pixel_coord_upper:new c.aQ(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,i.u_pixel_coord_lower),u_scale:new c.aP(m,i.u_scale),u_fade:new c.aM(m,i.u_fade)}),fillOutline:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_world:new c.aQ(m,i.u_world)}),fillOutlinePattern:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_world:new c.aQ(m,i.u_world),u_image:new c.aL(m,i.u_image),u_texsize:new c.aQ(m,i.u_texsize),u_pixel_coord_upper:new c.aQ(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,i.u_pixel_coord_lower),u_scale:new c.aP(m,i.u_scale),u_fade:new c.aM(m,i.u_fade)}),circle:(m,i)=>({u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_scale_with_map:new c.aL(m,i.u_scale_with_map),u_pitch_with_map:new c.aL(m,i.u_pitch_with_map),u_extrude_scale:new c.aQ(m,i.u_extrude_scale),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_matrix:new c.aN(m,i.u_matrix)}),collisionBox:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_pixels_to_tile_units:new c.aM(m,i.u_pixels_to_tile_units),u_extrude_scale:new c.aQ(m,i.u_extrude_scale),u_overscale_factor:new c.aM(m,i.u_overscale_factor)}),collisionCircle:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_inv_matrix:new c.aN(m,i.u_inv_matrix),u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_viewport_size:new c.aQ(m,i.u_viewport_size)}),debug:(m,i)=>({u_color:new c.aR(m,i.u_color),u_matrix:new c.aN(m,i.u_matrix),u_overlay:new c.aL(m,i.u_overlay),u_overlay_scale:new c.aM(m,i.u_overlay_scale)}),clippingMask:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix)}),heatmap:(m,i)=>({u_extrude_scale:new c.aM(m,i.u_extrude_scale),u_intensity:new c.aM(m,i.u_intensity),u_matrix:new c.aN(m,i.u_matrix)}),heatmapTexture:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_world:new c.aQ(m,i.u_world),u_image:new c.aL(m,i.u_image),u_color_ramp:new c.aL(m,i.u_color_ramp),u_opacity:new c.aM(m,i.u_opacity)}),hillshade:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_image:new c.aL(m,i.u_image),u_latrange:new c.aQ(m,i.u_latrange),u_light:new c.aQ(m,i.u_light),u_shadow:new c.aR(m,i.u_shadow),u_highlight:new c.aR(m,i.u_highlight),u_accent:new c.aR(m,i.u_accent)}),hillshadePrepare:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_image:new c.aL(m,i.u_image),u_dimension:new c.aQ(m,i.u_dimension),u_zoom:new c.aM(m,i.u_zoom),u_unpack:new c.aO(m,i.u_unpack)}),line:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_ratio:new c.aM(m,i.u_ratio),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,i.u_units_to_pixels)}),lineGradient:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_ratio:new c.aM(m,i.u_ratio),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,i.u_units_to_pixels),u_image:new c.aL(m,i.u_image),u_image_height:new c.aM(m,i.u_image_height)}),linePattern:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_texsize:new c.aQ(m,i.u_texsize),u_ratio:new c.aM(m,i.u_ratio),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_image:new c.aL(m,i.u_image),u_units_to_pixels:new c.aQ(m,i.u_units_to_pixels),u_scale:new c.aP(m,i.u_scale),u_fade:new c.aM(m,i.u_fade)}),lineSDF:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_ratio:new c.aM(m,i.u_ratio),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,i.u_units_to_pixels),u_patternscale_a:new c.aQ(m,i.u_patternscale_a),u_patternscale_b:new c.aQ(m,i.u_patternscale_b),u_sdfgamma:new c.aM(m,i.u_sdfgamma),u_image:new c.aL(m,i.u_image),u_tex_y_a:new c.aM(m,i.u_tex_y_a),u_tex_y_b:new c.aM(m,i.u_tex_y_b),u_mix:new c.aM(m,i.u_mix)}),raster:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_tl_parent:new c.aQ(m,i.u_tl_parent),u_scale_parent:new c.aM(m,i.u_scale_parent),u_buffer_scale:new c.aM(m,i.u_buffer_scale),u_fade_t:new c.aM(m,i.u_fade_t),u_opacity:new c.aM(m,i.u_opacity),u_image0:new c.aL(m,i.u_image0),u_image1:new c.aL(m,i.u_image1),u_brightness_low:new c.aM(m,i.u_brightness_low),u_brightness_high:new c.aM(m,i.u_brightness_high),u_saturation_factor:new c.aM(m,i.u_saturation_factor),u_contrast_factor:new c.aM(m,i.u_contrast_factor),u_spin_weights:new c.aP(m,i.u_spin_weights)}),symbolIcon:(m,i)=>({u_is_size_zoom_constant:new c.aL(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,i.u_is_size_feature_constant),u_size_t:new c.aM(m,i.u_size_t),u_size:new c.aM(m,i.u_size),u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_pitch:new c.aM(m,i.u_pitch),u_rotate_symbol:new c.aL(m,i.u_rotate_symbol),u_aspect_ratio:new c.aM(m,i.u_aspect_ratio),u_fade_change:new c.aM(m,i.u_fade_change),u_matrix:new c.aN(m,i.u_matrix),u_label_plane_matrix:new c.aN(m,i.u_label_plane_matrix),u_coord_matrix:new c.aN(m,i.u_coord_matrix),u_is_text:new c.aL(m,i.u_is_text),u_pitch_with_map:new c.aL(m,i.u_pitch_with_map),u_texsize:new c.aQ(m,i.u_texsize),u_texture:new c.aL(m,i.u_texture)}),symbolSDF:(m,i)=>({u_is_size_zoom_constant:new c.aL(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,i.u_is_size_feature_constant),u_size_t:new c.aM(m,i.u_size_t),u_size:new c.aM(m,i.u_size),u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_pitch:new c.aM(m,i.u_pitch),u_rotate_symbol:new c.aL(m,i.u_rotate_symbol),u_aspect_ratio:new c.aM(m,i.u_aspect_ratio),u_fade_change:new c.aM(m,i.u_fade_change),u_matrix:new c.aN(m,i.u_matrix),u_label_plane_matrix:new c.aN(m,i.u_label_plane_matrix),u_coord_matrix:new c.aN(m,i.u_coord_matrix),u_is_text:new c.aL(m,i.u_is_text),u_pitch_with_map:new c.aL(m,i.u_pitch_with_map),u_texsize:new c.aQ(m,i.u_texsize),u_texture:new c.aL(m,i.u_texture),u_gamma_scale:new c.aM(m,i.u_gamma_scale),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_is_halo:new c.aL(m,i.u_is_halo)}),symbolTextAndIcon:(m,i)=>({u_is_size_zoom_constant:new c.aL(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,i.u_is_size_feature_constant),u_size_t:new c.aM(m,i.u_size_t),u_size:new c.aM(m,i.u_size),u_camera_to_center_distance:new c.aM(m,i.u_camera_to_center_distance),u_pitch:new c.aM(m,i.u_pitch),u_rotate_symbol:new c.aL(m,i.u_rotate_symbol),u_aspect_ratio:new c.aM(m,i.u_aspect_ratio),u_fade_change:new c.aM(m,i.u_fade_change),u_matrix:new c.aN(m,i.u_matrix),u_label_plane_matrix:new c.aN(m,i.u_label_plane_matrix),u_coord_matrix:new c.aN(m,i.u_coord_matrix),u_is_text:new c.aL(m,i.u_is_text),u_pitch_with_map:new c.aL(m,i.u_pitch_with_map),u_texsize:new c.aQ(m,i.u_texsize),u_texsize_icon:new c.aQ(m,i.u_texsize_icon),u_texture:new c.aL(m,i.u_texture),u_texture_icon:new c.aL(m,i.u_texture_icon),u_gamma_scale:new c.aM(m,i.u_gamma_scale),u_device_pixel_ratio:new c.aM(m,i.u_device_pixel_ratio),u_is_halo:new c.aL(m,i.u_is_halo)}),background:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_opacity:new c.aM(m,i.u_opacity),u_color:new c.aR(m,i.u_color)}),backgroundPattern:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_opacity:new c.aM(m,i.u_opacity),u_image:new c.aL(m,i.u_image),u_pattern_tl_a:new c.aQ(m,i.u_pattern_tl_a),u_pattern_br_a:new c.aQ(m,i.u_pattern_br_a),u_pattern_tl_b:new c.aQ(m,i.u_pattern_tl_b),u_pattern_br_b:new c.aQ(m,i.u_pattern_br_b),u_texsize:new c.aQ(m,i.u_texsize),u_mix:new c.aM(m,i.u_mix),u_pattern_size_a:new c.aQ(m,i.u_pattern_size_a),u_pattern_size_b:new c.aQ(m,i.u_pattern_size_b),u_scale_a:new c.aM(m,i.u_scale_a),u_scale_b:new c.aM(m,i.u_scale_b),u_pixel_coord_upper:new c.aQ(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,i.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aM(m,i.u_tile_units_to_pixels)}),terrain:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_texture:new c.aL(m,i.u_texture),u_ele_delta:new c.aM(m,i.u_ele_delta)}),terrainDepth:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_ele_delta:new c.aM(m,i.u_ele_delta)}),terrainCoords:(m,i)=>({u_matrix:new c.aN(m,i.u_matrix),u_texture:new c.aL(m,i.u_texture),u_terrain_coords_id:new c.aM(m,i.u_terrain_coords_id),u_ele_delta:new c.aM(m,i.u_ele_delta)})};class Pl{constructor(i,l,d){this.context=i;const f=i.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Aa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Al{constructor(i,l,d,f){this.length=l.length,this.attributes=d,this.itemSize=l.bytesPerElement,this.dynamicDraw=f,this.context=i;const _=i.gl;this.buffer=_.createBuffer(),i.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,l){for(let d=0;d<this.attributes.length;d++){const f=l.attributes[this.attributes[d].name];f!==void 0&&i.enableVertexAttribArray(f)}}setVertexAttribPointers(i,l,d){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],b=l.attributes[_.name];b!==void 0&&i.vertexAttribPointer(b,_.components,i[Aa[_.type]],!1,this.itemSize,_.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Oo=new WeakMap;function $s(m){var i;if(Oo.has(m))return Oo.get(m);{const l=(i=m.getParameter(m.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Oo.set(m,l),l}}class Xt{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Il extends Xt{getDefault(){return c.aT.transparent}set(i){const l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ar extends Xt{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class lr extends Xt{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class ru extends Xt{getDefault(){return[!0,!0,!0,!0]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Ml extends Xt{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Ll extends Xt{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class su extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const l=this.current;(i.func!==l.func||i.ref!==l.ref||i.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class ou extends Xt{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class zl extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=i,this.dirty=!1}}class au extends Xt{getDefault(){return[0,1]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class lu extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=i,this.dirty=!1}}class Dl extends Xt{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class kd extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.BLEND):l.disable(l.BLEND),this.current=i,this.dirty=!1}}class Ed extends Xt{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Vo extends Xt{getDefault(){return c.aT.transparent}set(i){const l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Fm extends Xt{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Bm extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=i,this.dirty=!1}}class Nm extends Xt{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class jm extends Xt{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class Om extends Xt{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Vm extends Xt{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class cu extends Xt{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Rl extends Xt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class uu extends Xt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class hu extends Xt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class $o extends Xt{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Cd extends Xt{getDefault(){return null}set(i){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Pd extends Xt{getDefault(){return null}set(i){var l;if(i===this.current&&!this.dirty)return;const d=this.gl;$s(d)?d.bindVertexArray(i):(l=d.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class du extends Xt{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class lo extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Ad extends Xt{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Us extends Xt{constructor(i,l){super(i),this.context=i,this.parent=l}getDefault(){return null}}class Uo extends Us{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Id extends Us{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class pu extends Us{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class rn{constructor(i,l,d,f,_){this.context=i,this.width=l,this.height=d;const b=i.gl,S=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new Uo(i,S),f)this.depthAttachment=_?new pu(i,S):new Id(i,S);else if(_)throw new Error("Stencil cannot be setted without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,l=this.colorAttachment.get();if(l&&i.deleteTexture(l),this.depthAttachment){const d=this.depthAttachment.get();d&&i.deleteRenderbuffer(d)}i.deleteFramebuffer(this.framebuffer)}}class Cn{constructor(i,l,d){this.blendFunction=i,this.blendColor=l,this.mask=d}}Cn.Replace=[1,0],Cn.disabled=new Cn(Cn.Replace,c.aT.transparent,[!1,!1,!1,!1]),Cn.unblended=new Cn(Cn.Replace,c.aT.transparent,[!0,!0,!0,!0]),Cn.alphaBlended=new Cn([1,771],c.aT.transparent,[!0,!0,!0,!0]);class $m{constructor(i){var l,d;if(this.gl=i,this.clearColor=new Il(this),this.clearDepth=new ar(this),this.clearStencil=new lr(this),this.colorMask=new ru(this),this.depthMask=new Ml(this),this.stencilMask=new Ll(this),this.stencilFunc=new su(this),this.stencilOp=new ou(this),this.stencilTest=new zl(this),this.depthRange=new au(this),this.depthTest=new lu(this),this.depthFunc=new Dl(this),this.blend=new kd(this),this.blendFunc=new Ed(this),this.blendColor=new Vo(this),this.blendEquation=new Fm(this),this.cullFace=new Bm(this),this.cullFaceSide=new Nm(this),this.frontFace=new jm(this),this.program=new Om(this),this.activeTexture=new Vm(this),this.viewport=new cu(this),this.bindFramebuffer=new Rl(this),this.bindRenderbuffer=new uu(this),this.bindTexture=new hu(this),this.bindVertexBuffer=new $o(this),this.bindElementBuffer=new Cd(this),this.bindVertexArray=new Pd(this),this.pixelStoreUnpack=new du(this),this.pixelStoreUnpackPremultiplyAlpha=new lo(this),this.pixelStoreUnpackFlipY=new Ad(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),$s(i)){this.HALF_FLOAT=i.HALF_FLOAT;const f=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=i.RGBA16F)!==null&&l!==void 0?l:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=i.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const f=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,l){return new Pl(this,i,l)}createVertexBuffer(i,l,d){return new Al(this,i,l,d)}createRenderbuffer(i,l,d){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,i,l,d),this.bindRenderbuffer.set(null),_}createFramebuffer(i,l,d,f){return new rn(this,i,l,d,f)}clear({color:i,depth:l,stencil:d}){const f=this.gl;let _=0;i&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(_)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){c.aG(i.blendFunction,Cn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return $s(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var l;return $s(this.gl)?this.gl.deleteVertexArray(i):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class Yt{constructor(i,l,d){this.func=i,this.mask=l,this.range=d}}Yt.ReadOnly=!1,Yt.ReadWrite=!0,Yt.disabled=new Yt(519,Yt.ReadOnly,[0,1]);const co=7680;class Pn{constructor(i,l,d,f,_,b){this.test=i,this.ref=l,this.mask=d,this.fail=f,this.depthFail=_,this.pass=b}}Pn.disabled=new Pn({func:519,mask:0},0,0,co,co,co);class Tn{constructor(i,l,d){this.enable=i,this.mode=l,this.frontFace=d}}let Ia;function Md(m,i,l,d,f,_,b){const S=m.context,E=S.gl,A=m.useProgram("collisionBox"),M=[];let z=0,V=0;for(let ie=0;ie<d.length;ie++){const ye=d[ie],Pe=i.getTile(ye),Ae=Pe.getBucket(l);if(!Ae)continue;let ze=ye.posMatrix;f[0]===0&&f[1]===0||(ze=m.translatePosMatrix(ye.posMatrix,Pe,f,_));const Be=b?Ae.textCollisionBox:Ae.iconCollisionBox,Fe=Ae.collisionCircleArray;if(Fe.length>0){const $e=c.Z(),ht=ze;c.aU($e,Ae.placementInvProjMatrix,m.transform.glCoordMatrix),c.aU($e,$e,Ae.placementViewportMatrix),M.push({circleArray:Fe,circleOffset:V,transform:ht,invTransform:$e,coord:ye}),z+=Fe.length/4,V=z}Be&&A.draw(S,E.LINES,Yt.disabled,Pn.disabled,m.colorModeForRenderPass(),Tn.disabled,Qc(ze,m.transform,Pe),m.style.map.terrain&&m.style.map.terrain.getTerrainData(ye),l.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,null,m.transform.zoom,null,null,Be.collisionVertexBuffer)}if(!b||!M.length)return;const Y=m.useProgram("collisionCircle"),X=new c.aV;X.resize(4*z),X._trim();let Q=0;for(const ie of M)for(let ye=0;ye<ie.circleArray.length/4;ye++){const Pe=4*ye,Ae=ie.circleArray[Pe+0],ze=ie.circleArray[Pe+1],Be=ie.circleArray[Pe+2],Fe=ie.circleArray[Pe+3];X.emplace(Q++,Ae,ze,Be,Fe,0),X.emplace(Q++,Ae,ze,Be,Fe,1),X.emplace(Q++,Ae,ze,Be,Fe,2),X.emplace(Q++,Ae,ze,Be,Fe,3)}(!Ia||Ia.length<2*z)&&(Ia=function(ie){const ye=2*ie,Pe=new c.aX;Pe.resize(ye),Pe._trim();for(let Ae=0;Ae<ye;Ae++){const ze=6*Ae;Pe.uint16[ze+0]=4*Ae+0,Pe.uint16[ze+1]=4*Ae+1,Pe.uint16[ze+2]=4*Ae+2,Pe.uint16[ze+3]=4*Ae+2,Pe.uint16[ze+4]=4*Ae+3,Pe.uint16[ze+5]=4*Ae+0}return Pe}(z));const H=S.createIndexBuffer(Ia,!0),me=S.createVertexBuffer(X,c.aW.members,!0);for(const ie of M){const ye={u_matrix:ie.transform,u_inv_matrix:ie.invTransform,u_camera_to_center_distance:(Se=m.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};Y.draw(S,E.TRIANGLES,Yt.disabled,Pn.disabled,m.colorModeForRenderPass(),Tn.disabled,ye,m.style.map.terrain&&m.style.map.terrain.getTerrainData(ie.coord),l.id,me,H,c.S.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,m.transform.zoom,null,null,null)}var Se;me.destroy(),H.destroy()}Tn.disabled=new Tn(!1,1029,2305),Tn.backCCW=new Tn(!0,1029,2305);const fu=c.ao(new Float32Array(16));function Fl(m,i,l,d,f,_){const{horizontalAlign:b,verticalAlign:S}=c.au(m);return new c.P((-(b-.5)*i/f+d[0])*_,(-(S-.5)*l/f+d[1])*_)}function Bl(m,i,l,d,f,_,b,S,E,A,M){const z=m.text.placedSymbolArray,V=m.text.dynamicLayoutVertexArray,Y=m.icon.dynamicLayoutVertexArray,X={};V.clear();for(let Q=0;Q<z.length;Q++){const H=z.get(Q),me=H.hidden||!H.crossTileID||m.allowVerticalPlacement&&!H.placedOrientation?null:d[H.crossTileID];if(me){const Se=new c.P(H.anchorX,H.anchorY),ie=Sn(Se,l?b:_,M),ye=ys(f.cameraToCenterDistance,ie.signedDistanceFromCamera);let Pe=c.aj(m.textSizeData,E,H)*ye/c.ap;l&&(Pe*=m.tilePixelRatio/S);const{width:Ae,height:ze,anchor:Be,textOffset:Fe,textBoxScale:$e}=me,ht=Fl(Be,Ae,ze,Fe,$e,Pe),Zt=l?Sn(Se.add(ht),_,M).point:ie.point.add(i?ht.rotate(-f.angle):ht),Ye=m.allowVerticalPlacement&&H.placedOrientation===c.ai.vertical?Math.PI/2:0;for(let vt=0;vt<H.numGlyphs;vt++)c.ak(V,Zt,Ye);A&&H.associatedIconIndex>=0&&(X[H.associatedIconIndex]={shiftedAnchor:Zt,angle:Ye})}else W(H.numGlyphs,V)}if(A){Y.clear();const Q=m.icon.placedSymbolArray;for(let H=0;H<Q.length;H++){const me=Q.get(H);if(me.hidden)W(me.numGlyphs,Y);else{const Se=X[H];if(Se)for(let ie=0;ie<me.numGlyphs;ie++)c.ak(Y,Se.shiftedAnchor,Se.angle);else W(me.numGlyphs,Y)}}m.icon.dynamicLayoutVertexBuffer.updateData(Y)}m.text.dynamicLayoutVertexBuffer.updateData(V)}function mu(m,i,l){return l.iconsInText&&i?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Nl(m,i,l,d,f,_,b,S,E,A,M,z){const V=m.context,Y=V.gl,X=m.transform,Q=S==="map",H=E==="map",me=S!=="viewport"&&l.layout.get("symbol-placement")!=="point",Se=Q&&!H&&!me,ie=!l.layout.get("symbol-sort-key").isConstant();let ye=!1;const Pe=m.depthModeForSublayer(0,Yt.ReadOnly),Ae=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ze=[];for(const Be of d){const Fe=i.getTile(Be),$e=Fe.getBucket(l);if(!$e)continue;const ht=f?$e.text:$e.icon;if(!ht||!ht.segments.get().length||!ht.hasVisibleVertices)continue;const Zt=ht.programConfigurations.get(l.id),Ye=f||$e.sdfIcons,vt=f?$e.textSizeData:$e.iconSizeData,pt=H||X.pitch!==0,pn=m.useProgram(mu(Ye,f,$e),Zt),Vt=c.ah(vt,X.zoom),Mt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Be);let Gt,jn,_n,vi,ni=[0,0],qn=null;if(f)jn=Fe.glyphAtlasTexture,_n=Y.LINEAR,Gt=Fe.glyphAtlasTexture.size,$e.iconsInText&&(ni=Fe.imageAtlasTexture.size,qn=Fe.imageAtlasTexture,vi=pt||m.options.rotating||m.options.zooming||vt.kind==="composite"||vt.kind==="camera"?Y.LINEAR:Y.NEAREST);else{const On=l.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;jn=Fe.imageAtlasTexture,_n=Ye||m.options.rotating||m.options.zooming||On||pt?Y.LINEAR:Y.NEAREST,Gt=Fe.imageAtlasTexture.size}const hr=pe(Fe,1,m.transform.zoom),wn=Ze(Be.posMatrix,H,Q,m.transform,hr),es=sr(Be.posMatrix,H,Q,m.transform,hr),ts=Ae&&$e.hasTextData(),Gs=l.layout.get("icon-text-fit")!=="none"&&ts&&$e.hasIconData();if(me){const On=m.style.map.terrain?(Zi,Vn)=>m.style.map.terrain.getElevation(Be,Zi,Vn):null,ii=l.layout.get("text-rotation-alignment")==="map";He($e,Be.posMatrix,m,f,wn,es,H,A,ii,On)}const mo=m.translatePosMatrix(Be.posMatrix,Fe,_,b),Xo=me||f&&Ae||Gs?fu:wn,Ci=m.translatePosMatrix(es,Fe,_,b,!0),wi=Ye&&l.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Di;Di=Ye?$e.iconsInText?ao(vt.kind,Vt,Se,H,m,mo,Xo,Ci,Gt,ni):iu(vt.kind,Vt,Se,H,m,mo,Xo,Ci,f,Gt,!0):nu(vt.kind,Vt,Se,H,m,mo,Xo,Ci,f,Gt);const go={program:pn,buffers:ht,uniformValues:Di,atlasTexture:jn,atlasTextureIcon:qn,atlasInterpolation:_n,atlasInterpolationIcon:vi,isSDF:Ye,hasHalo:wi};if(ie&&$e.canOverlap){ye=!0;const On=ht.segments.get();for(const ii of On)ze.push({segments:new c.S([ii]),sortKey:ii.sortKey,state:go,terrainData:Mt})}else ze.push({segments:ht.segments,sortKey:0,state:go,terrainData:Mt})}ye&&ze.sort((Be,Fe)=>Be.sortKey-Fe.sortKey);for(const Be of ze){const Fe=Be.state;if(V.activeTexture.set(Y.TEXTURE0),Fe.atlasTexture.bind(Fe.atlasInterpolation,Y.CLAMP_TO_EDGE),Fe.atlasTextureIcon&&(V.activeTexture.set(Y.TEXTURE1),Fe.atlasTextureIcon&&Fe.atlasTextureIcon.bind(Fe.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),Fe.isSDF){const $e=Fe.uniformValues;Fe.hasHalo&&($e.u_is_halo=1,gu(Fe.buffers,Be.segments,l,m,Fe.program,Pe,M,z,$e,Be.terrainData)),$e.u_is_halo=0}gu(Fe.buffers,Be.segments,l,m,Fe.program,Pe,M,z,Fe.uniformValues,Be.terrainData)}}function gu(m,i,l,d,f,_,b,S,E,A){const M=d.context;f.draw(M,M.gl.TRIANGLES,_,b,S,Tn.disabled,E,A,l.id,m.layoutVertexBuffer,m.indexBuffer,i,l.paint,d.transform.zoom,m.programConfigurations.get(l.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Ma(m,i,l,d,f){if(!l||!d||!d.imageAtlas)return;const _=d.imageAtlas.patternPositions;let b=_[l.to.toString()],S=_[l.from.toString()];if(!b&&S&&(b=S),!S&&b&&(S=b),!b||!S){const E=f.getPaintProperty(i);b=_[E],S=_[E]}b&&S&&m.setConstantPatternPositions(b,S)}function La(m,i,l,d,f,_,b){const S=m.context.gl,E="fill-pattern",A=l.paint.get(E),M=A&&A.constantOr(1),z=l.getCrossfadeParameters();let V,Y,X,Q,H;b?(Y=M&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=S.LINES):(Y=M?"fillPattern":"fill",V=S.TRIANGLES);const me=A.constantOr(null);for(const Se of d){const ie=i.getTile(Se);if(M&&!ie.patternsLoaded())continue;const ye=ie.getBucket(l);if(!ye)continue;const Pe=ye.programConfigurations.get(l.id),Ae=m.useProgram(Y,Pe),ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Se);M&&(m.context.activeTexture.set(S.TEXTURE0),ie.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Pe.updatePaintBuffers(z)),Ma(Pe,E,me,ie,l);const Be=ze?Se:null,Fe=m.translatePosMatrix(Be?Be.posMatrix:Se.posMatrix,ie,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(b){Q=ye.indexBuffer2,H=ye.segments2;const $e=[S.drawingBufferWidth,S.drawingBufferHeight];X=Y==="fillOutlinePattern"&&M?Tl(Fe,m,z,ie,$e):Sl(Fe,$e)}else Q=ye.indexBuffer,H=ye.segments,X=M?Jc(Fe,m,z,ie):_d(Fe);Ae.draw(m.context,V,f,m.stencilModeForClipping(Se),_,Tn.disabled,X,ze,l.id,ye.layoutVertexBuffer,Q,H,l.paint,m.transform.zoom,Pe)}}function za(m,i,l,d,f,_,b){const S=m.context,E=S.gl,A="fill-extrusion-pattern",M=l.paint.get(A),z=M.constantOr(1),V=l.getCrossfadeParameters(),Y=l.paint.get("fill-extrusion-opacity"),X=M.constantOr(null);for(const Q of d){const H=i.getTile(Q),me=H.getBucket(l);if(!me)continue;const Se=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Q),ie=me.programConfigurations.get(l.id),ye=m.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ie);z&&(m.context.activeTexture.set(E.TEXTURE0),H.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ie.updatePaintBuffers(V)),Ma(ie,A,X,H,l);const Pe=m.translatePosMatrix(Q.posMatrix,H,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Ae=l.paint.get("fill-extrusion-vertical-gradient"),ze=z?Os(Pe,m,Ae,Y,Q,V,H):Yc(Pe,m,Ae,Y);ye.draw(S,S.gl.TRIANGLES,f,_,b,Tn.backCCW,ze,Se,l.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,l.paint,m.transform.zoom,ie,m.style.map.terrain&&me.centroidVertexBuffer)}}function Um(m,i,l,d,f,_,b){const S=m.context,E=S.gl,A=l.fbo;if(!A)return;const M=m.useProgram("hillshade"),z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(i);S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,A.colorAttachment.get()),M.draw(S,E.TRIANGLES,f,_,b,Tn.disabled,((V,Y,X,Q)=>{const H=X.paint.get("hillshade-shadow-color"),me=X.paint.get("hillshade-highlight-color"),Se=X.paint.get("hillshade-accent-color");let ie=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(ie-=V.transform.angle);const ye=!V.options.moving;return{u_matrix:Q?Q.posMatrix:V.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),ye),u_image:0,u_latrange:eu(0,Y.tileID),u_light:[X.paint.get("hillshade-exaggeration"),ie],u_shadow:H,u_highlight:me,u_accent:Se}})(m,l,d,z?i:null),z,d.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function yu(m,i,l,d,f,_){const b=m.context,S=b.gl,E=i.dem;if(E&&E.data){const A=E.dim,M=E.stride,z=E.getPixels();if(b.activeTexture.set(S.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||m.getTileTexture(M),i.demTexture){const Y=i.demTexture;Y.update(z,{premultiply:!1}),Y.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else i.demTexture=new Oe(b,z,S.RGBA,{premultiply:!1}),i.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);b.activeTexture.set(S.TEXTURE0);let V=i.fbo;if(!V){const Y=new Oe(b,{width:A,height:A,data:null},S.RGBA);Y.bind(S.LINEAR,S.CLAMP_TO_EDGE),V=i.fbo=b.createFramebuffer(A,A,!0,!1),V.colorAttachment.set(Y.texture)}b.bindFramebuffer.set(V.framebuffer),b.viewport.set([0,0,A,A]),m.useProgram("hillshadePrepare").draw(b,S.TRIANGLES,d,f,_,Tn.disabled,((Y,X)=>{const Q=X.stride,H=c.Z();return c.aS(H,0,c.N,-c.N,0,0,1),c.$(H,H,[0,-c.N,0]),{u_matrix:H,u_image:1,u_dimension:[Q,Q],u_zoom:Y.overscaledZ,u_unpack:X.getUnpackVector()}})(i.tileID,E),null,l.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function qm(m,i,l,d,f,_){const b=d.paint.get("raster-fade-duration");if(!_&&b>0){const S=c.h.now(),E=(S-m.timeAdded)/b,A=i?(S-i.timeAdded)/b:-1,M=l.getSource(),z=f.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),V=!i||Math.abs(i.tileID.overscaledZ-z)>Math.abs(m.tileID.overscaledZ-z),Y=V&&m.refreshedUponExpiration?1:c.ad(V?E:1-A,0,1);return m.refreshedUponExpiration&&E>=1&&(m.refreshedUponExpiration=!1),i?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Ld=new c.aT(1,0,0,1),jl=new c.aT(0,1,0,1),_u=new c.aT(0,0,1,1),zd=new c.aT(1,0,1,1),Dd=new c.aT(0,1,1,1);function Da(m,i,l,d){Vl(m,0,i+l/2,m.transform.width,l,d)}function Ol(m,i,l,d){Vl(m,i-l/2,0,l,m.transform.height,d)}function Vl(m,i,l,d,f,_){const b=m.context,S=b.gl;S.enable(S.SCISSOR_TEST),S.scissor(i*m.pixelRatio,l*m.pixelRatio,d*m.pixelRatio,f*m.pixelRatio),b.clear({color:_}),S.disable(S.SCISSOR_TEST)}function Rd(m,i,l){const d=m.context,f=d.gl,_=l.posMatrix,b=m.useProgram("debug"),S=Yt.disabled,E=Pn.disabled,A=m.colorModeForRenderPass(),M="$debug",z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(l);d.activeTexture.set(f.TEXTURE0);const V=i.getTileByID(l.key).latestRawTileData,Y=Math.floor((V&&V.byteLength||0)/1024),X=i.getTile(l).tileSize,Q=512/Math.min(X,512)*(l.overscaledZ/m.transform.zoom)*.5;let H=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(H+=` => ${l.overscaledZ}`),function(me,Se){me.initDebugOverlayCanvas();const ie=me.debugOverlayCanvas,ye=me.context.gl,Pe=me.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,ie.width,ie.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(Se,5,5),Pe.strokeText(Se,5,5),me.debugOverlayTexture.update(ie),me.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(m,`${H} ${Y}kB`),b.draw(d,f.TRIANGLES,S,E,Cn.alphaBlended,Tn.disabled,Pa(_,c.aT.transparent,Q),null,M,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),b.draw(d,f.LINE_STRIP,S,E,A,Tn.disabled,Pa(_,c.aT.red),z,M,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function zn(m,i,l){const d=m.context,f=d.gl,_=m.colorModeForRenderPass(),b=new Yt(f.LEQUAL,Yt.ReadWrite,m.depthRangeFor3D),S=m.useProgram("terrain"),E=i.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,m.width,m.height]);for(const A of l){const M=m.renderToTexture.getTexture(A),z=i.getTerrainData(A.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,M.texture);const V={u_matrix:m.transform.calculatePosMatrix(A.tileID.toUnwrapped()),u_texture:0,u_ele_delta:i.getMeshFrameDelta(m.transform.zoom)};S.draw(d,f.TRIANGLES,b,Pn.disabled,_,Tn.backCCW,V,z,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class uo{constructor(i,l){this.context=new $m(i),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.Z(),renderTime:0},this.setup(),this.numSublayers=ti.maxUnderzooming+ti.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vl}resize(i,l,d){if(this.width=Math.floor(i*d),this.height=Math.floor(l*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const i=this.context,l=new c.a_;l.emplaceBack(0,0),l.emplaceBack(c.N,0),l.emplaceBack(0,c.N),l.emplaceBack(c.N,c.N),this.tileExtentBuffer=i.createVertexBuffer(l,wl.members),this.tileExtentSegments=c.S.simpleSegment(0,0,4,2);const d=new c.a_;d.emplaceBack(0,0),d.emplaceBack(c.N,0),d.emplaceBack(0,c.N),d.emplaceBack(c.N,c.N),this.debugBuffer=i.createVertexBuffer(d,wl.members),this.debugSegments=c.S.simpleSegment(0,0,4,5);const f=new c.V;f.emplaceBack(0,0,0,0),f.emplaceBack(c.N,0,c.N,0),f.emplaceBack(0,c.N,0,c.N),f.emplaceBack(c.N,c.N,c.N,c.N),this.rasterBoundsBuffer=i.createVertexBuffer(f,Lt.members),this.rasterBoundsSegments=c.S.simpleSegment(0,0,4,2);const _=new c.a_;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(_,wl.members),this.viewportSegments=c.S.simpleSegment(0,0,4,2);const b=new c.a$;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(b);const S=new c.b0;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(S);const E=this.context.gl;this.stencilClearMode=new Pn({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const i=this.context,l=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.Z();c.aS(d,0,this.width,this.height,0,0,1),c.a0(d,d,[l.drawingBufferWidth,l.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,l.TRIANGLES,Yt.disabled,this.stencilClearMode,Cn.disabled,Tn.disabled,xd(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,l){if(this.currentStencilSource===i.source||!i.isTileClipped()||!l||!l.length)return;this.currentStencilSource=i.source;const d=this.context,f=d.gl;this.nextStencilID+l.length>256&&this.clearStencil(),d.setColorMode(Cn.disabled),d.setDepthMode(Yt.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of l){const S=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);_.draw(d,f.TRIANGLES,Yt.disabled,new Pn({func:f.ALWAYS,mask:0},S,255,f.KEEP,f.KEEP,f.REPLACE),Cn.disabled,Tn.disabled,xd(b.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,l=this.context.gl;return new Pn({func:l.NOTEQUAL,mask:255},i,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(i){const l=this.context.gl;return new Pn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(i){const l=this.context.gl,d=i.sort((b,S)=>S.overscaledZ-b.overscaledZ),f=d[d.length-1].overscaledZ,_=d[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const b={};for(let S=0;S<_;S++)b[S+f]=new Pn({func:l.GEQUAL,mask:255},S+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=_,[b,d]}return[{[f]:Pn.disabled},d]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new Cn([i.CONSTANT_COLOR,i.ONE],new c.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cn.unblended:Cn.alphaBlended}depthModeForSublayer(i,l,d){if(!this.opaquePassEnabledForLayer())return Yt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Yt(d||this.context.gl.LEQUAL,l,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,l){this.style=i,this.options=l,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(c.h.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,_={},b={},S={};for(const E in f){const A=f[E];A.used&&A.prepare(this.context),_[E]=A.getVisibleCoordinates(),b[E]=_[E].slice().reverse(),S[E]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<d.length;E++)if(this.style._layers[d[E]].is3D()){this.opaquePassCutoff=E;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const E=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!c.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||E.length)&&(c.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(A,M){const z=A.context,V=z.gl,Y=Cn.unblended,X=new Yt(V.LEQUAL,Yt.ReadWrite,[0,1]),Q=M.getTerrainMesh(),H=M.sourceCache.getRenderableTiles(),me=A.useProgram("terrainDepth");z.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),z.clear({color:c.aT.transparent,depth:1});for(const Se of H){const ie=M.getTerrainData(Se.tileID),ye={u_matrix:A.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:M.getMeshFrameDelta(A.transform.zoom)};me.draw(z,V.TRIANGLES,X,Pn.disabled,Y,Tn.backCCW,ye,ie,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain),function(A,M){const z=A.context,V=z.gl,Y=Cn.unblended,X=new Yt(V.LEQUAL,Yt.ReadWrite,[0,1]),Q=M.getTerrainMesh(),H=M.getCoordsTexture(),me=M.sourceCache.getRenderableTiles(),Se=A.useProgram("terrainCoords");z.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),z.clear({color:c.aT.transparent,depth:1}),M.coordsIndex=[];for(const ie of me){const ye=M.getTerrainData(ie.tileID);z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,H.texture);const Pe={u_matrix:A.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(A.transform.zoom)};Se.draw(z,V.TRIANGLES,X,Pn.disabled,Y,Tn.backCCW,Pe,ye,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments),M.coordsIndex.push(ie.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const E of d){const A=this.style._layers[E];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const M=b[A.source];(A.type==="custom"||M.length)&&this.renderLayer(this,f[A.source],A,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?c.aT.black:c.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[d[this.currentLayer]],A=f[E.source],M=_[E.source];this._renderTileClippingMasks(E,M),this.renderLayer(this,A,E,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const E=this.style._layers[d[this.currentLayer]],A=f[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const M=(E.type==="symbol"?S:b)[E.source];this._renderTileClippingMasks(E,_[E.source]),this.renderLayer(this,A,E,M)}if(this.options.showTileBoundaries){const E=function(A,M){let z=null;const V=Object.values(A._layers).flatMap(H=>H.source&&!H.isHidden(M)?[A.sourceCaches[H.source]]:[]),Y=V.filter(H=>H.getSource().type==="vector"),X=V.filter(H=>H.getSource().type!=="vector"),Q=H=>{(!z||z.getSource().maxzoom<H.getSource().maxzoom)&&(z=H)};return Y.forEach(H=>Q(H)),z||X.forEach(H=>Q(H)),z}(this.style,this.transform.zoom);E&&function(A,M,z){for(let V=0;V<z.length;V++)Rd(A,M,z[V])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const A=E.transform.padding;Da(E,E.transform.height-(A.top||0),3,Ld),Da(E,A.bottom||0,3,jl),Ol(E,A.left||0,3,_u),Ol(E,E.transform.width-(A.right||0),3,zd);const M=E.transform.centerPoint;(function(z,V,Y,X){Vl(z,V-1,Y-10,2,20,X),Vl(z,V-10,Y-1,20,2,X)})(E,M.x,E.transform.height-M.y,Dd)}(this),this.context.setDefault()}renderLayer(i,l,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(_,b,S,E,A){if(_.renderPass!=="translucent")return;const M=Pn.disabled,z=_.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,Y,X,Q,H,me,Se){const ie=Y.transform,ye=H==="map",Pe=me==="map";for(const Ae of V){const ze=Q.getTile(Ae),Be=ze.getBucket(X);if(!Be||!Be.text||!Be.text.segments.get().length)continue;const Fe=c.ah(Be.textSizeData,ie.zoom),$e=pe(ze,1,Y.transform.zoom),ht=Ze(Ae.posMatrix,Pe,ye,Y.transform,$e),Zt=X.layout.get("icon-text-fit")!=="none"&&Be.hasIconData();if(Fe){const Ye=Math.pow(2,ie.zoom-ze.tileID.overscaledZ);Bl(Be,ye,Pe,Se,ie,ht,Ae.posMatrix,Ye,Fe,Zt,Y.style.map.terrain?(vt,pt)=>Y.style.map.terrain.getElevation(Ae,vt,pt):null)}}}(E,_,S,b,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),A),S.paint.get("icon-opacity").constantOr(1)!==0&&Nl(_,b,S,E,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),M,z),S.paint.get("text-opacity").constantOr(1)!==0&&Nl(_,b,S,E,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),M,z),b.map.showCollisionBoxes&&(Md(_,b,S,E,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),!0),Md(_,b,S,E,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),!1))})(i,l,d,f,this.style.placement.variableOffsets);break;case"circle":(function(_,b,S,E){if(_.renderPass!=="translucent")return;const A=S.paint.get("circle-opacity"),M=S.paint.get("circle-stroke-width"),z=S.paint.get("circle-stroke-opacity"),V=!S.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(M.constantOr(1)===0||z.constantOr(1)===0))return;const Y=_.context,X=Y.gl,Q=_.depthModeForSublayer(0,Yt.ReadOnly),H=Pn.disabled,me=_.colorModeForRenderPass(),Se=[];for(let ie=0;ie<E.length;ie++){const ye=E[ie],Pe=b.getTile(ye),Ae=Pe.getBucket(S);if(!Ae)continue;const ze=Ae.programConfigurations.get(S.id),Be=_.useProgram("circle",ze),Fe=Ae.layoutVertexBuffer,$e=Ae.indexBuffer,ht=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ye),Zt={programConfiguration:ze,program:Be,layoutVertexBuffer:Fe,indexBuffer:$e,uniformValues:Vs(_,ye,Pe,S),terrainData:ht};if(V){const Ye=Ae.segments.get();for(const vt of Ye)Se.push({segments:new c.S([vt]),sortKey:vt.sortKey,state:Zt})}else Se.push({segments:Ae.segments,sortKey:0,state:Zt})}V&&Se.sort((ie,ye)=>ie.sortKey-ye.sortKey);for(const ie of Se){const{programConfiguration:ye,program:Pe,layoutVertexBuffer:Ae,indexBuffer:ze,uniformValues:Be,terrainData:Fe}=ie.state;Pe.draw(Y,X.TRIANGLES,Q,H,me,Tn.disabled,Be,Fe,S.id,Ae,ze,ie.segments,S.paint,_.transform.zoom,ye)}})(i,l,d,f);break;case"heatmap":(function(_,b,S,E){if(S.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const A=_.context,M=A.gl,z=Pn.disabled,V=new Cn([M.ONE,M.ONE],c.aT.transparent,[!0,!0,!0,!0]);(function(Y,X,Q){const H=Y.gl;Y.activeTexture.set(H.TEXTURE1),Y.viewport.set([0,0,X.width/4,X.height/4]);let me=Q.heatmapFbo;if(me)H.bindTexture(H.TEXTURE_2D,me.colorAttachment.get()),Y.bindFramebuffer.set(me.framebuffer);else{const Se=H.createTexture();H.bindTexture(H.TEXTURE_2D,Se),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),me=Q.heatmapFbo=Y.createFramebuffer(X.width/4,X.height/4,!1,!1),function(ie,ye,Pe,Ae){var ze,Be;const Fe=ie.gl,$e=(ze=ie.HALF_FLOAT)!==null&&ze!==void 0?ze:Fe.UNSIGNED_BYTE,ht=(Be=ie.RGBA16F)!==null&&Be!==void 0?Be:Fe.RGBA;Fe.texImage2D(Fe.TEXTURE_2D,0,ht,ye.width/4,ye.height/4,0,Fe.RGBA,$e,null),Ae.colorAttachment.set(Pe)}(Y,X,Se,me)}})(A,_,S),A.clear({color:c.aT.transparent});for(let Y=0;Y<E.length;Y++){const X=E[Y];if(b.hasRenderableParent(X))continue;const Q=b.getTile(X),H=Q.getBucket(S);if(!H)continue;const me=H.programConfigurations.get(S.id),Se=_.useProgram("heatmap",me),{zoom:ie}=_.transform;Se.draw(A,M.TRIANGLES,Yt.disabled,z,V,Tn.disabled,Dm(X.posMatrix,Q,ie,S.paint.get("heatmap-intensity")),null,S.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,S.paint,_.transform.zoom,me)}A.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(A,M){const z=A.context,V=z.gl,Y=M.heatmapFbo;if(!Y)return;z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,Y.colorAttachment.get()),z.activeTexture.set(V.TEXTURE1);let X=M.colorRampTexture;X||(X=M.colorRampTexture=new Oe(z,M.colorRamp,V.RGBA)),X.bind(V.LINEAR,V.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(z,V.TRIANGLES,Yt.disabled,Pn.disabled,A.colorModeForRenderPass(),Tn.disabled,((Q,H,me,Se)=>{const ie=c.Z();c.aS(ie,0,Q.width,Q.height,0,0,1);const ye=Q.context.gl;return{u_matrix:ie,u_world:[ye.drawingBufferWidth,ye.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:H.paint.get("heatmap-opacity")}})(A,M),null,M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)}(_,S))})(i,l,d,f);break;case"line":(function(_,b,S,E){if(_.renderPass!=="translucent")return;const A=S.paint.get("line-opacity"),M=S.paint.get("line-width");if(A.constantOr(1)===0||M.constantOr(1)===0)return;const z=_.depthModeForSublayer(0,Yt.ReadOnly),V=_.colorModeForRenderPass(),Y=S.paint.get("line-dasharray"),X=S.paint.get("line-pattern"),Q=X.constantOr(1),H=S.paint.get("line-gradient"),me=S.getCrossfadeParameters(),Se=Q?"linePattern":Y?"lineSDF":H?"lineGradient":"line",ie=_.context,ye=ie.gl;let Pe=!0;for(const Ae of E){const ze=b.getTile(Ae);if(Q&&!ze.patternsLoaded())continue;const Be=ze.getBucket(S);if(!Be)continue;const Fe=Be.programConfigurations.get(S.id),$e=_.context.program.get(),ht=_.useProgram(Se,Fe),Zt=Pe||ht.program!==$e,Ye=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ae),vt=X.constantOr(null);if(vt&&ze.imageAtlas){const Vt=ze.imageAtlas,Mt=Vt.patternPositions[vt.to.toString()],Gt=Vt.patternPositions[vt.from.toString()];Mt&&Gt&&Fe.setConstantPatternPositions(Mt,Gt)}const pt=Ye?Ae:null,pn=Q?Rm(_,ze,S,me,pt):Y?wd(_,ze,S,Y,me,pt):H?vd(_,ze,S,Be.lineClipsArray.length,pt):tu(_,ze,S,pt);if(Q)ie.activeTexture.set(ye.TEXTURE0),ze.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Fe.updatePaintBuffers(me);else if(Y&&(Zt||_.lineAtlas.dirty))ie.activeTexture.set(ye.TEXTURE0),_.lineAtlas.bind(ie);else if(H){const Vt=Be.gradients[S.id];let Mt=Vt.texture;if(S.gradientVersion!==Vt.version){let Gt=256;if(S.stepInterpolant){const jn=b.getSource().maxzoom,_n=Ae.canonical.z===jn?Math.ceil(1<<_.transform.maxZoom-Ae.canonical.z):1;Gt=c.ad(c.aY(Be.maxLineLength/c.N*1024*_n),256,ie.maxTextureSize)}Vt.gradient=c.aZ({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Gt,image:Vt.gradient||void 0,clips:Be.lineClipsArray}),Vt.texture?Vt.texture.update(Vt.gradient):Vt.texture=new Oe(ie,Vt.gradient,ye.RGBA),Vt.version=S.gradientVersion,Mt=Vt.texture}ie.activeTexture.set(ye.TEXTURE0),Mt.bind(S.stepInterpolant?ye.NEAREST:ye.LINEAR,ye.CLAMP_TO_EDGE)}ht.draw(ie,ye.TRIANGLES,z,_.stencilModeForClipping(Ae),V,Tn.disabled,pn,Ye,S.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,S.paint,_.transform.zoom,Fe,Be.layoutVertexBuffer2),Pe=!1}})(i,l,d,f);break;case"fill":(function(_,b,S,E){const A=S.paint.get("fill-color"),M=S.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const z=_.colorModeForRenderPass(),V=S.paint.get("fill-pattern"),Y=_.opaquePassEnabledForLayer()&&!V.constantOr(1)&&A.constantOr(c.aT.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===Y){const X=_.depthModeForSublayer(1,_.renderPass==="opaque"?Yt.ReadWrite:Yt.ReadOnly);La(_,b,S,E,X,z,!1)}if(_.renderPass==="translucent"&&S.paint.get("fill-antialias")){const X=_.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Yt.ReadOnly);La(_,b,S,E,X,z,!0)}})(i,l,d,f);break;case"fill-extrusion":(function(_,b,S,E){const A=S.paint.get("fill-extrusion-opacity");if(A!==0&&_.renderPass==="translucent"){const M=new Yt(_.context.gl.LEQUAL,Yt.ReadWrite,_.depthRangeFor3D);if(A!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))za(_,b,S,E,M,Pn.disabled,Cn.disabled),za(_,b,S,E,M,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const z=_.colorModeForRenderPass();za(_,b,S,E,M,Pn.disabled,z)}}})(i,l,d,f);break;case"hillshade":(function(_,b,S,E){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const A=_.context,M=_.depthModeForSublayer(0,Yt.ReadOnly),z=_.colorModeForRenderPass(),[V,Y]=_.renderPass==="translucent"?_.stencilConfigForOverlap(E):[{},E];for(const X of Y){const Q=b.getTile(X);Q.needsHillshadePrepare!==void 0&&Q.needsHillshadePrepare&&_.renderPass==="offscreen"?yu(_,Q,S,M,Pn.disabled,z):_.renderPass==="translucent"&&Um(_,X,Q,S,M,V[X.overscaledZ],z)}A.viewport.set([0,0,_.width,_.height])})(i,l,d,f);break;case"raster":(function(_,b,S,E){if(_.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!E.length)return;const A=_.context,M=A.gl,z=b.getSource(),V=_.useProgram("raster"),Y=_.colorModeForRenderPass(),[X,Q]=z instanceof tn?[{},E]:_.stencilConfigForOverlap(E),H=Q[Q.length-1].overscaledZ,me=!_.options.moving;for(const Se of Q){const ie=_.depthModeForSublayer(Se.overscaledZ-H,S.paint.get("raster-opacity")===1?Yt.ReadWrite:Yt.ReadOnly,M.LESS),ye=b.getTile(Se);ye.registerFadeDuration(S.paint.get("raster-fade-duration"));const Pe=b.findLoadedParent(Se,0),Ae=qm(ye,Pe,b,S,_.transform,_.style.map.terrain);let ze,Be;const Fe=S.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;A.activeTexture.set(M.TEXTURE0),ye.texture.bind(Fe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(M.TEXTURE1),Pe?(Pe.texture.bind(Fe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,Pe.tileID.overscaledZ-ye.tileID.overscaledZ),Be=[ye.tileID.canonical.x*ze%1,ye.tileID.canonical.y*ze%1]):ye.texture.bind(Fe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const $e=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Se),ht=$e?Se:null,Zt=ht?ht.posMatrix:_.transform.calculatePosMatrix(Se.toUnwrapped(),me),Ye=Sd(Zt,Be||[0,0],ze||1,Ae,S);z instanceof tn?V.draw(A,M.TRIANGLES,ie,Pn.disabled,Y,Tn.disabled,Ye,$e,S.id,z.boundsBuffer,_.quadTriangleIndexBuffer,z.boundsSegments):V.draw(A,M.TRIANGLES,ie,X[Se.overscaledZ],Y,Tn.disabled,Ye,$e,S.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}})(i,l,d,f);break;case"background":(function(_,b,S,E){const A=S.paint.get("background-color"),M=S.paint.get("background-opacity");if(M===0)return;const z=_.context,V=z.gl,Y=_.transform,X=Y.tileSize,Q=S.paint.get("background-pattern");if(_.isPatternMissing(Q))return;const H=!Q&&A.a===1&&M===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==H)return;const me=Pn.disabled,Se=_.depthModeForSublayer(0,H==="opaque"?Yt.ReadWrite:Yt.ReadOnly),ie=_.colorModeForRenderPass(),ye=_.useProgram(Q?"backgroundPattern":"background"),Pe=E||Y.coveringTiles({tileSize:X,terrain:_.style.map.terrain});Q&&(z.activeTexture.set(V.TEXTURE0),_.imageManager.bind(_.context));const Ae=S.getCrossfadeParameters();for(const ze of Pe){const Be=E?ze.posMatrix:_.transform.calculatePosMatrix(ze.toUnwrapped()),Fe=Q?Er(Be,M,_,Q,{tileID:ze,tileSize:X},Ae):El(Be,M,A),$e=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ze);ye.draw(z,V.TRIANGLES,Se,me,ie,Tn.disabled,Fe,$e,S.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}})(i,0,d,f);break;case"custom":(function(_,b,S){const E=_.context,A=S.implementation;if(_.renderPass==="offscreen"){const M=A.prerender;M&&(_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),M.call(A,E.gl,_.transform.customLayerMatrix()),E.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),E.setStencilMode(Pn.disabled);const M=A.renderingMode==="3d"?new Yt(_.context.gl.LEQUAL,Yt.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,Yt.ReadOnly);E.setDepthMode(M),A.render(E.gl,_.transform.customLayerMatrix()),E.setDirty(),_.setBaseState(),E.bindFramebuffer.set(null)}})(i,0,d)}}translatePosMatrix(i,l,d,f,_){if(!d[0]&&!d[1])return i;const b=_?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(b){const A=Math.sin(b),M=Math.cos(b);d=[d[0]*M-d[1]*A,d[0]*A+d[1]*M]}const S=[_?d[0]:pe(l,d[0],this.transform.zoom),_?d[1]:pe(l,d[1],this.transform.zoom),0],E=new Float32Array(16);return c.$(E,i,S),E}saveTileTexture(i){const l=this._tileTextures[i.size[0]];l?l.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const l=this._tileTextures[i];return l&&l.length>0?l.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const l=this.imageManager.getPattern(i.from.toString()),d=this.imageManager.getPattern(i.to.toString());return!l||!d}useProgram(i,l){this.cache=this.cache||{};const d=i+(l?l.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new bl(this.context,En[i],l,Cl[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Oe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:l}=this.context.gl;return this.width!==i||this.height!==l}}class Ui{constructor(i,l){this.points=i,this.planes=l}static fromInvProjectionMatrix(i,l,d){const f=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const E=1/(S=c.ag([],S,i))[3]/l*f;return c.b3(S,S,[E,E,1/S[3],E])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const E=function(V,Y){var X=Y[0],Q=Y[1],H=Y[2],me=X*X+Q*Q+H*H;return me>0&&(me=1/Math.sqrt(me)),V[0]=Y[0]*me,V[1]=Y[1]*me,V[2]=Y[2]*me,V}([],function(V,Y,X){var Q=Y[0],H=Y[1],me=Y[2],Se=X[0],ie=X[1],ye=X[2];return V[0]=H*ye-me*ie,V[1]=me*Se-Q*ye,V[2]=Q*ie-H*Se,V}([],Ee([],_[S[0]],_[S[1]]),Ee([],_[S[2]],_[S[1]]))),A=-((M=E)[0]*(z=_[S[1]])[0]+M[1]*z[1]+M[2]*z[2]);var M,z;return E.concat(A)});return new Ui(_,b)}}class qo{constructor(i,l){this.min=i,this.max=l,this.center=function(d,f,_){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,_){return d[0]=f[0]+_[0],d[1]=f[1]+_[1],d[2]=f[2]+_[2],d}([],this.min,this.max))}quadrant(i){const l=[i%2==0,i<2],d=fe(this.min),f=fe(this.max);for(let _=0;_<l.length;_++)d[_]=l[_]?this.min[_]:this.center[_],f[_]=l[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new qo(d,f)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const l=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<i.planes.length;f++){const _=i.planes[f];let b=0;for(let S=0;S<l.length;S++)c.b4(_,l[S])>=0&&b++;if(b===0)return 0;b!==l.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let S=0;S<i.points.length;S++){const E=i.points[S][f]-this.min[f];_=Math.min(_,E),b=Math.max(b,E)}if(b<0||_>this.max[f]-this.min[f])return 0}return 1}}class Ra{constructor(i=0,l=0,d=0,f=0){if(isNaN(i)||i<0||isNaN(l)||l<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=l,this.left=d,this.right=f}interpolate(i,l,d){return l.top!=null&&i.top!=null&&(this.top=c.B.number(i.top,l.top,d)),l.bottom!=null&&i.bottom!=null&&(this.bottom=c.B.number(i.bottom,l.bottom,d)),l.left!=null&&i.left!=null&&(this.left=c.B.number(i.left,l.left,d)),l.right!=null&&i.right!=null&&(this.right=c.B.number(i.right,l.right,d)),this}getCenter(i,l){const d=c.ad((this.left+i-this.right)/2,0,i),f=c.ad((this.top+l-this.bottom)/2,0,l);return new c.P(d,f)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ra(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class $l{constructor(i,l,d,f,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||!!_,this._minZoom=i||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ra,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const i=new $l(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this._minEleveationForCurrentTile=i._minEleveationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const l=-c.b5(i,-180,180)*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=function(){var d=new c.A(4);return c.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,_){var b=f[0],S=f[1],E=f[2],A=f[3],M=Math.sin(_),z=Math.cos(_);d[0]=b*z+E*M,d[1]=S*z+A*M,d[2]=b*-M+E*z,d[3]=S*-M+A*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const l=c.ad(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const l=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this.tileZoom=Math.max(0,Math.floor(l)),this.scale=this.zoomScale(l),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,l,d){this._unmodified=!1,this._edgeInsets.interpolate(i,l,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const l=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(i){const l=[new c.b6(0,i)];if(this._renderWorldCopies){const d=this.pointCoordinate(new c.P(0,0)),f=this.pointCoordinate(new c.P(this.width,0)),_=this.pointCoordinate(new c.P(this.width,this.height)),b=this.pointCoordinate(new c.P(0,this.height)),S=Math.floor(Math.min(d.x,f.x,_.x,b.x)),E=Math.floor(Math.max(d.x,f.x,_.x,b.x)),A=1;for(let M=S-A;M<=E+A;M++)M!==0&&l.push(new c.b6(M,i))}return l}coveringTiles(i){var l,d;let f=this.coveringZoomLevel(i);const _=f;if(i.minzoom!==void 0&&f<i.minzoom)return[];i.maxzoom!==void 0&&f>i.maxzoom&&(f=i.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),S=c.U.fromLngLat(this.center),E=Math.pow(2,f),A=[E*b.x,E*b.y,0],M=[E*S.x,E*S.y,0],z=Ui.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f);let V=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=f);const Y=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,X=ie=>({aabb:new qo([ie*E,0,0],[(ie+1)*E,E,0]),zoom:0,x:0,y:0,wrap:ie,fullyVisible:!1}),Q=[],H=[],me=f,Se=i.reparseOverscaled?_:f;if(this._renderWorldCopies)for(let ie=1;ie<=3;ie++)Q.push(X(-ie)),Q.push(X(ie));for(Q.push(X(0));Q.length>0;){const ie=Q.pop(),ye=ie.x,Pe=ie.y;let Ae=ie.fullyVisible;if(!Ae){const ht=ie.aabb.intersects(z);if(ht===0)continue;Ae=ht===2}const ze=i.terrain?A:M,Be=ie.aabb.distanceX(ze),Fe=ie.aabb.distanceY(ze),$e=Math.max(Math.abs(Be),Math.abs(Fe));if(ie.zoom===me||$e>Y+(1<<me-ie.zoom)-2&&ie.zoom>=V){const ht=me-ie.zoom,Zt=A[0]-.5-(ye<<ht),Ye=A[1]-.5-(Pe<<ht);H.push({tileID:new c.O(ie.zoom===me?Se:ie.zoom,ie.wrap,ie.zoom,ye,Pe),distanceSq:Ie([M[0]-.5-ye,M[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(Zt*Zt+Ye*Ye)})}else for(let ht=0;ht<4;ht++){const Zt=(ye<<1)+ht%2,Ye=(Pe<<1)+(ht>>1),vt=ie.zoom+1;let pt=ie.aabb.quadrant(ht);if(i.terrain){const pn=new c.O(vt,ie.wrap,vt,Zt,Ye),Vt=i.terrain.getMinMaxElevation(pn),Mt=(l=Vt.minElevation)!==null&&l!==void 0?l:this.elevation,Gt=(d=Vt.maxElevation)!==null&&d!==void 0?d:this.elevation;pt=new qo([pt.min[0],pt.min[1],Mt],[pt.max[0],pt.max[1],Gt])}Q.push({aabb:pt,zoom:vt,x:Zt,y:Ye,wrap:ie.wrap,fullyVisible:Ae})}}return H.sort((ie,ye)=>ie.distanceSq-ye.distanceSq).map(ie=>ie.tileID)}resize(i,l){this.width=i,this.height=l,this.pixelsToGLUnits=[2/i,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const l=c.ad(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.P(c.G(i.lng)*this.worldSize,c.H(l)*this.worldSize)}unproject(i){return new c.U(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const l=this.pointLocation(this.centerPoint,i),d=i.getElevationForLngLatZoom(l,this.tileZoom);if(!(this.elevation-d))return;const f=this.getCameraPosition(),_=c.U.fromLngLat(f.lngLat,f.altitude),b=c.U.fromLngLat(l,d),S=_.x-b.x,E=_.y-b.y,A=_.z-b.z,M=Math.sqrt(S*S+E*E+A*A),z=this.scaleZoom(this.cameraToCenterDistance/M/this.tileSize);this._elevation=d,this._center=l,this.zoom=z}setLocationAtPoint(i,l){const d=this.pointCoordinate(l),f=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(i),b=new c.U(_.x-(d.x-f.x),_.y-(d.y-f.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,l){return l?this.coordinatePoint(this.locationCoordinate(i),l.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,l){return this.coordinateLocation(this.pointCoordinate(i,l))}locationCoordinate(i){return c.U.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,l){if(l){const V=l.pointCoordinate(i);if(V!=null)return V}const d=[i.x,i.y,0,1],f=[i.x,i.y,1,1];c.ag(d,d,this.pixelMatrixInverse),c.ag(f,f,this.pixelMatrixInverse);const _=d[3],b=f[3],S=d[1]/_,E=f[1]/b,A=d[2]/_,M=f[2]/b,z=A===M?0:(0-A)/(M-A);return new c.U(c.B.number(d[0]/_,f[0]/b,z)/this.worldSize,c.B.number(S,E,z)/this.worldSize)}coordinatePoint(i,l=0,d=this.pixelMatrix){const f=[i.x*this.worldSize,i.y*this.worldSize,l,1];return c.ag(f,f,d),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new Ft().extend(this.pointLocation(new c.P(0,i))).extend(this.pointLocation(new c.P(this.width,i))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ft([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(i,l=!1){const d=i.key,f=l?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const _=i.canonical,b=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*i.wrap,E=c.ao(new Float64Array(16));return c.$(E,E,[S*b,_.y*b,0]),c.a0(E,E,[b/c.N,b/c.N,1]),c.a1(E,l?this.alignedProjMatrix:this.projMatrix,E),f[d]=new Float32Array(E),f[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i,l,d,f,_=-90,b=90,S=-180,E=180;const A=this.size,M=this._unmodified;if(this.latRange){const Y=this.latRange;_=c.H(Y[1])*this.worldSize,b=c.H(Y[0])*this.worldSize,i=b-_<A.y?A.y/(b-_):0}if(this.lngRange){const Y=this.lngRange;S=c.b5(c.G(Y[0])*this.worldSize,0,this.worldSize),E=c.b5(c.G(Y[1])*this.worldSize,0,this.worldSize),E<S&&(E+=this.worldSize),l=E-S<A.x?A.x/(E-S):0}const z=this.point,V=Math.max(l||0,i||0);if(V)return this.center=this.unproject(new c.P(l?(E+S)/2:z.x,i?(b+_)/2:z.y)),this.zoom+=this.scaleZoom(V),this._unmodified=M,void(this._constraining=!1);if(this.latRange){const Y=z.y,X=A.y/2;Y-X<_&&(f=_+X),Y+X>b&&(f=b-X)}if(this.lngRange){const Y=(S+E)/2,X=c.b5(z.x,Y-this.worldSize/2,Y+this.worldSize/2),Q=A.x/2;X-Q<S&&(d=S+Q),X+Q>E&&(d=E-Q)}d===void 0&&f===void 0||(this.center=this.unproject(new c.P(d!==void 0?d:z.x,f!==void 0?f:z.y)).wrap()),this._unmodified=M,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,l=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b7(1,this.center.lat)*this.worldSize;let f=c.ao(new Float64Array(16));c.a0(f,f,[this.width/2,-this.height/2,1]),c.$(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=c.ao(new Float64Array(16)),c.a0(f,f,[1,-1,1]),c.$(f,f,[-1,-1,0]),c.a0(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const _=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this._minEleveationForCurrentTile),S=_-b*this._pixelPerMeter/Math.cos(this._pitch),E=b<0?S:_,A=Math.PI/2+this._pitch,M=this._fov*(.5+i.y/this.height),z=Math.sin(M)*E/Math.sin(c.ad(Math.PI-A-M,.01,Math.PI-.01)),V=this.getHorizon(),Y=2*Math.atan(V/this.cameraToCenterDistance)*(.5+i.y/(2*V)),X=Math.sin(Y)*E/Math.sin(c.ad(Math.PI-A-Y,.01,Math.PI-.01)),Q=Math.min(z,X),H=1.01*(Math.cos(Math.PI/2-this._pitch)*Q+E),me=this.height/50;f=new Float64Array(16),c.b8(f,this._fov,this.width/this.height,me,H),f[8]=2*-i.x/this.width,f[9]=2*i.y/this.height,c.a0(f,f,[1,-1,1]),c.$(f,f,[0,0,-this.cameraToCenterDistance]),c.b9(f,f,this._pitch),c.ae(f,f,this.angle),c.$(f,f,[-l,-d,0]),this.mercatorMatrix=c.a0([],f,[this.worldSize,this.worldSize,this.worldSize]),c.a0(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.a1(new Float64Array(16),this.labelPlaneMatrix,f),c.$(f,f,[0,0,-this.elevation]),this.projMatrix=f,this.invProjMatrix=c.as([],f),this.pixelMatrix3D=c.a1(new Float64Array(16),this.labelPlaneMatrix,f);const Se=this.width%2/2,ie=this.height%2/2,ye=Math.cos(this.angle),Pe=Math.sin(this.angle),Ae=l-Math.round(l)+ye*Se+Pe*ie,ze=d-Math.round(d)+ye*ie+Pe*Se,Be=new Float64Array(f);if(c.$(Be,Be,[Ae>.5?Ae-1:Ae,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=Be,f=c.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new c.P(0,0)),l=[i.x*this.worldSize,i.y*this.worldSize,0,1];return c.ag(l,l,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,i))}getCameraQueryGeometry(i){const l=this.getCameraPoint();if(i.length===1)return[i[0],l];{let d=l.x,f=l.y,_=l.x,b=l.y;for(const S of i)d=Math.min(d,S.x),f=Math.min(f,S.y),_=Math.max(_,S.x),b=Math.max(b,S.y);return[new c.P(d,f),new c.P(_,f),new c.P(_,b),new c.P(d,b),new c.P(d,f)]}}}function ho(m,i){let l,d=!1,f=null,_=null;const b=()=>{f=null,d&&(m.apply(_,l),f=setTimeout(b,i),d=!1)};return(...S)=>(d=!0,_=this,l=S,f||b(),f)}class Fa{constructor(i){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(l.length>=3&&!l.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,l)}catch{}},this._updateHash=ho(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const l=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),b=Math.round(l.lng*_)/_,S=Math.round(l.lat*_)/_,E=this._map.getBearing(),A=this._map.getPitch();let M="";if(M+=i?`/${b}/${S}/${d}`:`${d}/${S}/${b}`,(E||A)&&(M+="/"+Math.round(10*E)/10),A&&(M+=`/${Math.round(A)}`),this._hashName){const z=this._hashName;let V=!1;const Y=window.location.hash.slice(1).split("&").map(X=>{const Q=X.split("=")[0];return Q===z?(V=!0,`${Q}=${M}`):X}).filter(X=>X);return V||Y.push(`${z}=${M}`),`#${Y.join("&")}`}return`#${M}`}}const Zo={linearity:.3,easing:c.ba(0,0,.3,1)},Fd=c.e({deceleration:2500,maxSpeed:1400},Zo),Bd=c.e({deceleration:20,maxSpeed:1400},Zo),Nd=c.e({deceleration:1e3,maxSpeed:360},Zo),jd=c.e({deceleration:1e3,maxSpeed:90},Zo);class Od{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.h.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,l=c.h.now();for(;i.length>0&&l-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)l.zoom+=_.zoomDelta||0,l.bearing+=_.bearingDelta||0,l.pitch+=_.pitchDelta||0,_.panDelta&&l.pan._add(_.panDelta),_.around&&(l.around=_.around),_.pinchAround&&(l.pinchAround=_.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(l.pan.mag()){const _=Ba(l.pan.mag(),d,c.e({},Fd,i||{}));f.offset=l.pan.mult(_.amount/l.pan.mag()),f.center=this._map.transform.center,Qr(f,_)}if(l.zoom){const _=Ba(l.zoom,d,Bd);f.zoom=this._map.transform.zoom+_.amount,Qr(f,_)}if(l.bearing){const _=Ba(l.bearing,d,Nd);f.bearing=this._map.transform.bearing+c.ad(_.amount,-179,179),Qr(f,_)}if(l.pitch){const _=Ba(l.pitch,d,jd);f.pitch=this._map.transform.pitch+_.amount,Qr(f,_)}if(f.zoom||f.bearing){const _=l.pinchAround===void 0?l.around:l.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function Qr(m,i){(!m.duration||m.duration<i.duration)&&(m.duration=i.duration,m.easing=i.easing)}function Ba(m,i,l){const{maxSpeed:d,linearity:f,deceleration:_}=l,b=c.ad(m*f/(i/1e3),-d,d),S=Math.abs(b)/(_*f);return{easing:l.easing,duration:1e3*S,amount:b*(S/2)}}class cr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l,d,f={}){const _=k.mousePos(l.getCanvasContainer(),d),b=l.unproject(_);super(i,c.e({point:_,lngLat:b,originalEvent:d},f)),this._defaultPrevented=!1,this.target=l}}class Na extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l,d){const f=i==="touchend"?d.changedTouches:d.touches,_=k.touchPos(l.getCanvasContainer(),f),b=_.map(E=>l.unproject(E)),S=_.reduce((E,A,M,z)=>E.add(A.div(z.length)),new c.P(0,0));super(i,{points:_,point:S,lngLats:b,lngLat:l.unproject(S),originalEvent:d}),this._defaultPrevented=!1}}class Vd extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l,d){super(i,{originalEvent:d}),this._defaultPrevented=!1}}class $d{constructor(i,l){this._map=i,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Vd(i.type,this._map,i))}mousedown(i,l){return this._mousedownPos=l,this._firePreventable(new cr(i.type,this._map,i))}mouseup(i){this._map.fire(new cr(i.type,this._map,i))}click(i,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new cr(i.type,this._map,i))}dblclick(i){return this._firePreventable(new cr(i.type,this._map,i))}mouseover(i){this._map.fire(new cr(i.type,this._map,i))}mouseout(i){this._map.fire(new cr(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Na(i.type,this._map,i))}touchmove(i){this._map.fire(new Na(i.type,this._map,i))}touchend(i){this._map.fire(new Na(i.type,this._map,i))}touchcancel(i){this._map.fire(new Na(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ud{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new cr(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new cr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new cr(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _s{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(c.P.convert(i),this._map.terrain)}}class qd{constructor(i,l){this._map=i,this._tr=new _s(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,l){this.isEnabled()&&i.shiftKey&&i.button===0&&(k.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(i,l){if(!this._active)return;const d=l;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=k.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const _=Math.min(f.x,d.x),b=Math.max(f.x,d.x),S=Math.min(f.y,d.y),E=Math.max(f.y,d.y);k.setTransform(this._box,`translate(${_}px,${S}px)`),this._box.style.width=b-_+"px",this._box.style.height=E-S+"px"}mouseupWindow(i,l){if(!this._active||i.button!==0)return;const d=this._startPos,f=l;if(this.reset(),k.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:i})),{cameraAnimation:_=>_.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,l){return this._map.fire(new c.k(i,{originalEvent:l}))}}function Cr(m,i){if(m.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${i.length}`);const l={};for(let d=0;d<m.length;d++)l[m[d].identifier]=i[d];return l}class xs{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,l,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const _=new c.P(0,0);for(const b of f)_._add(b);return _.div(f.length)}(l),this.touches=Cr(d,l)))}touchmove(i,l,d){if(this.aborted||!this.centroid)return;const f=Cr(d,l);for(const _ in this.touches){const b=f[_];(!b||b.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(i,l,d){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Ul{constructor(i){this.singleTap=new xs(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,l,d){this.singleTap.touchstart(i,l,d)}touchmove(i,l,d){this.singleTap.touchmove(i,l,d)}touchend(i,l,d){const f=this.singleTap.touchend(i,l,d);if(f){const _=i.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(_&&b||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class vs{constructor(i){this._tr=new _s(i),this._zoomIn=new Ul({numTouches:1,numTaps:2}),this._zoomOut=new Ul({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,l,d){this._zoomIn.touchstart(i,l,d),this._zoomOut.touchstart(i,l,d)}touchmove(i,l,d){this._zoomIn.touchmove(i,l,d),this._zoomOut.touchmove(i,l,d)}touchend(i,l,d){const f=this._zoomIn.touchend(i,l,d),_=this._zoomOut.touchend(i,l,d),b=this._tr;return f?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(f)},{originalEvent:i})}):_?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(_)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ws{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const l=this._moveFunction(...i);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(i,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=l.length?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,l){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const f=l.length?l[0]:l;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&k.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zm={0:1,2:2};class xu{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const l=k.mouseButton(i);this._eventButton=l}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(l,d){const f=Zm[d];return l.buttons===void 0||(l.buttons&f)!==f}(i,this._eventButton)}isValidEndEvent(i){return k.mouseButton(i)===this._eventButton}}class Zd{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const ql=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=function(i){i.preventDefault()}},Go=({enable:m,clickTolerance:i,bearingDegreesPerPixelMoved:l=.8})=>{const d=new xu({checkCorrectEvent:f=>k.mouseButton(f)===0&&f.ctrlKey||k.mouseButton(f)===2});return new ws({clickTolerance:i,move:(f,_)=>({bearingDelta:(_.x-f.x)*l}),moveStateManager:d,enable:m,assignEvents:ql})},bs=({enable:m,clickTolerance:i,pitchDegreesPerPixelMoved:l=-.5})=>{const d=new xu({checkCorrectEvent:f=>k.mouseButton(f)===0&&f.ctrlKey||k.mouseButton(f)===2});return new ws({clickTolerance:i,move:(f,_)=>({pitchDelta:(_.y-f.y)*l}),moveStateManager:d,enable:m,assignEvents:ql})};class st{constructor(i,l){this._minTouches=i.cooperativeGestures?2:1,this._clickTolerance=i.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(i,l,d){return this._calculateTransform(i,l,d)}touchmove(i,l,d){if(this._map._cooperativeGestures&&(this._minTouches===2&&d.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(i,!1,d.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(d.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,l,d)}touchend(i,l,d){this._calculateTransform(i,l,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,l,d){d.length>0&&(this._active=!0);const f=Cr(d,l),_=new c.P(0,0),b=new c.P(0,0);let S=0;for(const A in f){const M=f[A],z=this._touches[A];z&&(_._add(M),b._add(M.sub(z)),S++,f[A]=M)}if(this._touches=f,S<this._minTouches||!b.mag())return;const E=b.div(S);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(S),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,l,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([l[0],l[1]]))}touchmove(i,l,d){if(!this._firstTwoTouches)return;i.preventDefault();const[f,_]=this._firstTwoTouches,b=qs(d,l,f),S=qs(d,l,_);if(!b||!S)return;const E=this._aroundCenter?null:b.add(S).div(2);return this._move([b,S],E,i)}touchend(i,l,d){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,b=qs(d,l,f),S=qs(d,l,_);b&&S||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function qs(m,i,l){for(let d=0;d<m.length;d++)if(m[d].identifier===l)return i[d]}function Wo(m,i){return Math.log(m/i)/Math.LN2}class Gd extends Zl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,l){const d=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Wo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wo(this._distance,d),pinchAround:l}}}function tt(m,i){return 180*m.angleWith(i)/Math.PI}class vu extends Zl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,l){const d=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:tt(this._vector,d),pinchAround:l}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const l=25/(Math.PI*this._minDiameter)*360,d=tt(i,this._startVector);return Math.abs(d)<l}}function wu(m){return Math.abs(m.y)>Math.abs(m.x)}class Gm extends Zl{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,l,d){super.touchstart(i,l,d),this._currentTouchCount=d.length}_start(i){this._lastPoints=i,wu(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,l,d){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const f=i[0].sub(this._lastPoints[0]),_=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,d.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(i,l,d){if(this._valid!==void 0)return this._valid;const f=i.mag()>=2,_=l.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const b=i.y>0==l.y>0;return wu(i)&&wu(l)&&b}}const bu={panStep:100,bearingStep:15,pitchStep:10};class Wd{constructor(i){this._tr=new _s(i);const l=bu;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let l=0,d=0,f=0,_=0,b=0;switch(i.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:i.shiftKey?d=-1:(i.preventDefault(),_=-1);break;case 39:i.shiftKey?d=1:(i.preventDefault(),_=1);break;case 38:i.shiftKey?f=1:(i.preventDefault(),b=-1);break;case 40:i.shiftKey?f=-1:(i.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:S=>{const E=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Hd,zoom:l?Math.round(E.zoom)+l*(i.shiftKey?2:1):E.zoom,bearing:E.bearing+d*this._bearingStep,pitch:E.pitch+f*this._pitchStep,offset:[-_*this._panStep,-b*this._panStep],center:E.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Hd(m){return m*(2-m)}const Kd=4.000244140625;class Wm{constructor(i,l){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=i,this._tr=new _s(i),this._el=i.getCanvasContainer(),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!i[this._map._metaKey])return;i.preventDefault()}let l=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const d=c.h.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,l!==0&&l%Kd==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(f*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),i.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=i,this._delta-=l,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=k.mousePos(this._el,i),d=this._tr;this._around=c.L.convert(this._aroundCenter?d.center:d.unproject(l)),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Kd?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&E!==0&&(E=1/E);const A=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(A*E))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,d=this._startZoom,f=this._easing;let _,b=!1;if(this._type==="wheel"&&d&&f){const S=Math.min((c.h.now()-this._lastWheelEventTime)/200,1),E=f(S);_=c.B.number(d,l,E),S<1?this._frameId||(this._frameId=!0):b=!0}else _=l,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:_-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let l=c.bb;if(this._prevEase){const d=this._prevEase,f=(c.h.now()-d.start)/d.duration,_=d.easing(f+.01)-d.easing(f),b=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-b*b);l=c.ba(b,S,.25,1)}return this._prevEase={start:c.h.now(),duration:i,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Su{constructor(i,l){this._clickZoom=i,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Tu{constructor(i){this._tr=new _s(i),this.reset()}reset(){this._active=!1}dblclick(i,l){return i.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ku{constructor(){this._tap=new Ul({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,l,d){if(!this._swipePoint)if(this._tapTime){const f=l[0],_=i.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;_&&b?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(i,l,d)}touchmove(i,l,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=l[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,i.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(i,l,d)}touchend(i,l,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(i,l,d);f&&(this._tapTime=i.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eu{constructor(i,l,d){this._el=i,this._mousePan=l,this._touchPan=d}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(i,l,d){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=l,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Zs{constructor(i,l,d,f){this._el=i,this._touchZoom=l,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ja=m=>m.zoom||m.drag||m.pitch||m.rotate;class Cu extends c.k{}function Oa(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Pu{constructor(i,l){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,S={needsRenderFrame:!1},E={},A={},M=f.touches,z=M?this._getMapTouches(M):void 0,V=z?k.touchPos(this._el,z):k.mousePos(this._el,f);for(const{handlerName:Q,handler:H,allowed:me}of this._handlers){if(!H.isEnabled())continue;let Se;this._blockedByActive(A,me,Q)?H.reset():H[_||f.type]&&(Se=H[_||f.type](f,V,z),this.mergeHandlerResult(S,E,Se,Q,b),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||H.isActive())&&(A[Q]=H)}const Y={};for(const Q in this._previousActiveHandlers)A[Q]||(Y[Q]=b);this._previousActiveHandlers=A,(Object.keys(Y).length||Oa(S))&&(this._changes.push([S,E,Y]),this._triggerRenderFrame()),(Object.keys(A).length||Oa(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=S;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Od(i),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,b]of this._listeners)k.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[i,l,d]of this._listeners)k.removeEventListener(i,l,i===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(i){const l=this._map,d=l.getCanvasContainer();this._add("mapEvent",new $d(l,i));const f=l.boxZoom=new qd(l,i);this._add("boxZoom",f),i.interactive&&i.boxZoom&&f.enable();const _=new vs(l),b=new Tu(l);l.doubleClickZoom=new Su(b,_),this._add("tapZoom",_),this._add("clickZoom",b),i.interactive&&i.doubleClickZoom&&l.doubleClickZoom.enable();const S=new ku;this._add("tapDragZoom",S);const E=l.touchPitch=new Gm(l);this._add("touchPitch",E),i.interactive&&i.touchPitch&&l.touchPitch.enable(i.touchPitch);const A=Go(i),M=bs(i);l.dragRotate=new qi(i,A,M),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]),i.interactive&&i.dragRotate&&l.dragRotate.enable();const z=(({enable:me,clickTolerance:Se})=>{const ie=new xu({checkCorrectEvent:ye=>k.mouseButton(ye)===0&&!ye.ctrlKey});return new ws({clickTolerance:Se,move:(ye,Pe)=>({around:Pe,panDelta:Pe.sub(ye)}),activateOnStart:!0,moveStateManager:ie,enable:me,assignEvents:ql})})(i),V=new st(i,l);l.dragPan=new Eu(d,z,V),this._add("mousePan",z),this._add("touchPan",V,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&l.dragPan.enable(i.dragPan);const Y=new vu,X=new Gd;l.touchZoomRotate=new Zs(d,X,Y,S),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&l.touchZoomRotate.enable(i.touchZoomRotate);const Q=l.scrollZoom=new Wm(l,()=>this._triggerRenderFrame());this._add("scrollZoom",Q,["mousePan"]),i.interactive&&i.scrollZoom&&l.scrollZoom.enable(i.scrollZoom);const H=l.keyboard=new Wd(l);this._add("keyboard",H),i.interactive&&i.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new Ud(l))}_add(i,l,d){this._handlers.push({handlerName:i,handler:l,allowed:d}),this._handlersById[i]=l}stop(i){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,l,d){for(const f in i)if(f!==d&&(!l||l.indexOf(f)<0))return!0;return!1}_getMapTouches(i){const l=[];for(const d of i)this._el.contains(d.target)&&l.push(d);return l}mergeHandlerResult(i,l,d,f,_){if(!d)return;c.e(i,d);const b={handlerName:f,originalEvent:d.originalEvent||_};d.zoomDelta!==void 0&&(l.zoom=b),d.panDelta!==void 0&&(l.drag=b),d.pitchDelta!==void 0&&(l.pitch=b),d.bearingDelta!==void 0&&(l.rotate=b)}_applyChanges(){const i={},l={},d={};for(const[f,_,b]of this._changes)f.panDelta&&(i.panDelta=(i.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(i.around=f.around),f.pinchAround!==void 0&&(i.pinchAround=f.pinchAround),f.noInertia&&(i.noInertia=f.noInertia),c.e(l,_),c.e(d,b);this._updateMapTransform(i,l,d),this._changes=[]}_updateMapTransform(i,l,d){const f=this._map,_=f._getTransformForUpdate(),b=f.terrain;if(!(Oa(i)||b&&this._terrainMovement))return this._fireEvents(l,d,!0);let{panDelta:S,zoomDelta:E,bearingDelta:A,pitchDelta:M,around:z,pinchAround:V}=i;V!==void 0&&(z=V),f._stop(!0),z=z||f.transform.centerPoint;const Y=_.pointLocation(S?z.sub(S):z);A&&(_.bearing+=A),M&&(_.pitch+=M),E&&(_.zoom+=E),b?this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?_.center=_.pointLocation(_.centerPoint.sub(S)):_.setLocationAtPoint(Y,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,_.setLocationAtPoint(Y,z),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,_.recalculateZoom(f.terrain)})):_.setLocationAtPoint(Y,z),f._applyUpdatedTransform(_),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(l,d,!0)}_fireEvents(i,l,d){const f=ja(this._eventsInProgress),_=ja(i),b={};for(const M in i){const{originalEvent:z}=i[M];this._eventsInProgress[M]||(b[`${M}start`]=z),this._eventsInProgress[M]=i[M]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const M in b)this._fireEvent(M,b[M]);_&&this._fireEvent("move",_.originalEvent);for(const M in i){const{originalEvent:z}=i[M];this._fireEvent(M,z)}const S={};let E;for(const M in this._eventsInProgress){const{handlerName:z,originalEvent:V}=this._eventsInProgress[M];this._handlersById[z].isActive()||(delete this._eventsInProgress[M],E=l[z]||V,S[`${M}end`]=E)}for(const M in S)this._fireEvent(M,S[M]);const A=ja(this._eventsInProgress);if(d&&(f||_)&&!A){this._updatingCamera=!0;const M=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!M||!M.essential&&c.h.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),z(this._map.getBearing())&&this._map.resetNorth()):(z(M.bearing||this._map.getBearing())&&(M.bearing=0),M.freezeElevation=!0,this._map.easeTo(M,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(i,l){this._map.fire(new c.k(i,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new Cu("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Xd extends c.E{constructor(i,l){super(),this._renderFrameCallback=()=>{const d=Math.min((c.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=l.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.L(this.transform.center.lng,this.transform.center.lat)}setCenter(i,l){return this.jumpTo({center:i},l)}panBy(i,l,d){return i=c.P.convert(i).mult(-1),this.panTo(this.transform.center,c.e({offset:i},l),d)}panTo(i,l,d){return this.easeTo(c.e({center:i},l),d)}getZoom(){return this.transform.zoom}setZoom(i,l){return this.jumpTo({zoom:i},l),this}zoomTo(i,l,d){return this.easeTo(c.e({zoom:i},l),d)}zoomIn(i,l){return this.zoomTo(this.getZoom()+1,i,l),this}zoomOut(i,l){return this.zoomTo(this.getZoom()-1,i,l),this}getBearing(){return this.transform.bearing}setBearing(i,l){return this.jumpTo({bearing:i},l),this}getPadding(){return this.transform.padding}setPadding(i,l){return this.jumpTo({padding:i},l),this}rotateTo(i,l,d){return this.easeTo(c.e({bearing:i},l),d)}resetNorth(i,l){return this.rotateTo(0,c.e({duration:1e3},i),l),this}resetNorthPitch(i,l){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},i),l),this}snapToNorth(i,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,l):this}getPitch(){return this.transform.pitch}setPitch(i,l){return this.jumpTo({pitch:i},l),this}cameraForBounds(i,l){i=Ft.convert(i);const d=l&&l.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),d,l)}_cameraForBoxAndBearing(i,l,d,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const Pe=f.padding;f.padding={top:Pe,bottom:Pe,right:Pe,left:Pe}}f.padding=c.e(_,f.padding);const b=this.transform,S=b.padding,E=b.project(c.L.convert(i)),A=b.project(c.L.convert(l)),M=E.rotate(-d*Math.PI/180),z=A.rotate(-d*Math.PI/180),V=new c.P(Math.max(M.x,z.x),Math.max(M.y,z.y)),Y=new c.P(Math.min(M.x,z.x),Math.min(M.y,z.y)),X=V.sub(Y),Q=(b.width-(S.left+S.right+f.padding.left+f.padding.right))/X.x,H=(b.height-(S.top+S.bottom+f.padding.top+f.padding.bottom))/X.y;if(H<0||Q<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const me=Math.min(b.scaleZoom(b.scale*Math.min(Q,H)),f.maxZoom),Se=c.P.convert(f.offset),ie=new c.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(d*Math.PI/180),ye=Se.add(ie).mult(b.scale/b.zoomScale(me));return{center:b.unproject(E.add(A).div(2).sub(ye)),zoom:me,bearing:d}}fitBounds(i,l,d){return this._fitInternal(this.cameraForBounds(i,l),l,d)}fitScreenCoordinates(i,l,d,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(i)),this.transform.pointLocation(c.P.convert(l)),d,f),f,_)}_fitInternal(i,l,d){return i?(delete(l=c.e(i,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this}jumpTo(i,l){this.stop();const d=this._getTransformForUpdate();let f=!1,_=!1,b=!1;return"zoom"in i&&d.zoom!==+i.zoom&&(f=!0,d.zoom=+i.zoom),i.center!==void 0&&(d.center=c.L.convert(i.center)),"bearing"in i&&d.bearing!==+i.bearing&&(_=!0,d.bearing=+i.bearing),"pitch"in i&&d.pitch!==+i.pitch&&(b=!0,d.pitch=+i.pitch),i.padding==null||d.isPaddingEqual(i.padding)||(d.padding=i.padding),this._applyUpdatedTransform(d),this.fire(new c.k("movestart",l)).fire(new c.k("move",l)),f&&this.fire(new c.k("zoomstart",l)).fire(new c.k("zoom",l)).fire(new c.k("zoomend",l)),_&&this.fire(new c.k("rotatestart",l)).fire(new c.k("rotate",l)).fire(new c.k("rotateend",l)),b&&this.fire(new c.k("pitchstart",l)).fire(new c.k("pitch",l)).fire(new c.k("pitchend",l)),this.fire(new c.k("moveend",l))}calculateCameraOptionsFromTo(i,l,d,f=0){const _=c.U.fromLngLat(i,l),b=c.U.fromLngLat(d,f),S=b.x-_.x,E=b.y-_.y,A=b.z-_.z,M=Math.hypot(S,E,A);if(M===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(S,E),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),Y=180*Math.atan2(S,-E)/Math.PI;let X=180*Math.acos(z/M)/Math.PI;return X=A<0?90-X:90+X,{center:b.toLngLat(),zoom:V,pitch:X,bearing:Y}}easeTo(i,l){this._stop(!1,i.easeId),((i=c.e({offset:[0,0],duration:500,easing:c.bb},i)).animate===!1||!i.essential&&c.h.prefersReducedMotion)&&(i.duration=0);const d=this._getTransformForUpdate(),f=this.getZoom(),_=this.getBearing(),b=this.getPitch(),S=this.getPadding(),E="zoom"in i?+i.zoom:f,A="bearing"in i?this._normalizeBearing(i.bearing,_):_,M="pitch"in i?+i.pitch:b,z="padding"in i?i.padding:d.padding,V=c.P.convert(i.offset);let Y=d.centerPoint.add(V);const X=d.pointLocation(Y),Q=c.L.convert(i.center||X);this._normalizeCenter(Q);const H=d.project(X),me=d.project(Q).sub(H),Se=d.zoomScale(E-f);let ie,ye;i.around&&(ie=c.L.convert(i.around),ye=d.locationPoint(ie));const Pe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==f,this._rotating=this._rotating||_!==A,this._pitching=this._pitching||M!==b,this._padding=!d.isPaddingEqual(z),this._easeId=i.easeId,this._prepareEase(l,i.noMoveStart,Pe),this.terrain&&this._prepareElevation(Q),this._ease(Ae=>{if(this._zooming&&(d.zoom=c.B.number(f,E,Ae)),this._rotating&&(d.bearing=c.B.number(_,A,Ae)),this._pitching&&(d.pitch=c.B.number(b,M,Ae)),this._padding&&(d.interpolatePadding(S,z,Ae),Y=d.centerPoint.add(V)),this.terrain&&!i.freezeElevation&&this._updateElevation(Ae),ie)d.setLocationAtPoint(ie,ye);else{const ze=d.zoomScale(d.zoom-f),Be=E>f?Math.min(2,Se):Math.max(.5,Se),Fe=Math.pow(Be,1-Ae),$e=d.unproject(H.add(me.mult(Ae*Fe)).mult(ze));d.setLocationAtPoint(d.renderWorldCopies?$e.wrap():$e,Y)}this._applyUpdatedTransform(d),this._fireMoveEvents(l)},Ae=>{this.terrain&&this._finalizeElevation(),this._afterEase(l,Ae)},i),this}_prepareEase(i,l,d={}){this._moving=!0,l||d.moving||this.fire(new c.k("movestart",i)),this._zooming&&!d.zooming&&this.fire(new c.k("zoomstart",i)),this._rotating&&!d.rotating&&this.fire(new c.k("rotatestart",i)),this._pitching&&!d.pitching&&this.fire(new c.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&l!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(d-(l-(d*i+this._elevationStart))/(1-i)),this._elevationTarget=l}this.transform.elevation=c.B.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(i){if(!this.transformCameraUpdate)return;const l=i.clone(),{center:d,zoom:f,pitch:_,bearing:b,elevation:S}=this.transformCameraUpdate(l);d&&(l.center=d),f!==void 0&&(l.zoom=f),_!==void 0&&(l.pitch=_),b!==void 0&&(l.bearing=b),S!==void 0&&(l.elevation=S),this.transform.apply(l)}_fireMoveEvents(i){this.fire(new c.k("move",i)),this._zooming&&this.fire(new c.k("zoom",i)),this._rotating&&this.fire(new c.k("rotate",i)),this._pitching&&this.fire(new c.k("pitch",i))}_afterEase(i,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const d=this._zooming,f=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.k("zoomend",i)),f&&this.fire(new c.k("rotateend",i)),_&&this.fire(new c.k("pitchend",i)),this.fire(new c.k("moveend",i))}flyTo(i,l){if(!i.essential&&c.h.prefersReducedMotion){const pt=c.F(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(pt,l)}this.stop(),i=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.bb},i);const d=this._getTransformForUpdate(),f=this.getZoom(),_=this.getBearing(),b=this.getPitch(),S=this.getPadding(),E="zoom"in i?c.ad(+i.zoom,d.minZoom,d.maxZoom):f,A="bearing"in i?this._normalizeBearing(i.bearing,_):_,M="pitch"in i?+i.pitch:b,z="padding"in i?i.padding:d.padding,V=d.zoomScale(E-f),Y=c.P.convert(i.offset);let X=d.centerPoint.add(Y);const Q=d.pointLocation(X),H=c.L.convert(i.center||Q);this._normalizeCenter(H);const me=d.project(Q),Se=d.project(H).sub(me);let ie=i.curve;const ye=Math.max(d.width,d.height),Pe=ye/V,Ae=Se.mag();if("minZoom"in i){const pt=c.ad(Math.min(i.minZoom,f,E),d.minZoom,d.maxZoom),pn=ye/d.zoomScale(pt-f);ie=Math.sqrt(pn/Ae*2)}const ze=ie*ie;function Be(pt){const pn=(Pe*Pe-ye*ye+(pt?-1:1)*ze*ze*Ae*Ae)/(2*(pt?Pe:ye)*ze*Ae);return Math.log(Math.sqrt(pn*pn+1)-pn)}function Fe(pt){return(Math.exp(pt)-Math.exp(-pt))/2}function $e(pt){return(Math.exp(pt)+Math.exp(-pt))/2}const ht=Be(!1);let Zt=function(pt){return $e(ht)/$e(ht+ie*pt)},Ye=function(pt){return ye*(($e(ht)*(Fe(pn=ht+ie*pt)/$e(pn))-Fe(ht))/ze)/Ae;var pn},vt=(Be(!0)-ht)/ie;if(Math.abs(Ae)<1e-6||!isFinite(vt)){if(Math.abs(ye-Pe)<1e-6)return this.easeTo(i,l);const pt=Pe<ye?-1:1;vt=Math.abs(Math.log(Pe/ye))/ie,Ye=function(){return 0},Zt=function(pn){return Math.exp(pt*ie*pn)}}return i.duration="duration"in i?+i.duration:1e3*vt/("screenSpeed"in i?+i.screenSpeed/ie:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=_!==A,this._pitching=M!==b,this._padding=!d.isPaddingEqual(z),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(H),this._ease(pt=>{const pn=pt*vt,Vt=1/Zt(pn);d.zoom=pt===1?E:f+d.scaleZoom(Vt),this._rotating&&(d.bearing=c.B.number(_,A,pt)),this._pitching&&(d.pitch=c.B.number(b,M,pt)),this._padding&&(d.interpolatePadding(S,z,pt),X=d.centerPoint.add(Y)),this.terrain&&!i.freezeElevation&&this._updateElevation(pt);const Mt=pt===1?H:d.unproject(me.add(Se.mult(Ye(pn))).mult(Vt));d.setLocationAtPoint(d.renderWorldCopies?Mt.wrap():Mt,X),this._applyUpdatedTransform(d),this._fireMoveEvents(l)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(l)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,l)}if(!i){const d=this.handlers;d&&d.stop(!1)}return this}_ease(i,l,d){d.animate===!1||d.duration===0?(i(1),l()):(this._easeStart=c.h.now(),this._easeOptions=d,this._onEaseFrame=i,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,l){i=c.b5(i,-180,180);const d=Math.abs(i-l);return Math.abs(i-360-l)<d&&(i-=360),Math.abs(i+360-l)<d&&(i+=360),i}_normalizeCenter(i){const l=this.transform;if(!l.renderWorldCopies||l.lngRange)return;const d=i.lng-l.center.lng;i.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(c.L.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}class ur{constructor(i={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options&&this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,l){const d=this._map._getUIString(`AttributionControl.${l}`);i.title=d,i.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const l=this._map.style.sourceCaches;for(const f in l){const _=l[f];if(_.used||_.usedForTerrain){const b=_.getSource();b.attribution&&i.indexOf(b.attribution)<0&&i.push(b.attribution)}}i=i.filter(f=>String(f).trim()),i.sort((f,_)=>f.length-_.length),i=i.filter((f,_)=>{for(let b=_+1;b<i.length;b++)if(i[b].indexOf(f)>=0)return!1;return!0});const d=i.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,i.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class vn{constructor(i={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl");const l=k.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Gl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const l=++this._id;return this._queue.push({callback:i,id:l,cancelled:!1}),l}remove(i){const l=this._currentlyRunning,d=l?this._queue.concat(l):this._queue;for(const f of d)if(f.id===i)return void(f.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const d of l)if(!d.cancelled&&(d.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Au={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Yd=c.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Jd extends c.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,l){this.sourceCache.update(i,l),this._renderableTilesKeys=[];const d={};for(const f of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),c.aS(f.posMatrix,0,c.N,0,c.N,0,1),this._tiles[f.key]=new ki(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(i){for(const l in this._tiles){const d=this._tiles[l];(!i||d.tileID.equals(i)||d.tileID.isChildOf(i)||i.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const l={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(i.canonical)){const _=i.clone();_.posMatrix=new Float64Array(16),c.aS(_.posMatrix,0,c.N,0,c.N,0,1),l[d]=_}else if(f.canonical.isChildOf(i.canonical)){const _=i.clone();_.posMatrix=new Float64Array(16);const b=f.canonical.z-i.canonical.z,S=f.canonical.x-(f.canonical.x>>b<<b),E=f.canonical.y-(f.canonical.y>>b<<b),A=c.N>>b;c.aS(_.posMatrix,0,A,0,A,0,1),c.$(_.posMatrix,_.posMatrix,[-S*A,-E*A,0]),l[d]=_}else if(i.canonical.isChildOf(f.canonical)){const _=i.clone();_.posMatrix=new Float64Array(16);const b=i.canonical.z-f.canonical.z,S=i.canonical.x-(i.canonical.x>>b<<b),E=i.canonical.y-(i.canonical.y>>b<<b),A=c.N>>b;c.aS(_.posMatrix,0,c.N,0,c.N,0,1),c.$(_.posMatrix,_.posMatrix,[S*A,E*A,0]),c.a0(_.posMatrix,_.posMatrix,[1/2**b,1/2**b,0]),l[d]=_}}return l}getSourceTile(i,l){const d=this.sourceCache._source;let f=i.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!_||!_.dem)&&l)for(;f>=d.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(i.scaledTo(f--).key);return _}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(l=>l.timeAdded>=i)}}class Qd{constructor(i,l,d){this.painter=i,this.sourceCache=new Jd(l),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,l,d,f=c.N){var _;if(!(l>=0&&l<f&&d>=0&&d<f))return 0;const b=this.getTerrainData(i),S=(_=b.tile)===null||_===void 0?void 0:_.dem;if(!S)return 0;const E=function(X,Q,H){var me=Q[0],Se=Q[1];return X[0]=H[0]*me+H[4]*Se+H[12],X[1]=H[1]*me+H[5]*Se+H[13],X}([],[l/f*c.N,d/f*c.N],b.u_terrain_matrix),A=[E[0]*S.dim,E[1]*S.dim],M=Math.floor(A[0]),z=Math.floor(A[1]),V=A[0]-M,Y=A[1]-z;return S.get(M,z)*(1-V)*(1-Y)+S.get(M+1,z)*V*(1-Y)+S.get(M,z+1)*(1-V)*Y+S.get(M+1,z+1)*V*Y}getElevationForLngLatZoom(i,l){const{tileID:d,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(i,l);return this.getElevation(d,f%c.N,_%c.N,c.N)}getElevation(i,l,d,f=c.N){return this.getDEMElevation(i,l,d,f)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const f=this.painter.context,_=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Oe(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Oe(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ao([])}const l=this.sourceCache.getSourceTile(i,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const f=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new Oe(f,l.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),l.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const d=l&&l+l.tileID.key+i.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=i.canonical.z-l.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=f?_=i.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=i.canonical.x-(i.canonical.x>>_<<_),S=i.canonical.y-(i.canonical.y>>_<<_),E=c.bc(new Float64Array(16),[1/(c.N<<_),1/(c.N<<_),0]);c.$(E,E,[b*c.N,S*c.N,0]),this._demMatrixCache[i.key]={matrix:E,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(i){const l=this.painter,d=l.width/devicePixelRatio,f=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Oe(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Oe(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,b=0;_<this._coordsTextureSize;_++)for(let S=0;S<this._coordsTextureSize;S++,b+=4)l[b+0]=255&S,l[b+1]=255&_,l[b+2]=S>>8<<4|_>>8,l[b+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),f=new Oe(i,d,i.gl.RGBA,{premultiply:!1});return f.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(i){const l=new Uint8Array(4),d=this.painter.context,f=d.gl;d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null);const _=l[0]+(l[2]>>4<<8),b=l[1]+((15&l[2])<<8),S=this.coordsIndex[255-l[3]],E=S&&this.sourceCache.getTileByID(S);if(!E)return null;const A=this._coordsTextureSize,M=(1<<E.tileID.canonical.z)*A;return new c.U(this._allowMercatorOverflow(i,(E.tileID.canonical.x*A+_)/M),(E.tileID.canonical.y*A+b)/M,this.getElevation(E.tileID,_,b,A))}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,l=new c.bd,d=new c.b0,f=this.meshSize,_=c.N/f,b=f*f;for(let z=0;z<=f;z++)for(let V=0;V<=f;V++)l.emplaceBack(V*_,z*_,0);for(let z=0;z<b;z+=f+1)for(let V=0;V<f;V++)d.emplaceBack(V+z,f+V+z+1,f+V+z+2),d.emplaceBack(V+z,f+V+z+2,V+z+1);const S=l.length,E=S+2*(f+1);for(const z of[0,1])for(let V=0;V<=f;V++)for(const Y of[0,1])l.emplaceBack(V*_,z*c.N,Y);for(let z=0;z<2*f;z+=2)d.emplaceBack(E+z,E+z+1,E+z+3),d.emplaceBack(E+z,E+z+3,E+z+2),d.emplaceBack(S+z,S+z+3,S+z+1),d.emplaceBack(S+z,S+z+2,S+z+3);const A=l.length,M=A+2*(f+1);for(const z of[0,1])for(let V=0;V<=f;V++)for(const Y of[0,1])l.emplaceBack(z*c.N,V*_,Y);for(let z=0;z<2*f;z+=2)d.emplaceBack(A+z,A+z+1,A+z+3),d.emplaceBack(A+z,A+z+3,A+z+2),d.emplaceBack(M+z,M+z+3,M+z+1),d.emplaceBack(M+z,M+z+2,M+z+3);return this._mesh={indexBuffer:i.createIndexBuffer(d),vertexBuffer:i.createVertexBuffer(l,Yd.members),segments:c.S.simpleSegment(0,0,l.length,d.length)},this._mesh}getMeshFrameDelta(i){return 2*Math.PI*c.be/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,l){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(i,l);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(i){const l=this.getTerrainData(i).tile,d={minElevation:null,maxElevation:null};return l&&l.dem&&(d.minElevation=l.dem.min*this.exaggeration,d.maxElevation=l.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(i,l){const d=c.U.fromLngLat(i.wrap()),f=(1<<l)*c.N,_=d.x*f,b=d.y*f,S=Math.floor(_/c.N),E=Math.floor(b/c.N);return{tileID:new c.O(l,0,l,S,E),mercatorX:_,mercatorY:b}}_allowMercatorOverflow(i,l){const d=i.x<this.painter.width/2;let f=c.bf(l);const _=this.painter.transform.center.lng;return d&&Math.sign(f)>0&&Math.sign(_)<0||!d&&Math.sign(f)<0&&Math.sign(_)>0?(f=360*Math.sign(_)+f,c.G(f)):l}}class Hm{constructor(i,l,d){this._context=i,this._size=l,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Oe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(d.texture),{id:i,fbo:l,texture:d,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>i.id!==l),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const zi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Wl{constructor(i,l){this.painter=i,this.terrain=l,this.pool=new Hm(i.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(d=>!i._layers[d].isHidden(l)),this._coordsDescendingInv={};for(const d in i.sourceCaches){this._coordsDescendingInv[d]={};const f=i.sourceCaches[d].getVisibleCoordinates();for(const _ of f){const b=this.terrain.sourceCache.getTerrainCoords(_);for(const S in b)this._coordsDescendingInv[d][S]||(this._coordsDescendingInv[d][S]=[]),this._coordsDescendingInv[d][S].push(b[S])}}this._coordsDescendingInvStr={};for(const d of i._order){const f=i._layers[d],_=f.source;if(zi[f.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const b in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][b]=this._coordsDescendingInv[_][b].map(S=>S.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[f][d.tileID.key];_&&_!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const l=i.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(zi[l]&&(this._prevType&&zi[this._prevType]||this._stacks.push([]),this._prevType=l,this._stacks[this._stacks.length-1].push(i.id),!f))return!0;if(zi[this._prevType]||zi[l]&&f){this._prevType=l;const _=this._stacks.length-1,b=this._stacks[_]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(zn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[_]){const A=this.pool.getObjectForId(S.rtt[_].id);if(A.stamp===S.rtt[_].stamp){this.pool.useObject(A);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),S.rtt[_]={id:E.id,stamp:E.stamp},d.context.bindFramebuffer.set(E.fbo.framebuffer),d.context.clear({color:c.aT.transparent,stencil:0}),d.currentStencilSource=void 0;for(let A=0;A<b.length;A++){const M=d.style._layers[b[A]],z=M.source?this._coordsDescendingInv[M.source][S.tileID.key]:[S.tileID];d.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),d._renderTileClippingMasks(M,z),d.renderLayer(d,d.style.sourceCaches[M.source],M,z),M.source&&(S.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][S.tileID.key])}}return zn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),zi[l]}return!1}}const mt=C,xt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Va=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},Iu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mu{constructor(i,l,d=!1){this.mousedown=b=>{this.startMouse(c.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),k.mousePos(this.element,b)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,k.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),k.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=i.dragRotate._mouseRotate.getClickTolerance(),_=i.dragRotate._mousePitch.getClickTolerance();this.element=l,this.mouseRotate=Go({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:S,bearingDegreesPerPixelMoved:E=.8})=>{const A=new Zd;return new ws({clickTolerance:S,move:(M,z)=>({bearingDelta:(z.x-M.x)*E}),moveStateManager:A,enable:b,assignEvents:Va})})({clickTolerance:f,enable:!0}),this.map=i,d&&(this.mousePitch=bs({clickTolerance:_,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:S,pitchDegreesPerPixelMoved:E=-.5})=>{const A=new Zd;return new ws({clickTolerance:S,move:(M,z)=>({pitchDelta:(z.y-M.y)*E}),moveStateManager:A,enable:b,assignEvents:Va})})({clickTolerance:_,enable:!0})),k.addEventListener(l,"mousedown",this.mousedown),k.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(l,"touchcancel",this.reset)}startMouse(i,l){this.mouseRotate.dragStart(i,l),this.mousePitch&&this.mousePitch.dragStart(i,l),k.disableDrag()}startTouch(i,l){this.touchRotate.dragStart(i,l),this.touchPitch&&this.touchPitch.dragStart(i,l),k.disableDrag()}moveMouse(i,l){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(i,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:_}=this.mousePitch.dragMove(i,l)||{};_&&d.setPitch(d.getPitch()+_)}}moveTouch(i,l){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(i,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:_}=this.touchPitch.dragMove(i,l)||{};_&&d.setPitch(d.getPitch()+_)}}off(){const i=this.element;k.removeEventListener(i,"mousedown",this.mousedown),k.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend),k.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend)}}let Un;function Lu(m,i,l){if(m=new c.L(m.lng,m.lat),i){const d=new c.L(m.lng-360,m.lat),f=new c.L(m.lng+360,m.lat),_=l.locationPoint(m).distSqr(i);l.locationPoint(d).distSqr(i)<_?m=d:l.locationPoint(f).distSqr(i)<_&&(m=f)}for(;Math.abs(m.lng-l.center.lng)>180;){const d=l.locationPoint(m);if(d.x>=0&&d.y>=0&&d.x<=l.width&&d.y<=l.height)break;m.lng>l.center.lng?m.lng-=360:m.lng+=360}return m}const Pr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ep(m,i,l){const d=m.classList;for(const f in Pr)d.remove(`maplibregl-${l}-anchor-${f}`);d.add(`maplibregl-${l}-anchor-${i}`)}class po extends c.E{constructor(i){if(super(),this._onKeyPress=l=>{const d=l.code,f=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=l=>{const d=l.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=l=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!d)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Lu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),l&&l.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Pr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${f}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const b=this._map.unproject(this._pos),S=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=b.distanceTo(this._lngLat)>20*S?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=l=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=c.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");const l=k.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${d}px`),l.setAttributeNS(null,"width",`${f}px`),l.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const _=k.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const b=k.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=k.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const me of E){const Se=k.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",me.rx),Se.setAttributeNS(null,"ry",me.ry),S.appendChild(Se)}const A=k.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const M=k.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(M);const z=k.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const V=k.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(V);const Y=k.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const X=k.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=k.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const H=k.createNS("http://www.w3.org/2000/svg","circle");H.setAttributeNS(null,"fill","#FFFFFF"),H.setAttributeNS(null,"cx","5.5"),H.setAttributeNS(null,"cy","5.5"),H.setAttributeNS(null,"r","5.4999962"),X.appendChild(Q),X.appendChild(H),b.appendChild(S),b.appendChild(A),b.appendChild(z),b.appendChild(Y),b.appendChild(X),l.appendChild(b),l.setAttributeNS(null,"height",d*this._scale+"px"),l.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(l),this._offset=c.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),ep(this._element,this._anchor,"marker"),i&&i.className)for(const l of i.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=c.L.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const f=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(i){return this._offset=c.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Dn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let An=0,Ho=!1;const $a={maxWidth:100,unit:"metric"};function Ua(m,i,l){const d=l&&l.maxWidth||100,f=m._container.clientHeight/2,_=m.unproject([0,f]),b=m.unproject([d,f]),S=_.distanceTo(b);if(l&&l.unit==="imperial"){const E=3.2808*S;E>5280?fo(i,d,E/5280,m._getUIString("ScaleControl.Miles")):fo(i,d,E,m._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?fo(i,d,S/1852,m._getUIString("ScaleControl.NauticalMiles")):S>=1e3?fo(i,d,S/1e3,m._getUIString("ScaleControl.Kilometers")):fo(i,d,S,m._getUIString("ScaleControl.Meters"))}function fo(m,i,l,d){const f=function(_){const b=Math.pow(10,`${Math.floor(_)}`.length-1);let S=_/b;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(E){const A=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*A)/A}(S),b*S}(l);m.style.width=i*(f/l)+"px",m.innerHTML=`${f}&nbsp;${d}`}const zu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Du=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ko(m){if(m){if(typeof m=="number"){const i=Math.round(Math.abs(m)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,m),"top-left":new c.P(i,i),"top-right":new c.P(-i,i),bottom:new c.P(0,-m),"bottom-left":new c.P(i,-i),"bottom-right":new c.P(-i,-i),left:new c.P(m,0),right:new c.P(-m,0)}}if(m instanceof c.P||Array.isArray(m)){const i=c.P.convert(m);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:c.P.convert(m.center||[0,0]),top:c.P.convert(m.top||[0,0]),"top-left":c.P.convert(m["top-left"]||[0,0]),"top-right":c.P.convert(m["top-right"]||[0,0]),bottom:c.P.convert(m.bottom||[0,0]),"bottom-left":c.P.convert(m["bottom-left"]||[0,0]),"bottom-right":c.P.convert(m["bottom-right"]||[0,0]),left:c.P.convert(m.left||[0,0]),right:c.P.convert(m.right||[0,0])}}return Ko(new c.P(0,0))}const Ru={extend:(m,...i)=>c.e(m,...i),run(m){m()},logToElement(m,i=!1,l="log"){const d=window.document.getElementById(l);d&&(i&&(d.innerHTML=""),d.innerHTML+=`<br>${m}`)}},Fu=C;class sn{static get version(){return Fu}static get workerCount(){return rr.workerCount}static set workerCount(i){rr.workerCount=i}static get maxParallelImageRequests(){return c.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(i){c.c.MAX_PARALLEL_IMAGE_REQUESTS=i}static get workerUrl(){return c.c.WORKER_URL}static set workerUrl(i){c.c.WORKER_URL=i}static addProtocol(i,l){c.c.REGISTERED_PROTOCOLS[i]=l}static removeProtocol(i){delete c.c.REGISTERED_PROTOCOLS[i]}}return sn.Map=class extends Xd{constructor(m){if(c.bg.mark(c.bh.create),(m=c.e({},xt,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new $l(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._cooperativeGesturesOnWheel=i=>{this._onCooperativeGesture(i,i[this._metaKey],1)},this._contextLost=i=>{i.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.k("webglcontextlost",{originalEvent:i}))},this._contextRestored=i=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:i}))},this._onMapScroll=i=>{if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Gl,this._controls=[],this._mapId=c.a2(),this._locale=c.e({},Au,m.locale),this._clickTolerance=m.clickTolerance,this._overridePixelRatio=m.pixelRatio,this._maxCanvasSize=m.maxCanvasSize,this.transformCameraUpdate=m.transformCameraUpdate,this._imageQueueHandle=ue.addThrottleControl(()=>this.isMoving()),this._requestManager=new q(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let i=!1;const l=ho(d=>{this._trackResize&&!this._removed&&this.resize(d)._update()},50);this._resizeObserver=new ResizeObserver(d=>{i?l(d):i=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Pu(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new Fa(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,c.e({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new ur({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new vn,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update(i.dataType==="style"),this.fire(new c.k(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new c.k(`${i.dataType}dataloading`,i))}),this.on("dataabort",i=>{this.fire(new c.k("sourcedataabort",i))})}_getMapId(){return this._mapId}addControl(m,i){if(i===void 0&&(i=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=m.onAdd(this);this._controls.push(m);const d=this._controlPositions[i];return i.indexOf("bottom")!==-1?d.insertBefore(l,d.firstChild):d.appendChild(l),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(m);return i>-1&&this._controls.splice(i,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,i,l,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,i,l,d)}resize(m){var i;const l=this._containerDimensions(),d=l[0],f=l[1],_=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,_),this.painter.resize(d,f,_),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const E=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,E),this.painter.resize(d,f,E)}this.transform.resize(d,f),(i=this._requestedCameraState)===null||i===void 0||i.resize(d,f);const b=!this._moving;return b&&(this.stop(),this.fire(new c.k("movestart",m)).fire(new c.k("move",m))),this.fire(new c.k("resize",m)),b&&this.fire(new c.k("moveend",m)),this}_getClampedPixelRatio(m,i){const{0:l,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),_=m*f,b=i*f;return Math.min(_>l?l/_:1,b>d?d/b:1)*f}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Ft.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(m){return this.transform.locationPoint(c.L.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(c.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,i,l){if(m==="mouseenter"||m==="mouseover"){let d=!1;return{layer:i,listener:l,delegates:{mousemove:_=>{const b=this.getLayer(i)?this.queryRenderedFeatures(_.point,{layers:[i]}):[];b.length?d||(d=!0,l.call(this,new cr(m,this,_.originalEvent,{features:b}))):d=!1},mouseout:()=>{d=!1}}}}if(m==="mouseleave"||m==="mouseout"){let d=!1;return{layer:i,listener:l,delegates:{mousemove:b=>{(this.getLayer(i)?this.queryRenderedFeatures(b.point,{layers:[i]}):[]).length?d=!0:d&&(d=!1,l.call(this,new cr(m,this,b.originalEvent)))},mouseout:b=>{d&&(d=!1,l.call(this,new cr(m,this,b.originalEvent)))}}}}{const d=f=>{const _=this.getLayer(i)?this.queryRenderedFeatures(f.point,{layers:[i]}):[];_.length&&(f.features=_,l.call(this,f),delete f.features)};return{layer:i,listener:l,delegates:{[m]:d}}}}on(m,i,l){if(l===void 0)return super.on(m,i);const d=this._createDelegatedListener(m,i,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(m,i,l){if(l===void 0)return super.once(m,i);const d=this._createDelegatedListener(m,i,l);for(const f in d.delegates)this.once(f,d.delegates[f]);return this}off(m,i,l){return l===void 0?super.off(m,i):(this._delegatedListeners&&this._delegatedListeners[m]&&(d=>{const f=this._delegatedListeners[m];for(let _=0;_<f.length;_++){const b=f[_];if(b.layer===i&&b.listener===l){for(const S in b.delegates)this.off(S,b.delegates[S]);return f.splice(_,1),this}}})(),this)}queryRenderedFeatures(m,i){if(!this.style)return[];let l;const d=m instanceof c.P||Array.isArray(m),f=d?m:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(d?{}:m)||{},f instanceof c.P||typeof f[0]=="number")l=[c.P.convert(f)];else{const _=c.P.convert(f[0]),b=c.P.convert(f[1]);l=[_,new c.P(b.x,_.y),b,new c.P(_.x,b.y),_]}return this.style.queryRenderedFeatures(l,i,this.transform)}querySourceFeatures(m,i){return this.style.querySourceFeatures(m,i)}setStyle(m,i){return(i=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(m,i))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const i=this._locale[m];if(i==null)throw new Error(`Missing UI string '${m}'`);return i}_updateStyle(m,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,i));const l=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new xi(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,i,l):this.style.loadJSON(m,i,l),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new xi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,i){if(typeof m=="string"){const l=this._requestManager.transformRequest(m,Z.Style);c.f(l,(d,f)=>{d?this.fire(new c.j(d)):f&&this._updateDiff(f,i)})}else typeof m=="object"&&this._updateDiff(m,i)}_updateDiff(m,i){try{this.style.setState(m,i)&&this._update(!0)}catch(l){c.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(m,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(m,i){return this._lazyInitEmptyStyle(),this.style.addSource(m,i),this._update(!0)}isSourceLoaded(m){const i=this.style&&this.style.sourceCaches[m];if(i!==void 0)return i.loaded();this.fire(new c.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const i=this.style.sourceCaches[m.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);for(const l in this.style._layers){const d=this.style._layers[l];d.type==="hillshade"&&d.source===m.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Qd(this.painter,i,m),this.painter.renderToTexture=new Wl(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=l=>{l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==m.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:m})),this}getTerrain(){var m,i;return(i=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const i in m){const l=m[i]._tiles;for(const d in l){const f=l[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}addSourceType(m,i,l){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,i,l)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,i,l={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:_,stretchY:b,content:S}=l;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||c.a(i))){if(i.width===void 0||i.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:A,data:M}=i,z=i;return this.style.addImage(m,{data:new c.R({width:E,height:A},new Uint8Array(M)),pixelRatio:d,stretchX:_,stretchY:b,content:S,sdf:f,version:0,userImage:z}),z.onAdd&&z.onAdd(this,m),this}}{const{width:E,height:A,data:M}=c.h.getImageData(i);this.style.addImage(m,{data:new c.R({width:E,height:A},M),pixelRatio:d,stretchX:_,stretchY:b,content:S,sdf:f,version:0})}}updateImage(m,i){const l=this.style.getImage(m);if(!l)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=i instanceof HTMLImageElement||c.a(i)?c.h.getImageData(i):i,{width:f,height:_,data:b}=d;if(f===void 0||_===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==l.data.width||_!==l.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(i instanceof HTMLImageElement||c.a(i));return l.data.replace(b,S),this.style.updateImage(m,l),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,i){ue.getImage(this._requestManager.transformRequest(m,Z.Image),i)}listImages(){return this.style.listImages()}addLayer(m,i){return this._lazyInitEmptyStyle(),this.style.addLayer(m,i),this._update(!0)}moveLayer(m,i){return this.style.moveLayer(m,i),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,i,l){return this.style.setLayerZoomRange(m,i,l),this._update(!0)}setFilter(m,i,l={}){return this.style.setFilter(m,i,l),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,i,l,d={}){return this.style.setPaintProperty(m,i,l,d),this._update(!0)}getPaintProperty(m,i){return this.style.getPaintProperty(m,i)}setLayoutProperty(m,i,l,d={}){return this.style.setLayoutProperty(m,i,l,d),this._update(!0)}getLayoutProperty(m,i){return this.style.getLayoutProperty(m,i)}setGlyphs(m,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,i,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,i,l,d=>{d||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,i,l=>{l||this._update(!0)}),this}setLight(m,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,i){return this.style.setFeatureState(m,i),this._update()}removeFeatureState(m,i){return this.style.removeFeatureState(m,i),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,i=0;return this._container&&(m=this._container.clientWidth||400,i=this._container.clientHeight||300),[m,i]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const i=this._canvasContainer=k.create("div","maplibregl-canvas-container",m);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),d=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],d);const f=this._controlContainer=k.create("div","maplibregl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{_[b]=k.create("div",`maplibregl-ctrl-${b} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=k.create("div","maplibregl-cooperative-gesture-screen",this._container);let m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${m}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){k.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(m,i,l){this._canvas.width=Math.floor(l*m),this._canvas.height=Math.floor(l*i),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{i={requestedAttributes:m},d&&(i.statusMessage=d.statusMessage,i.type=d.type)},{once:!0});const l=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!l){const d="Failed to initialize WebGL";throw i?(i.message=d,new Error(JSON.stringify(i))):new Error(d)}this.painter=new uo(l,this.transform),L.testSupport(l)}_onCooperativeGesture(m,i,l){return!i&&l<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let l=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,_=c.h.now();this.style.zoomHistory.update(f,_);const b=new c.a8(f,{now:_,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=b.crossFadingFactor();S===1&&S===this._crossFadingFactor||(l=!0,this._crossFadingFactor=S),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bg.mark(c.bh.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||l)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,c.bg.mark(c.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ue.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),c.bg.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=c.h.frame(m=>{c.bg.frame(m),this._frame=null,this._render(m)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return mt}getCameraTargetElevation(){return this.transform.elevation}},sn.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const i=this._map.getZoom(),l=i===this._map.getMaxZoom(),d=i===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,l)=>{const d=this._map._getUIString(`NavigationControl.${l}`);i.title=d,i.setAttribute("aria-label",d)},this.options=c.e({},Iu,m),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),k.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),k.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=k.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,i){const l=k.create("button",m,this._container);return l.type="button",l.addEventListener("click",i),l}},sn.GeolocateControl=class extends c.E{constructor(m){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const l=new c.L(i.coords.longitude,i.coords.latitude),d=i.coords.accuracy,f=this._map.getBearing(),_=c.e({bearing:f},this.options.fitBoundsOptions),b=Ft.fromLngLat(l,d);this._map.fitBounds(b,_,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const l=new c.L(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Ho)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=i=>{if(this._map){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new po({element:this._dotElement}),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new po({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")))})}},this.options=c.e({},Dn,m)}onAdd(m){return this._map=m,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(i,l=!1){Un===void 0||l?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(d=>{Un=d.state!=="denied",i(Un)}).catch(()=>{Un=!!window.navigator.geolocation,i(Un)}):(Un=!!window.navigator.geolocation,i(Un)):i(Un)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,An=0,Ho=!1}_isOutOfMapMaxBounds(m){const i=this._map.getMaxBounds(),l=m.coords;return i&&(l.longitude<i.getWest()||l.longitude>i.getEast()||l.latitude<i.getSouth()||l.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),i=m.getSouthEast(),l=m.getNorthEast(),d=i.distanceTo(l),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":An--,Ho=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),An++,An>1?(m={maximumAge:6e5,timeout:0},Ho=!0):(m=this.options.positionOptions,Ho=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},sn.AttributionControl=ur,sn.LogoControl=vn,sn.ScaleControl=class{constructor(m){this._onMove=()=>{Ua(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,Ua(this._map,this._container,this.options)},this.options=c.e({},$a,m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},sn.FullscreenControl=class extends c.E{constructor(m={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},sn.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=m}onAdd(m){return this._map=m,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},sn.Popup=class extends c.E{constructor(m){super(),this.remove=()=>(this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.k("close")),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=k.create("div","maplibregl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Lu(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!i)return;const l=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);let d=this.options.anchor;const f=Ko(this.options.offset);if(!d){const b=this._container.offsetWidth,S=this._container.offsetHeight;let E;E=l.y+f.bottom.y<S?["top"]:l.y>this._map.transform.height-S?["bottom"]:[],l.x<b/2?E.push("left"):l.x>this._map.transform.width-b/2&&E.push("right"),d=E.length===0?"bottom":E.join("-")}const _=l.add(f[d]).round();k.setTransform(this._container,`${Pr[d]} translate(${_.x}px,${_.y}px)`),ep(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(zu),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.L.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const i=document.createDocumentFragment(),l=document.createElement("body");let d;for(l.innerHTML=m;d=l.firstChild,d;)i.appendChild(d);return this.setDOMContent(i)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Du);m&&m.focus()}},sn.Marker=po,sn.Style=xi,sn.LngLat=c.L,sn.LngLatBounds=Ft,sn.Point=c.P,sn.MercatorCoordinate=c.U,sn.Evented=c.E,sn.AJAXError=c.bi,sn.config=c.c,sn.CanvasSource=ut,sn.GeoJSONSource=gi,sn.ImageSource=tn,sn.RasterDEMTileSource=gn,sn.RasterTileSource=an,sn.VectorTileSource=hn,sn.VideoSource=qe,sn.setRTLTextPlugin=c.bj,sn.getRTLTextPluginStatus=c.bk,sn.prewarm=function(){so().acquire(Ht)},sn.clearPrewarmedResources=function(){const m=wr;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Ht),wr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Ru.extend(sn,{isSafari:c.ac,getPerformanceMetrics:c.bg.getPerformanceMetrics}),sn});var v=h;return v})})(WE);var _R=WE.exports;const xR=T2(_R);const vR=({station:e,position:t,isDarkMode:s})=>{if(!e)return null;const a={left:t.x>window.innerWidth*.7?t.x-240:t.x+10,top:t.y>window.innerHeight*.7?t.y-100:t.y+10};return R.jsx("div",{className:"absolute z-50 pointer-events-none",style:a,children:R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:`
          p-4 rounded-xl shadow-lg backdrop-blur-md w-[240px]
          ${s?"bg-black/90 text-white border border-white/10":"bg-white/90 text-black border border-black/10"}
        `,children:R.jsxs("div",{className:"flex gap-3",children:[e.favicon?R.jsx("img",{src:e.favicon,alt:"",className:"w-8 h-8 rounded-lg object-cover flex-shrink-0",onError:h=>{h.target.style.display="none",h.target.nextSibling.style.display="flex"}}):R.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${s?"bg-white/10":"bg-black/5"}`,children:R.jsx(VE,{className:`w-4 h-4 ${s?"text-white/80":"text-black/80"}`})}),R.jsxs("div",{className:"flex flex-col min-w-0 flex-1 overflow-hidden",children:[R.jsx("div",{className:"font-medium text-sm leading-tight text-left break-words overflow-wrap-anywhere",children:e.name}),R.jsx("div",{className:"text-xs opacity-75 mt-1 leading-tight text-left break-words overflow-wrap-anywhere",children:[e.city,e.state,e.countrycode?xa(e.countrycode):null].filter(Boolean).slice(0,2).join(", ")})]})]})})})},wR=$t.memo(vR),bR=({stations:e,onStationSelect:t,selectedStation:s,favorites:a,mapCenter:h,isDarkMode:g})=>{const v=ce.useRef(null),c=ce.useRef(null),[C,k]=ce.useState(!1),[L,B]=ce.useState(null),[F,oe]=ce.useState({x:0,y:0}),se=ce.useRef(g?"dark":"light"),re=ce.useRef(h),ue=ce.useRef(null),Z=ce.useRef(s),q=ce.useRef(!1),G=ce.useRef(null),[fe,xe]=ce.useState(g?"dark":"light"),Ee=ce.useRef(null),Ie=ce.useRef(Date.now());ce.useEffect(()=>{Z.current=s},[s]);const ke=ce.useMemo(()=>({dark:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",light:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"}),[]),it=ce.useMemo(()=>{const Ve={type:"FeatureCollection",features:e.filter(rt=>(rt==null?void 0:rt.geo_lat)&&(rt==null?void 0:rt.geo_long)).map(rt=>({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(rt.geo_long),parseFloat(rt.geo_lat)]},properties:{...rt,isFavorite:Array.isArray(a)&&a.some(Re=>Re.stationuuid===rt.stationuuid)}}))};return ue.current=Ve,Ve},[e,a]),Oe=ce.useCallback(Ve=>{var rt,Re,at;return{"circle-color":["case",["==",["get","isFavorite"],!0],"#FF3366",["case",["==",["get","stationuuid"],((rt=Z.current)==null?void 0:rt.stationuuid)||""],"transparent",Ve==="dark"?"#FFFFFF":"#000000"]],"circle-radius":["interpolate",["linear"],["zoom"],0,3,22,8],"circle-stroke-width":["case",["==",["get","stationuuid"],((Re=Z.current)==null?void 0:Re.stationuuid)||""],0,1],"circle-stroke-color":Ve==="dark"?"#000000":"#FFFFFF","circle-stroke-opacity":.5,"circle-opacity":["case",["==",["get","stationuuid"],((at=Z.current)==null?void 0:at.stationuuid)||""],0,.7]}},[]),At=ce.useCallback((Ve,rt=!1)=>{if(!c.current||!(Ve!=null&&Ve.geo_lat)||!(Ve!=null&&Ve.geo_long))return;const Re=parseFloat(Ve.geo_long),at=parseFloat(Ve.geo_lat);if(isNaN(Re)||isNaN(at))return;const Ne=c.current.getZoom(),wt=c.current.getBearing(),Rt=c.current.getPitch(),Nt=Math.max(Ne,rt?6:4),hn=rt?Nt:Math.min(Nt+.75,8);c.current.flyTo({center:[Re,at],zoom:hn,duration:rt?2e3:1800,essential:!0,padding:{top:100,bottom:100,left:100,right:100},bearing:wt,pitch:Rt,curve:1.42,easing:an=>an===1?1:1-Math.pow(2,-10*an)})},[]),Ct=ce.useCallback(()=>{c.current&&(c.current.off("click","stations"),c.current.off("mousemove","stations"),c.current.off("mouseleave","stations"))},[]),It=ce.useCallback(()=>{c.current&&(["stations","selected-station"].forEach(Ve=>{if(c.current.getLayer(Ve))try{c.current.removeLayer(Ve)}catch(rt){console.warn(`Failed to remove layer ${Ve}:`,rt)}}),["stations","selected-station"].forEach(Ve=>{if(c.current.getSource(Ve))try{c.current.removeSource(Ve)}catch(rt){console.warn(`Failed to remove source ${Ve}:`,rt)}}))},[]),Ut=ce.useCallback(()=>{if(!c.current||!c.current.loaded())return;const Ve=1500,Re=(Date.now()-Ie.current)%Ve/Ve,at=25+Math.sin(Re*Math.PI*2)*15;c.current.getLayer("selected-station-pulse")&&(c.current.setPaintProperty("selected-station-pulse","circle-radius",at),c.current.setPaintProperty("selected-station-pulse","circle-opacity",.15-(at-25)/30)),Ee.current=requestAnimationFrame(Ut)},[]);ce.useEffect(()=>()=>{Ee.current&&cancelAnimationFrame(Ee.current)},[]);const on=ce.useCallback(()=>{if(!(!c.current||q.current)){console.log("Setting up map layers"),It(),Ct();try{if(c.current.addSource("stations",{type:"geojson",data:ue.current||it}),c.current.addLayer({id:"stations",type:"circle",source:"stations",paint:Oe(fe)}),c.current.addSource("selected-station",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),c.current.addLayer({id:"selected-station-pulse",type:"circle",source:"selected-station",paint:{"circle-color":"#10B981","circle-radius":25,"circle-opacity":.15,"circle-blur":.5}}),c.current.addLayer({id:"selected-station",type:"circle",source:"selected-station",paint:{"circle-color":"#10B981","circle-radius":6,"circle-stroke-width":2,"circle-stroke-color":"#10B981","circle-opacity":.9}}),Ie.current=Date.now(),Ee.current&&cancelAnimationFrame(Ee.current),Ut(),c.current.on("click","stations",Ve=>{var Re;if(!((Re=Ve.features)!=null&&Re.length))return;const rt=Ve.features[0].properties;t==null||t(rt)}),c.current.on("mousemove","stations",Ve=>{var rt;(rt=Ve.features)!=null&&rt.length&&(c.current.getCanvas().style.cursor="pointer",B(Ve.features[0].properties),oe({x:Ve.point.x,y:Ve.point.y}))}),c.current.on("mouseleave","stations",()=>{c.current.getCanvas().style.cursor="",B(null)}),Z.current){const Ve=c.current.getSource("selected-station");Ve&&Ve.setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(Z.current.geo_long),parseFloat(Z.current.geo_lat)]},properties:Z.current}]})}}catch(Ve){console.error("Error setting up map layers:",Ve)}}},[it,fe,t,It,Ct,Oe,Ut]);return ce.useEffect(()=>{if(!v.current||c.current)return;const Ve=g?"dark":"light";return xe(Ve),se.current=Ve,c.current=new xR.Map({container:v.current,style:ke[Ve],center:h||[0,20],zoom:1.5,projection:"globe",renderWorldCopies:!0,maxZoom:20,minZoom:1,attributionControl:!1,fadeDuration:0,maxBounds:null,antialias:!0,maxPitch:85,bearing:0,pitch:0,bounds:[[-180,-85],[180,85]],fitBoundsOptions:{padding:0}}),c.current.on("load",()=>{console.log("Map loaded initially"),k(!0),setTimeout(()=>{on()},100)}),()=>{G.current&&clearTimeout(G.current),Ct(),c.current&&(c.current.remove(),c.current=null)}},[]),ce.useEffect(()=>{if(!c.current||!C)return;const Ve=g?"dark":"light";fe!==Ve&&(console.log(`Theme change requested: ${fe} -> ${Ve}`),G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{q.current=!0;const rt=c.current.getCenter(),Re=c.current.getZoom(),at=c.current.getBearing(),Ne=c.current.getPitch(),wt=c.current.getSource("stations"),Rt=c.current.getSource("selected-station"),Ft=wt?ue.current:null,Nt=Rt?c.current.getSource("selected-station")._data:null;try{console.log(`Setting map style to ${Ve}`),c.current.setStyle(ke[Ve],{diff:!1}),se.current=Ve,xe(Ve),c.current.once("style.load",()=>{console.log("Map style loaded"),c.current.setCenter(rt),c.current.setZoom(Re),c.current.setBearing(at),c.current.setPitch(Ne),c.current.once("idle",()=>{console.log("Map idle after style change, adding layers"),Ft&&(c.current.addSource("stations",{type:"geojson",data:Ft}),c.current.addLayer({id:"stations",type:"circle",source:"stations",paint:Oe(Ve)})),Nt&&(c.current.addSource("selected-station",{type:"geojson",data:Nt}),c.current.addLayer({id:"selected-station",type:"circle",source:"selected-station",paint:{"circle-color":"#10B981","circle-radius":6,"circle-stroke-width":2,"circle-stroke-color":"#10B981","circle-opacity":.9}})),c.current.on("click","stations",hn=>{var gn;if(!((gn=hn.features)!=null&&gn.length))return;const an=hn.features[0].properties;t==null||t(an)}),c.current.on("mousemove","stations",hn=>{var an;(an=hn.features)!=null&&an.length&&(c.current.getCanvas().style.cursor="pointer",B(hn.features[0].properties),oe({x:hn.point.x,y:hn.point.y}))}),c.current.on("mouseleave","stations",()=>{c.current.getCanvas().style.cursor="",B(null)}),setTimeout(()=>{q.current=!1,console.log("Style change complete")},100)})})}catch(hn){console.error("Error during style change:",hn),q.current=!1}},200))},[g,C,ke,on,Ct,fe,t]),ce.useEffect(()=>{if(!(!c.current||!C||q.current))try{const Ve=c.current.getSource("stations");Ve&&Ve.setData(it)}catch(Ve){console.warn("Error updating stations data:",Ve)}},[it,C]),ce.useEffect(()=>{if(!(!c.current||!C||!s||q.current))try{const Ve=c.current.getSource("selected-station");Ve&&(Ve.setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(s.geo_long),parseFloat(s.geo_lat)]},properties:s}]}),Ee.current||(Ie.current=Date.now(),Ut())),At(s,!1)}catch(Ve){console.error("Error updating selected station:",Ve)}},[s,C,At,Ut]),ce.useEffect(()=>{var Ve,rt;if(!(!c.current||!C||!h||q.current))try{const[Re,at]=h;(((Ve=re.current)==null?void 0:Ve[0])!==Re||((rt=re.current)==null?void 0:rt[1])!==at)&&(c.current.easeTo({center:[Re,at],duration:1e3}),re.current=h)}catch(Re){console.error("Error updating map center:",Re)}},[h,C]),R.jsxs(R.Fragment,{children:[R.jsx("div",{ref:v,className:"fixed inset-0 w-full h-full",style:{margin:0,padding:0}}),R.jsx(In,{children:L&&R.jsx(wR,{station:L,position:F,isDarkMode:g})})]})},h2=$t.memo(bR);class d2 extends $t.Component{constructor(t){super(t),this.state={hasError:!1,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,s){console.error("Error caught by boundary:",t),this.setState({errorInfo:s})}render(){return this.state.hasError?R.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-90",children:R.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",children:[R.jsx("h2",{className:"text-xl text-white mb-4",children:"Something went wrong"}),R.jsx("button",{onClick:()=>window.location.reload(),className:`px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-full
                        transition-all duration-300`,children:"Reload Application"})]})}):this.props.children}}function As(e,t){const s=ce.useCallback(()=>{try{const v=window.localStorage.getItem(e);return v?typeof t=="boolean"?v==="true":JSON.parse(v):t}catch(v){return console.warn(`Error reading localStorage key "${e}":`,v),t}},[e,t]),[a,h]=ce.useState(s()),g=ce.useCallback(v=>{try{const c=v instanceof Function?v(a):v;h(c),window.localStorage.setItem(e,typeof c=="boolean"?c.toString():JSON.stringify(c))}catch(c){console.warn(`Error setting localStorage key "${e}":`,c)}},[e,a]);return ce.useEffect(()=>{const v=c=>{c.key===e&&h(s())};return window.addEventListener("storage",v),()=>window.removeEventListener("storage",v)},[e,s]),[a,g]}function KE(e){var t,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(s=KE(e[t]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function ll(){for(var e,t,s=0,a="",h=arguments.length;s<h;s++)(e=arguments[s])&&(t=KE(e))&&(a&&(a+=" "),a+=t);return a}function SR(e){if(!e||typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}SR(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var md=e=>typeof e=="number"&&!isNaN(e),gl=e=>typeof e=="string",Ro=e=>typeof e=="function",TR=e=>gl(e)||md(e),X0=e=>gl(e)||Ro(e)?e:null,kR=(e,t)=>e===!1||md(e)&&e>0?e:t,Y0=e=>ce.isValidElement(e)||gl(e)||Ro(e)||md(e);function ER(e,t,s=300){let{scrollHeight:a,style:h}=e;requestAnimationFrame(()=>{h.minHeight="initial",h.height=a+"px",h.transition=`all ${s}ms`,requestAnimationFrame(()=>{h.height="0",h.padding="0",h.margin="0",setTimeout(t,s)})})}function CR({enter:e,exit:t,appendPosition:s=!1,collapse:a=!0,collapseDuration:h=300}){return function({children:g,position:v,preventExitTransition:c,done:C,nodeRef:k,isIn:L,playToast:B}){let F=s?`${e}--${v}`:e,oe=s?`${t}--${v}`:t,se=ce.useRef(0);return ce.useLayoutEffect(()=>{let re=k.current,ue=F.split(" "),Z=q=>{q.target===k.current&&(B(),re.removeEventListener("animationend",Z),re.removeEventListener("animationcancel",Z),se.current===0&&q.type!=="animationcancel"&&re.classList.remove(...ue))};re.classList.add(...ue),re.addEventListener("animationend",Z),re.addEventListener("animationcancel",Z)},[]),ce.useEffect(()=>{let re=k.current,ue=()=>{re.removeEventListener("animationend",ue),a?ER(re,C,h):C()};L||(c?ue():(se.current=1,re.className+=` ${oe}`,re.addEventListener("animationend",ue)))},[L]),$t.createElement($t.Fragment,null,g)}}function p2(e,t){return{content:XE(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function XE(e,t,s=!1){return ce.isValidElement(e)&&!gl(e.type)?ce.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:s}):Ro(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:s}):e}function PR({closeToast:e,theme:t,ariaLabel:s="close"}){return $t.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:a=>{a.stopPropagation(),e(!0)},"aria-label":s},$t.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},$t.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function AR({delay:e,isRunning:t,closeToast:s,type:a="default",hide:h,className:g,controlledProgress:v,progress:c,rtl:C,isIn:k,theme:L}){let B=h||v&&c===0,F={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};v&&(F.transform=`scaleX(${c})`);let oe=ll("Toastify__progress-bar",v?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${L}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":C}),se=Ro(g)?g({rtl:C,type:a,defaultClassName:oe}):ll(oe,g),re={[v&&c>=1?"onTransitionEnd":"onAnimationEnd"]:v&&c<1?null:()=>{k&&s()}};return $t.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":B},$t.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${L} Toastify__progress-bar--${a}`}),$t.createElement("div",{role:"progressbar","aria-hidden":B?"true":"false","aria-label":"notification timer",className:se,style:F,...re}))}var IR=1,YE=()=>`${IR++}`;function MR(e,t,s){let a=1,h=0,g=[],v=[],c=t,C=new Map,k=new Set,L=q=>(k.add(q),()=>k.delete(q)),B=()=>{v=Array.from(C.values()),k.forEach(q=>q())},F=({containerId:q,toastId:G,updateId:fe})=>{let xe=q?q!==e:e!==1,Ee=C.has(G)&&fe==null;return xe||Ee},oe=(q,G)=>{C.forEach(fe=>{var xe;(G==null||G===fe.props.toastId)&&((xe=fe.toggle)==null||xe.call(fe,q))})},se=q=>{var G,fe;(fe=(G=q.props)==null?void 0:G.onClose)==null||fe.call(G,q.removalReason),q.isActive=!1},re=q=>{if(q==null)C.forEach(se);else{let G=C.get(q);G&&se(G)}B()},ue=()=>{h-=g.length,g=[]},Z=q=>{var G,fe;let{toastId:xe,updateId:Ee}=q.props,Ie=Ee==null;q.staleId&&C.delete(q.staleId),q.isActive=!0,C.set(xe,q),B(),s(p2(q,Ie?"added":"updated")),Ie&&((fe=(G=q.props).onOpen)==null||fe.call(G))};return{id:e,props:c,observe:L,toggle:oe,removeToast:re,toasts:C,clearQueue:ue,buildToast:(q,G)=>{if(F(G))return;let{toastId:fe,updateId:xe,data:Ee,staleId:Ie,delay:ke}=G,it=xe==null;it&&h++;let Oe={...c,style:c.toastStyle,key:a++,...Object.fromEntries(Object.entries(G).filter(([Ct,It])=>It!=null)),toastId:fe,updateId:xe,data:Ee,isIn:!1,className:X0(G.className||c.toastClassName),progressClassName:X0(G.progressClassName||c.progressClassName),autoClose:G.isLoading?!1:kR(G.autoClose,c.autoClose),closeToast(Ct){C.get(fe).removalReason=Ct,re(fe)},deleteToast(){let Ct=C.get(fe);if(Ct!=null){if(s(p2(Ct,"removed")),C.delete(fe),h--,h<0&&(h=0),g.length>0){Z(g.shift());return}B()}}};Oe.closeButton=c.closeButton,G.closeButton===!1||Y0(G.closeButton)?Oe.closeButton=G.closeButton:G.closeButton===!0&&(Oe.closeButton=Y0(c.closeButton)?c.closeButton:!0);let At={content:q,props:Oe,staleId:Ie};c.limit&&c.limit>0&&h>c.limit&&it?g.push(At):md(ke)?setTimeout(()=>{Z(At)},ke):Z(At)},setProps(q){c=q},setToggle:(q,G)=>{let fe=C.get(q);fe&&(fe.toggle=G)},isToastActive:q=>{var G;return(G=C.get(q))==null?void 0:G.isActive},getSnapshot:()=>v}}var yr=new Map,rd=[],J0=new Set,LR=e=>J0.forEach(t=>t(e)),JE=()=>yr.size>0;function zR(){rd.forEach(e=>eC(e.content,e.options)),rd=[]}var DR=(e,{containerId:t})=>{var s;return(s=yr.get(t||1))==null?void 0:s.toasts.get(e)};function QE(e,t){var s;if(t)return!!((s=yr.get(t))!=null&&s.isToastActive(e));let a=!1;return yr.forEach(h=>{h.isToastActive(e)&&(a=!0)}),a}function RR(e){if(!JE()){rd=rd.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||TR(e))yr.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=yr.get(e.containerId);t?t.removeToast(e.id):yr.forEach(s=>{s.removeToast(e.id)})}}var FR=(e={})=>{yr.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function eC(e,t){Y0(e)&&(JE()||rd.push({content:e,options:t}),yr.forEach(s=>{s.buildToast(e,t)}))}function BR(e){var t;(t=yr.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function tC(e,t){yr.forEach(s=>{(t==null||!(t!=null&&t.containerId)||(t==null?void 0:t.containerId)===s.id)&&s.toggle(e,t==null?void 0:t.id)})}function NR(e){let t=e.containerId||1;return{subscribe(s){let a=MR(t,e,LR);yr.set(t,a);let h=a.observe(s);return zR(),()=>{h(),yr.delete(t)}},setProps(s){var a;(a=yr.get(t))==null||a.setProps(s)},getSnapshot(){var s;return(s=yr.get(t))==null?void 0:s.getSnapshot()}}}function jR(e){return J0.add(e),()=>{J0.delete(e)}}function OR(e){return e&&(gl(e.toastId)||md(e.toastId))?e.toastId:YE()}function gd(e,t){return eC(e,t),t.toastId}function Am(e,t){return{...t,type:t&&t.type||e,toastId:OR(t)}}function Im(e){return(t,s)=>gd(t,Am(e,s))}function mn(e,t){return gd(e,Am("default",t))}mn.loading=(e,t)=>gd(e,Am("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function VR(e,{pending:t,error:s,success:a},h){let g;t&&(g=gl(t)?mn.loading(t,h):mn.loading(t.render,{...h,...t}));let v={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(k,L,B)=>{if(L==null){mn.dismiss(g);return}let F={type:k,...v,...h,data:B},oe=gl(L)?{render:L}:L;return g?mn.update(g,{...F,...oe}):mn(oe.render,{...F,...oe}),B},C=Ro(e)?e():e;return C.then(k=>c("success",a,k)).catch(k=>c("error",s,k)),C}mn.promise=VR;mn.success=Im("success");mn.info=Im("info");mn.error=Im("error");mn.warning=Im("warning");mn.warn=mn.warning;mn.dark=(e,t)=>gd(e,Am("default",{theme:"dark",...t}));function $R(e){RR(e)}mn.dismiss=$R;mn.clearWaitingQueue=FR;mn.isActive=QE;mn.update=(e,t={})=>{let s=DR(e,t);if(s){let{props:a,content:h}=s,g={delay:100,...a,...t,toastId:t.toastId||e,updateId:YE()};g.toastId!==e&&(g.staleId=e);let v=g.render||h;delete g.render,gd(v,g)}};mn.done=e=>{mn.update(e,{progress:1})};mn.onChange=jR;mn.play=e=>tC(!0,e);mn.pause=e=>tC(!1,e);function UR(e){var t;let{subscribe:s,getSnapshot:a,setProps:h}=ce.useRef(NR(e)).current;h(e);let g=(t=ce.useSyncExternalStore(s,a,a))==null?void 0:t.slice();function v(c){if(!g)return[];let C=new Map;return e.newestOnTop&&g.reverse(),g.forEach(k=>{let{position:L}=k.props;C.has(L)||C.set(L,[]),C.get(L).push(k)}),Array.from(C,k=>c(k[0],k[1]))}return{getToastToRender:v,isToastActive:QE,count:g==null?void 0:g.length}}function qR(e){let[t,s]=ce.useState(!1),[a,h]=ce.useState(!1),g=ce.useRef(null),v=ce.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:C,closeToast:k,onClick:L,closeOnClick:B}=e;BR({id:e.toastId,containerId:e.containerId,fn:s}),ce.useEffect(()=>{if(e.pauseOnFocusLoss)return F(),()=>{oe()}},[e.pauseOnFocusLoss]);function F(){document.hasFocus()||Z(),window.addEventListener("focus",ue),window.addEventListener("blur",Z)}function oe(){window.removeEventListener("focus",ue),window.removeEventListener("blur",Z)}function se(Ie){if(e.draggable===!0||e.draggable===Ie.pointerType){q();let ke=g.current;v.canCloseOnClick=!0,v.canDrag=!0,ke.style.transition="none",e.draggableDirection==="x"?(v.start=Ie.clientX,v.removalDistance=ke.offsetWidth*(e.draggablePercent/100)):(v.start=Ie.clientY,v.removalDistance=ke.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function re(Ie){let{top:ke,bottom:it,left:Oe,right:At}=g.current.getBoundingClientRect();Ie.nativeEvent.type!=="touchend"&&e.pauseOnHover&&Ie.clientX>=Oe&&Ie.clientX<=At&&Ie.clientY>=ke&&Ie.clientY<=it?Z():ue()}function ue(){s(!0)}function Z(){s(!1)}function q(){v.didMove=!1,document.addEventListener("pointermove",fe),document.addEventListener("pointerup",xe)}function G(){document.removeEventListener("pointermove",fe),document.removeEventListener("pointerup",xe)}function fe(Ie){let ke=g.current;if(v.canDrag&&ke){v.didMove=!0,t&&Z(),e.draggableDirection==="x"?v.delta=Ie.clientX-v.start:v.delta=Ie.clientY-v.start,v.start!==Ie.clientX&&(v.canCloseOnClick=!1);let it=e.draggableDirection==="x"?`${v.delta}px, var(--y)`:`0, calc(${v.delta}px + var(--y))`;ke.style.transform=`translate3d(${it},0)`,ke.style.opacity=`${1-Math.abs(v.delta/v.removalDistance)}`}}function xe(){G();let Ie=g.current;if(v.canDrag&&v.didMove&&Ie){if(v.canDrag=!1,Math.abs(v.delta)>v.removalDistance){h(!0),e.closeToast(!0),e.collapseAll();return}Ie.style.transition="transform 0.2s, opacity 0.2s",Ie.style.removeProperty("transform"),Ie.style.removeProperty("opacity")}}let Ee={onPointerDown:se,onPointerUp:re};return c&&C&&(Ee.onMouseEnter=Z,e.stacked||(Ee.onMouseLeave=ue)),B&&(Ee.onClick=Ie=>{L&&L(Ie),v.canCloseOnClick&&k(!0)}),{playToast:ue,pauseToast:Z,isRunning:t,preventExitTransition:a,toastRef:g,eventHandlers:Ee}}var ZR=typeof window<"u"?ce.useLayoutEffect:ce.useEffect,Mm=({theme:e,type:t,isLoading:s,...a})=>$t.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...a});function GR(e){return $t.createElement(Mm,{...e},$t.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function WR(e){return $t.createElement(Mm,{...e},$t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function HR(e){return $t.createElement(Mm,{...e},$t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function KR(e){return $t.createElement(Mm,{...e},$t.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function XR(){return $t.createElement("div",{className:"Toastify__spinner"})}var Q0={info:WR,warning:GR,success:HR,error:KR,spinner:XR},YR=e=>e in Q0;function JR({theme:e,type:t,isLoading:s,icon:a}){let h=null,g={theme:e,type:t};return a===!1||(Ro(a)?h=a({...g,isLoading:s}):ce.isValidElement(a)?h=ce.cloneElement(a,g):s?h=Q0.spinner():YR(t)&&(h=Q0[t](g))),h}var QR=e=>{let{isRunning:t,preventExitTransition:s,toastRef:a,eventHandlers:h,playToast:g}=qR(e),{closeButton:v,children:c,autoClose:C,onClick:k,type:L,hideProgressBar:B,closeToast:F,transition:oe,position:se,className:re,style:ue,progressClassName:Z,updateId:q,role:G,progress:fe,rtl:xe,toastId:Ee,deleteToast:Ie,isIn:ke,isLoading:it,closeOnClick:Oe,theme:At,ariaLabel:Ct}=e,It=ll("Toastify__toast",`Toastify__toast-theme--${At}`,`Toastify__toast--${L}`,{"Toastify__toast--rtl":xe},{"Toastify__toast--close-on-click":Oe}),Ut=Ro(re)?re({rtl:xe,position:se,type:L,defaultClassName:It}):ll(It,re),on=JR(e),Ve=!!fe||!C,rt={closeToast:F,type:L,theme:At},Re=null;return v===!1||(Ro(v)?Re=v(rt):ce.isValidElement(v)?Re=ce.cloneElement(v,rt):Re=PR(rt)),$t.createElement(oe,{isIn:ke,done:Ie,position:se,preventExitTransition:s,nodeRef:a,playToast:g},$t.createElement("div",{id:Ee,tabIndex:0,onClick:k,"data-in":ke,className:Ut,...h,style:ue,ref:a,...ke&&{role:G,"aria-label":Ct}},on!=null&&$t.createElement("div",{className:ll("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!it})},on),XE(c,e,!t),Re,!e.customProgressBar&&$t.createElement(AR,{...q&&!Ve?{key:`p-${q}`}:{},rtl:xe,theme:At,delay:C,isRunning:t,isIn:ke,closeToast:F,hide:B,type:L,className:Z,controlledProgress:Ve,progress:fe||0})))},eF=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),tF=CR(eF("bounce",!0)),nF={position:"top-right",transition:tF,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function f2(e){let t={...nF,...e},s=e.stacked,[a,h]=ce.useState(!0),g=ce.useRef(null),{getToastToRender:v,isToastActive:c,count:C}=UR(t),{className:k,style:L,rtl:B,containerId:F,hotKeys:oe}=t;function se(ue){let Z=ll("Toastify__toast-container",`Toastify__toast-container--${ue}`,{"Toastify__toast-container--rtl":B});return Ro(k)?k({position:ue,rtl:B,defaultClassName:Z}):ll(Z,X0(k))}function re(){s&&(h(!0),mn.play())}return ZR(()=>{var ue;if(s){let Z=g.current.querySelectorAll('[data-in="true"]'),q=12,G=(ue=t.position)==null?void 0:ue.includes("top"),fe=0,xe=0;Array.from(Z).reverse().forEach((Ee,Ie)=>{let ke=Ee;ke.classList.add("Toastify__toast--stacked"),Ie>0&&(ke.dataset.collapsed=`${a}`),ke.dataset.pos||(ke.dataset.pos=G?"top":"bot");let it=fe*(a?.2:1)+(a?0:q*Ie);ke.style.setProperty("--y",`${G?it:it*-1}px`),ke.style.setProperty("--g",`${q}`),ke.style.setProperty("--s",`${1-(a?xe:0)}`),fe+=ke.offsetHeight,xe+=.025})}},[a,C,s]),ce.useEffect(()=>{function ue(Z){var q;let G=g.current;oe(Z)&&((q=G.querySelector('[tabIndex="0"]'))==null||q.focus(),h(!1),mn.pause()),Z.key==="Escape"&&(document.activeElement===G||G!=null&&G.contains(document.activeElement))&&(h(!0),mn.play())}return document.addEventListener("keydown",ue),()=>{document.removeEventListener("keydown",ue)}},[oe]),$t.createElement("section",{ref:g,className:"Toastify",id:F,onMouseEnter:()=>{s&&(h(!1),mn.pause())},onMouseLeave:re,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},v((ue,Z)=>{let q=Z.length?{...L}:{...L,pointerEvents:"none"};return $t.createElement("div",{tabIndex:-1,className:se(ue),"data-stacked":s,style:q,key:`c-${ue}`},Z.map(({content:G,props:fe})=>$t.createElement(QR,{...fe,stacked:s,collapseAll:re,isIn:c(fe.toastId,fe.containerId),key:`t-${fe.key}`},G)))}))}function iF(e){return kt({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"},child:[]}]})(e)}const m2=({isDarkMode:e})=>{const[t,s]=ce.useState(!1),[a,h]=ce.useState(!1),[g,v]=ce.useState(!1);ce.useEffect(()=>{const L=()=>{h(window.innerWidth<768)},B=()=>{const F=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");v(F)};return L(),B(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]);const c=[{icon:R.jsx(YD,{size:18}),href:"mailto:hi@prateekkeshari.com",title:"Email"},{icon:R.jsx(iF,{size:16}),href:"https://twitter.com/prkeshari",title:"Twitter"},{icon:R.jsx(HD,{size:18}),href:"https://github.com/prateekkeshari",title:"GitHub"},{icon:R.jsx(XD,{size:18}),href:"https://linkedin.com/in/prateekkeshari",title:"LinkedIn"},{icon:R.jsx(id,{size:18}),href:"https://prateekkeshari.com",title:"Website"}],C={hidden:{y:"100%",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:300}},exit:{y:"100%",opacity:0,transition:{type:"spring",damping:25,stiffness:300,duration:.2}}},k={hidden:{opacity:0,scale:.95,y:-5},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25}},exit:{opacity:0,scale:.95,y:-5,transition:{duration:.2}}};return R.jsxs(R.Fragment,{children:[R.jsx(In,{children:(!t||a)&&R.jsx(lt.div,{className:`fixed z-40 ${g?"about-btn-pwa":"top-[17px] left-4"}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:g?{top:"calc(var(--sat) + 17px)",left:"max(16px, calc(var(--sal) + 8px))"}:{},children:R.jsx(lt.button,{onClick:()=>s(!t),className:`flex items-center justify-center text-xs font-medium about-button
                ${a?"rounded-full w-8 h-8 p-0 aspect-square":"rounded-full py-1 px-1 pr-2.5 gap-2"}
                ${e?"bg-black/30 text-white/80 hover:bg-black/40 hover:text-white border border-white/10":"bg-white/40 text-gray-700 hover:bg-white/60 hover:text-gray-800 border border-black/5"} backdrop-blur-md transition-all duration-300 shadow-sm`,whileHover:{scale:1.02},whileTap:{scale:.97},"aria-label":"About",children:a?R.jsx(Jf,{className:"w-4 h-4"}):R.jsxs(R.Fragment,{children:[R.jsx("img",{src:"https://ca.slack-edge.com/T0JE33RMW-U02RC8V15L3-9202113e3b06-512",alt:"Prateek Keshari",className:"w-6 h-6 rounded-full object-cover"}),R.jsx("span",{children:"About"})]})})})}),a&&R.jsx(In,{children:t&&R.jsxs(R.Fragment,{children:[R.jsx(lt.div,{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),R.jsxs(lt.div,{className:`fixed bottom-0 left-0 right-0 z-50 ${e?"bg-black/80 text-white/90":"bg-white/90 text-black/80"} rounded-t-2xl backdrop-blur-md`,style:{boxShadow:e?"0 -10px 25px -5px rgba(0, 0, 0, 0.3)":"0 -10px 25px -5px rgba(0, 0, 0, 0.1)",paddingBottom:"calc(10px + env(safe-area-inset-bottom, 10px))"},variants:C,initial:"hidden",animate:"visible",exit:"exit",drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:(L,B)=>{B.offset.y>70&&s(!1)},children:[R.jsx("div",{className:"w-full flex justify-center pt-3 pb-1",children:R.jsx("div",{className:`w-10 h-1 rounded-full ${e?"bg-white/20":"bg-black/10"}`})}),R.jsxs("div",{className:"px-5 pt-3 pb-2",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[R.jsx("img",{src:"https://ca.slack-edge.com/T0JE33RMW-U02RC8V15L3-9202113e3b06-512",alt:"Prateek Keshari",className:"w-10 h-10 rounded-full object-cover ring-1 ring-white/10"}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-sm font-medium",children:"Made by Prateek Keshari"}),R.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[R.jsx("span",{className:`text-xs ${e?"text-white/50":"text-black/50"}`,children:"Product marketer in Berlin."}),R.jsx(Ns,{className:`w-3 h-3 ${e?"text-white/60":"text-black/60"} ml-1`})]})]})]}),R.jsx("div",{className:"flex justify-around py-1",children:c.map((L,B)=>R.jsx(lt.a,{href:L.href,target:"_blank",rel:"noopener noreferrer",whileHover:{scale:1.1},whileTap:{scale:.95},className:`p-2.5 rounded-full ${e?"bg-white/5 hover:bg-white/10 text-white/80":"bg-black/5 hover:bg-black/10 text-black/70"}`,"aria-label":L.title,children:L.icon},B))})]})]})]})}),!a&&R.jsx(In,{children:t&&R.jsxs(R.Fragment,{children:[R.jsx(lt.div,{className:"fixed inset-0 z-30",initial:{opacity:0},animate:{opacity:.001},exit:{opacity:0},onClick:()=>s(!1)}),R.jsx(lt.div,{className:`fixed z-40 min-w-[220px] ${g?"about-menu-pwa":"top-[17px] left-4"}`,style:g?{top:"calc(var(--sat) + 17px)",left:"max(16px, calc(var(--sal) + 8px))"}:{},variants:k,initial:"hidden",animate:"visible",exit:"exit",children:R.jsx("div",{className:`rounded-xl overflow-hidden shadow-lg backdrop-blur-lg
                  ${e?"bg-black/80 border border-white/10 text-white/90":"bg-white/90 border border-black/5 text-black/80"}
                `,children:R.jsxs("div",{className:"p-4",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[R.jsx("img",{src:"https://ca.slack-edge.com/T0JE33RMW-U02RC8V15L3-9202113e3b06-512",alt:"Prateek Keshari",className:"w-10 h-10 rounded-full object-cover"}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-sm font-medium",children:"Made by Prateek Keshari"}),R.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[R.jsx("span",{className:"text-xs opacity-70",children:"Product marketer in Berlin."}),R.jsx(Ns,{className:"w-3 h-3 opacity-70 ml-1"})]})]})]}),R.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-current to-transparent opacity-10 my-2"}),R.jsx("div",{className:"grid grid-cols-5 gap-1 mt-3",children:c.map((L,B)=>R.jsx(lt.a,{href:L.href,target:"_blank",rel:"noopener noreferrer",className:`flex items-center justify-center p-2 rounded-lg ${e?"hover:bg-white/10 text-white/80":"hover:bg-black/5 text-black/70"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:L.title,children:L.icon},B))})]})})})]})})]})},rF=({message:e,isDarkMode:t})=>R.jsxs(lt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
      fixed bottom-4 left-1/2 transform -translate-x-1/2
      px-4 py-2 rounded-lg shadow-lg
      ${t?"bg-green-500/20 text-green-400":"bg-green-50 text-green-600"}
      flex items-center gap-2
    `,children:[R.jsx(Pm,{className:"w-4 h-4"}),e]}),Cy=({station:e,className:t})=>{const[s,a]=ce.useState(!1);return e.favicon&&!s?R.jsx("div",{className:`${t} overflow-hidden`,children:R.jsx("img",{src:e.favicon,alt:e.name,className:"w-full h-full object-cover rounded-lg",onError:()=>a(!0)})}):R.jsx("div",{className:t,children:R.jsx($c,{className:"w-4 h-4"})})},sF=()=>R.jsx("div",{className:"flex items-center gap-[2px] h-3",children:[1,2,3].map(e=>R.jsx(lt.div,{className:"w-[2px] bg-green-400",animate:{height:[6,12,6]},transition:{duration:1,repeat:1/0,delay:e*.2}},e))}),oF=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),g2=({isOpen:e,setIsOpen:t,isDarkMode:s,setIsDarkMode:a,onStationSelect:h,stations:g,onPlayToggle:v,isPlaying:c,onShuffle:C,favorites:k,recentStations:L,onVolumeChange:B,volume:F,selectedGenre:oe,onGenreSelect:se,onSleepTimerSet:re,sleepTimeout:ue,onSleepTimerCancel:Z,showKeyboardShortcuts:q,setShowKeyboardShortcuts:G,onToggleFavorite:fe,station:xe,selectedStation:Ee,activeSection:Ie,setActiveSection:ke,currentFont:it,setCurrentFont:Oe,onStationLocate:At,onShare:Ct})=>{const[It,Ut]=ce.useState(""),[on,Ve]=ce.useState(-1);ce.useRef(null);const rt=ce.useRef(null),[Re,at]=ce.useState(null),[Ne,wt]=ce.useState(null),[Rt,Ft]=ce.useState(!1),Nt=ce.useRef(null),hn=$t.useMemo(()=>({name:"Stations",commands:It?g.filter(qe=>{var ut,zt,qt;return((ut=qe.name)==null?void 0:ut.toLowerCase().includes(It.toLowerCase()))||(qe.countrycode?xa(qe.countrycode).toLowerCase().includes(It.toLowerCase()):!1)||((zt=qe.city)==null?void 0:zt.toLowerCase().includes(It.toLowerCase()))||((qt=qe.state)==null?void 0:qt.toLowerCase().includes(It.toLowerCase()))||(Array.isArray(qe.tags)?qe.tags.join(",").toLowerCase().includes(It.toLowerCase()):typeof qe.tags=="string"?qe.tags.toLowerCase().includes(It.toLowerCase()):!1)}).slice(0,8).map(qe=>({id:`station-${qe.stationuuid}`,name:qe.name,description:[Mc(qe),Array.isArray(qe.tags)?qe.tags[0]:typeof qe.tags=="string"?qe.tags.split(",")[0].trim():null,qe.bitrate?`${qe.bitrate}kbps`:null].filter(Boolean).join("  "),station:qe,icon:({className:ut})=>R.jsx(Cy,{station:qe,className:ut}),action:()=>{h(qe),t(!1)}})):[]}),[It,g,h,t]),an=$t.useMemo(()=>{const qe={name:"Controls",commands:[{id:"play-pause",name:c?`${Ee==null?void 0:Ee.name}`:Ee?"Play":"Select a station to play",description:c?Ee!=null&&Ee.countrycode?xa(Ee.countrycode):null:Ee?"Resume playback":"Browse stations to get started",icon:c?Z0:G0,shortcut:"Space",iconClassName:c?"text-green-400":"",action:()=>{Ee&&(v(),c||(wt("play"),setTimeout(()=>wt(null),2e3)))}},{id:"shuffle",name:"Random Station",description:"Discover something new",icon:$E,shortcut:"R",action:()=>{C(),t(!1)}},{id:"locate-station",name:Ee?`Locate ${Ee.name}`:"Locate Current Station",description:Ee?`Find ${Ee.name} on the globe`:"Find the current station on the globe",icon:jE,shortcut:"L",action:()=>{Ee&&(At(Ee),t(!1))},disabled:!Ee},{id:"share-station",name:Ee?`Share ${Ee.name}`:"Share Current Station",description:Ee?`Share ${Ee.name} with others`:"Share the current station with others",icon:NE,shortcut:"C",action:()=>{Ee&&(Ct(Ee),t(!1))},disabled:!Ee},{id:"volume-up",name:"Volume Up",description:`Current: ${Math.round(F*100)}%`,icon:W0,shortcut:"",action:()=>{const _t=Math.min(1,F+.1);B(_t)}},{id:"volume-down",name:"Volume Down",description:`Current: ${Math.round(F*100)}%`,icon:qE,shortcut:"",action:()=>{const _t=Math.max(0,F-.1);B(_t)}},{id:"volume-mute",name:F===0?"Unmute":"Mute",description:F===0?"Restore volume":"Silence audio",icon:F===0?W0:ZE,shortcut:"M",action:()=>{B(F===0?1:0)}}]},ut={name:"Sleep Timer",commands:[{id:"sleep-timer",name:"Set Sleep Timer",description:ue?`Currently set for ${ue} minutes`:"Stop playback after a duration",icon:oc,shortcut:"T",hasSubmenu:!0,action:()=>{ke("sleep-options"),Ve(0),Ut("")}}]},zt={name:"Sleep Timer Options",commands:[{id:"timer-15",name:"15 minutes",icon:oc,iconClassName:ue===15?"text-green-400":s?"text-gray-400":"text-gray-500",action:()=>{re(15),wt("timer-15"),setTimeout(()=>wt(null),2e3)}},{id:"timer-30",name:"30 minutes",icon:oc,iconClassName:ue===30?"text-green-400":s?"text-gray-400":"text-gray-500",action:()=>{re(30),wt("timer-30"),setTimeout(()=>wt(null),2e3)}},{id:"timer-45",name:"45 minutes",icon:oc,iconClassName:ue===45?"text-green-400":s?"text-gray-400":"text-gray-500",action:()=>{re(45),wt("timer-45"),setTimeout(()=>wt(null),2e3)}},{id:"timer-60",name:"60 minutes",icon:oc,iconClassName:ue===60?"text-green-400":s?"text-gray-400":"text-gray-500",action:()=>{re(60),wt("timer-60"),setTimeout(()=>wt(null),2e3)}},...ue?[{id:"timer-cancel",name:"Cancel Timer",description:`Currently set for ${ue} minutes`,icon:Lh,iconClassName:"text-red-400",action:()=>{Z(),wt("timer-cancel"),setTimeout(()=>wt(null),2e3)}}]:[]]},qt={name:"Navigation",commands:[{id:"favorites",name:"Favorite Stations",description:`${k.length} stations`,icon:Ns,shortcut:" + F",hasSubmenu:!0,action:()=>ke("favorites")},{id:"history",name:"Recent Stations",description:`${L.length} stations`,icon:OD,shortcut:"H",hasSubmenu:!0,action:()=>ke("history")}]},en={name:"Appearance",commands:[{id:"toggle-theme",name:s?"Switch to Light Mode":"Switch to Dark Mode",description:`Currently using ${s?"dark":"light"} theme`,icon:s?aR:oR,shortcut:"T",action:()=>{a(!s),t(!1)}}]},jt={name:"Fonts",commands:[{id:"font-system",name:"System Font",description:"Use your system default font",icon:Zp,action:()=>{Oe("system"),t(!1)},active:it==="system"},{id:"font-inter",name:"Inter",description:"Modern and readable interface font",icon:Zp,action:()=>{Oe("inter"),t(!1)},active:it==="inter"},{id:"font-mono",name:"Monospace",description:"Fixed-width typewriter style",icon:Zp,action:()=>{Oe("mono"),t(!1)},active:it==="mono"},{id:"font-serif",name:"Serif",description:"Classic and elegant typography",icon:Zp,action:()=>{Oe("serif"),t(!1)},active:it==="serif"}]};return Ie==="sleep-options"?[zt]:Ie==="favorites"?[{name:"Favorites",commands:k.map(_t=>({id:`fav-${_t.stationuuid}`,name:_t.name,description:[Mc(_t),Array.isArray(_t.tags)?_t.tags[0]:typeof _t.tags=="string"?_t.tags.split(",")[0].trim():null,_t.bitrate?`${_t.bitrate}kbps`:null].filter(Boolean).join("  "),station:_t,icon:({className:ki})=>R.jsx(Cy,{station:_t,className:ki}),action:()=>{h(_t),t(!1)}}))}]:Ie==="history"?[{name:"Recent",commands:L.map(_t=>({id:`recent-${_t.stationuuid}`,name:_t.name,description:[Mc(_t),Array.isArray(_t.tags)?_t.tags[0]:typeof _t.tags=="string"?_t.tags.split(",")[0].trim():null,_t.bitrate?`${_t.bitrate}kbps`:null].filter(Boolean).join("  "),station:_t,icon:({className:ki})=>R.jsx(Cy,{station:_t,className:ki}),action:()=>{h(_t),t(!1)}}))}]:It?[hn,qe,qt,ut,en,jt]:[qe,qt,ut,en,jt]},[c,s,It,Ie,k,L,ue,F,v,C,re,Z,a,t,hn,it,Oe,B]),gn=$t.useMemo(()=>!It&&!Ie?an:an.map(ut=>({name:ut.name,commands:ut.commands.filter(zt=>{var qt;return zt.name.toLowerCase().includes(It.toLowerCase())||((qt=zt.description)==null?void 0:qt.toLowerCase().includes(It.toLowerCase()))})})).filter(ut=>ut.commands.length>0),[It,an,Ie]),gi=qe=>{if(!rt.current)return;const zt=rt.current.querySelectorAll("button")[qe];zt&&zt.scrollIntoView({behavior:"smooth",block:"nearest"})};ce.useEffect(()=>{if(!e)return;const qe=ut=>{var en;Ft(!0);const zt=gn.flatMap(jt=>jt.commands),qt=zt.length;switch(ut.key){case"Backspace":Ie&&!It&&(ut.preventDefault(),ke(null));break;case"Enter":if(ut.preventDefault(),on>=0&&on<qt){const jt=zt[on];if(jt!=null&&jt.action&&(jt.action(),(en=jt.id)!=null&&en.startsWith("timer-"))){const _t=parseInt(jt.name);isNaN(_t)||(re(_t),wt(jt.id),setTimeout(()=>wt(null),2e3))}}break;case"ArrowDown":ut.preventDefault(),Ve(jt=>{const _t=jt<qt-1?jt+1:0;return setTimeout(()=>gi(_t),0),_t});break;case"ArrowUp":ut.preventDefault(),Ve(jt=>{const _t=jt>0?jt-1:qt-1;return setTimeout(()=>gi(_t),0),_t});break;case"Escape":ut.preventDefault(),t(!1),ke(null),Ut("");break}};return window.addEventListener("keydown",qe),()=>window.removeEventListener("keydown",qe)},[e,on,gn,Ie,It]),ce.useEffect(()=>{const qe=()=>{Ft(!1)};return window.addEventListener("mousemove",qe),()=>window.removeEventListener("mousemove",qe)},[]),ce.useEffect(()=>{Ve(-1)},[e,It]);const Lt=(qe,ut)=>{let zt=0;for(let qt=0;qt<qe;qt++)zt+=gn[qt].commands.length;return zt+ut},tn=$t.memo(({command:qe,index:ut,groupIndex:zt,isSelected:qt,isDarkMode:en,isUsingKeyboard:jt,onSelect:_t,onAction:ki})=>R.jsxs(lt.button,{onClick:ki,"aria-selected":qt,className:`
        w-full px-4 py-3 flex items-center justify-between
        transition-colors duration-150 text-left
        ${jt?"using-keyboard":""}
        ${qt?en?"bg-white/5":"bg-black/5":"hover:bg-black/5 dark:hover:bg-white/5"}
      `,onMouseEnter:_t,children:[R.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[R.jsx("div",{className:`
          p-1.5 rounded-lg flex-shrink-0 w-8 h-8
          transition-colors duration-150
          border
          ${qt?en?"bg-white/10 border-white/10":"bg-black/5 border-black/5":en?"bg-white/5 border-white/10":"bg-black/5 border-black/5"}
        `,children:qe.icon&&(typeof qe.icon=="function"?qe.icon({className:`w-full h-full ${qe.iconClassName||(en?"text-white/70":"text-black/60")}`}):R.jsx(qe.icon,{className:`w-4 h-4 ${qe.iconClassName||(en?"text-white/70":"text-black/60")}`}))}),R.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[R.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[R.jsx("span",{className:`
              text-base font-medium truncate max-w-[300px]
              ${en?"text-white/90":"text-black/90"}
            `,children:qe.name}),qe.id==="play-pause"&&c&&R.jsx(sF,{})]}),qe.description&&R.jsx("span",{className:`
              text-sm truncate max-w-[300px]
              ${en?"text-white/50":"text-black/50"}
            `,children:qe.description})]})]}),R.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[qe.shortcut&&R.jsx("kbd",{className:`
            hidden sm:flex items-center justify-center
            px-2 py-1 text-xs font-medium rounded
            border
            ${en?"bg-white/10 text-white/40 border-white/10":"bg-black/5 text-black/40 border-black/5"}
          `,children:qe.shortcut}),qe.hasSubmenu&&R.jsx(BE,{className:`
            w-4 h-4
            ${en?"text-white/40":"text-black/40"}
          `})]})]}));return ce.useEffect(()=>{const qe=ut=>{if(!(ut.target.tagName==="INPUT"&&!ut.metaKey&&!ut.ctrlKey)){if((ut.metaKey||ut.ctrlKey)&&ut.key.toLowerCase()==="k"){ut.preventDefault(),t(zt=>!zt),e||(ke(null),Ut(""));return}if(!e)switch(ut.key.toLowerCase()){case"f":ut.metaKey||ut.ctrlKey?(ut.preventDefault(),t(!0),ke("favorites")):xe&&(ut.preventDefault(),fe(xe));break;case"l":!ut.metaKey&&!ut.ctrlKey&&(ut.preventDefault(),a(zt=>!zt));break;case"h":!ut.metaKey&&!ut.ctrlKey&&(ut.preventDefault(),t(!0),ke("history"));break;case"t":!ut.metaKey&&!ut.ctrlKey&&(ut.preventDefault(),t(!0),ke("sleep-options"));break}}};return window.addEventListener("keydown",qe),()=>window.removeEventListener("keydown",qe)},[e,t,ke,a,fe,Ee,Ct]),ce.useEffect(()=>()=>{ke(null),Ut("")},[]),ce.useEffect(()=>{e&&Ve(0)},[e]),ce.useEffect(()=>{Ie&&Ve(0)},[Ie]),ce.useEffect(()=>{document.documentElement.style.setProperty("--app-font",`var(--font-${it})`),document.body.classList.remove("font-jetbrains","font-inter"),document.body.classList.add(`font-${it}`)},[it]),ce.useEffect(()=>{const qe=ut=>{Nt.current&&!Nt.current.contains(ut.target)&&t(!1)};return e&&document.addEventListener("mousedown",qe),()=>{document.removeEventListener("mousedown",qe)}},[e,t]),R.jsx(In,{children:e&&R.jsxs(R.Fragment,{children:[R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:`
              fixed inset-0 z-50
              ${s?"bg-black/90":"bg-white/90"}
            `,onClick:()=>t(!1)}),R.jsx("div",{className:`fixed inset-0 z-50 flex items-start justify-center pt-[15vh] ${oF()?"pwa-mode":""}`,children:R.jsx(lt.div,{ref:Nt,className:"w-full max-w-2xl mx-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.15},children:R.jsxs("div",{className:`
                ${s?"bg-black border-white/10":"bg-white border-black/5"} 
                rounded-2xl border shadow-2xl overflow-hidden
                ring-1 ${s?"ring-white/10":"ring-black/5"}
              `,children:[R.jsx("div",{className:"p-4 border-b border-gray-200/5",children:R.jsxs("div",{className:"flex items-center gap-3 px-0 py-2",children:[Ie?R.jsx("button",{onClick:()=>ke(null),className:`p-1 rounded-lg ${s?"hover:bg-white/10":"hover:bg-black/5"}`,children:R.jsx(BD,{className:`w-5 h-5 ${s?"text-white/60":"text-black/60"}`})}):R.jsx(K0,{className:`w-6 h-6 ${s?"text-white/60":"text-black/60"}`}),R.jsx("input",{type:"text",placeholder:"Type a command or search stations...",className:`
                        w-full bg-transparent outline-none text-base
                        ${s?"text-white placeholder:text-white/40":"text-black placeholder:text-black/40"}
                      `,value:It,onChange:qe=>{Ut(qe.target.value),Ve(0)},inputMode:"search",enterKeyHint:"search",onFocus:qe=>{setTimeout(()=>{window.scrollTo(0,0),qe.target.click(),qe.target.focus()},100)},ref:qe=>{qe&&e&&setTimeout(()=>{qe.focus(),window.scrollTo(0,0)},100)},onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),qe.target.focus()}}),R.jsx("kbd",{className:`
                      hidden sm:flex items-center justify-center
                      px-2 py-1 text-xs font-medium rounded
                      ${s?"bg-white/10 text-white/40 border border-white/10":"bg-black/5 text-black/40 border border-black/5"}
                    `,children:"ESC"})]})}),R.jsx("div",{ref:rt,className:"max-h-[60vh] overflow-y-auto",children:gn.map((qe,ut)=>R.jsxs("div",{className:"py-2",children:[R.jsx("div",{className:`
                        px-4 py-2 text-xs font-medium tracking-wider
                        ${s?"text-white/40":"text-black/40"}
                      `,children:qe.name.toUpperCase()}),qe.commands.map((zt,qt)=>R.jsx(tn,{command:zt,index:qt,groupIndex:ut,isSelected:Lt(ut,qt)===on,isDarkMode:s,isUsingKeyboard:Rt,onSelect:()=>{Rt||Ve(Lt(ut,qt))},onAction:zt.action},zt.id))]},qe.name))})]})})}),R.jsx(In,{children:Re&&R.jsx(rF,{message:Re,isDarkMode:s})})]})})},Gp=[{name:"Radio Meuh",url_resolved:"https://radiomeuh.ice.infomaniak.ch/radiomeuh-128.mp3",url:"https://www.radiomeuh.com/",favicon:"https://www.radiomeuh.com/apple-icon-120x120.png",country:"France",countrycode:"FR",state:"",city:"La Clusaz",stationuuid:"radiomeuh-fr",geo_lat:"45.9044",geo_long:"6.4229",tags:"electronic,funk,music"},{name:"Nordic Chillout Radio",url_resolved:"https://listen.radioking.com/radio/672094/stream/736489",url:"http://www.nordichilloutradio.com/",favicon:"https://nordichilloutradio.com/wp-content/themes/nordichillout/media/apple-touch-icon.png",country:"Latvia",countrycode:"LV",state:"Riga",city:"Riga",stationuuid:"nordic-chillout-lv",geo_lat:"56.8102",geo_long:"24.1575",tags:"chillout,downtempo,electronic"}],Rx=async()=>{try{return(await(await fetch("https://all.api.radio-browser.info/json/servers")).json()).map(s=>`https://${s.name}`).sort(()=>Math.random()-.5)}catch(e){return console.warn("Failed to get radio servers list:",e),["https://de1.api.radio-browser.info","https://nl1.api.radio-browser.info","https://fr1.api.radio-browser.info","https://de2.api.radio-browser.info"].sort(()=>Math.random()-.5)}};let Wp=null,Py=0;const aF=async()=>{Wp||(Wp=await Rx());const e=Wp[Py];return Py=(Py+1)%Wp.length,e},nC=i3.create({timeout:15e3,headers:{"User-Agent":"radiocast/2.0"}}),y2=[500,1e3,1500,2e3,2500,3e3],lF=1e4,zh=1e3,cF=async(e,t,s)=>{try{const a=await aF(),h=await nC.get(`${a}/json/stations/search`,{params:{offset:t,limit:s,hidebroken:!0,has_geo_info:!0,order:"clickcount",reverse:!0,fields:["name","url_resolved","url","favicon","countrycode","state","city","stationuuid","geo_lat","geo_long","tags"].join(",")}});return h.data?h.data:null}catch(a){return console.error("Error loading batch:",a),null}},cl="radio_stations_cache",uF=24*60*60*1e3,_2=1e3,hF=()=>{try{const e=localStorage.getItem(`${cl}_meta`);if(!e)return null;const t=JSON.parse(e);if(Date.now()-t.timestamp>uF)return Tc(),null;let s=[];for(let a=0;a<t.chunks;a++){const h=localStorage.getItem(`${cl}_${a}`);if(!h)return console.warn(`Cache chunk ${a} missing, invalidating cache`),Tc(),null;s=[...s,...JSON.parse(h)]}return s.length>=zh?s:(Tc(),null)}catch(e){return console.warn("Error reading cache:",e),Tc(),null}},Tc=()=>{try{const e=localStorage.getItem(`${cl}_meta`);if(e){const t=JSON.parse(e);for(let s=0;s<t.chunks;s++)localStorage.removeItem(`${cl}_${s}`)}localStorage.removeItem(`${cl}_meta`)}catch(e){console.warn("Error clearing cache:",e)}},e_=e=>{try{Tc();const t=[];for(let s=0;s<e.length;s+=_2)t.push(e.slice(s,s+_2));localStorage.setItem(`${cl}_meta`,JSON.stringify({timestamp:Date.now(),chunks:t.length,totalStations:e.length})),t.forEach((s,a)=>{try{localStorage.setItem(`${cl}_${a}`,JSON.stringify(s))}catch(h){throw console.warn(`Failed to cache chunk ${a}:`,h),Tc(),h}}),console.log(`Successfully cached ${e.length} stations in ${t.length} chunks`)}catch(t){console.warn("Error caching stations:",t)}},dF=async(e,t,s,a=2)=>{for(let h=0;h<=a;h++)try{const g=await cF(e,t,s);if(g!=null&&g.length)return g;if(h===a)return null;await new Promise(v=>setTimeout(v,Math.pow(2,h)*1e3))}catch(g){if(console.warn(`Batch load attempt ${h+1} failed:`,g),h===a)throw g;await new Promise(v=>setTimeout(v,Math.pow(2,h)*1e3))}return null},pF=async e=>{const s=["/api/search",...(await Rx()).map(L=>`${L}/json/stations/search`)];let a=0,h=0,g=0,v=[];const c=async()=>{if(a>=lF||g>=y2.length)return null;const L=s[h],B=y2[g];try{const F=await dF(L,a,B);if(F!=null&&F.length)return a+=F.length,g++,F;if(h++,h<s.length)return c()}catch(F){if(console.error("Failed to load batch:",F),h++,h<s.length)return c()}return null};let C=!0,k=0;for(;C;){const L=await c();if(!L){if(C=!1,v.length>zh){e(v,!1);try{await e_(v)}catch(F){console.warn("Final cache attempt failed:",F)}return v}continue}v=[...v,...L];const B=Array.from(new Map(v.map(F=>[F.stationuuid,F])).values());if(v=B,console.log(`Loaded batch of ${L.length} stations. Total: ${B.length}`),e(B,C),B.length-k>=2500)try{await e_(B),k=B.length}catch(F){console.warn("Intermediate cache attempt failed:",F)}}return v},fF=async e=>{try{console.time("stations-load");const t=await nC.get(e,{params:{hidebroken:!0,has_geo_info:!0,limit:15e3,order:"clickcount",reverse:!0,fields:"name,url_resolved,url,favicon,countrycode,state,city,stationuuid,geo_lat,geo_long,tags"}});if(!t.data)return null;const s=t.data.filter(a=>a&&a.url_resolved&&a.stationuuid);return console.timeEnd("stations-load"),console.log(`Loaded ${s.length} stations`),s}catch(t){return console.error("Error loading stations:",t),null}},mF=async e=>{try{const t=hF();if((t==null?void 0:t.length)>=zh)return console.log(`Using ${t.length} cached stations`),e(t,!1),t;try{const a=await pF(e);if((a==null?void 0:a.length)>=zh)return a}catch(a){console.error("Failed to load stations in batches:",a)}const s=await Rx();for(const a of["/api/search",...s.map(h=>`${h}/json/stations/search`)])try{const h=await fF(a);if((h==null?void 0:h.length)>=zh)return e(h,!1),e_(h),h}catch(h){console.warn(`Failed to load from ${a}:`,h);continue}return console.log("Using featured stations as fallback"),e(Gp,!1),Gp}catch(t){return console.error("Failed to load stations:",t),e(Gp,!1),Gp}},x2=({currentCount:e,hasMoreStations:t})=>{const[s,a]=ce.useState(0),[h,g]=ce.useState(!0),[v,c]=ce.useState(!1);return ce.useEffect(()=>{if(t===!1){const C=setTimeout(()=>{g(!1)},1e3);return()=>clearTimeout(C)}},[t]),ce.useEffect(()=>{if(e>0)c(!0);else{const C=setTimeout(()=>{c(!0)},1500);return()=>clearTimeout(C)}},[e]),ce.useEffect(()=>{const C=Math.min(e/3e3*100,99),L=setInterval(()=>{a(B=>{const F=C-B;return B===0?5:B+(F>0?Math.max(F*.1,.5):0)})},16);return()=>clearInterval(L)},[e]),ce.useEffect(()=>{t===!1&&a(100)},[t]),R.jsx(In,{children:h&&R.jsxs(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed top-0 left-0 right-0 z-50",children:[R.jsx("div",{className:"absolute inset-0 h-[4px] bg-black/20 backdrop-blur-sm"}),R.jsxs(lt.div,{className:"relative h-[4px] overflow-hidden",style:{width:`${s}%`},initial:{width:"5%"},animate:{width:`${s}%`},transition:{type:"spring",stiffness:100,damping:20},children:[R.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400 via-green-500 to-emerald-400 background-animate",style:{backgroundSize:"200% 100%",animation:"shimmer 2s linear infinite"}}),R.jsxs("div",{className:"absolute inset-0",children:[R.jsx("div",{className:"wave-effect"}),R.jsx("div",{className:"wave-effect",style:{animationDelay:"-2.5s"}}),R.jsx("div",{className:"wave-effect",style:{animationDelay:"-3.5s",opacity:.3}})]}),R.jsx("div",{className:"absolute inset-0 bg-emerald-400/30 blur-sm"})]}),v&&R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute right-4 top-4 text-xs font-medium tracking-wider text-white/50",children:e>0?`${e.toLocaleString()} stations`:"Loading stations..."})]})})},gF=`
  @keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  @keyframes wave {
    0% { transform: translateX(-100%) translateZ(0) scaleY(1); }
    50% { transform: translateX(-50%) translateZ(0) scaleY(0.7); }
    100% { transform: translateX(0) translateZ(0) scaleY(1); }
  }

  .background-animate {
    background-size: 200% 100%;
    animation: shimmer 2s linear infinite;
  }

  .wave-effect {
    position: absolute;
    inset: -50% -100% -50% -100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.4),
      transparent
    );
    animation: wave 3s ease-in-out infinite;
    transform-origin: 50% 50%;
  }
`,iC=document.createElement("style");iC.textContent=gF;document.head.appendChild(iC);function yF(e){return kt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"},child:[]}]})(e)}const Hp=[{icon:Jf,title:"Important notice",description:"Radiocast aggregates public radio streams from third parties. Stream content is unmonitored - listen at your own discretion."},{icon:id,title:"Explore",description:"Rotate the globe to discover 8,000+ radio stations worldwide."},{icon:$c,title:"Listen live",description:"Click any dot to tune in. Press R for random stations."},{icon:Ns,title:"Favorite",description:"Save stations you love and find them as hearts on the globe."},{icon:Yf,title:"Quick access",description:"Use  + K for search, timer, and more."}],_F=({icon:e,title:t,description:s,isActive:a})=>R.jsxs(lt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`flex items-start space-x-3 p-2.5 sm:p-3 rounded-2xl transition-all duration-300
      ${a?"bg-white/10":"opacity-50"}`,children:[R.jsx("div",{className:"p-2 sm:p-2.5 rounded-xl bg-white/5 mt-0.5",children:e===Ns&&a?R.jsx(lt.div,{initial:{opacity:.5,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,ease:"easeOut"},children:R.jsx(yF,{className:"w-5 h-5 text-red-500"})}):e===id&&a?R.jsx(lt.div,{initial:{opacity:.5},animate:{opacity:1},transition:{duration:.3},children:R.jsx(lt.div,{animate:{rotate:360},transition:{duration:30,repeat:1/0,ease:"linear"},children:R.jsx(id,{className:"w-5 h-5 text-white"})})}):e===$c&&a?R.jsx(lt.div,{initial:{opacity:.5},animate:{opacity:1},transition:{duration:.3},children:R.jsx(lt.div,{animate:{y:[0,-1,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:R.jsx($c,{className:"w-5 h-5 text-white"})})}):e===Yf&&a?R.jsx(lt.div,{initial:{opacity:.5},animate:{opacity:1},transition:{duration:.3},children:R.jsx(lt.div,{animate:{opacity:[1,.7,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:R.jsx(Yf,{className:"w-5 h-5 text-white"})})}):R.jsx(e,{className:"w-5 h-5 text-white"})}),R.jsxs("div",{className:"flex-1",children:[R.jsx("h3",{className:"text-white text-sm sm:text-base font-medium mb-0.5",children:t}),R.jsx("p",{className:"text-white/70 text-xs sm:text-sm leading-snug",children:s})]})]}),v2=({onComplete:e})=>{const[t,s]=ce.useState(0),a=ce.useCallback(()=>{t<Hp.length-1?s(v=>v+1):e()},[t,e]),h=ce.useCallback(v=>{v.target===v.currentTarget&&e()},[e]),g=ce.useCallback(v=>{v.stopPropagation()},[]);return R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:h,children:R.jsx("div",{className:"w-full max-w-[380px] mx-auto max-h-[90vh] overflow-y-auto",children:R.jsxs(lt.div,{className:"relative bg-black/80 rounded-2xl p-4 sm:p-5 space-y-4 sm:space-y-5",initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.23,1,.32,1],delay:.1},onClick:g,children:[R.jsxs("div",{className:"text-center mb-6",children:[R.jsx("h2",{className:"text-xl font-medium text-white mb-2",children:"Welcome to Radiocast"}),R.jsx("p",{className:"text-white/60 text-sm",children:"Let's get you started with a quick tour"})]}),R.jsx("div",{className:"space-y-2 sm:space-y-3",children:Hp.map((v,c)=>R.jsx(_F,{...v,isActive:t===c},c))}),R.jsxs("div",{className:"flex justify-between items-center mt-6 pt-5 border-t border-white/10",children:[R.jsx("div",{className:"flex space-x-1.5",children:Hp.map((v,c)=>R.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 
                    ${t===c?"bg-white":"bg-white/20"}`},c))}),R.jsx("button",{onClick:a,className:`px-5 py-1.5 bg-white text-black rounded-lg hover:opacity-90 
                       transition-all duration-300 text-sm font-medium`,children:t<Hp.length-1?"Next":"Start listening"})]})]})})})};function w2({isOpen:e,onClose:t,isDarkMode:s}){return e?R.jsx(In,{children:R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`
          fixed inset-0 z-50 flex items-end justify-center px-4 pb-8
          ${s?"bg-black/60":"bg-black/40"} 
          backdrop-blur-lg
        `,onClick:t,children:R.jsxs(lt.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:35,stiffness:400},onClick:a=>a.stopPropagation(),className:`
            ${s?"bg-[#1C1C1E]":"bg-[#F5F5F7]"} 
            rounded-2xl w-full max-w-lg overflow-hidden
            ${s?"text-white":"text-black"}
            shadow-2xl
          `,children:[R.jsx("div",{className:"px-8 pt-4 pb-2",children:R.jsx("div",{className:"flex justify-center",children:R.jsx("div",{className:`
                w-8 h-1 rounded-full 
                ${s?"bg-[#636366]":"bg-[#3A3A3C]"}
              `})})}),R.jsxs("div",{className:"px-8 pt-4 pb-6",children:[R.jsx("h2",{className:`
              text-2xl font-bold mb-2
              ${s?"text-white/90":"text-black/90"}
              tracking-tight
            `,children:"Install Radiocast"}),R.jsx("p",{className:`
              text-sm leading-relaxed
              ${s?"text-[#98989F]":"text-[#6E6E73]"}
            `,children:"Access 8,000+ radio stations from around the world"})]}),R.jsxs("div",{className:`
            ${s?"bg-black/40":"bg-white"}
            px-8 py-6 space-y-6
            border-t ${s?"border-white/10":"border-black/5"}
          `,children:[R.jsxs("div",{className:"flex items-center gap-5",children:[R.jsx("div",{className:`
                p-3 rounded-xl
                ${s?"bg-white/5 ring-1 ring-white/10":"bg-black/5 ring-1 ring-black/5"}
              `,children:R.jsx(nR,{className:`
                  w-5 h-5
                  ${s?"text-white/80":"text-black/80"}
                `})}),R.jsxs("div",{children:[R.jsx("p",{className:`
                  font-medium text-base mb-0.5
                  ${s?"text-white/90":"text-black/90"}
                `,children:"1. Tap the share button"}),R.jsx("p",{className:`
                  text-sm
                  ${s?"text-white/50":"text-black/50"}
                `,children:"Open share menu"})]})]}),R.jsxs("div",{className:"flex items-center gap-5",children:[R.jsx("div",{className:`
                p-3 rounded-xl
                ${s?"bg-white/5 ring-1 ring-white/10":"bg-black/5 ring-1 ring-black/5"}
              `,children:R.jsx(QD,{className:`
                  w-5 h-5
                  ${s?"text-white/80":"text-black/80"}
                `})}),R.jsxs("div",{children:[R.jsx("p",{className:`
                  font-medium text-base mb-0.5
                  ${s?"text-white/90":"text-black/90"}
                `,children:"2. Add to Home Screen"}),R.jsx("p",{className:`
                  text-sm
                  ${s?"text-white/50":"text-black/50"}
                `,children:"Choose 'Add to Home Screen' option"})]})]})]}),R.jsx("div",{className:`
            ${s?"bg-black/40":"bg-white"}
            px-8 py-6
            border-t ${s?"border-white/10":"border-black/5"}
          `,children:R.jsx("button",{onClick:t,className:`
                w-full py-3.5 rounded-2xl text-base font-medium
                transition-all duration-200
                ${s?"bg-white/5 hover:bg-white/10 active:bg-white/5 text-white/90":"bg-black/5 hover:bg-black/10 active:bg-black/5 text-black/90"}
              `,children:"Cancel"})})]})})}):null}const xF=({isDarkMode:e})=>{const[t,s]=ce.useState(!1),a=[{key:" K",description:"Command palette"},{key:"Space",description:"Play/pause"},{key:"R",description:"Random station"},{key:"G",description:"Fly to station"},{key:"C",description:"Copy station link"},{key:"",description:"Volume up"},{key:"",description:"Volume down"},{key:"M",description:"Mute/unmute"},{key:"T",description:"Sleep timer"},{key:" F",description:"Favorites"},{key:"H",description:"Recent stations"},{key:"L",description:"Toggle theme"}];return R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:()=>s(!t),className:`
          fixed bottom-4 right-4 z-[9999]
          w-10 h-10 rounded-full flex items-center justify-center
          transition-all duration-300
          hidden md:flex
          ${e?"bg-gradient-to-br from-white/15 to-white/5 text-white hover:from-white/20 hover:to-white/10":"bg-gradient-to-br from-black/10 to-black/5 text-black hover:from-black/15 hover:to-black/10"}
          shadow-lg backdrop-blur-sm
          border ${e?"border-white/10":"border-black/5"}
        `,"aria-label":"Keyboard shortcuts",children:t?R.jsx(Lh,{className:"w-5 h-5"}):R.jsx(K0,{className:`w-5 h-5 ${e?"text-white/90":"text-black/80"}`})}),R.jsx(In,{children:t&&R.jsxs(lt.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{duration:.3,ease:[.19,1,.22,1]},className:`
              fixed bottom-16 right-4 z-[9999]
              w-72 p-4 rounded-2xl
              hidden md:block
              ${e?"bg-black border border-white/10 text-white":"bg-white border border-black/10 text-black"}
              shadow-xl backdrop-blur-sm
              ${e?"bg-opacity-90":"bg-opacity-95"}
            `,children:[R.jsx("div",{className:"flex items-center justify-between mb-3",children:R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx(K0,{className:"w-4 h-4"}),R.jsx("h3",{className:"text-sm font-medium",children:"Keyboard shortcuts"})]})}),R.jsx("div",{className:"space-y-1",children:a.map((h,g)=>R.jsxs(lt.div,{className:"flex items-center justify-between py-1.5",initial:{opacity:0,x:-5},animate:{opacity:1,x:0},transition:{delay:g*.03,duration:.2},children:[R.jsx("span",{className:"text-sm opacity-70",children:h.description}),R.jsx("kbd",{className:`
                    px-2 py-1 text-xs font-medium rounded
                    border
                    ${e?"bg-white/10 text-white/80 border-white/10":"bg-black/5 text-black/80 border-black/5"}
                  `,children:h.key})]},g))})]})})]})},vF="https://www.perplexity.ai/browser/claim-invite/Mzg3NjZiYmQtNWI4MC00ZjkyLWJkYTEtMzQ2YjA2MGY2N2I1?via=prateekkeshari&dub_id=wZQQ8ThRCJiIFaVv",b2=({isDarkMode:e})=>{const t=e?"bg-[#141227]/95 text-white":"bg-white text-[#131931]",s=e?"border border-white/12":"border border-[#d2d9ff]/70",a=`inline-flex items-center gap-1.5 rounded-full px-3.5 py-1 text-xs font-semibold transition-colors duration-200 ${e?"bg-white text-[#141227] hover:bg-slate-100":"bg-[#131931] text-white hover:bg-[#23305a]"}`,h=e?"focus-visible:ring-2 focus-visible:ring-white/60 focus-visible:ring-offset-2 focus-visible:ring-offset-[#090b17]":"focus-visible:ring-2 focus-visible:ring-[#3148d6]/40 focus-visible:ring-offset-2 focus-visible:ring-offset-white";return R.jsx("div",{className:"w-full flex justify-center px-4 sm:px-0",children:R.jsx("a",{href:vF,target:"_blank",rel:"noopener noreferrer",className:`group block w-full max-w-[420px] sm:max-w-[500px] focus-visible:outline-none ${h}`,children:R.jsxs("div",{className:`flex items-center gap-2 sm:gap-2.5 px-3 sm:px-3.5 py-2 rounded-full shadow-md backdrop-blur-md transition-transform duration-150 group-hover:-translate-y-0.5 group-active:translate-y-0 ${t} ${s}`,children:[R.jsx("div",{className:"flex h-8 w-8 sm:h-9 sm:w-9 items-center justify-center rounded-xl bg-white shadow-sm overflow-hidden flex-shrink-0",children:R.jsx("img",{src:"https://brandlogos.net/wp-content/uploads/2025/05/perplexity_icon-logo_brandlogos.net_a9d3e-512x591.png",alt:"Perplexity logo",className:"h-6 w-6 sm:h-7 sm:w-7 object-contain",loading:"lazy"})}),R.jsx("div",{className:"flex-1 min-w-0 font-semibold",children:R.jsx("span",{className:"block text-xs sm:text-sm sm:leading-none leading-tight truncate sm:whitespace-nowrap",children:"Claim Comet Invite"})}),R.jsx("div",{className:"flex items-center flex-shrink-0",children:R.jsxs("span",{className:a,children:[R.jsx("span",{className:"hidden sm:inline",children:"Get 1 mo of Perplexity Pro"}),R.jsx("span",{className:"inline sm:hidden",children:"Get Pro"}),R.jsx(ND,{className:"h-3.5 w-3.5","aria-hidden":"true"})]})})]})})})},Ay=e=>{try{document.querySelectorAll("link[rel*='icon']").forEach(a=>a.remove());const s=document.createElement("link");s.type="image/x-icon",s.rel="icon",s.href=(e==null?void 0:e.favicon)||"/favicon.ico",document.head.appendChild(s)}catch(t){console.error("Favicon update failed:",t)}},wF=(e,t,s)=>{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:(e==null?void 0:e.name)||"Radiocast",artist:e!=null&&e.countrycode?xa(e.countrycode):"World radio stations",artwork:[{src:(e==null?void 0:e.favicon)||"/favicon.ico",sizes:"96x96",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",()=>{s(!0)}),navigator.mediaSession.setActionHandler("pause",()=>{s(!1)}),navigator.mediaSession.playbackState=t?"playing":"paused")},Ys={name:"Nordic Chillout Radio",country:"Latvia",countrycode:"LV",state:"Riga",city:"Riga",url_resolved:"https://listen.radioking.com/radio/672094/stream/736489",favicon:"https://nordichilloutradio.com/wp-content/themes/nordichillout/media/apple-touch-icon.png",tags:["chillout","downtempo","electronic"],geo_lat:"56.8102",geo_long:"24.1575",stationuuid:"fd57ae03-5547-4d41-9540-33059a7a42c5",homepage:"http://www.nordichilloutradio.com/"},S2=({onClick:e,isDarkMode:t})=>{const[s,a]=ce.useState(()=>window.innerWidth<768),[h,g]=ce.useState(!1),[v,c]=ce.useState(0),[C,k]=ce.useState(!1),[L,B]=As("searchInteractionCount",0),F=L<2,oe=["Search stations","See favorites","Start sleep timer","Switch theme","Random station"];ce.useEffect(()=>{const re=()=>{a(window.innerWidth<768)},ue=()=>{const Z=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;g(Z)};return re(),ue(),window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),ce.useEffect(()=>{if(!F)return;const re=setInterval(()=>{k(!0),setTimeout(()=>{c(ue=>(ue+1)%oe.length),setTimeout(()=>{k(!1)},300)},200)},4500);return()=>clearInterval(re)},[F]);const se=()=>{B(re=>re+1),e()};return ce.useEffect(()=>{const re=ue=>{(ue.metaKey||ue.ctrlKey)&&ue.key==="k"&&B(Z=>Z+1)};return window.addEventListener("keydown",re),()=>window.removeEventListener("keydown",re)},[B]),R.jsx("div",{className:`fixed top-0 left-0 right-0 flex justify-center z-40 search-island-container ${h?"pwa-search":"pt-4"}`,children:R.jsxs(lt.button,{onClick:se,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{type:"spring",damping:20},className:`pointer-events-auto
          flex items-center justify-center gap-2.5 px-6 py-3 rounded-full 
          transition-all duration-300 border border-opacity-10
          hover:scale-105 active:scale-95 w-auto min-w-[200px]
          backdrop-blur-md
          ${t?"bg-black text-white border-white/10 shadow-[0_8px_16px_rgba(0,0,0,0.5)] hover:bg-[#0c0c0c]":"bg-white text-gray-800 border-gray-200/50 shadow-[0_8px_30px_rgba(0,0,0,0.08)] hover:bg-gray-50"}`,children:[R.jsx(eR,{className:`w-4 h-4 transition-all duration-300 ${C&&F?"text-orange-500":""}`}),R.jsx("div",{className:"relative h-5 overflow-hidden flex items-center mx-1.5 min-w-[90px] justify-center",children:F?R.jsx(In,{mode:"wait",children:R.jsx(lt.span,{className:`text-sm font-medium whitespace-nowrap transition-colors duration-300 ${C?t?"text-orange-400":"text-orange-600":""}`,initial:{y:8,opacity:0,filter:"blur(8px)"},animate:{y:0,opacity:1,filter:"blur(0px)"},exit:{y:-8,opacity:0,filter:"blur(8px)"},transition:{duration:.4,ease:[.22,1,.36,1]},children:oe[v]},oe[v])}):R.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:"Search stations"})}),!s&&R.jsxs("div",{className:`px-1.5 py-0.5 rounded text-xs flex items-center ${t?"bg-white/10":"bg-black/5"}`,children:[R.jsx(Yf,{className:"w-3 h-3 mr-0.5"}),"K"]})]})})};function bF(){const[e,t]=ce.useState(null),[s,a]=ce.useState(!1),[h,g]=ce.useState(!0),[v,c]=ce.useState([]),[C,k]=ce.useState(null),[L,B]=As("favorites",[]),[F,oe]=As("recentlyPlayed",[]),[se,re]=ce.useState(1),[ue,Z]=As("selectedTags",[]),[q,G]=ce.useState([0,20]),[fe,xe]=ce.useState("connected");ce.useRef(null),ce.useState(!1);const[Ee,Ie]=ce.useState(!1),[ke,it]=ce.useState([]),[Oe,At]=As("lastPlayedStation",null),[Ct,It]=As("recentStations",[]),[Ut,on]=ce.useState(!1),[Ve,rt]=ce.useState(!0),[Re,at]=ce.useState(null),[Ne,wt]=As("darkMode",!1),[Rt,Ft]=ce.useState(!1);ce.useEffect(()=>{(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"))&&(Ft(!0),document.documentElement.classList.add("pwa-mode"))},[]);const[Nt,hn]=ce.useState(0),an=3;ce.useState(!1);const[gn,gi]=ce.useState(null),[Lt,tn]=ce.useState(null),qe=ce.useRef(null),[ut,zt]=ce.useState(!1),[qt,en]=ce.useState(null),[jt,_t]=As("appFont","inter"),[ki,ms]=ce.useState(!1),[Me,ti]=ce.useState(()=>window.innerWidth<768);ce.useEffect(()=>{const he=()=>{window.innerWidth<768&&!Me&&ti(!0)};return window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)},[Me]);const[di,ln]=As("selectedMood",null),[Ht,rr]=As("onboardingComplete",!1),[Fr,wr]=ce.useState(!1),[so,gs]=ce.useState(!1);ce.useEffect(()=>{jt&&(document.documentElement.style.setProperty("--app-font",`var(--font-${jt})`),document.body.classList.remove("font-jetbrains","font-inter"),document.body.classList.add(`font-${jt}`),document.documentElement.classList.remove("font-jetbrains","font-inter"),document.documentElement.classList.add(`font-${jt}`))},[jt]);const Br=he=>{onSleepTimerCancel();const ve=he*60;tn(ve),gi(new Date(Date.now()+ve*1e3)),qe.current=setInterval(()=>{tn(Te=>Te<=1?(Nr(),a(!1),0):Te-1)},1e3)},Nr=()=>{gi(null),tn(null),qe.current&&clearInterval(qe.current)},Ze=$t.useMemo(()=>!v||!Array.isArray(v)?[]:v.filter(he=>{var ve,Te;if(!he||ue.length>0&&!(he.tags||[]).some(Ge=>ue.includes(Ge)))return!1;if(di){const Qe=Array.isArray(he.tags)?he.tags.map(ct=>ct.toLowerCase()):((ve=he.tags)==null?void 0:ve.toLowerCase().split(",").map(ct=>ct.trim()))||[],Ue={chill:["chill","chillout","ambient","downtempo"],energetic:["dance","edm","house","techno","drum and bass"],focus:["classical","instrumental","study","ambient"],party:["dance","pop","top 40","hits","party"],relaxing:["smooth jazz","easy listening","ambient","nature"],workout:["dance","electronic","rock","hip hop","fitness"],sleep:["ambient","nature","meditation","relaxation"],meditation:["ambient","meditation","spiritual","healing"]}[di]||[];return Qe.some(ct=>Ue.some(St=>ct.includes(St)))}return Re?(Array.isArray(he.tags)?he.tags.map(Ge=>Ge.toLowerCase()):((Te=he.tags)==null?void 0:Te.toLowerCase().split(",").map(Ge=>Ge.trim()))||[]).includes(Re.toLowerCase()):!0}),[v,ue,Re,di]);ce.useEffect(()=>{if(!/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent)){if(!new URLSearchParams(window.location.search).get("s")){const Qe=localStorage.getItem("lastPlayedStation");if(Qe)try{const Ge=JSON.parse(Qe);Ge&&Ge.url_resolved&&Ge.geo_lat&&Ge.geo_long&&(console.log("Loading last played station:",Ge.name),t(Ge),G([parseFloat(Ge.geo_long),parseFloat(Ge.geo_lat)]))}catch(Ge){console.warn("Error parsing last played station:",Ge)}else console.log("No last played station, using default:",Ys.name),t(Ys),G([parseFloat(Ys.geo_long),parseFloat(Ys.geo_lat)])}ys()}},[]);const[sr,Sn]=ce.useState(0),ys=async()=>{try{g(!0),k(null);const ve=new URLSearchParams(window.location.search).get("s"),Qe=await mF((Ge,Ue)=>{c(ct=>{const St=Array.isArray(ct)?ct:[],Jt=Array.isArray(Ge)?Ge:[];if(Jt.length===0)return console.warn("Received empty batch of stations"),St;const cn=[...St,...Jt],Ot=Array.from(new Map(cn.map(Dt=>[Dt.stationuuid,Dt])).values());if(console.log(`Updated stations count: ${Ot.length}`),Sn(Ot.length),g(Ue),ve){const Dt=Ot.find(pi=>pi.stationuuid===ve);Dt&&Tt(Dt)}return Ot})});if(!Qe||Qe.length===0)throw new Error("No stations loaded");g(!1)}catch(he){console.error("Failed to load stations:",he),k("Unable to load stations. Please try again."),g(!1)}},[Jr,He]=As("lastSelectedStation",null),Tt=he=>{if(!he)return;const ve=parseFloat(he.geo_long),Te=parseFloat(he.geo_lat);if(!(isNaN(ve)||isNaN(Te))&&!(Math.abs(Te)>90||Math.abs(ve)>180)){if(ke.includes(he.stationuuid)){mn.warning(`"${he.name}" failed to play earlier. Try another station.`);return}Ay(he),localStorage.setItem("lastPlayedStation",JSON.stringify(he)),requestAnimationFrame(()=>{t(he),G([ve,Te]),At(he),Ve||a(!0),Ie(!1),oe(Qe=>{const Ge=Qe.filter(Ue=>Ue.stationuuid!==he.stationuuid);return[he,...Ge].slice(0,10)}),It(Qe=>{const Ge=Qe.filter(Ue=>Ue.stationuuid!==he.stationuuid);return[he,...Ge].slice(0,10)})}),He(he)}},bt=()=>a(!s),Nn=he=>{he&&B(ve=>{const Te=Array.isArray(ve)?ve:[];return Te.some(Ge=>Ge.stationuuid===he.stationuuid)?Te.filter(Ge=>Ge.stationuuid!==he.stationuuid):[...Te,he]})},yi=()=>{if(!v.length)return;const he=Math.floor(Math.random()*v.length),ve=v[he];ve&&Tt(ve)},Et=ce.useCallback(he=>{console.error("Playback error:",he),Ie(!0),xe("error"),a(!1),it(ve=>[...ve,e==null?void 0:e.stationuuid])},[e]),br=()=>{xe("connected"),Ie(!1),it([])},J=he=>{if(!he)return;const ve=parseFloat(he.geo_long),Te=parseFloat(he.geo_lat);isNaN(ve)||isNaN(Te)||(G([ve+1e-4,Te+1e-4]),setTimeout(()=>{G([ve,Te])},10))},N=ce.useCallback(he=>{re(he)},[]),O=he=>{if(!he)return;const ve=`${window.location.origin}?station=${encodeURIComponent(he.stationuuid)}`;let Te=!1;try{if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(ve),Te=!0;else{const Ue=document.createElement("textarea");Ue.value=ve,Ue.style.position="fixed",Ue.style.left="-999999px",Ue.style.top="-999999px",document.body.appendChild(Ue),Ue.focus(),Ue.select(),Te=document.execCommand("copy"),document.body.removeChild(Ue)}}catch(Ue){console.error("Copy failed:",Ue)}const Qe=Mc(he),Ge="share-toast";mn.dismiss(Ge),Te?mn(R.jsx("div",{className:"clean-toast-content",children:R.jsxs("div",{className:"flex items-center gap-3 w-full",children:[R.jsx("div",{className:"flex-shrink-0",children:he.favicon&&R.jsx("img",{src:he.favicon,alt:"",className:"w-10 h-10 rounded-lg object-cover",onError:Ue=>{Ue.currentTarget.style.display="none"}})}),R.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[R.jsx("span",{className:"text-sm font-medium truncate",children:he.name}),Qe?R.jsx("span",{className:"text-xs text-gray-500 truncate",children:Qe}):null,R.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${Ne?"text-green-400":"text-green-600"}`,children:[R.jsx(Pm,{className:"w-3 h-3"}),R.jsx("span",{children:"Copied"})]})]})]})}),{toastId:Ge,position:"top-center",autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,closeButton:!1,className:"clean-toast",style:{background:Ne?"#000000":"#ffffff",color:Ne?"#ffffff":"#000000",borderRadius:"12px",padding:"12px",width:"auto",maxWidth:"320px",minWidth:"260px",fontFamily:"'Inter', sans-serif",fontWeight:"400",minHeight:"auto",border:Ne?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.08)",boxShadow:Ne?"0 8px 24px rgba(0, 0, 0, 0.4)":"0 8px 24px rgba(0, 0, 0, 0.08)"}}):mn(R.jsx("div",{className:"clean-toast-content",children:R.jsxs("div",{className:"flex items-center gap-3 w-full",children:[R.jsx("div",{className:"flex-shrink-0",children:he.favicon&&R.jsx("img",{src:he.favicon,alt:"",className:"w-10 h-10 rounded-lg object-cover opacity-60",onError:Ue=>{Ue.currentTarget.style.display="none"}})}),R.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[R.jsx("span",{className:"text-sm font-medium truncate",children:"Copy failed"}),R.jsx("span",{className:"text-xs text-gray-500 truncate mt-0.5",children:"Try again"})]}),R.jsx("div",{className:"flex-shrink-0",children:R.jsx(Lh,{className:`w-4 h-4 ${Ne?"text-red-400":"text-red-500"}`})})]})}),{toastId:Ge,position:"top-center",autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,closeButton:!1,className:"clean-toast",style:{background:Ne?"#000000":"#ffffff",color:Ne?"#ffffff":"#000000",borderRadius:"12px",padding:"12px",width:"auto",maxWidth:"320px",minWidth:"260px",fontFamily:"'Inter', sans-serif",fontWeight:"400",minHeight:"auto",border:Ne?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.08)",boxShadow:Ne?"0 8px 24px rgba(0, 0, 0, 0.4)":"0 8px 24px rgba(0, 0, 0, 0.08)"}})};ce.useEffect(()=>{const he=ve=>{if(!(ve.target.tagName==="INPUT"||ut))switch(ve.key.toLowerCase()){case" ":ve.preventDefault(),e&&bt();break;case"m":ve.preventDefault(),re(Te=>Te===0?1:0);break;case"z":ve.preventDefault(),ti(Te=>!Te);break;case"arrowright":ve.preventDefault(),re(Te=>Math.min(1,Te+.1));break;case"arrowleft":ve.preventDefault(),re(Te=>Math.max(0,Te-.1));break;case"f":ve.metaKey||ve.ctrlKey?(ve.preventDefault(),zt(!0),en("favorites")):e&&(ve.preventDefault(),Nn(e));break;case"g":!ve.metaKey&&!ve.ctrlKey&&e&&(ve.preventDefault(),J(e));break;case"l":!ve.metaKey&&!ve.ctrlKey&&(ve.preventDefault(),wt(Te=>!Te));break;case"h":!ve.metaKey&&!ve.ctrlKey&&(Ct==null?void 0:Ct.length)>0&&(ve.preventDefault(),zt(!0),en("history"));break;case"t":!ve.metaKey&&!ve.ctrlKey&&(ve.preventDefault(),zt(!0),en("sleep-options"));break;case"r":!ve.metaKey&&!ve.ctrlKey&&(ve.preventDefault(),yi());break;case"c":!ve.metaKey&&!ve.ctrlKey&&e&&(ve.preventDefault(),O(e));break}};return window.addEventListener("keydown",he),()=>window.removeEventListener("keydown",he)},[ut,e,bt,Nn,wt,yi,Ct,zt,en,J,N,O]),ce.useEffect(()=>()=>{hn(0),k(null)},[]),ce.useEffect(()=>{ut||en(null)},[ut]),ce.useEffect(()=>{e&&wF(e,s,a)},[e,s]),ce.useEffect(()=>{const he="Radiocast  Explore world radio stations";e&&s?(document.title=`${e.name} - Radiocast`,Ay(e),"mediaSession"in navigator&&(navigator.mediaSession.playbackState="playing")):(document.title=he,Ay(e),"mediaSession"in navigator&&(navigator.mediaSession.playbackState="paused"))},[e,s]),ce.useEffect(()=>{if(!Ht){const he=setTimeout(()=>{wr(!0)},3500);return()=>clearTimeout(he)}},[Ht]);const W=ce.useCallback(()=>{rr(!0),wr(!1)},[rr]);ce.useEffect(()=>{console.log("Complete:",Ht),console.log("Show:",Fr)},[Ht,Fr]),ce.useEffect(()=>{const ve=new URLSearchParams(window.location.search).get("station");if(!ve)return;const Te=v.find(Qe=>Qe.stationuuid===ve);if(Te){Tt(Te),ee(Te);return}},[v]);const ee=he=>{if(!he)return;document.title=`${he.name} - Radiocast`;const ve={description:`Listen to ${he.name} from ${he.countrycode?xa(he.countrycode):"Unknown"} on Radiocast - World radio stations`,"og:title":`${he.name} - Radiocast`,"og:description":`Listen to ${he.name} from ${he.countrycode?xa(he.countrycode):"Unknown"}`,"og:image":he.favicon||"/favicon.ico","twitter:title":`${he.name} - Radiocast`,"twitter:description":`Listen to ${he.name} from ${he.countrycode?xa(he.countrycode):"Unknown"}`,"twitter:image":he.favicon||"/favicon.ico"};Object.entries(ve).forEach(([Te,Qe])=>{let Ge=document.querySelector(`meta[property="${Te}"]`)||document.querySelector(`meta[name="${Te}"]`);Ge||(Ge=document.createElement("meta"),Ge.setAttribute(Te.includes("og:")?"property":"name",Te),document.head.appendChild(Ge)),Ge.setAttribute("content",Qe)})},[ne,we]=ce.useState(!1),[pe,ae]=ce.useState(!1);ce.useEffect(()=>{const he=localStorage.getItem("installHintDismissed")==="true";if(he)return;const ve=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),Te=/iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase()),Qe=/android/.test(window.navigator.userAgent.toLowerCase()),Ge=/safari/.test(window.navigator.userAgent.toLowerCase()),Ue=/chrome/.test(window.navigator.userAgent.toLowerCase()),ct=!ve()&&!he&&(Te&&Ge||Qe&&Ue);if(ct){const St=setTimeout(()=>{we(!0)},2e3);return()=>clearTimeout(St)}console.log({isStandalone:ve(),isIOS:Te,isAndroid:Qe,isSafari:Ge,isChrome:Ue,shouldShowInstall:ct})},[]),ce.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(he=>{he&&he.update()})},[]);const ge=100;return v.length<ge?R.jsxs(R.Fragment,{children:[R.jsx(In,{children:so&&R.jsx(lt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-3.5 shadow-lg ${Ne?"bg-gradient-to-r from-orange-950/90 to-orange-900/90 text-white border-b border-orange-800/30":"bg-gradient-to-r from-orange-50 to-amber-50 text-orange-900 border-b border-orange-200/50"} backdrop-blur-md`,children:R.jsxs("div",{className:"flex items-center gap-3 max-w-3xl mx-auto w-full",children:[R.jsx("div",{className:`p-2 rounded-full ${Ne?"bg-orange-500/20":"bg-orange-500/10"}`,children:R.jsx(Jf,{className:"flex-shrink-0 w-5 h-5"})}),R.jsxs("div",{className:"flex-1",children:[R.jsx("p",{className:`text-sm font-medium ${Ne?"text-white":"text-orange-950"}`,children:"Temporary issue with radio stations"}),R.jsx("p",{className:`text-xs mt-0.5 ${Ne?"text-orange-200/70":"text-orange-800/70"}`,children:"Radio stations may be slow to load or temporarily unavailable. Please try again later."})]}),R.jsx("button",{onClick:()=>gs(!1),className:`p-1.5 rounded-full flex-shrink-0 transition-colors ${Ne?"hover:bg-orange-800/60 active:bg-orange-800/80":"hover:bg-orange-200/50 active:bg-orange-200/70"}`,"aria-label":"Dismiss",children:R.jsx(Lh,{className:"w-5 h-5"})})]})})}),R.jsxs(lt.div,{className:`fixed inset-0 min-h-screen select-none ${Ne?"dark":""}`,children:[v.length<ge&&R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed top-0 left-0 right-0 z-50",children:R.jsx("div",{className:"h-1 bg-gradient-to-r from-orange-500 to-purple-500",children:R.jsx(lt.div,{className:"h-full bg-black/20 backdrop-blur-sm",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,repeat:1/0}})})}),v.length<ge&&R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:`fixed top-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-full 
                         bg-black/80 backdrop-blur-sm text-white/70 text-sm
                         border border-white/10`,children:"Loading stations..."}),R.jsx(d2,{children:R.jsxs("div",{className:"fixed inset-0 w-full h-full bg-gray-100 dark:bg-black overflow-hidden",children:[R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1},className:"absolute inset-0 w-full h-full",children:R.jsx(h2,{stations:Ze||[],onStationSelect:Tt,selectedStation:e,favorites:L,mapCenter:q,uiReady:Ut,initialLoad:Ve,isDarkMode:Ne})}),R.jsx(S2,{onClick:()=>zt(!0),isDarkMode:Ne}),R.jsx("div",{className:"fixed inset-0 pointer-events-none flex items-end justify-center pb-20 z-50 player-container",style:{paddingBottom:"max(16px, env(safe-area-inset-bottom, 0px))"},children:R.jsxs("div",{className:"pointer-events-auto flex flex-col items-center gap-2.5 sm:gap-3",children:[R.jsx(In,{mode:"wait",children:R.jsx(u2,{station:e||Ys,isPlaying:s,onPlayToggle:bt,volume:se,onVolumeChange:N,isFavorite:L.some(he=>he.stationuuid===((e==null?void 0:e.stationuuid)||Ys.stationuuid)),onToggleFavorite:()=>Nn(e||Ys),onError:Et,onPlay:br,onShuffle:yi,recentStations:Ct,onStationSelect:Tt,stations:v,selectedGenre:Re,onGenreSelect:at,favorites:L,isDarkMode:Ne,onThemeToggle:()=>wt(he=>!he),sleepTimeout:gn,timeRemaining:Lt,timerRef:qe,setShowCommandPalette:zt,onStationLocate:J,isCollapsed:Me,onCollapseToggle:ti,selectedMood:di,onMoodSelect:ln,onShare:O},(e==null?void 0:e.stationuuid)||"default")}),R.jsx(b2,{isDarkMode:Ne})]})}),R.jsx(In,{children:C&&R.jsx(lt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{type:"spring",stiffness:500,damping:30},className:"fixed top-6 left-1/2 -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm sm:text-base",children:C})}),R.jsx(f2,{position:"top-center",autoClose:2e3,hideProgressBar:!0,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!0,style:{width:"auto",maxWidth:"90vw"}}),R.jsx(g2,{isOpen:ut,setIsOpen:zt,isDarkMode:Ne,setIsDarkMode:wt,onStationSelect:Tt,stations:v,onPlayToggle:bt,isPlaying:s,onShuffle:yi,favorites:L,recentStations:Ct,onVolumeChange:N,volume:se,selectedGenre:Re,onGenreSelect:at,onToggleFavorite:Nn,station:e,selectedStation:e,onSleepTimerSet:Br,onSleepTimerCancel:Nr,sleepTimeout:gn,timeRemaining:Lt,activeSection:qt,setActiveSection:en,currentFont:jt,setCurrentFont:_t,onStationLocate:J,onShare:O}),R.jsx(x2,{currentCount:sr,hasMoreStations:h}),R.jsx(In,{children:Fr&&R.jsx(v2,{onComplete:W})}),R.jsx(a2,{isDarkMode:Ne,showButton:!1})]})}),R.jsx(m2,{isDarkMode:Ne}),R.jsx(w2,{isOpen:pe,onClose:()=>ae(!1),isDarkMode:Ne})]})]}):C&&Nt>=an?R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 flex items-center justify-center bg-black font-mono",children:R.jsxs("div",{className:"text-center max-w-lg px-6 space-y-8",children:[R.jsxs(lt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"space-y-4",children:[R.jsx("h2",{className:"text-2xl font-bold text-white/90",children:"Unable to Load Stations"}),R.jsx("p",{className:"text-white/70 text-lg",children:"We're experiencing technical difficulties. Please try again in a few moments."})]}),R.jsx(lt.button,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},onClick:()=>window.location.reload(),className:`px-6 py-3 bg-white/10 hover:bg-white/20 rounded-3xl
                     text-white transition-all duration-300
                     hover:scale-105 active:scale-95`,children:"Try Again"})]})}):R.jsxs(R.Fragment,{children:[R.jsx(In,{children:so&&R.jsx(lt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-3.5 shadow-lg ${Ne?"bg-gradient-to-r from-orange-950/90 to-orange-900/90 text-white border-b border-orange-800/30":"bg-gradient-to-r from-orange-50 to-amber-50 text-orange-900 border-b border-orange-200/50"} backdrop-blur-md`,children:R.jsxs("div",{className:"flex items-center gap-3 max-w-3xl mx-auto w-full",children:[R.jsx("div",{className:`p-2 rounded-full ${Ne?"bg-orange-500/20":"bg-orange-500/10"}`,children:R.jsx(Jf,{className:"flex-shrink-0 w-5 h-5"})}),R.jsxs("div",{className:"flex-1",children:[R.jsx("p",{className:`text-sm font-medium ${Ne?"text-white":"text-orange-950"}`,children:"Radio stations temporarily unavailable"}),R.jsx("p",{className:`text-xs mt-0.5 ${Ne?"text-orange-200/70":"text-orange-800/70"}`,children:"The radio-browser.info API is currently down. We're working on restoring access."})]}),R.jsx("button",{onClick:()=>gs(!1),className:`p-1.5 rounded-full flex-shrink-0 transition-colors ${Ne?"hover:bg-orange-800/60 active:bg-orange-800/80":"hover:bg-orange-200/50 active:bg-orange-200/70"}`,"aria-label":"Dismiss",children:R.jsx(Lh,{className:"w-5 h-5"})})]})})}),R.jsxs(lt.div,{className:`fixed inset-0 min-h-screen select-none ${Ne?"dark":""}`,children:[v.length<ge&&R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed top-0 left-0 right-0 z-50",children:R.jsx("div",{className:"h-1 bg-gradient-to-r from-orange-500 to-purple-500",children:R.jsx(lt.div,{className:"h-full bg-black/20 backdrop-blur-sm",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,repeat:1/0}})})}),v.length<ge&&R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},className:`fixed top-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-full 
                       bg-black/80 backdrop-blur-sm text-white/70 text-sm
                       border border-white/10`,children:"Loading stations..."}),R.jsx(d2,{children:R.jsxs("div",{className:"fixed inset-0 w-full h-full bg-gray-100 dark:bg-black overflow-hidden",children:[R.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1},className:"absolute inset-0 w-full h-full",children:R.jsx(h2,{stations:Ze||[],onStationSelect:Tt,selectedStation:e,favorites:L,mapCenter:q,uiReady:Ut,initialLoad:Ve,isDarkMode:Ne})}),R.jsx(S2,{onClick:()=>zt(!0),isDarkMode:Ne}),R.jsx("div",{className:"fixed inset-0 pointer-events-none flex items-end justify-center pb-20 z-50 player-container",style:{paddingBottom:"max(16px, env(safe-area-inset-bottom, 0px))"},children:R.jsxs("div",{className:"pointer-events-auto flex flex-col items-center gap-2.5 sm:gap-3",children:[R.jsx(In,{mode:"wait",children:R.jsx(u2,{station:e||Ys,isPlaying:s,onPlayToggle:bt,volume:se,onVolumeChange:N,isFavorite:L.some(he=>he.stationuuid===((e==null?void 0:e.stationuuid)||Ys.stationuuid)),onToggleFavorite:()=>Nn(e||Ys),onError:Et,onPlay:br,onShuffle:yi,recentStations:Ct,onStationSelect:Tt,stations:v,selectedGenre:Re,onGenreSelect:at,favorites:L,isDarkMode:Ne,onThemeToggle:()=>wt(he=>!he),sleepTimeout:gn,timeRemaining:Lt,timerRef:qe,setShowCommandPalette:zt,onStationLocate:J,isCollapsed:Me,onCollapseToggle:ti,selectedMood:di,onMoodSelect:ln,onShare:O},(e==null?void 0:e.stationuuid)||"default")}),R.jsx(b2,{isDarkMode:Ne})]})}),R.jsx(In,{children:C&&R.jsx(lt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{type:"spring",stiffness:500,damping:30},className:"fixed top-6 left-1/2 -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm sm:text-base",children:C})}),R.jsx(f2,{}),R.jsx(g2,{isOpen:ut,setIsOpen:zt,isDarkMode:Ne,setIsDarkMode:wt,onStationSelect:Tt,stations:v,onPlayToggle:bt,isPlaying:s,onShuffle:yi,favorites:L,recentStations:Ct,onVolumeChange:N,volume:se,selectedGenre:Re,onGenreSelect:at,onToggleFavorite:Nn,station:e,selectedStation:e,onSleepTimerSet:Br,onSleepTimerCancel:Nr,sleepTimeout:gn,timeRemaining:Lt,activeSection:qt,setActiveSection:en,currentFont:jt,setCurrentFont:_t,onStationLocate:J,onShare:O}),R.jsx(x2,{currentCount:sr,hasMoreStations:h}),R.jsx(In,{children:Fr&&R.jsx(v2,{onComplete:W})}),R.jsx(a2,{isDarkMode:Ne,showButton:!1})]})}),R.jsx(m2,{isDarkMode:Ne}),R.jsx(w2,{isOpen:pe,onClose:()=>ae(!1),isDarkMode:Ne})]}),R.jsx(In,{mode:"wait",children:ki&&R.jsx(xF,{onClose:()=>ms(!1),isDarkMode:Ne})})]})}const SF=()=>{const e=localStorage.getItem("appFont"),t=e?JSON.parse(e):"jetbrains";document.documentElement.style.setProperty("--app-font",`var(--font-${t})`),document.documentElement.classList.remove("font-jetbrains","font-inter"),document.documentElement.classList.add(`font-${t}`)};SF();console.log("App starting up with React",$t.version);Iy.createRoot(document.getElementById("root")).render(R.jsx($t.StrictMode,{children:R.jsx(bF,{})}));
